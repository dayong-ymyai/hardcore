<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>trtd core demo2</title>
    <link rel="stylesheet" href="./menus.css">
    <style>
        .diagramdiv{
            width: 100%;
            height: 900px;
            /* margin: 50px auto; */
            border: solid 1px #000;
        }
        #demo-btn {
            position: fixed;
            bottom: 120px;
            cursor: pointer;
            z-index: 9999;
            right:20px;
            width:100px;
            height:30px;
            display: block;
            background-color: antiquewhite;
            
        }
    </style>
</head>
<body>
    <div style="position:relative;height:100%" class="mainbox" id="mainbox">
        <div id="myDiagramDiv" class="diagramdiv"></div>
    </div>
    <div id="demo-btn">下一页</div>
</body>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gojs/1.8.16/go.js'></script>
<!-- <script src='go2.js'></script> -->
<script src='figure.js'></script>
<!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/gojs/2.0.5/go.js'></script> -->

<script src='../lib/main.js'></script>

<script>
     var myDiagram;
    function load(){
        console.log('dddd',window.Trtd)
       
        if(myDiagram){
            myDiagram.diagram == null;
        }
     
        // var jsonData = { "class": "go.GraphLinksModel",
        // "modelData": {"currentType":"dipan","currentThemeID":6,"isNewFile":true},
        // "nodeDataArray": [
        //     { "key": 1, "text": "中心主题", "fill": "#FF91E4", "category": "Root", "dangle": 0, "sweep": 360, "dradius": 0, "level": 0, "isparent": 2 ,"group":"g_1"}, 
        //     { "key": 2, "text": "双击编辑内容", "level": 1, "category": "dipan", "parent": 1, "radius": 100, "fill": "#EBBAFF", "strokeWidth": 2, "stroke": "#767678", "loc": "90.93266739736603 -52.50000000000005", "dangle": -30, "sweep": 120, "dradius": 70, "next":3, "isparent": 5, "group": -5 }, 
        //     { "key": 3, "text": "双击编辑内容", "color": "yellow", "level": 1, "category": "dipan", "radius": 100, "fill": "#EBBAFF", "dangle": 90, "dradius": 70, "sweep": 120, "parent": 1, "prev": 2, "strokeWidth": 2, "stroke": "#767678", "loc": "0 105", "next": 4, "isparent": 7, "group": -7 }, 
        //     { "key": 4, "text": "双击编辑内容", "color": "yellow", "level": 1, "category": "dipan", "radius": 100, "fill": "#EBBAFF", "dangle": 210, "dradius": 70, "sweep": 120, "parent": 1, "prev": 3, "strokeWidth": 2, "stroke": "#767678", "loc": "-90.93266739736605 -52.500000000000014", "isparent": 9, "group": -9 }, 
        //     { "isGroup": true, "parent": 2, "key": -5 }, 
        //     { "key": 5, "text": "双击编辑内容", "level": 2, "parent": 2, "category": "dipan", "radius": 90, "group": -5, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "151.55444566227672 -87.50000000000007", "dangle": -30, "sweep": 120, "dradius": 140 }, 
        //     { "isGroup": true, "parent": 3, "key": -7 }, 
        //     { "key": 7, "text": "双击编辑内容", "level": 2, "parent": 3, "category": "dipan", "istemp": false, "radius": 90, "group": -7, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "0 175", "dangle": 90, "sweep": 120, "dradius": 140 }, 
        //     { "isGroup": true, "parent": "4", "key": -9 }, 
        //     { "key": 9, "text": "双击编辑内容", "level": 2, "parent": 4, "category": "dipan", "istemp": false, "radius": 90, "group": -9, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "-151.55444566227675 -87.50000000000001", "dangle": 210, "sweep": 120, "dradius": 140 }
        // ], 
        // "linkDataArray": [
        //     { "from": 1, "to": "2", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 }, 
        //     { "from": "2", "to": "3", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 }, 
        //     { "from": "3", "to": "4", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 },
        //     { "from": "2", "to": "5", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }, 
        //     { "from": "3", "to": "7", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }, 
        //     { "from": "4", "to": "9", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }
        // ]}
        

        var jsonData ={ "class": "go.GraphLinksModel",
  "modelData": {"currentType":"tianpan", "type":"dspiral", "updatedAt":1560241655178},
  "nodeDataArray": [ 
{"text":"总结1", "deletable":true, "textStroke":"#0e399d", "iconVisible":false, "locationSpot":"0 0 0 0", "textAlign":"left", "category":"autoText", "loc":"-107.76606241341199 -425", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-33},
{"text":"总结3", "deletable":true, "textStroke":"#FFC000", "iconVisible":false, "locationSpot":"0 0.5 0 0", "textAlign":"left", "category":"autoText", "loc":"-139.46951672795058 -456.06601717798213", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-34},
{"text":"总结2", "deletable":true, "textStroke":"#cb1c27", "iconVisible":false, "locationSpot":"0 1 0 0", "textAlign":"left", "category":"autoText", "loc":"-192.407079217778 -481.5569669100272", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-35},
{"text":"总结", "deletable":true, "fill":"black", "iconVisible":false, "locationSpot":"1 0 0 0", "textAlign":"center", "category":"autoText", "loc":"-239 -353", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-36},
{"text":"时间", "deletable":true, "fill":"black", "iconVisible":false, "locationSpot":"1 0 0 0", "textAlign":"center", "category":"autoText", "loc":"-92 -350", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-37},
{"text":"能量", "deletable":true, "fill":"black", "iconVisible":false, "locationSpot":"1 0 0 0", "textAlign":"center", "category":"autoText", "loc":"-242 -500", "movable":true, "group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "key":-38},
{"group":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "text":"", "resizable":false, "category":"pic", "loc":"-242 -350", "picture":"https://static.365trtd.com/system/cbian/cbian.png", "width":150, "height":150, "key":-39},
{"category":"picGroup", "role":"cbian", "isGroup":true, "level":0, "key":"1a88558b-c9b2-d0a3-633e-097e53e507a4", "loc":"-318 -279.13701171875", "deletable":true}
 ],
  "linkDataArray": []}

        myDiagram = new Trtd("myDiagramDiv",{
                    modelChangedListener:function(m){
                        // console.log('from trtd:',m);
                    },
                    model: JSON.stringify(jsonData)
                })
        // myDiagram.loadModel(JSON.stringify(jsonData));
        
        // console.log('tdData:', tdData);
        // var tdData = myDiagram.getTdData();
        // console.log('tdData:', tdData);

        // myDiagram.downloadImage();
        // console.log('myDiagram.downloadImage():', myDiagram.downloadImage())
        // document.getElementsByTagName('img')[0].setAttribute('src', myDiagram.downloadImage())



        setTimeout(function(){
            
            // 双击画布创建的节点类型
            myDiagram.addTextNode('新增文本节点');
            // myDiagram.insertPicture('http://ytyi.oss-cn-beijing.aliyuncs.com/test/cbian.png');

        },1000)


    }
    load();

    document.getElementById('demo-btn').addEventListener('click', () => {
        // myDiagram.
        console.log("demo-btn",myDiagram.diagram.viewportBounds,myDiagram.diagram.viewportBounds.offset(myDiagram.diagram.viewportBounds.width,0))
        var bounds = myDiagram.diagram.viewportBounds.copy()
        bounds.offset(bounds.width,0)
        myDiagram.diagram.scrollToRect(bounds)
    })
</script>
<script src='./domjs.js'></script>
</html>