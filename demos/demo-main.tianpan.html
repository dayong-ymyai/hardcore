<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>trtd core demo2</title>
    <link rel="stylesheet" href="./menus.css">
    <style>
        .diagramdiv{
            width: 100%;
            height: 500px;
            /* margin: 50px auto; */
            border: solid 1px #000;
        }
    </style>
</head>
<body>
    <div style="position:relative;height:100%" class="mainbox" id="mainbox">
        <div id="myDiagramDiv" class="diagramdiv"></div>
    </div>
</body>
<script src='https://cdnjs.cloudflare.com/ajax/libs/gojs/1.8.16/go.js'></script>
<script src='../lib/main.js'></script>

<script>
     var myDiagram;
    function load(){
        console.log('dddd',window.Trtd)
       
        if(myDiagram){
            myDiagram.diagram == null;
        }
        // myDiagram = new Trtd("myDiagramDiv",{type:'tianpan',
        // ViewportBoundsChangedListener:function(m){
        //         // console.log('from trtd:',m);
        //         console.log("ViewportBoundsChangedListener:", arguments)
        //     }
        // })
        // var jsonData = { "class": "go.GraphLinksModel",
        // "modelData": {"currentType":"dipan","currentThemeID":6,"isNewFile":true},
        // "nodeDataArray": [
        //     { "key": 1, "text": "中心主题", "fill": "#FF91E4", "category": "Root", "dangle": 0, "sweep": 360, "dradius": 0, "level": 0, "isparent": 2 ,"group":"g_1"}, 
        //     { "key": 2, "text": "双击编辑内容", "level": 1, "category": "dipan", "parent": 1, "radius": 100, "fill": "#EBBAFF", "strokeWidth": 2, "stroke": "#767678", "loc": "90.93266739736603 -52.50000000000005", "dangle": -30, "sweep": 120, "dradius": 70, "next":3, "isparent": 5, "group": -5 }, 
        //     { "key": 3, "text": "双击编辑内容", "color": "yellow", "level": 1, "category": "dipan", "radius": 100, "fill": "#EBBAFF", "dangle": 90, "dradius": 70, "sweep": 120, "parent": 1, "prev": 2, "strokeWidth": 2, "stroke": "#767678", "loc": "0 105", "next": 4, "isparent": 7, "group": -7 }, 
        //     { "key": 4, "text": "双击编辑内容", "color": "yellow", "level": 1, "category": "dipan", "radius": 100, "fill": "#EBBAFF", "dangle": 210, "dradius": 70, "sweep": 120, "parent": 1, "prev": 3, "strokeWidth": 2, "stroke": "#767678", "loc": "-90.93266739736605 -52.500000000000014", "isparent": 9, "group": -9 }, 
        //     { "isGroup": true, "parent": 2, "key": -5 }, 
        //     { "key": 5, "text": "双击编辑内容", "level": 2, "parent": 2, "category": "dipan", "radius": 90, "group": -5, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "151.55444566227672 -87.50000000000007", "dangle": -30, "sweep": 120, "dradius": 140 }, 
        //     { "isGroup": true, "parent": 3, "key": -7 }, 
        //     { "key": 7, "text": "双击编辑内容", "level": 2, "parent": 3, "category": "dipan", "istemp": false, "radius": 90, "group": -7, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "0 175", "dangle": 90, "sweep": 120, "dradius": 140 }, 
        //     { "isGroup": true, "parent": "4", "key": -9 }, 
        //     { "key": 9, "text": "双击编辑内容", "level": 2, "parent": 4, "category": "dipan", "istemp": false, "radius": 90, "group": -9, "fill": "#B4B0FC", "strokeWidth": 2, "stroke": "#767678", "loc": "-151.55444566227675 -87.50000000000001", "dangle": 210, "sweep": 120, "dradius": 140 }
        // ], 
        // "linkDataArray": [
        //     { "from": 1, "to": "2", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 }, 
        //     { "from": "2", "to": "3", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 }, 
        //     { "from": "3", "to": "4", "level": 1, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 4 },
        //     { "from": "2", "to": "5", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }, 
        //     { "from": "3", "to": "7", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }, 
        //     { "from": "4", "to": "9", "level": 2, "color": "blue", "category": "dipan", "isTreeLink": true, "strokeWidth": 2.5 }
        // ]}
        

        var jsonData = {"class":"go.GraphLinksModel","modelData":{"currentType":"tianpan","type":"tianpan","currentThemeID":14,"backgroundColor":"#ffffff","updatedAt":1556170554276},"nodeDataArray":[{"key":"1","text":"精神","level":0,"font":"bold 18px 幼圆","radius":120,"loc":"-11 10","angle":0,"category":"0","isparent":"10","rad":24.000000000000075,"group":-2,"role":"theme"},{"isGroup":true,"parent":"1","fill":"rgba(0,0,0,0)","stroke":"rgba(0,0,0,0)","strokeWidth":0,"level":0,"key":-2,"loc":"-15.788799352971836 15.111886831145256","angle":0},{"key":"8","text":"冲破障碍","level":1,"parent":"1","prev":"9","next":"6","radius":100,"group":-2,"fill":"white","category":"0","loc":"127.42438303314839 -56.75412452561709","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":7.6,"rad":21.50000000000004},{"key":"9","text":"面对困难","level":1,"parent":"1","prev":"10","next":"8","radius":100,"group":-2,"fill":"white","category":"0","loc":"-34.502785856583046 -124.5851450415125","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":6.3,"rad":21.50000000000004},{"key":"10","text":"向往光明","level":1,"parent":"1","next":"9","radius":100,"group":-2,"fill":"white","category":"0","loc":"-159.0019817390921 -13.201937132519333","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":5,"rad":21.50000000000004},{"key":"6","text":"坚持不懈","color":"yellow","strokeWidth":2,"stroke":"black","fill":"white","group":-2,"level":1,"radius":100,"parent":"1","prev":"8","font":"bold 18px 幼圆","textStroke":"black","loc":"104.68387749586391 100.91089796720507","category":"0","newAdd":true,"angle":8.9,"next":"7"},{"key":"7","text":"奉献精神","color":"yellow","strokeWidth":2,"stroke":"black","fill":"white","group":-2,"level":1,"radius":100,"parent":"1","prev":"6","font":"bold 18px 幼圆","textStroke":"black","loc":"-69.95212182726954 154.808918703803","category":"0","newAdd":true,"angle":10.200000000000001}],"linkDataArray":[{"from":"9","to":"8","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":24.000000000000075,"unautoLink":false,"points":[16.34248329875518,-128.55485592786317,45.281208920042445,-125.67420393807585,72.23700854806762,-114.38246450899915,94.58887634136012,-95.77757260870595]},{"from":"1","to":"10","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","points":[-51.1689346719447,55.90704398369641,-83.69722984500002,71.12236433151651,-119.56561473358308,62.85369882301774,-142.14993886105202,34.9333789133601],"curviness":24.000000000000075,"unautoLink":false},{"from":"10","to":"9","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":24.000000000000075,"unautoLink":false,"points":[-139.3221376663135,-60.25195028098856,-125.41280555527094,-81.69001732587833,-106.29253572195468,-98.79596708743429,-83.4445651261457,-110.24282159203567]},{"from":"8","to":"6","level":1,"color":"black","isTreeLink":true,"strokeWidth":2,"points":[139.78209600340176,-7.273957487248743,141.41104415287558,14.617106597318596,138.26907251408525,36.40110028600272,130.52037957054222,56.939598685228496],"unautoLink":false},{"from":"6","to":"7","level":1,"color":"black","isTreeLink":true,"strokeWidth":2,"points":[68.32940125780769,136.67892918862694,42.33648833471334,154.7792796579252,11.90978410243256,164.16989294507098,-19.76295532266719,163.86692983060718],"unautoLink":false}]}


         jsonData = {"class":"go.GraphLinksModel","modelData":{"currentType":"tianpan","type":"tianpan","currentThemeID":14,"backgroundColor":"#ffffff","updatedAt":1554963743516},"nodeDataArray":[{"key":"1","text":"中心主题","level":0,"font":"bold 18px 幼圆","radius":120,"loc":"-11 10","angle":0,"category":"0","isparent":"10","rad":40.70000000000031,"group":-2,"role":"theme"},{"isGroup":true,"parent":"1","fill":"rgba(0,0,0,0)","stroke":"rgba(0,0,0,0)","strokeWidth":0,"level":0,"key":-2,"loc":"43.425724097208615 -178.31395562106127","angle":0},{"key":"8","text":"","level":1,"parent":"1","prev":"9","next":null,"radius":100,"group":-11,"fill":"white","category":"0","loc":"306.9093371045635 17.39376998317927","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":0,"isparent":"18","rad":21.50000000000004},{"key":"9","text":"","level":1,"parent":"1","prev":"10","next":"8","radius":100,"group":-25,"fill":"white","category":"0","loc":"53.17465361364418 -244.65115202769226","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":0,"isparent":"31","rad":21.50000000000004},{"key":"10","text":"","level":1,"parent":"1","next":"9","radius":100,"group":-19,"fill":"white","category":"0","loc":"-194.59603894559672 -86.753472720557","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":0,"isparent":"24","rad":21.50000000000004},{"isGroup":true,"group":-2,"parent":"8","fill":"rgba(0,0,0,0)","stroke":"rgba(0,0,0,0)","strokeWidth":0,"level":1,"key":-11,"loc":"288.7617410854215 -47.29149461562466","angle":7.7488935718910685},{"key":"17","text":"","level":2,"parent":"8","prev":"18","next":null,"radius":95,"group":-11,"fill":"white","category":"0","loc":"367.5997676051073 -111.97675921442863","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":6.570796326794897},{"key":"18","text":"","level":2,"parent":"8","next":"17","radius":95,"group":-11,"fill":"white","category":"0","loc":"209.92371456573545 -33.71678685937499","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":5},{"isGroup":true,"group":-2,"parent":"10","fill":"rgba(0,0,0,0)","stroke":"rgba(0,0,0,0)","strokeWidth":0,"level":1,"key":-19,"loc":"-241.8388502150109 -112.30875114183445","angle":5},{"key":"24","text":"","level":2,"parent":"10","next":null,"radius":95,"group":-19,"fill":"white","category":"0","loc":"-291.5816614844248 -137.86402956311196","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":5},{"isGroup":true,"group":-2,"parent":"9","fill":"rgba(0,0,0,0)","stroke":"rgba(0,0,0,0)","strokeWidth":0,"level":1,"key":-25,"loc":"35.02705759450244 -309.3364166264971","angle":6.374446785945534},{"key":"27","text":"","level":2,"parent":"9","prev":"31","next":null,"radius":95,"group":-25,"fill":"white","category":"0","loc":"113.86508411418798 -374.02168122530225","strokeWidth":2,"stroke":"black","font":"bold 18px 幼圆","textStroke":"black","newAdd":true,"angle":6.570796326794897},{"key":"31","text":"","color":"yellow","strokeWidth":2,"stroke":"black","fill":"white","next":"27","group":-25,"level":2,"radius":95,"parent":"9","font":"bold 18px 幼圆","textStroke":"black","loc":"-43.81096892518301 -295.76170887024716","category":"0","newAdd":true,"angle":5}],"linkDataArray":[{"from":"9","to":"8","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":24.000000000000075,"unautoLink":false,"points":[103.1057965444436,-234.26457580527642,200.2659987661732,-204.8822680830413,271.8997354741981,-130.90240576881624,298.13671520967654,-32.84606585541943]},{"from":"1","to":"10","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","points":[-59.85631034210658,46.5247989694094,-125.58743427058808,70.29695647157716,-188.4308775999624,33.09854879607417,-199.21183186171865,-35.96278011102972],"curviness":40.70000000000031,"unautoLink":false},{"from":"10","to":"9","level":1,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":24.000000000000075,"unautoLink":false,"points":[-173.35817335924693,-133.12105908577698,-135.18492287063773,-196.89139866309085,-71.7503143986527,-237.3165892375909,2.1757408165118086,-244.9841588001361]},{"from":"8","to":"18","level":2,"isTreeLink":true,"strokeWidth":2,"color":"black","points":[261.1843887500255,39.9820213093644,242.36665251877417,39.620240705591385,225.72030935049548,30.303636015704768,215.57119624744428,14.453286325692062],"curviness":21.50000000000004,"unautoLink":false},{"from":"18","to":"17","level":2,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":21.50000000000004,"unautoLink":false,"points":[234.22300022276482,-75.69052527469941,256.176703739299,-100.7286950864208,286.258677011293,-115.65939858433146,319.47578318273304,-118.00437261569354]},{"from":"31","to":"27","level":2,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":21.50000000000004,"unautoLink":false,"points":[-19.511683268152893,-337.7354472855732,2.442020248381155,-362.7736170972946,32.523993520375086,-377.7043205952054,65.74109969181488,-380.04929462656736]},{"from":"9","to":"31","level":2,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":21.50000000000004,"unautoLink":false,"points":[7.449705259107844,-222.06290070150953,-11.36803097214306,-222.42468130528255,-28.014374140421467,-231.74128599516905,-38.16348724347259,-247.59163568518147]},{"from":"10","to":"24","level":2,"isTreeLink":true,"strokeWidth":2,"color":"black","curviness":21.50000000000004,"unautoLink":false,"points":[-240.32098730013377,-64.16522139437166,-259.13872353138515,-64.52700199814456,-275.785066699664,-73.84360668803133,-285.9341798027152,-89.69395637804422]}]}
        // myDiagram.loadModel(JSON.stringify(jsonData));
        myDiagram = new Trtd("myDiagramDiv",{
                    modelChangedListener:function(m){
                        // console.log('from trtd:',m);
                    },
                    model: jsonData
                })
        // console.log('tdData:', tdData);
        // var tdData = myDiagram.getTdData();
        // console.log('tdData:', tdData);

        // myDiagram.downloadImage();
        // console.log('myDiagram.downloadImage():', myDiagram.downloadImage())
        // document.getElementsByTagName('img')[0].setAttribute('src', myDiagram.downloadImage())



        // setTimeout(function(){
            
        //     // 双击画布创建的节点类型
        //     myDiagram.addTextNode('新增文本节点');
        //     myDiagram.insertPicture('http://www.365trtd.com/media/images/qipao/gpsmapicons02_看图王.png');

        // },1000)


    }
    load();
</script>
<script src='./domjs.js'></script>
</html>