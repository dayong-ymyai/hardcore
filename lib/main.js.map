{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap de4648fe67bdd93e1de1","webpack:///./src/helpers/helpers.gojs.js","webpack:///./src/nodeTemplate/base.js","webpack:///./src/nodeTemplate/createPictureSingleNodeTemplate.js","webpack:///./src/nodeTemplate/createTextNodeTemplate.js","webpack:///./src/diagram/tianpan.js","webpack:///./src/nodeTemplate/createPictureNodeTemplate.js","webpack:///./src/nodeTemplate/createNodeSvgTemplate.js","webpack:///./src/nodeTemplate/createNodeTemplate.js","webpack:///./src/datas/svg.template.js","webpack:///./src/layout/waveGroupLayout.js","webpack:///./src/diagram/trtd.js","webpack:///./src/nodeTemplate/factory.js","webpack:///./src/assets/localization.js","webpack:///./src/main.js","webpack:///./src/layout/SpiralLayout.js","webpack:///./src/nodeTemplate/waveNodeTemplate.js","webpack:///./src/nodeTemplate/waveGroupNodeTemplate.js","webpack:///./src/nodeTemplate/axisGroupNodeTemplate.js","webpack:///./src/layout/axisGroupLayout.js","webpack:///./src/nodeTemplate/iconTextNodeTemplate.js","webpack:///./src/nodeTemplate/autoTextNodeTemplate.js","webpack:///./src/nodeTemplate/labelGroupNodeTemplate.js","webpack:///./src/nodeTemplate/picNodeTemplate.js","webpack:///./src/nodeTemplate/picGroupNodeTemplate.js","webpack:///./src/nodeTemplate/yunGroupNodeTemplate.js","webpack:///./src/layout/yunGroupLayout.js","webpack:///./src/nodeTemplate/yunpanGroupNodeTemplate.js","webpack:///./src/layout/yunpanGroupLayout.js","webpack:///./src/nodeTemplate/shapeNodeTemplate.js","webpack:///./src/nodeTemplate/shapeTextNodeTemplate.js","webpack:///./src/linkTemplate/createTianpanLink.js","webpack:///./src/diagram/dipan.js","webpack:///./src/diagram/jin.js","webpack:///./src/diagram/huo.js","webpack:///./src/diagram/shui.js","webpack:///./src/diagram/yunpan.js","webpack:///./src/diagram/wheel.js","webpack:///./src/diagram/dspiral.js","webpack:///./src/nodeTemplate/createArcNodeTemplate.js","webpack:///./src/nodeTemplate/createLineNodeTemplate.js","webpack:///./src/nodeTemplate/createWaveNodeTemplate.js","webpack:///./src/tools/GroupRotatingTool.js","webpack:///./src/tools/textEditor.js"],"names":["exports","module","checkPhone","navigator","userAgent","match","guid","S4","Math","random","toString","substring","getElementByAttr","document","tag","attr","value","aElements","getElementsByTagName","aEle","i","length","getAttribute","push","clear","chart","ctx","clearRect","width","height","nodeInfo","d","str","key","text","group","linkInfo","from","to","groupInfo","adornment","g","adornedPart","mems","memberParts","count","links","each","part","go","Link","data","queue","enqueue","record","unshift","dequeue","pop","tdTravelTdpDataWidth","nodeData","model","collector","callback","console","log","dealingNode","isEmpty","isparent","childNodeData","findNodeDataForKey","next","tdTravelTdpData","e","nextNodeData","deleteOldData","time","temp","diff","item","window","localStorage","hasOwnProperty","startsWith","JSON","parse","getItem","Date","getTime","modelData","updatedAt","removeItem","error","saveModelToLocalStorage","tpid","setItem","toJson","checkModel","nodeDataArray","root","collectior","checkDataExists","msg","level","parent","prev","tdTransToNum","defaultVal","arguments","result","parseFloat","simulateEnterWithAlt","myDiagram","diagram","currentTool","currentTextEditor","textEditorHandler","evt","which","keyCode","altKey","ctrlKey","shiftKey","start","selectionStart","end","selectionEnd","val","slice","isActive","acceptText","TextEditingTool","LostFocus","mainElement","onkeypress","travelParts","rootNode","containingGroup","stack","node","link","child","nextChild","findNodeForKey","findLinksTo","first","$","GraphObject","make","info","defineBuilder","args","buttonFillNormal","buttonStrokeNormal","buttonFillOver","buttonStrokeOver","buttonFillPressed","buttonStrokePressed","buttonFillDisabled","paddingHorizontal","paddingVertical","button","Panel","isActionable","enabledChanged","btn","enabled","shape","findObject","fill","cursor","Shape","name","figure","spot1","Spot","spot2","parameter1","parameter2","stroke","mouseEnter","isEnabledObject","brush","mouseLeave","actionDown","oldskip","skipsUndoManager","actionUp","overButton","actionCancel","actionMove","firstInput","standardMouseOver","over","findObjectAt","documentPoint","x","panel","NodeBase","options","that","nodeProperties","getNodeProperties","binding","getBinding","Binding","obj","remark","TextBlock","maxSize","Size","NaN","font","wrap","WrapFit","margin","properties","Adornment","strokeWidth","Placeholder","Point","makeTwoWay","stringify","alignment","editable","isMultiline","overflow","OverflowClip","WrapDesiredSize","textAlign","spacingAbove","spacingBelow","portId","stretch","Uniform","v","indexOf","helpers","ofObject","Node","__trtd","nodeClickListener","selectText","showNodeRemarkTips","removeNodeRemarkTips","selnode","selection","category","_prevFill","setNodeAsSibling","setNodeAsChildren","createPictureSingleNodeTemplate","fontSize","layerName","zOrder","locationSpot","Center","resizeCellSize","locationObjectName","resizable","resizeObjectName","rotatable","rotateObjectName","doubleClick","nodeDoubleClickListener","click","selectable","movable","angle","layoutConditions","Part","LayoutStandard","alignmentFocus","resizeAdornmentTemplate","nodeResizeAdornmentTemplate","contextMenu","nodeContextMenu","selectionAdornmentTemplate","commandHandler","deleteSelection","centerPicture","equalWidthHeightPicture","bringToLayer","undefined","startTransaction","setDataProperty","commitTransaction","Picture","successFunction","pict","element","sourceCrossOrigin","now","replace","createTextNodeTemplate","location","toMaxLinks","strokeDashArray","fromLinkable","toLinkable","minSize","split","Brush","color","Fill","_","contains","SpiralLayout","require","TRTD_BASE","Trtd","lang","createNodeTemplate","createPictureNodeTemplate","createNodeSvgTemplate","createTianpanLink","colorMap","div","config","modelChangedListener","type","initDiagramBase","initDiagram","initListener","initModel","defaultConfig","diagramConfig","Object","assign","setProperties","addNodeTemplate","addLinkTemplate","addGroupTemplate","showIds","loc","lastInput","addNodeData","findPartAt","fixPictureMenu","message","trans","tmpModel","Model","fromJson","currentType","filter","isGroup","linkDataArray","layout","isInitial","centerTextAngle","centerTextMode","maxOlive","shapeStrokes","beginSpark","showShape","role","visible","updateAllTargetBindings","animationManager","isEnabled","groupTemplateMap","add","Group","pickable","ungroupable","contextClick","actualBounds","Top","Bottom","copyable","isRealtime","radius","clockwise","LayoutNodeSized","LayoutAdded","parseInt","size","addNodeTemplateBase","nodeTemplateMap","linkTemplateMap","isDescendant","disconnectFromTreeStructure","firstChild","setToKeyForLinkData","newLink","copyLinkData","addLinkData","isTreeLink","applyTheme2Link","newGroup","nodeGroup","addGroupForNode","sibling","nextNode","preLink","findLinksInto","parentGroup","isOngoing","isValidLayout","cmd","locateNode","tempArray","removeNodeData","deleteNode","CommandHandler","prototype","call","ex","select","mainNode","n","preNode","findNodesInto","nextNodeLink","intoLink","tmpNodeData","oldlink","points","__gohashid","nodeGroupData","nodes","groups","mylinks","isMemberOf","removeNodeDataCollection","removeLinkDataCollection","parGroup","grandNode","removeLinkData","isModified","isautolayout","toKey","nextkey","follower","makeNodeDataKeyUnique","nextnode","nextlink","findNodesOutOf","findLinksOutOf","l","applyTheme2Node","deleteLink","dangle","dradius","sweep","layerThickness","tdDipanTextAngle","textStroke","nextLocation","copy","parentNode","computeNextLoc","newAdd","linkToFollower","toArrow","copyLink","iskeyboard","toolManager","textEditingTool","tb","innerText","stopTool","ControlAutoLayout","autoLayoutPart","addLevelNodeData","newnode","findNodeForData","editTextBlock","addChildNodeData","centerRect","firstNode","firstLink","istemp","max","InitialFontSize","applyTheme2Group","setGroupKeyForNodeData","computeChildLoc","picture","direction","prevNode","event","autoLayoutAll","centerNode","centerCurrentNode","zoomToFit","bubbles","addFollower","startNewSpiral","canCollapseSubGraph","collapseSubGraph","canExpandSubGraph","expandSubGraph","moveWithinNodes","doKeyDown","imgdata","makeImageData","scale","background","tinycolor","saturate","toolTip","Margin","desiredSize","arr","pushChildKeyToArr","re","test","changeTemp2normal","tmpNode","lastNode","tdCurrentTheme","borderWidth","borderColor","colorRange","randomColor","luminosity","Array","tmpColor","makeAnnularWedge","p","rotate","q","geo","Geometry","PathFigure","y","PathSegment","Arc","Line","close","normalize","getRootNodeData","getNodeContextMenu","style","menus","applyStyle2Level","applyStyle2CurLevel","applyStyle2ChiLevel","yunpan","yunpandel","addy","addx","dipan","addFollowerGround","addNewCircle","descendant","cur","parNode","linkColor","parentGroupKey","childGroup","flag","groupStrokeWidth","groupStroke","groupColor","rootLoc","rootPoint","firstLoc","relativeFirstLoc","relativeMidLoc","midLoc","offset","computeOffset","curLoc","relativeLoc","depth","nextLoc","relativeNextLoc","directionPoint","prevLoc","relativeLocPrev","lastLoc","newR","newStartAngle","ctl2","dy","dx","sin","PI","cos","interactions","getNodeSelectionAdornmentTemplate","va","sqrt","svg","doubleClickCreateNodeType","selectionObjectName","geometryString","threeWheel","measuredBounds","mouseOver","mouseDragEnter","mouseDragLeave","mouseDrop","RowColumnDefinition","column","row","Left","alert","rowSpan","adustOliveText","setTimeout","trim","lineCount","adjustTextAngle","shi","xu","groupTextAngle","textAngle","order","nangle","__location","naturalBounds","computeNewRotateLoc","nloc","__switchOrder","__offset","subtract","layoutWaveGroup","it","collection","oliveWidth","oliveHeight","shiStroke","xuStroke","centerStroke","oliveType","haveTail","maxWidth","maxHeight","line","waveTotalSize","shiTextColl","xuTextColl","centerTextColl","shiStrokeWidth","xuStrokeWidth","shiStrokeDashArray","xuStrokeDashArray","autogroupConfig","resizeObject","waveCount","sort","a","b","Number","lastOlive","oldOrder","forEach","index","newOrder","__oldOrder","shiText","xuText","isNew","__oldLocation","nalign","initCenterText","centerText","objCenterText","nwidth","updateTargetBindings","ncolor","WaveGroupLayout","Layout","Diagram","inherit","rotateCenter","currentLoc","equals","nodeOrigin","newNodeOrigin","newNodeLoc","doLayout","coll","collectParts","iterator","GridLayout","nodeTemplateFactory","textDoubleClick","showContextMenuListener","hideContextMenuListener","dealFireTextCallback","exportAsSubFigureCallback","ViewportBoundsChangedListener","InitialLayoutCompleted","cxElement","deleteCallback","canAddAxisGroup","createFigure","openFigure","useDefaultContext","defaultCxElement","containerDivId","id","themeName","lastModified","modifiedIndex","resetZoom","source","apiInsertPicture","rootKey","err","themeText","subRole","tmp","figureId","setCategoryForNodeData","newData","copyNodeData","clearRelProperty","dimKey","iconVisible","deletable","theta","orderX","orderY","dimX","dimY","imageParas","list","List","isSelected","findSubGraphParts","parts","doCancel","undo","redo","getNodeTemplate","groupKey","basePoint","groupData","picData","themeData","timeData","energeData","text1Data","text2Data","text3Data","onTextChanged","initialContentAlignment","initialAutoScale","initialDocumentSpot","initialViewportSpot","padding","allowDrop","ToolManager","WheelZoom","maxScale","minScale","hasVerticalScrollbar","hasHorizontalScrollbar","scrollMode","InfiniteScroll","scrollMargin","maxSelectionCount","validCycle","CycleDestinationTree","isTransactionFinished","saveModel","ViewportBoundsChanged","mouseOverListener","clickListener","forelayer","findLayer","addLayerBefore","Layer","draggingTool","computeEffectiveCollection","rotatingTool","handleArchetype","linkReshapingTool","linkingTool","linkValidation","sameGroup","relinkingTool","dokeyDownFn","nodeCopy","clearSelection","clickCreatingTool","archetypeNodeData","addDiagramContextMenu","doms","getElementById","removeChild","createElement","setAttribute","body","appendChild","box","toolTipText","innerHTML","left","clientX","top","clientY","position","zIndex","backgroundColor","TopLeft","BottomRight","getDefaultCustomMenuDivStr","mainbox","contextMeluDom","getElementsByClassName","bindMenuEventListener","menuList","addEventListener","cxTool","contextMenuTool","customMenu","preventDefault","tabIndex","showContextMenu","contextmenu","currentContextMenu","hideContextMenu","mousePt","viewPoint","showMenus","getShowContextMenus","liL","display","Set","addAll","tool","DraggingTool","fromnode","fromport","tonode","toport","cxcommand","ContextMenuTool","tdAddChildNode","tdAddLevelNode","changeDipanBackgroundImg","removeDipanBackgroundImg","removeNodePicture","removeOutCycle","insertTextNode","duplicateNode","insertPart","orderChildNode","clearOrderChildNode","waveNodeTemplate","waveGroupNodeTemplate","axisGroupNodeTemplate","iconTextNodeTemplate","autoTextNodeTemplate","labelGroupNodeTemplate","picNodeTemplate","picGroupNodeTemplate","yunGroupNodeTemplate","yunpanGroupNodeTemplate","shapeNodeTemplate","shapeTextNodeTemplate","nodeType","nodeTemplateClass","eval","localization","en","chn","cn","typeModules","IS_PROD","trtdClass","version","TRTD_VERSION","tdDebug","tdSpacing","tdSpiralMode","_radius","_spacing","_clockwise","_pointlist","cloneProtected","getInvolutePoint","checkCoveredWithNodes","rect","nodesRectList","_cover","point","distanceSquaredPoint","network","makeNetwork","findFlag","vertexes","topNodes","sourceEdges","cw","rad","vert","_do","res","initialAngle","edge","fromVert","dept","dl","nextedge","nextvert","nodesDealed","curRect","newPoint","dia","distance","equaldistance","tmpR","destinationEdges","toVertex","childCount","hasGroup","tmpPoint","radiusDis","adjustAngleCount","curviness","angleOld","toNode","atan","centerX","centerY","unautoLink","angle1","angle2","equalSpiral","min","updateParts","commitLayout","commit","edges","diameter","bounds","defineProperty","get","set","Error","invalidateLayout","computeControlPoint","p1","p2","p3","triangleCircle","cent","abs","startX","startY","endX","endY","ctl1","isThreePointsOnOneLine","x1","x2","x3","y1","y2","y3","c","S","t1","t2","t3","Base","stayInGroup","pt","gridpt","grp","back","shift","getDocumentPoint","WaveNodeTemplate","radiusX","radiusY","SvgArc","clockwiseFlag","defaultStretch","seg","QuadraticBezier","None","flip","makeGeo","makeGeoWave","textEdited","textBlock","oldv","newv","enterCount","isPanelMain","Right","addOlive","__trtdNode","getTooTip","LayoutRemoved","LeftCenter","deleteObjs","cbian","backupSelnode","h","getShiHalfEllipseShape","getXuHalfEllipseShape","getTextBuild","TopRight","s","targetObject","title","waveGroupLayout","axisGroupLayout","AxisNodeTemplate","BottomLeft","switchBorder","addFreeText","AxisGroupLayout","dataCollection","centerLine","axisX","axisY","axisXText","axisYText","labelText1","labelText2","labelText3","labelGroup","waveGroup","itl","IconTextTemplate","verticalAlignment","OverflowEllipsis","maxLines","AutoTextTemplate","checkSameRadius","maxRadius","r1","r2","reset","gridWidth","Rect","zoomToRect","dealFireText","showBorder","_controlExpand","oliveNode","olive","selOrderX","selOrderY","selDimKey","nodeCoreTexts","selnodeCoreTexts","yunnodeCoreTexts","yunselnodeCoreTexts","normDim","selOrder","nodeOrder","tmpX","tmpY","selDimId","dimid","centerOrderX","__yunPointsX","centerOrderY","__yunPointsY","areaBackground","selectionChanged","snapType","__prestroke","shapeData","nod","opacity","UniformToFill","m","RightCenter","LabelGroupNodeTemplate","oldStatus","hiddenAllText","spacing","cellSize","arrangement","LeftToRight","wrappingColumn","Location","PicNodeTemplate","PicGroupNodeTemplate","offsetBig","cbianText1","cbianText2","cbianText3","offsetSmall","cbianThemes","textStrokes","offsets","pictureBig","offsetsBig","sizeBig","cbianType","cbianName","theme","len","baseNode","pic","propertyPicture","propertySize","propertyoffset","nodeNameList","nodeName","changeCbianThemeColor","nextIndex","changeCbianName","yunGroupLayout","YunNodeTemplate","defaultTextFont","minX","minY","snapToGrid","gridHeight","YunGroupLayout","verticalLines","horizontalLines","freelLines","allLines","freeTexts","shapeNodes","allPointsX","allPointsY","shapeWidth","autoSnapText","dimXLoc","dimYLoc","addFreeShapeText","horizontalDim","verticalDim","isShadowed","shadowColor","shadowOffset","SmoothLink","computeNewCenter","O","A","B","C","locD","r","OC","directionOC","directionFlagOD","directionOD","angleDOC","OD","makeGeometry","Path","figures","computePoints","fromNode","isReal","centInfo","centorPoint","micenter","rcenter","rstart","rend","center2mid","af","acos","start2","end2","clearPoints","isNaN","oust","curve","Bezier","adjusting","Stretch","relinkableFrom","relinkableTo","reshapable","_preStoke","_preStrokeWidth","draggedNode","readOnly","allowMove","groundLayout","globalProperties","tdGetModelData","createDipanTemplate","getDipanRootTemplate","selectionAdorned","BottomCenter","myDiagram1","currentThemeID","splitLayer","maxCircle","getMaxCircle","maxCircles","totalCount","dipanRoot","nodeArr","nodeLevelArr","maxNodeArr","apply","Infinity","firstnodeData","sectotLayerThickNess","getTdLayout","followerNode","changeLayout","radialLayout","splitRadlayout","maxlayer","_laid","radlay1","layer","getAllChilds","parentKey","found","newdata","rootRadius","separator","label","tmpDataObj","getNumOfLevelChild","childNum","sweepUnit","tmpArray","tmpAngle","isAll","has","find","o","Trtd_tianpan","initDiagramYun","getYunpanNodeContextMenu","yunpanDokeyDownFn","createNodeTemplatex","createNodeTemplatey","yTemplate","tTemplate","LogicXor","addtextTemplate","geometry","mouseHover","spotConverter","dir","shapeShowblur","circleStroke","showToolTip","circle","shadowBlur","del","yl","locy","locL","loclc","geometryStringx","loco","newy","newytext","xl","newx","newxtext","locx","changelen","changelenx","datalocx","gs","gs2","gs3","createArcNodeTemplate","createLineNodeTemplate","createWaveNodeTemplate","GroupRotatingTool","PartResized","subject","lastWave","nodeSize","waveSize","SelectionMoved","clearAllTextBorder","canCopySelection","pasteFromClipboard","waveColl","yunGroup","resizingTool","computeReshape","adornedObject","TextEditor","defaultTextEditor","canDelete","deleteNodes","deleteLines","unnormDim","lineRole","copySelection","pasteSelection","axisData","addAxisGroup","emptyAxis","curOrder","splitOlive","addCbian","curShiText","curXuText","hyperlink","baseLoc","axisGroupKey","labelGroupKey","waveGroupKey","olive1Key","olive2Key","olive3Key","olive4Key","olive1ShiTextKey","olive1XuTextKey","olive2ShiTextKey","olive2XuTextKey","olive3ShiTextKey","olive3XuTextKey","olive4ShiTextKey","olive4XuTextKey","olive1CenterTextKey","olive2CenterTextKey","olive3CenterTextKey","olive4CenterTextKey","concat","axisGroupCount","getAxisGroupData","fireTexts","dimText1","dimText2","dimText3","dimText4","dimText5","dimText6","dimText7","dimText8","text1","text2","text3","text4","text5","text6","text7","text8","waveTail","tailOlive","mapObj","curLine","dimTextData","lineData","changeCbianSize","toLayerName","toZOrder","tempData","prenode","upnode","downnode","findPrevOlive","upNode","findUpOlive","findNextOlive","downNode","findDownOlive","canSelect","lineLoc","nodeLoc","cp","_rotatePoint","relativeLocation","newangle","originalAngle","ang","newrad","centerLocationOffset","dist","cpOrigin","Horizontal","strokeCap","makeWave","tx","ty","repeat","offx","offy","sx","sy","fig","odd","computeGeo1","isGeometryPositioned","computeGeo","computeGeo2","RotatingTool","_initialInfo","handleAngle","doActivate","infos","Map","MultiplePartInfo","walkTree","locationObject","locoffset","relloc","rotateObject","relativeloc","rotationAngle","textarea","tempText","measureTemporaryTextBlock","textScale","rows","observe","attachEvent","handlers","t","handler","resize","minHeight","scrollHeight","delayedResize","keynum","Enter","Tab","doFocus","state","StateActive","StateEditing","selectsTextOnActivate","setSelectionRange","StateNone","focus","HTMLInfo","valueFunction","show","StateInvalid","border","pos","sc","textscale","getDocumentScale","minimumEditorScale","textwidth","textheight","paddingsize","className","hide"],"mappings":"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KAAKvF,IAAL,CAAUoD,MAAb,EAAoB;AAChB,oBAAI2V,aAAaxT,KAAK1B,OAAL,CAAa8B,cAAb,CAA4BJ,KAAKvF,IAAL,CAAUoD,MAAtC,CAAjB;AACA,oBAAG2V,WAAW/Y,IAAX,CAAgBqa,MAAnB,EAA0B;AACtB;AACH;AACJ;AACDuE,kBAAME,YAAN,CAAmBzd,CAAnB;AACH;AAX2B,KADpC,CA5JG,EA0KHyE,EAAE,mBAAF,EACIA,EAAEhG,GAAG8J,SAAL,EAAgB,IAAhB,CADJ,EAC2BuU,KAD3B,EACkC;AAC1B9Q,eAAO,eAAShM,CAAT,EAAYqI,GAAZ,EAAiB;AACpB,gBAAI9F,YAAYvC,EAAEwC,OAAlB;AACA,gBAAI0B,OAAO3B,UAAUsI,SAAV,CAAoBrG,KAApB,EAAX;AACA,gBAAGN,KAAKvF,IAAL,CAAUoD,MAAb,EAAoB;AAChB,oBAAI2V,aAAaxT,KAAK1B,OAAL,CAAa8B,cAAb,CAA4BJ,KAAKvF,IAAL,CAAUoD,MAAtC,CAAjB;AACA,oBAAG2V,WAAW/Y,IAAX,CAAgBqa,MAAnB,EAA0B;AACtB;AACH;AACJ;AACDuE,kBAAME,YAAN,CAAmBzd,CAAnB;AACH;AAXyB,KADlC,CA1KG,CAAP;AA0LH;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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MAAxE,EAAgF+J,KAAhF,EAHJ,CADC,CAAV;AAKAP,QAAIQ,SAAJ;AACA,WAAOR,GAAP;AACH;;AAED,SAASS,eAAT,CAAyBxd,KAAzB,EAAgC;AAC5B,QAAIsC,OAAO,IAAX;AACAA,WAAOtC,MAAMqC,aAAN,CAAoBumC,IAApB,CAAyB,UAACC,CAAD,EAAK;AACjC,YAAG,CAACA,EAAEh3B,OAAH,IAAcg3B,EAAEn9B,QAAF,IAAc,MAA5B,IAAsCm9B,EAAEnmC,KAAF,IAAW,CAApD,EAAsD;AAClD,mBAAO,IAAP;AACH;AACJ,KAJM,CAAP;;AAMA,WAAOJ,IAAP;AACH;;AAMD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA,SAASqmB,gBAAT,CAA0BppB,IAA1B,EAAgC;AAC5BA,SAAKmD,KAAL,GAAa,CAAb;AACA,WAAOnD,KAAKqD,IAAZ;AACA,WAAOrD,KAAKgB,QAAZ;AACA,WAAOhB,KAAKmB,IAAZ;AACA,WAAOnB,KAAKhB,KAAZ;AACA,WAAOgB,KAAKoD,MAAZ;AACA,WAAOpD,IAAP;AACH;;AAED;AACA,SAAS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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"main\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"main\"] = factory();\n\telse\n\t\troot[\"main\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap de4648fe67bdd93e1de1","// 'use strict';\n\n// var helpers = require('./helpers.core');\n// import buckets from '../assets/buckets.min'\n/**\n * @namespace Chart.helpers.canvas\n */\nvar exports = module.exports = {\n\n\tcheckPhone(){\n\t\t\tif(!navigator) return true;\n\t\t\tif ((navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))) {\n\t\t\t\t/*window.location.href=\"你的手机版地址\";*/\n\t\t\t\treturn true\n\t\t\t}\n\t\t\telse {\n\t\t\t\t/*window.location.href=\"你的电脑版地址\";    */\n\t\t\t\treturn false\n\t\t\t}\n\t},\n\n\tguid() {\n\t\tfunction S4() {\n\t\t\treturn (((1+Math.random())*0x10000)|0).toString(16).substring(1);\n\t\t}\n\t\treturn (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\n\t},\n\n\tgetElementByAttr(document, tag,attr,value)\n\t{\n\t\tvar aElements=document.getElementsByTagName(tag);\n\t\tvar aEle=[];\n\t\tfor(var i=0;i<aElements.length;i++)\n\t\t{\n\t\t\tif(aElements[i].getAttribute(attr)==value)\n\t\t\t\taEle.push( aElements[i] );\n\t\t}\n\t\treturn aEle;\n\t},\n\t// extend: function(target) {\n\t// \tvar setFn = function(value, key) {\n\t// \t\ttarget[key] = value;\n\t// \t};\n\t// \tfor (var i = 1, ilen = arguments.length; i < ilen; ++i) {\n\t// \t\thelpers.each(arguments[i], setFn);\n\t// \t}\n\t// \treturn target;\n\t// },\n\n\t/**\n\t * Clears the entire canvas associated to the given `chart`.\n\t * @param {Chart} chart - The chart for which to clear the canvas.\n\t */\n\tclear: function(chart) {\n\t\tchart.ctx.clearRect(0, 0, chart.width, chart.height);\n\t},\n\tnodeInfo: function(d) {  // Tooltip info for a node data object\n\t\tvar str = \"Node \" + d.key + \": \" + d.text + \"\\n\";\n\t\tif (d.group)\n\t\t  str += \"member of \" + d.group;\n\t\telse\n\t\t  str += \"top-level node\";\n\t\treturn str;\n\t},\n\tlinkInfo: function(d) {  // Tooltip info for a link data object\n\t\treturn \"Link:\\nfrom \" + d.from + \" to \" + d.to;\n\t},\n\tgroupInfo: function(adornment) {  // takes the tooltip or context menu, not a group node data object\n\t\tvar g = adornment.adornedPart;  // get the Group that the tooltip adorns\n\t\tvar mems = g.memberParts.count;\n\t\tvar links = 0;\n\t\tg.memberParts.each(function(part) {\n\t\t\tif (part instanceof go.Link) links++;\n\t\t});\n\t\treturn \"Group \" + g.data.key + \": \" + g.data.text + \"\\n\" + mems + \" members including \" + links + \" links\";\n\t},\n\tqueue: function(){\n\t\tthis.data = [];\n\t\tthis.enqueue = function(record) {\n\t\t\tthis.data.unshift(record);\n\t\t  }\n\t\tthis.dequeue = function() {\n\t\t\tthis.data.pop();\n\t\t}\n\t},\n\t// buckets: buckets,\n\t\t//遍历天地盘做指定操作,colletor=[] 广度优先\n\t\ttdTravelTdpDataWidth: function(nodeData, model, collector, callback) {\n\t\t\t\n\t\t\tvar queue = new exports.queue(); //队列数据结构，辅助用\n\t\t\tconsole.log(\"queue:\",queue)\n\t\t\tqueue.enqueue(nodeData);\n\n\t\t\tvar dealingNode = null;\n\t\t\twhile (!queue.isEmpty()) {\n\t\t\t\tdealingNode = queue.dequeue();\n\t\t\t\tcollector.push(callback(dealingNode));\n\t\t\t\t//1 处理同级节点\n\t\t\t\tif (dealingNode.isparent) {\n\t\t\t\t\tvar childNodeData = model.findNodeDataForKey(dealingNode.isparent);\n\t\t\t\t\tif (childNodeData) {\n\t\t\t\t\t\tqueue.enqueue(childNodeData);\n\t\t\t\t\t\twhile (childNodeData.next && childNodeData.next != childNodeData.key) { //加入所有子节点\n\t\t\t\t\t\t\tchildNodeData = model.findNodeDataForKey(childNodeData.next);\n\t\t\t\t\t\t\tif (childNodeData) {\n\t\t\t\t\t\t\t\tqueue.enqueue(childNodeData);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\t//遍历天地盘做指定操作,colletor=[]  深度优先\n\t\ttdTravelTdpData: function(nodeData, model, collector, callback) {\n\t\t\tif (nodeData) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcollector.push(callback(nodeData));\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\t//1 先处理子节点\n\t\t\tif (nodeData.isparent) {\n\t\t\t\t\tvar childNodeData = model.findNodeDataForKey(nodeData.isparent);\n\t\t\t\t\texports.tdTravelTdpData(childNodeData, model, collector, callback);\n\t\t\t}\n\t\t\t//2 再处理兄弟节点\n\t\t\tif (nodeData.next && nodeData.next != nodeData.key) { //处理异常情况\n\t\t\t\t\tvar nextNodeData = model.findNodeDataForKey(nodeData.next);\n\t\t\t\t\texports.tdTravelTdpData(nextNodeData, model, collector, callback);\n\t\t\t}\n\t\t},\n\t\tdeleteOldData(time){\n\t\t\tvar  temp, diff;\n\t\t\tfor(var item in window.localStorage) {\n\t\t\t\tif(window.localStorage.hasOwnProperty(item)) {\n\t\t\t\t\t// size += window.localStorage.getItem(item).length;\n\t\t\t\t\tif(item.startsWith(\"TDCurrent\")){\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\ttemp = JSON.parse(window.localStorage.getItem(item))\n\t\t\t\t\t\t\tdiff =  new Date().getTime() - temp.modelData.updatedAt;\n\t\t\t\t\t\t\tif(diff/1000 > 86400*time){\n\t\t\t\t\t\t\t\tconsole.log(\"delete old data:\"+item)\n\t\t\t\t\t\t\t\twindow.localStorage.removeItem(item)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}catch(e){\n\t\t\t\t\t\t\tconsole.error(e)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsaveModelToLocalStorage(tpid, model){\n\t\t\tconsole.log(\"存储model到localStorage，只保留最近三天的\")\n\t\t\tmodel.modelData.updatedAt = new Date().getTime()\n\t\t\tif(!window.localStorage) {\n\t\t\t\tconsole.error('浏览器不支持localStorage');\n\t\t\t\treturn;\n\t\t\t}\t\t\n\t\t\t// 只保留最近一周内的盘\n\t\t\texports.deleteOldData(3)\n\t\t\ttry{\n\t\t\t\twindow.localStorage.setItem(\"TDCurrent\" + tpid, model.toJson());\n\t\t\t}catch(e){\n\t\t\t\texports.deleteOldData(1)\n\t\t\t\t// window.localStorage.clear()\n\t\t\t}\n\t\t},\n\n\t\t// 检查gojs model数据关系是否正确\n\t\tcheckModel: function(model){\n\t\t\tvar nodeDataArray = model.nodeDataArray\n\t\t\tvar root = model.findNodeDataForKey(1)\n\t\t\tvar collectior = []\n\t\t\tfunction checkDataExists(key){\n\t\t\t\tvar data = model.findNodeDataForKey(key)\n\t\t\t\tif(data){\n\t\t\t\t\treturn \"exist\"\n\t\t\t\t}else{\n\t\t\t\t\treturn \"not exist\"\n\t\t\t\t}\n\t\t\t}\n\t\t\texports.tdTravelTdpData(root, model, collectior, function(data){\n\t\t\t\t\n\t\t\t\tvar msg = `check key:${data.key},level:${data.level},parent:${data.parent},`+\n\t\t\t\t`isparent:${data.isparent},prev:${data.prev},next:${data.next}`\n\t\t\t\tif(data.next && checkDataExists(data.next) == \"not exist\"){\n\t\t\t\t\tconsole.error(`data ${data.key} next指向的节点不存在, data: ${msg}`)\n\t\t\t\t}\n\t\t\t\tif(data.isparent && checkDataExists(data.isparent) == \"not exist\"){\n\t\t\t\t\tconsole.error(`data ${data.key} isparent指向的节点不存在, data: ${msg}`)\n\t\t\t\t}\n\t\t\t\tif(data.parent && checkDataExists(data.parent) == \"not exist\"){\n\t\t\t\t\tconsole.error(`data ${data.key} parent指向的节点不存在, data: ${msg}`)\n\t\t\t\t}\n\t\t\t\tif(data.prev && checkDataExists(data.prev) == \"not exist\"){\n\t\t\t\t\tconsole.error(`data ${data.key} prev指向的节点不存在, data: ${msg}`)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 数值转换\n\t\ttdTransToNum(from, defaultVal) {\n\t\t\tif(arguments.length <= 1){\n\t\t\t\tdefaultVal = 0\n\t\t\t}\n\t\t\tvar result = defaultVal;\n\t\t\ttry {\n\t\t\t\tresult = parseFloat(from);\n\t\t\t\treturn result;\n\t\t\t} catch (e) {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\t},\t\n\t\tsimulateEnterWithAlt(e) { //模拟alt+Enter键盘,将gojs内置文本编辑窗口中的Alt+Enter 转换为\\n\n\t\t\tvar myDiagram = e.diagram;\n\t\t\tif (myDiagram.currentTool.currentTextEditor) {\n\t\t\t\t// jQuery(myDiagram.currentTool.currentTextEditor).unbind(\"keypress\", myDiagram.currentTool.currentTextEditor);\n\t\t\t\t// jQuery(myDiagram.currentTool.currentTextEditor).keypress(textEditorHandler);\n\t\t\t\tmyDiagram.currentTool.currentTextEditor.mainElement.onkeypress = null;\n\t\t\t\tmyDiagram.currentTool.currentTextEditor.mainElement.onkeypress = textEditorHandler;\n\t\t\t\tvar val = myDiagram.currentTool.currentTextEditor.mainElement.value\n\t\t\t\t// 只在手机端定位到结尾\n\t\t\t\tif(module.exports.checkPhone()){\n\t\t\t\t\tmyDiagram.currentTool.currentTextEditor.mainElement.selectionStart = val.length; \n\t\t\t\t\tmyDiagram.currentTool.currentTextEditor.mainElement.selectionEnd = val.length; \n\t\t\t\t}\n\t\t\t\tfunction textEditorHandler(e) {\n\t\t\t\t\tvar evt = e;\n\t\t\t\t\tconsole.log('textblock catched the key:' + evt);\n\t\t\t\t\tif (evt.which) {\n\t\t\t\t\t\tif (evt.keyCode == 13 && evt.altKey || evt.keyCode == 10 && evt.ctrlKey || evt.keyCode == 13 && evt.shiftKey || evt.keyCode == 10 && evt.shiftKey) {\n\t\t\t\t\t\t\tvar start = this.selectionStart,\n\t\t\t\t\t\t\t\tend = this.selectionEnd,\n\t\t\t\t\t\t\t\tval = this.value;\n\t\t\t\t\t\t\tthis.value = val.slice(0, start) + \"\\n\" + val.slice(end);\n\t\t\t\t\n\t\t\t\t\t\t\t// Move the caret\n\t\t\t\t\t\t\tthis.selectionStart = this.selectionEnd = start + 1;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\tif (evt.keyCode == 13 && !evt.altKey) {\n\t\t\t\t\n\t\t\t\t\t\tif (myDiagram.currentTool.isActive) {\n\t\t\t\t\t\t\tmyDiagram.currentTool.acceptText(go.TextEditingTool.LostFocus);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false; //阻止默认行为\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/***\n * travel nodes, group and links\n * @param rootnode go.Node\n * @param callback function(part){}\n */\ntravelParts(rootNode, callback) {\n    var diagram = rootNode.diagram;\n    callback(rootNode);\n    var group = rootNode.containingGroup;\n    if (group && group.data.parent == rootNode.data.key) {\n        callback(group);\n    }\n    var stack = [rootNode];\n    var node, link, child, nextChild;\n    while (stack.length > 0) {\n        node = stack.pop();\n        if (node.data.isparent) {\n            child = diagram.findNodeForKey(node.data.isparent);\n            link = node.findLinksTo(child).first();\n            callback(link);\n            callback(child);\n            group = child.containingGroup;\n            if (group && group.data.parent == child.data.key) {\n                callback(group);\n            }\n            stack.push(child);\n            while (child.data.next) {\n                nextChild = diagram.findNodeForKey(child.data.next);\n                link = child.findLinksTo(nextChild).first();\n                callback(link);\n                callback(nextChild);\n                group = nextChild.containingGroup;\n                if (group && group.data.parent == nextChild.data.key) {\n                    callback(group);\n                }\n                stack.push(nextChild);\n                child = nextChild;\n            }\n        }\n    }\n}\n\n\t\t\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/helpers/helpers.gojs.js","var $ = go.GraphObject.make;\r\nconsole.info(\"gggggggggggggggggggggggg\")\r\ngo.GraphObject.defineBuilder('CircleButton', function (args) {\r\n    // default colors for 'Button' shape\r\n    var buttonFillNormal = '#F5F5F5';\r\n    var buttonStrokeNormal = '#BDBDBD';\r\n    var buttonFillOver = '#E0E0E0';\r\n    var buttonStrokeOver = '#9E9E9E';\r\n    var buttonFillPressed = '#BDBDBD'; // set to null for no button pressed effects\r\n    var buttonStrokePressed = '#9E9E9E';\r\n    var buttonFillDisabled = '#E5E5E5';\r\n  \r\n    // padding inside the ButtonBorder to match sizing from previous versions\r\n    var paddingHorizontal = 2.76142374915397;\r\n    var paddingVertical = 2.761423749153969;\r\n  \r\n    var button = (\r\n      go.GraphObject.make(go.Panel, 'Auto',\r\n        {\r\n          isActionable: true,  // needed so that the ActionTool intercepts mouse events\r\n          enabledChanged: function (btn, enabled) {\r\n            var shape = btn.findObject('ButtonBorder');\r\n            if (shape !== null) {\r\n              shape.fill = enabled ? btn['_buttonFillNormal'] : btn['_buttonFillDisabled'];\r\n            }\r\n          },\r\n          cursor: 'pointer',\r\n          // save these values for the mouseEnter and mouseLeave event handlers\r\n          '_buttonFillNormal': buttonFillNormal,\r\n          '_buttonStrokeNormal': buttonStrokeNormal,\r\n          '_buttonFillOver': buttonFillOver,\r\n          '_buttonStrokeOver': buttonStrokeOver,\r\n          '_buttonFillPressed': buttonFillPressed,\r\n          '_buttonStrokePressed': buttonStrokePressed,\r\n          '_buttonFillDisabled': buttonFillDisabled\r\n        },\r\n        go.GraphObject.make(go.Shape,  // the border\r\n          {\r\n            name: 'ButtonBorder',\r\n            figure: 'Circle',\r\n            spot1: new go.Spot(0, 0, paddingHorizontal, paddingVertical),\r\n            spot2: new go.Spot(1, 1, -paddingHorizontal, -paddingVertical),\r\n            parameter1: 2,\r\n            parameter2: 2,\r\n            fill: buttonFillNormal,\r\n            stroke: buttonStrokeNormal\r\n          }\r\n        )\r\n      )\r\n    );\r\n  \r\n    // There's no GraphObject inside the button shape -- it must be added as part of the button definition.\r\n    // This way the object could be a TextBlock or a Shape or a Picture or arbitrarily complex Panel.\r\n  \r\n    // mouse-over behavior\r\n    button.mouseEnter = function (e, btn, prev) {\r\n      if (!btn.isEnabledObject()) return;\r\n      var shape = btn.findObject('ButtonBorder');  // the border Shape\r\n      if (shape instanceof go.Shape) {\r\n        var brush = btn['_buttonFillOver'];\r\n        btn['_buttonFillNormal'] = shape.fill;\r\n        shape.fill = brush;\r\n        brush = btn['_buttonStrokeOver'];\r\n        btn['_buttonStrokeNormal'] = shape.stroke;\r\n        shape.stroke = brush;\r\n      }\r\n    };\r\n  \r\n    button.mouseLeave = function (e, btn, prev) {\r\n      if (!btn.isEnabledObject()) return;\r\n      var shape = btn.findObject('ButtonBorder');  // the border Shape\r\n      if (shape instanceof go.Shape) {\r\n        shape.fill = btn['_buttonFillNormal'];\r\n        shape.stroke = btn['_buttonStrokeNormal'];\r\n      }\r\n    };\r\n  \r\n    // mousedown/mouseup behavior\r\n    button.actionDown = function (e, btn) {\r\n      if (!btn.isEnabledObject()) return;\r\n      if (btn['_buttonFillPressed'] === null) return;\r\n      if (e.button !== 0) return;\r\n      var shape = btn.findObject('ButtonBorder');  // the border Shape\r\n      if (shape instanceof go.Shape) {\r\n        var diagram = e.diagram;\r\n        var oldskip = diagram.skipsUndoManager;\r\n        diagram.skipsUndoManager = true;\r\n        var brush = btn['_buttonFillPressed'];\r\n        btn['_buttonFillOver'] = shape.fill;\r\n        shape.fill = brush;\r\n        brush = btn['_buttonStrokePressed'];\r\n        btn['_buttonStrokeOver'] = shape.stroke;\r\n        shape.stroke = brush;\r\n        diagram.skipsUndoManager = oldskip;\r\n      }\r\n    };\r\n  \r\n    button.actionUp = function (e, btn) {\r\n      if (!btn.isEnabledObject()) return;\r\n      if (btn['_buttonFillPressed'] === null) return;\r\n      if (e.button !== 0) return;\r\n      var shape = btn.findObject('ButtonBorder');  // the border Shape\r\n      if (shape instanceof go.Shape) {\r\n        var diagram = e.diagram;\r\n        var oldskip = diagram.skipsUndoManager;\r\n        diagram.skipsUndoManager = true;\r\n        if (overButton(e, btn)) {\r\n          shape.fill = btn['_buttonFillOver'];\r\n          shape.stroke = btn['_buttonStrokeOver'];\r\n        } else {\r\n          shape.fill = btn['_buttonFillNormal'];\r\n          shape.stroke = btn['_buttonStrokeNormal'];\r\n        }\r\n        diagram.skipsUndoManager = oldskip;\r\n      }\r\n    };\r\n  \r\n    button.actionCancel = function (e, btn) {\r\n      if (!btn.isEnabledObject()) return;\r\n      if (btn['_buttonFillPressed'] === null) return;\r\n      var shape = btn.findObject('ButtonBorder');  // the border Shape\r\n      if (shape instanceof go.Shape) {\r\n        var diagram = e.diagram;\r\n        var oldskip = diagram.skipsUndoManager;\r\n        diagram.skipsUndoManager = true;\r\n        if (overButton(e, btn)) {\r\n          shape.fill = btn['_buttonFillOver'];\r\n          shape.stroke = btn['_buttonStrokeOver'];\r\n        } else {\r\n          shape.fill = btn['_buttonFillNormal'];\r\n          shape.stroke = btn['_buttonStrokeNormal'];\r\n        }\r\n        diagram.skipsUndoManager = oldskip;\r\n      }\r\n    };\r\n  \r\n    button.actionMove = function (e, btn) {\r\n      if (!btn.isEnabledObject()) return;\r\n      if (btn['_buttonFillPressed'] === null) return;\r\n      var diagram = e.diagram;\r\n      if (diagram.firstInput.button !== 0) return;\r\n      diagram.currentTool.standardMouseOver();\r\n      if (overButton(e, btn)) {\r\n        var shape = btn.findObject('ButtonBorder');\r\n        if (shape instanceof go.Shape) {\r\n          var oldskip = diagram.skipsUndoManager;\r\n          diagram.skipsUndoManager = true;\r\n          var brush = btn['_buttonFillPressed'];\r\n          if (shape.fill !== brush) shape.fill = brush;\r\n          brush = btn['_buttonStrokePressed'];\r\n          if (shape.stroke !== brush) shape.stroke = brush;\r\n          diagram.skipsUndoManager = oldskip;\r\n        }\r\n      }\r\n    };\r\n  \r\n    function overButton(e, btn) {\r\n      var over = e.diagram.findObjectAt(\r\n        e.documentPoint,\r\n        function (x) {\r\n          while (x.panel !== null) {\r\n            if (x.isActionable) return x;\r\n            x = x.panel;\r\n          }\r\n          return x;\r\n        },\r\n        function (x) { return x === btn; }\r\n      );\r\n      return over !== null;\r\n    }\r\n  \r\n    return button;\r\n  });\r\n  \r\nclass NodeBase {\r\n    constructor(options){\r\n        var that = this\r\n        this.diagram = options.diagram\r\n        this.nodeProperties = this.getNodeProperties()\r\n        this.binding = this.getBinding()\r\n        // this.nodeTemplate = this.getNodeTemplate()\r\n    }\r\n\r\n    getTooTip() {\r\n      var that = this;\r\n      return $(\r\n        \"ToolTip\",\r\n        { \"Border.fill\": \"whitesmoke\", \"Border.stroke\": \"black\" },\r\n        new go.Binding(\"visible\", \"\", function(obj) {\r\n          console.log(\"ToolTipToolTipToolTip\");\r\n          return obj.remark != null;\r\n        }),\r\n        $(\r\n          go.TextBlock,\r\n          {\r\n            maxSize: new go.Size(400, NaN),\r\n  \r\n            font: \"24px bold\",\r\n            wrap: go.TextBlock.WrapFit,\r\n            margin: 5\r\n          },\r\n  \r\n          new go.Binding(\"text\", \"\", function(obj) {\r\n           \r\n            return obj.remark || \"\";\r\n          })\r\n        )\r\n      );\r\n    }\r\n\r\n    getNodeProperties(){\r\n        var that = this\r\n        var diagram = this.diagram\r\n        var properties = {\r\n            // type: go.Panel.Auto,\r\n            // \"_controlExpand\": true,\r\n            // layerName: \"default\",\r\n            // locationSpot: go.Spot.Center,\r\n            // resizeCellSize: new go.Size(10, 10),\r\n            // // locationObjectName: \"SHAPE\",\r\n            // resizable: true,\r\n            // // resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n            // rotatable: false,\r\n            // location: new go.Point(0, 0),\r\n            // click: that.click,\r\n            // //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n            // doubleClick: that.doubleClick,\r\n            // toMaxLinks: 1,\r\n            // layoutConditions: go.Part.LayoutStandard,\r\n            // //layoutConditions:~go.Part.LayoutAdded,\r\n            // // fromLinkable: true, toLinkable: true,\r\n            // alignment: go.Spot.Center,\r\n            // alignmentFocus: go.Spot.Center,\r\n            // resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n            // // contextMenu: $(go.Adornment),\r\n            // contextMenu: $(go.Adornment),\r\n            // selectionAdornmentTemplate: diagram.__trtd.getNodeSelectionAdornmentTemplate(),\r\n            // mouseOver: that.mouseOver,\r\n            // mouseLeave: that.mouseLeave,\r\n            // mouseDragEnter: that.mouseDragEnter,\r\n            // mouseDragLeave: that.mouseDragLeave,\r\n            // mouseDrop: that.mouseDrop\r\n        }\r\n        return properties\r\n    }\r\n\r\n    getNodeSelectionAdornmentTemplate(){\r\n      return  $(go.Adornment, \"Auto\",\r\n          $(go.Shape, \"Rectangle\",\r\n          // { fill: null, stroke: \"#9aa8b6\", strokeWidth: 1 }),\r\n          { fill: null, stroke: \"dodgerblue\", strokeWidth: 3 }),\r\n          $(go.Placeholder)\r\n        )  // end Adornment\r\n    }\r\n\r\n    getBinding(){\r\n        return [\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n            new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n            new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n            new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n            new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n        ]\r\n    }\r\n    getTextBuild(){\r\n        return $(go.TextBlock, {\r\n                name: \"TEXT\",\r\n                alignment: new go.Spot(0.5, 0.4),\r\n                font: \"bold 18px 幼圆\",\r\n                editable: true,\r\n                // flip:go.GraphObject.FlipHorizontal,\r\n                //margin: 3, editable: true,\r\n                stroke: \"black\",\r\n                isMultiline: true,\r\n                overflow: go.TextBlock.OverflowClip,\r\n                wrap: go.TextBlock.WrapDesiredSize,\r\n                textAlign: \"center\",\r\n                spacingAbove: 4,\r\n                spacingBelow: 4,\r\n                portId: \"TEXT\",\r\n                stretch: go.GraphObject.Uniform\r\n            },\r\n            new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                return ['start', 'center', 'end'].indexOf(v)>-1 ? v : \"center\";\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v-30;\r\n            }).ofObject(\"main\"),\r\n            // new go.Binding(\"height\", \"height\", function (v) {\r\n            //   return v;\r\n            // }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n            new go.Binding(\"font\", \"font\").makeTwoWay()\r\n        )\r\n      }\r\n      \r\n    getNodeTemplate(){\r\n        console.log(\"NodeBase.getNodeTemplate\")\r\n        var that = this;\r\n        return $(go.Node, \r\n            that.nodeProperties,\r\n            that.binding\r\n        );\r\n    }\r\n\r\n    click(e, node){\r\n        // console.log(node.data)\r\n        if(node.diagram.__trtd.nodeClickListener){\r\n            node.diagram.__trtd.nodeClickListener(node)\r\n        }\r\n    }\r\n\r\n    doubleClick(e, node){\r\n        e.diagram.__trtd.selectText(e, node)\r\n    }\r\n\r\n    mouseOver(e, node) {\r\n        // if(node.data.hyperlink){\r\n        //   var textObj = node.findObject('TEXT');\r\n        //   textObj.isUnderline = true;\r\n        // }\r\n\r\n        e.diagram.__trtd.showNodeRemarkTips(e, node);\r\n\r\n    }\r\n\r\n    mouseLeave(e, node) {\r\n        // if(node.data.hyperlink) {\r\n        //   var textObj = node.findObject('TEXT');\r\n        //   textObj.isUnderline = false;\r\n        // }\r\n        e.diagram.__trtd.removeNodeRemarkTips();\r\n    }\r\n    mouseDragEnter(e, obj) {\r\n        var node = obj.part;\r\n        var selnode = e.diagram.selection.first();\r\n        if (!(selnode instanceof go.Node) || selnode.category == \"3\" || selnode.category == \"text\" || selnode.key == 1) {\r\n            return;\r\n        }\r\n        //var sat = node.selectionAdornmentTemplate;\r\n        //var adorn = sat.copy();\r\n        //adorn.adornedObject = node;\r\n        //node.addAdornment(\"dragEnter\", adorn);\r\n\r\n        //if (!mayWorkFor(selnode, node)) return;\r\n        var shape = node.findObject(\"SHAPE\");\r\n        if (shape) {\r\n            shape._prevFill = shape.fill; // remember the original brush\r\n            shape.fill = \"darkred\";\r\n        }\r\n\r\n    }\r\n    mouseDragLeave(e, obj) {\r\n        var node = obj.part;\r\n        var shape = node.findObject(\"SHAPE\");\r\n        if (shape && shape._prevFill) {\r\n            shape.fill = shape._prevFill; // restore the original brush\r\n        }\r\n        //node.removeAdornment(\"dragEnter\");\r\n    }\r\n    mouseDrop(e, obj) {\r\n        var node = obj.part;\r\n        var selnode = e.diagram.selection.first();\r\n        if (!(selnode instanceof go.Node) || selnode.data.category == \"3\" || selnode.data.category == \"text\" || selnode.data.key == 1) {\r\n            return;\r\n        }\r\n\r\n        if (node.data.isparent) {\r\n            var child = e.diagram.findNodeForKey(node.data.isparent);\r\n            while (child.data.next) {\r\n                child = e.diagram.findNodeForKey(child.data.next);\r\n            }\r\n            if (child.data.key == selnode.data.key) {\r\n                //最后一个子节点拖放到父节点上时，不做任何操作\r\n                return;\r\n            }\r\n            e.diagram.__trtd.setNodeAsSibling(selnode, child);\r\n        } else {\r\n            e.diagram.__trtd.setNodeAsChildren(selnode, node);\r\n        }\r\n    }\r\n}\r\n\r\nmodule.exports = NodeBase\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/base.js","var $ = go.GraphObject.make;\r\n\r\nmodule.exports = // 返回图片天盘的独立节点模板\r\nfunction createPictureSingleNodeTemplate (diagram) {\r\n    // var $ = go.GraphObject.make;\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 1,\r\n        stroke: \"#767678\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Auto\", {\r\n        name: \"NODE\",\r\n        \"_controlExpand\": true,\r\n        layerName: \"Background\",\r\n        // layerName: \"Foreground\",\r\n        zOrder: 20,\r\n        locationSpot: go.Spot.Center,\r\n        resizeCellSize: new go.Size(10, 10),\r\n        locationObjectName: \"SHAPE\",\r\n        resizable: true,\r\n        resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n        rotatable: true,\r\n        rotateObjectName: \"SHAPE\", // rotate the Shape without rotating the label\r\n        doubleClick: function (e, node) {\r\n            // interactions.selectText(e, node)\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeDoubleClickListener){\r\n                node.diagram.__trtd.nodeDoubleClickListener(node)\r\n            }\r\n            \r\n        },\r\n        click: function(e, node) {\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeClickListener){\r\n                node.diagram.__trtd.nodeClickListener(node)\r\n            }\r\n            // showNodeToolBar(e,node);\r\n        },\r\n        selectable: true,\r\n        movable: true,\r\n        angle: 0,\r\n        //toMaxLinks: 1,\r\n        layoutConditions: go.Part.LayoutStandard,\r\n        //layoutConditions:~go.Part.LayoutAdded,\r\n        // fromLinkable: true, toLinkable: true,\r\n        alignment: go.Spot.Center,\r\n        alignmentFocus: go.Spot.Center,\r\n        resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n        //rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n        contextMenu: diagram.__trtd.nodeContextMenu,\r\n        selectionAdornmentTemplate: function() {\r\n            var $ = go.GraphObject.make;\r\n            return $(go.Adornment, \"Spot\",\r\n                $(go.Panel, \"Auto\",\r\n                    $(go.Shape, { fill: null, stroke: \"blue\", strokeWidth: 1 }),\r\n                    $(go.Placeholder) // this represents the selected Node\r\n\r\n                ),\r\n                //$(\"TreeExpanderButton\",\r\n                $(go.Panel, \"Vertical\", {\r\n                        name: \"ButtonIcon1\",\r\n                        alignment: new go.Spot(0, 1, -20, 20),\r\n                        alignmentFocus: go.Spot.Center,\r\n                        width: 60,\r\n                        height: 60,\r\n                        isActionable: true,\r\n                        // click: interactions.expandCollapse // this function is defined below\r\n                    },\r\n\r\n                    $(go.Shape, \"Circle\", {\r\n                        fill: \"rgba(1,1,1,0)\",\r\n                        strokeWidth: 0,\r\n                        stroke: \"green\",\r\n                        width: 50,\r\n                        height: 50\r\n                    })\r\n\r\n                )\r\n            ); // end Adornment\r\n        }(),\r\n        contextMenu: function() {\r\n            var $ = go.GraphObject.make;\r\n            return $(go.Adornment, \"Vertical\",\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"删除\"), {\r\n                        click: function(e, obj) {\r\n                            e.diagram.commandHandler.deleteSelection();\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"居中\"), {\r\n                        click: function(e, obj) {\r\n                            centerPicture();\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"等宽高\"), {\r\n                        click: function(e, obj) {\r\n                            equalWidthHeightPicture();\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"原始比例\", { stroke: \"gray\" }), {\r\n                        click: function(e, obj) {\r\n                            //equalWidthHeightPicture();\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"至于顶层\"), {\r\n                        click: function(e, obj) {\r\n                            //bringToBackground();\r\n                            bringToLayer(\"Foreground\");\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"至于底层\"), {\r\n                        click: function(e, obj) {\r\n                            bringToLayer(\"Background\");\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"上移一层\"), {\r\n                        click: function(e, obj) {\r\n                            bringToLayer(null);\r\n                        }\r\n                    }),\r\n                $(\"ContextMenuButton\",\r\n                    $(go.TextBlock, \"固定\",\r\n                        new go.Binding(\"text\", \"\", function(d, obj) {\r\n                            var node = obj.part;\r\n                            return node.data.selectable != undefined ? (node.data.selectable ? \"固定\" : \"取消固定\") : \"固定\";\r\n                        })\r\n                    ), {\r\n                        name: \"fixnode\",\r\n                        click: function(e, obj) {\r\n                            var diagram = obj.diagram;\r\n                            var node = obj.part;\r\n                            diagram.startTransaction();\r\n                            //node.setProperties({\"movable\":node.data.movable?(!node.data.movable):true});\r\n                            diagram.model.setDataProperty(node.data, \"selectable\", node.data.selectable != undefined ? (!node.data.selectable) : false);\r\n                            diagram.commitTransaction();\r\n                        }\r\n                    }\r\n                )\r\n            );\r\n        }()},\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        $(go.TextBlock, // the text label\r\n            new go.Binding(\"text\", \"text\")),\r\n        $(go.Picture, // the icon showing the logo\r\n            // You should set the desiredSize (or width and height)\r\n            // whenever you know what size the Picture should be.\r\n            { name: \"SHAPE\" }, {\r\n                successFunction: function(pict, evt) {\r\n                    if ((!pict.width || !pict.height) && (!pict.part.data.width || !pict.part.data.height)) {\r\n                        pict.width = pict.element.width;\r\n                        pict.height = pict.element.height;\r\n                    }\r\n                }\r\n            }, {\r\n                sourceCrossOrigin: function(pict) {\r\n                    return \"\";\r\n                }\r\n            },\r\n            new go.Binding(\"source\", \"picture\", function(v){\r\n                    \r\n                return v+\"?\"+Date.now()\r\n\r\n            }).makeTwoWay(function(v){\r\n                if(v){\r\n                    v = v.replace(/\\?.*$/g,\"\")\r\n                    return v\r\n                }else{\r\n                    return \"\"\r\n                }\r\n            }),\r\n            new go.Binding(\"width\", \"width\", function(v, d) {\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"height\", \"height\", function(v, d) {\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"angle\", \"pictureangle\").makeTwoWay(),\r\n            new go.Binding(\"opacity\", \"opacity\", function(v, d) {\r\n                return v ? parseFloat(v) : 1;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            })\r\n        )\r\n    );\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createPictureSingleNodeTemplate.js","var $ = go.GraphObject.make;\r\n\r\nmodule.exports = function createTextNodeTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Rectangle\",\r\n        fill: \"rgba(0,0,0,0)\",\r\n        strokeWidth: 1,\r\n        stroke: \"rgba(0,0,0,0)\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Spot\", {\r\n            \"_controlExpand\": true,\r\n            layerName: \"Foreground\",\r\n            movable: true,\r\n            locationSpot: go.Spot.Center,\r\n            resizeCellSize: new go.Size(10, 10),\r\n            locationObjectName: \"SHAPE\",\r\n            resizable: true,\r\n            resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n            rotatable: true,\r\n            location: new go.Point(0, 0),\r\n            //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n            // doubleClick: selectText,\r\n            toMaxLinks: 1,\r\n            layoutConditions: go.Part.LayoutStandard,\r\n            //layoutConditions:~go.Part.LayoutAdded,\r\n            // fromLinkable: true, toLinkable: true,\r\n            alignment: go.Spot.Center,\r\n            alignmentFocus: go.Spot.Center,\r\n            contextMenu: $(go.Adornment),\r\n            doubleClick: function (e, node){\r\n                e.diagram.__trtd.selectText(e, node)\r\n            }\r\n\r\n            // selectionAdornmentTemplate: nodeSelectionAdornmentTemplate,\r\n        },\r\n        new go.Binding(\"locationSpot\", \"locationSpot\", function(v){\r\n            console.log(\"locationSpot1\")\r\n            return go.Spot.parse(v)\r\n        }).makeTwoWay(function(v){\r\n            console.log(\"locationSpot2\")\r\n            return go.Spot.stringify(v)\r\n        }),\r\n        new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n        new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        $(go.Shape, {\r\n                strokeDashArray: null,\r\n                // strokeDashOffset:10,\r\n                name: \"SHAPE\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                fromLinkable: true,\r\n                toLinkable: true,\r\n                cursor: \"pointer\",\r\n                minSize: new go.Size(50, 50),\r\n                strokeWidth: 2,\r\n                stroke: \"rgba(0,0,0,0)\",\r\n                portId: \"\",\r\n                width:150\r\n            },\r\n            new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n                return [v.split()[0], v.split()[1]];\r\n            }).makeTwoWay(function(v) {\r\n                return v[0] + \" \" + v[1];\r\n            }), //保留，设置边线样式\r\n            new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n                return v instanceof go.Brush ? v.color : v;\r\n            }).makeTwoWay(),\r\n            // new go.Binding(\"fill\", \"isSelected\", function(s, obj) { return s ? \"red\" : obj.part.data.color; }).ofObject()),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                return d;\r\n            }).makeTwoWay(function(d) {\r\n                return d;\r\n            }),\r\n            new go.Binding(\"figure\", \"figure\").makeTwoWay(), {\r\n                figure: properties.figure,\r\n                fill: properties.fill,\r\n                strokeWidth: properties.strokeWidth,\r\n                stroke: properties.stroke\r\n            }\r\n        ),\r\n        $(go.Shape, {\r\n                name: \"SHAPE_Back\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                // fromLinkable: true,\r\n                // toLinkable: true,\r\n                strokeWidth: 0\r\n            },\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\")\r\n        ),\r\n        $(go.TextBlock, {\r\n                name: \"TEXT\",\r\n                alignment: new go.Spot(0.5, 0.5),\r\n                font: \"bold 18px 幼圆\",\r\n                editable: true,\r\n                //margin: 3, editable: true,\r\n                stroke: \"black\",\r\n                isMultiline: true,\r\n                overflow: go.TextBlock.OverflowClip,\r\n                wrap: go.TextBlock.WrapDesiredSize,\r\n                textAlign: \"center\",\r\n                // verticalAlignment: go.Spot.Bottom,\r\n                spacingAbove: 4,\r\n                spacingBelow: 4,\r\n                portId: \"TEXT\",\r\n                stretch: go.GraphObject.Fill\r\n            },\r\n            new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            // new go.Binding(\"height\", \"height\", function (v) {\r\n            //   return v;\r\n            // }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n            new go.Binding(\"font\", \"font\").makeTwoWay()\r\n        )\r\n    );\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createTextNodeTemplate.js","// require('./core/core.controller')(Trtd);\r\n// import * as go from 'gojs';\r\nvar SpiralLayout = require('../layout/SpiralLayout');\r\nvar helpers = require('../helpers/helpers.gojs')\r\n// var commonFun = require('./commonFun')\r\nvar TRTD_BASE = require('./trtd').Trtd\r\nlet lang = require('../assets/localization');\r\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\nvar createTianpanLink = require('../linkTemplate/createTianpanLink')\r\n\r\nvar $ = go.GraphObject.make;\r\n\r\nvar colorMap = [\r\n    \"#FFBFBF\",\r\n    \"#E9BFFF\",\r\n    \"#D1FF72\",\r\n    \"#00A2E8\",\r\n    \"#99D9EA\"\r\n];\r\n\r\n\r\nclass Trtd  extends TRTD_BASE {\r\n\tconstructor(div, config){\r\n        super(div, config)\r\n\t\tthis.config = config;\r\n\t\tthis.modelChangedListener = config.modelChangedListener;\r\n\t\tthis.type = config.type;\r\n\t\tthis.diagram = {};\r\n        this.model = config.model;\r\n        this.initDiagramBase(div, config); // 基类初始化diagram\r\n\t\t// 初始化diagram\r\n        this.initDiagram(div, config);\r\n        // this.diagram.__trtd = this;\r\n\t\tthis.initListener();\r\n\t\t// Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        if(this.model){\r\n            this.initModel();\r\n        }\r\n\t}\r\n/**\r\n * method 初始化diagram\r\n * @param {*} div \r\n * @param {*} config \r\n */\r\n\tinitDiagram(div, config){\r\n        var defaultConfig = {\r\n            // layout: go.GraphObject.make(SpiralLayout, {\r\n            //     isRealtime: false,\r\n            //     radius: NaN,\r\n            //     clockwise: true,\r\n            //     //,spacing:100,\r\n            //     isInitial: true\r\n            // }) \r\n          }\r\n        var diagramConfig = Object.assign(defaultConfig, config.diagramConfig);\r\n        this.diagram.setProperties(diagramConfig);\r\n        this.addNodeTemplate();\r\n        // this.customMenu();\r\n \r\n        this.addLinkTemplate();\r\n        this.addGroupTemplate();\r\n    }\r\n    getTdData(){\r\n        return this.diagram.model.toJson()\r\n    }\r\n    // 以下两个方法控制菜单显示\r\n    getDefaultCustomMenuDivStr(){\r\n        return `\r\n        <ul>\r\n            <li trtd_action=\"addFollower\"><a class=\"i18n\" data-lang=\"insertsl\">插入同级节点</a></li>\r\n            <li trtd_action=\"startNewSpiral\"><a class=\"i18n\" data-lang=\"icn\">插入子节点</a></li>\r\n            <li trtd_action=\"apiDuplicateNode\"><a class=\"i18n\" data-lang=\"duplicateNode\">复制节点</a></li>\r\n            <li trtd_action=\"apiDeleteSelection\"><a class=\"i18n\" data-lang=\"remove\">删除</a></li>\r\n            <li trtd_action=\"orderChildNode\"><a class=\"i18n\" data-lang=\"ordernode\">子节点编号</a></li>\r\n            <li trtd_action=\"clearOrderChildNode\"><a class=\"i18n\" data-lang=\"clearordernode\">取消子节点编号</a></li>\r\n            <li trtd_action=\"clearNodeTextMenu\"><a class=\"i18n\" data-lang=\"emptynodetext\">清空节点文本</a></li>\r\n            <li trtd_action=\"apiInsertTianpanNode\"><a class=\"i18n\" data-lang=\"insertnodetianpan\">插入天盘节点</a></li>\r\n            <li trtd_action=\"addTextNode\"><a class=\"i18n\" data-lang=\"inserttext\">插入文本</a></li>\r\n            <li trtd_action=\"locateRootNodeMenu\"><a class=\"i18n\" data-lang=\"locaterootnode\">定位根节点</a></li>\r\n            <li trtd_action=\"showAllNodesMenu\"><a class=\"i18n\" data-lang=\"displayallnodes\">显示所有节点</a></li>\r\n            <li trtd_action=\"fixPictureMenu\"><a class=\"i18n\" data-lang=\"fixnode\">固定节点</a></li>\r\n            <li trtd_action=\"activePictureMenu\"><a class=\"i18n\" data-lang=\"cancelfix\">取消固定</a></li>\r\n\r\n            <li trtd_action=\"delYunpanAxis\"><a class=\"i18n\" data-lang=\"cancelfix\">删除 CTRL+DEL</a></li>\r\n            <li trtd_action=\"addYunpanAxis\"><a class=\"i18n\" data-lang=\"cancelfix\">增加 CTRL+X/Y</a></li>\r\n        </ul>\r\n        `\r\n    }\r\n    \r\n    getShowContextMenus(node){\r\n        var showIds = \"\"\r\n        if(node){\r\n            if(node.data.category == \"autoText\"){\r\n                return \"apiDeleteSelection\"\r\n            }\r\n            if(node.data.category == \"picGroup\"){\r\n                return \"apiDeleteSelection\"\r\n            }\r\n            if( node.data.category == \"8\"){\r\n                showIds = \"apiDeleteSelection,\";\r\n            }\r\n            if( node.data.category == \"text\"){\r\n                showIds = \"apiDeleteSelection,\" + \"apiDuplicateNode\";\r\n            }\r\n            if( node.data.category == \"3\"){\r\n                showIds = \"apiDeleteSelection,\";\r\n                if(node.selectable){\r\n                    showIds += \",fixPictureMenu\"\r\n                }else{\r\n                    showIds += \",activePictureMenu\"\r\n                }\r\n            }\r\n            if( node.data.category == \"0\" || node.data.category == \"1\" || node.data.category == \"2\" || node.data.category == \"\"){\r\n                showIds = \"apiDeleteSelection,apiDuplicateNode,addFollower,startNewSpiral,orderChildNode,clearOrderChildNode\";\r\n            }\r\n            if(node.data.category == \"yunpanx\"||node.data.category == \"yunpany\"){\r\n                showIds = \"delYunpanAxis,addYunpanAxis\";\r\n            }\r\n            // return \"addFollowerGround,\" + \"addNewCircle,\"+\"apiDeleteSelection\";\r\n        }else{\r\n            // return \"addFollowerGround\"\r\n            showIds = \"addTextNode,apiInsertTianpanNode\"\r\n        }\r\n        return showIds;\r\n    }\r\n\r\n    apiInsertTianpanNode(){\r\n        var myDiagram = this.diagram;\r\n        myDiagram.startTransaction();\r\n        var nodeData = {\r\n            \"key\":helpers.guid(), \"text\":\"双击编辑内容\", \"level\":0,\r\n         \"radius\":100,  \"fill\":\"white\", \"category\":\"0\", \r\n         \"strokeWidth\":2, \"stroke\":\"black\", \"font\":\"bold 18px 幼圆\", \"textStroke\":\"black\", \"newAdd\":true, \"angle\":5}\r\n        // var text = { text: message||lang.trans('blankText'), category: 'text' };\r\n        nodeData.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n        myDiagram.model.addNodeData(nodeData);\r\n        myDiagram.commitTransaction()\r\n        // this.diagram.toolManager.clickCreatingTool.insertPart(this.diagram.lastInput.documentPoint);\r\n    }\r\n    fixPictureMenu(){\r\n        var myDiagram = this.diagram\r\n        // var node = myDiagram.selection.first();\r\n        var node = myDiagram.findPartAt(myDiagram.lastInput.documentPoint, false);\r\n        myDiagram.startTransaction();\r\n        myDiagram.model.setDataProperty(node.data, \"selectable\", node.data.selectable != undefined ? (!node.data.selectable) : false);\r\n        myDiagram.commitTransaction();\r\n    }\r\n\r\n    activePictureMenu(){\r\n        this.fixPictureMenu()\r\n    }\r\n    addTextNode(message){\r\n        console.log('eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee:');\r\n        var myDiagram = this.diagram;\r\n        myDiagram.startTransaction();\r\n        var text = { text: message||lang.trans('blankText'), category: 'autoText' };\r\n        text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n        myDiagram.model.addNodeData(text);\r\n        myDiagram.commitTransaction()\r\n    }\r\n    guid() {\r\n        function S4() {\r\n            return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n        }\r\n    return (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\r\n    }\r\n    \r\n\r\n    /**\r\n     * method 初始化model\r\n     */\r\n\tinitModel(model){\r\n        if(model){\r\n            this.model = model;\r\n        }\r\n        console.log('initModel')\r\n        var tmpModel = go.Model.fromJson(this.model);\r\n        if(tmpModel.modelData.currentType == 'dipan'){\r\n            tmpModel.nodeDataArray = tmpModel.nodeDataArray.filter((d)=>{\r\n                if(!d.isGroup){\r\n                    delete d.group\r\n                    return true;\r\n                }\r\n            })\r\n            // tmpModel.nodeDataArray = \r\n            tmpModel.linkDataArray=[]\r\n        }\r\n        if(!tmpModel.modelData.currentType){\r\n            tmpModel.modelData.currentType = this.type;\r\n        }\r\n        if([\"jin\",\"shui\",\"wheel\",\"huo\"].indexOf(this.type)>-1 ){\r\n            tmpModel.modelData.currentType = \"tianpan\"\r\n        }\r\n        console.log(\" tmpModel.modelData.currentType\")\r\n        this.diagram.layout.isInitial = false;\r\n        //randomUrl(tmpModel);\r\n        tmpModel.modelData.type = this.type\r\n        for(var i = 0;i<tmpModel.nodeDataArray.length;i++){\r\n            if(tmpModel.nodeDataArray[i].category == \"waveGroup\"){\r\n                if(!tmpModel.nodeDataArray[i].centerTextAngle){\r\n                    tmpModel.nodeDataArray[i].centerTextAngle = \"independent\"\r\n                }\r\n                if(!tmpModel.nodeDataArray[i].centerTextMode){\r\n                    tmpModel.nodeDataArray[i].centerTextMode = \"independent\"\r\n                }\r\n                if(!tmpModel.nodeDataArray[i].maxOlive){\r\n                    tmpModel.nodeDataArray[i].maxOlive = 50\r\n                }\r\n            }\r\n            if(tmpModel.nodeDataArray[i].category == \"yunGroup\"){\r\n                if(!tmpModel.nodeDataArray[i].shapeStrokes){\r\n                    tmpModel.nodeDataArray[i].shapeStrokes = [\"RGBA(237,28,36,0.3)\",\"RGBA(255,192,0,0.3)\",\"RGBA(255,255,0,0.3)\",\"RGBA(146,208,80,0.3)\",\"RGBA(192,200,250,0.3)\",\"RGBA(255,178,125,0.3)\",\"RGBA(209,110,210,0.3)\",\"RGBA(248,163,62,0.3)\",\"RGBA(248,161,164,0.3)\",\"RGBA(244,115,120,0.3)\"]\r\n                }\r\n                if(!tmpModel.nodeDataArray[i].beginSpark){\r\n                    tmpModel.nodeDataArray[i].beginSpark = \"line\"\r\n                }\r\n                if(tmpModel.nodeDataArray[i].showShape == null){\r\n                    tmpModel.nodeDataArray[i].showShape = true\r\n                }\r\n            }\r\n            if(tmpModel.nodeDataArray[i].category == \"shape\" && tmpModel.nodeDataArray[i].role == \"background\"){\r\n                tmpModel.nodeDataArray[i].visible = true\r\n            }\r\n            if(tmpModel.nodeDataArray[i].role && tmpModel.nodeDataArray[i].role.indexOf(\"labelText\") > -1 ){\r\n                tmpModel.nodeDataArray[i].movable = true;\r\n            }\r\n            if(tmpModel.nodeDataArray[i].category == \"labelGroup\"){\r\n                tmpModel.nodeDataArray[i].selectable = false\r\n            }\r\n            // if(tmpModel.nodeDataArray[i].category == \"autoText\" && tmpModel.nodeDataArray[i].subRole==\"themeText\"\r\n            //     && tmpModel.nodeDataArray[i].orderX == 10 && tmpModel.nodeDataArray[i].orderY == 10\r\n            // ){\r\n            //     if(!tmpModel.nodeDataArray[i].width){\r\n            //         tmpModel.nodeDataArray[i].width = 140\r\n            //     }\r\n            //     if(!tmpModel.nodeDataArray[i].height){\r\n            //         tmpModel.nodeDataArray[i].height = 140\r\n            //     }\r\n            // }\r\n        }\r\n        // tmpModel.modelData.version = Trtd.version\r\n        // console.log(\" tmpModel.modelData.version \",  tmpModel.modelData.version)\r\n        this.diagram.model = tmpModel;\r\n        // this.diagram.model.copyNodeDataFunction = function(object, model) {\r\n        //     console.log(\"copyNodeDataFunctioncopyNodeDataFunctioncopyNodeDataFunction\")\r\n        //     // if (object.isGroup) {\r\n        //     //     return null;\r\n        //     // }\r\n        //     // var outputObj = null;\r\n        //     var outputObj = JSON.parse(JSON.stringify(object))\r\n        //     // outputObj.level = 0;\r\n        //     // outputObj.next = undefined;\r\n        //     // outputObj.group = undefined;\r\n        //     // outputObj.prev = undefined;\r\n        //     // outputObj.isparent = undefined;\r\n        //     // outputObj.parent = undefined;\r\n        //     // outputObj.copiedKey = outputObj.key;\r\n        //     delete outputObj.key;\r\n        //     delete outputObj.__gohashid;\r\n        //     delete outputObj.points;\r\n        //     // if(object.category == \"autoText\" && object.role != \"freeText\"){\r\n        //     //     delete object.dimKey;\r\n        //     //     delete object.role;\r\n        //     //     delete object.subRole;\r\n        //     // }\r\n        //     return object;\r\n        // }\r\n        // configModel(myDiagram.model);\r\n        this.diagram.updateAllTargetBindings();\r\n        // this.diagram.animationManager.isEnabled = true\r\n        // this.saveModel()\r\n    }\r\n    loadModel(model){\r\n        // console.log(model)\r\n        // var node = this.diagram.selection.first()\r\n        // if(node){\r\n        //     this.diagram.commandHandler.scrollToPart(node)\r\n        // }\r\n        this.diagram.animationManager.isEnabled = false\r\n        this.initModel(model)\r\n    }\r\n    // addNodeFile(model){\r\n    //     console.log(model)\r\n    // }\r\n    /**\r\n     * method: 初始化监听方法\r\n     */\r\n\tinitListener(){\r\n\t\tconsole.log('initListener')\r\n    }\r\n\r\n    addGroupTemplate(){\r\n        // return function getGroupTemplate() {\r\n            this.diagram.groupTemplateMap.add(\"\", $(go.Group, \"Auto\", {\r\n                    layerName: \"Background\",\r\n                    selectable: false,\r\n                    pickable: false,\r\n                    locationSpot: go.Spot.Center,\r\n                    ungroupable: true,\r\n                    alignment: go.Spot.Center,\r\n                    click: function(d) {\r\n                        // alert('click group');\r\n                        // d.diagram.clearSelection();\r\n                    },\r\n                    contextClick: function(d) {\r\n                        // alert('click right group');\r\n                    },\r\n                    alignmentFocus: go.Spot.Center,\r\n                    // contextMenu: nodeContextMenu,\r\n                    selectionAdornmentTemplate: $(go.Adornment, \"Spot\",\r\n                        $(go.Panel, \"Auto\",\r\n                            $(go.Shape, 'Circle', { stroke: \"dodgerblue\", strokeWidth: 2, fill: null },\r\n                                new go.Binding(\"width\", \"\", function(v) {\r\n                                    var node = myDiagram.selection.first();\r\n                                    if (node instanceof go.Group) {\r\n                                        return node.actualBounds.width;\r\n                                    }\r\n                                }),\r\n                                new go.Binding(\"height\", \"\", function(v) {\r\n                                    var node = myDiagram.selection.first();\r\n                                    if (node instanceof go.Group) {\r\n                                        return node.actualBounds.height;\r\n                                    }\r\n                                })),\r\n                            //new go.Binding('wit')),\r\n                            $(go.Placeholder)\r\n                        ),\r\n                        $(go.Panel, \"Horizontal\", { alignment: go.Spot.Top, alignmentFocus: go.Spot.Bottom })\r\n                    ),\r\n                    copyable: false\r\n                }, {\r\n                    layout: $(SpiralLayout, {\r\n                        isRealtime: false,\r\n                        radius: NaN,\r\n                        clockwise: true,\r\n                        isInitial: false\r\n                    }),\r\n                    layoutConditions: go.Part.LayoutStandard & ~go.Part.LayoutNodeSized & ~go.Part.LayoutAdded\r\n                },\r\n                new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n                $(go.Panel, \"Auto\",\r\n                    $(go.Shape, \"Circle\", {\r\n                            name: \"SHAPE\",\r\n                            fill: \"rgba(212,230,188,0)\",\r\n                            stroke: null,\r\n                            // ,\r\n                            //width:300,\r\n                            //height:300,\r\n                            spot1: new go.Spot(0.01, 0.01),\r\n                            spot2: new go.Spot(0.99, 0.99)\r\n                        },\r\n                        new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                            return v instanceof go.Brush ? v.stroke : v;\r\n                        }).makeTwoWay(),\r\n                        new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                            return d;\r\n                        }).makeTwoWay(function(d) {\r\n                            return d;\r\n                        }),\r\n                        new go.Binding(\"figure\", \"figure\").makeTwoWay(),\r\n                        new go.Binding(\"desiredSize\", \"radius\", function(v) {\r\n                            //alert(v);\r\n        \r\n                            var radius = parseInt(v ? v : 100);\r\n                            var size = new go.Size(radius, radius);\r\n                            return size;\r\n                        }).makeTwoWay(function(v) {\r\n                            return v.width;\r\n                        })\r\n                    ),\r\n                    $(go.Placeholder, {\r\n                        // margin: tdSpiralMode == 'terse' ? -10 : 0\r\n                        margin: 0\r\n                    })\r\n                )\r\n            )\r\n        )\r\n    }\r\n    /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n\r\n        var that = this;\r\n        var myDiagram = this.diagram\r\n        // var globalProperties = this.tdGetModelData(null, myDiagram.model,myDiagram); //获取所有全局属性到一个对象中,从localstorage中\r\n        //var layerThickness = myDiagram.model.modelData.layerThickness;\r\n        // var layerThickness = parseInt(globalProperties['layerThickness']);\r\n        // console.log(layerThickness)\r\n        // var tdDipanTextAngle = globalProperties['tdDipanTextAngle'];\r\n        // console.log(tdDipanTextAngle)\r\n\r\n        // myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\r\n        // myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", );\r\n        this.addNodeTemplateBase()\r\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\r\n\r\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\r\n\r\n        \r\n    }\r\n\r\n    addLinkTemplate(){\r\n        this.diagram.linkTemplateMap.add(\"\", createTianpanLink(this.diagram));\r\n        // myDiagram.linkTemplateMap.add(\"\", linkTemplate.getTianpanLink());\r\n    }\r\n\r\n    /***\r\n     * 将node(包括它的后代)设置为parent的第一个孩子. 如果parent是Node的后代，则不操作\r\n     * @param node go.Node Type\r\n     * @param parent go.Node Type\r\n     */\r\n    setNodeAsChildren(node, parent) {\r\n        if (isDescendant(parent, node)) {\r\n            //illegal action\r\n            return;\r\n        }\r\n        if (parent.data.isparent == node.data.key) {\r\n            return;\r\n        }\r\n\r\n        var diagram = node.diagram,\r\n            model = node.diagram.model;\r\n\r\n        model.startTransaction('setNodeAsChildren');\r\n        disconnectFromTreeStructure(node);\r\n\r\n        //add as the child of parent\r\n        if (parent.data.isparent) {\r\n            //if has children\r\n            var firstChild = diagram.findNodeForKey(parent.data.isparent);\r\n            model.setDataProperty(parent.data, 'isparent', node.data.key);\r\n            model.setDataProperty(firstChild.data, 'prev', node.data.key);\r\n            model.setDataProperty(node.data, 'next', firstChild.data.key);\r\n            model.setDataProperty(node.data, 'parent', parent.data.key);\r\n            // model.setDataProperty(node.data, 'fill', firstChild.data.fill);\r\n\r\n            var link = parent.findLinksTo(firstChild).first();\r\n            model.setToKeyForLinkData(link.data, node.data.key);\r\n            var newLink = model.copyLinkData(link.data);\r\n            newLink.from = node.data.key;\r\n            newLink.to = firstChild.data.key;\r\n            model.addLinkData(newLink);\r\n\r\n        } else {\r\n            //if it's a single node which has no children\r\n            model.setDataProperty(parent.data, 'isparent', node.data.key);\r\n            model.setDataProperty(node.data, 'next', null);\r\n            model.setDataProperty(node.data, 'parent', parent.data.key);\r\n            var newLink = { from: parent.data.key, to: node.data.key, level: parent.data.level + 1, isTreeLink: true };\r\n            // if (parent.findLinksInto().first()) {\r\n            //     newLink.strokeWidth = Math.max(1, parent.findLinksInto().first().data.strokeWidth - 0.5);\r\n            // } else {\r\n            //     newLink.strokeWidth = 4;\r\n            // }\r\n\r\n            newLink.strokeWidth = 2;\r\n\r\n            applyTheme2Link(newLink, node);\r\n            model.addLinkData(newLink);\r\n\r\n            var newGroup = {\r\n                isGroup: true,\r\n                group: parent.data.group,\r\n                parent: parent.data.key,\r\n                key: \"g_\" + parent.data.key,\r\n                level: parent.data.level\r\n            }\r\n            model.addNodeData(newGroup);\r\n            model.setDataProperty(parent.data, \"group\", newGroup.key);\r\n        }\r\n\r\n        //update group\r\n        var nodeGroup = node.containingGroup;\r\n        if (nodeGroup && nodeGroup.data.parent == node.data.key) {\r\n            model.setDataProperty(nodeGroup.data, 'group', parent.data.group);\r\n        } else {\r\n            if (node.data.parent == null && node.data.isparent != null) {\r\n                //add group for root node\r\n                addGroupForNode(node, parent.data.group);\r\n            } else {\r\n                model.setDataProperty(node.data, \"group\", parent.data.group);\r\n            }\r\n        }\r\n\r\n        //update level\r\n        var diff = node.data.level - parent.data.level - 1;\r\n        helpers.travelParts(node, function(part) {\r\n            model.setDataProperty(part.data, 'level', part.data.level - diff);\r\n        });\r\n        model.commitTransaction('setNodeAsChildren');\r\n    }\r\n\r\n    /***\r\n     * 将node(包括它的后代)设置为sibling的下一个兄弟\r\n     * @param node  go.Node Type\r\n     * @param sibling go.Node Type\r\n     */\r\n    setNodeAsSibling(node, sibling) {\r\n        if (isDescendant(sibling, node)) {\r\n            //illegal action\r\n            return;\r\n        }\r\n        if (sibling.data.next == node.data.key) {\r\n            return;\r\n        }\r\n    \r\n        var diagram = node.diagram,\r\n            model = node.diagram.model;\r\n    \r\n        model.startTransaction('setNodeAsSibling');\r\n        disconnectFromTreeStructure(node);\r\n    \r\n        //add as next brother of sibling\r\n        if (sibling.data.next != null) {\r\n            var nextNode = diagram.findNodeForKey(sibling.data.next);\r\n            model.setDataProperty(sibling.data, 'next', node.data.key);\r\n            model.setDataProperty(node.data, 'next', nextNode.data.key);\r\n            model.setDataProperty(node.data, 'prev', sibling.data.key);\r\n            model.setDataProperty(nextNode.data, 'prev', node.data.key);\r\n            model.setDataProperty(node.data, 'parent', sibling.data.parent);\r\n            // model.setDataProperty(node.data, 'fill', sibling.data.fill);\r\n    \r\n            var link = sibling.findLinksTo(nextNode).first();\r\n            model.setToKeyForLinkData(link.data, node.data.key);\r\n            var newLink = model.copyLinkData(link.data);\r\n            newLink.from = node.data.key;\r\n            newLink.to = nextNode.data.key;\r\n            model.addLinkData(newLink);\r\n        } else {\r\n            model.setDataProperty(sibling.data, 'next', node.data.key);\r\n            model.setDataProperty(node.data, 'next', null);\r\n            model.setDataProperty(node.data, 'prev', sibling.data.key);\r\n            model.setDataProperty(node.data, 'parent', sibling.data.parent);\r\n            // console.log(\"sibling.data.fill\",sibling.data.fill)\r\n            model.setDataProperty(node.data, 'fill', sibling.data.fill);\r\n    \r\n            var preLink = sibling.findLinksInto().first();\r\n            var newLink = model.copyLinkData(preLink.data);\r\n            newLink.from = sibling.data.key;\r\n            newLink.to = node.data.key;\r\n            model.addLinkData(newLink);\r\n        }\r\n    \r\n        //update level\r\n        var diff = node.data.level - sibling.data.level;\r\n        helpers.travelParts(node, function(part) {\r\n            model.setDataProperty(part.data, 'level', part.data.level - diff);\r\n        });\r\n    \r\n        //update group\r\n        var nodeGroup = node.containingGroup;\r\n        var parent = diagram.findNodeForKey(sibling.data.parent);\r\n        if (nodeGroup && nodeGroup.data.parent == node.data.key) {\r\n            model.setDataProperty(node.containingGroup.data, 'group', parent.data.group);\r\n        } else {\r\n            if (node.data.parent == null && node.data.isparent != null) {\r\n                //add group for root node\r\n                addGroupForNode(node, parent.data.group);\r\n            } else {\r\n                model.setDataProperty(node.data, \"group\", parent.data.group);\r\n            }\r\n        }\r\n        if (parent && parent.containingGroup) {\r\n            var parentGroup = parent.containingGroup;\r\n            if (parentGroup) {\r\n                parentGroup.layout.isOngoing = true;\r\n                parentGroup.layout.isValidLayout = false;\r\n            }\r\n        }\r\n        model.commitTransaction('setNodeAsSibling');\r\n    }\r\n\r\n\r\n    /***\r\n     * 将node(包括它的后代)设置为parent的第一个孩子. 如果parent是Node的后代，则不操作\r\n     * @param node go.Node Type\r\n     * @param parent go.Node Type\r\n     */\r\n    setNodeAsChildren(node, parent) {\r\n        if (isDescendant(parent, node)) {\r\n            //illegal action\r\n            return;\r\n        }\r\n        if (parent.data.isparent == node.data.key) {\r\n            return;\r\n        }\r\n\r\n        var diagram = node.diagram,\r\n            model = node.diagram.model;\r\n\r\n        model.startTransaction('setNodeAsChildren');\r\n        disconnectFromTreeStructure(node);\r\n\r\n        //add as the child of parent\r\n        if (parent.data.isparent) {\r\n            //if has children\r\n            var firstChild = diagram.findNodeForKey(parent.data.isparent);\r\n            model.setDataProperty(parent.data, 'isparent', node.data.key);\r\n            model.setDataProperty(firstChild.data, 'prev', node.data.key);\r\n            model.setDataProperty(node.data, 'next', firstChild.data.key);\r\n            model.setDataProperty(node.data, 'parent', parent.data.key);\r\n            // model.setDataProperty(node.data, 'fill', firstChild.data.fill);\r\n\r\n            var link = parent.findLinksTo(firstChild).first();\r\n            model.setToKeyForLinkData(link.data, node.data.key);\r\n            var newLink = model.copyLinkData(link.data);\r\n            newLink.from = node.data.key;\r\n            newLink.to = firstChild.data.key;\r\n            model.addLinkData(newLink);\r\n\r\n        } else {\r\n            //if it's a single node which has no children\r\n            model.setDataProperty(parent.data, 'isparent', node.data.key);\r\n            model.setDataProperty(node.data, 'next', null);\r\n            model.setDataProperty(node.data, 'parent', parent.data.key);\r\n            var newLink = { from: parent.data.key, to: node.data.key, level: parent.data.level + 1, isTreeLink: true };\r\n            // if (parent.findLinksInto().first()) {\r\n            //     newLink.strokeWidth = Math.max(1, parent.findLinksInto().first().data.strokeWidth - 0.5);\r\n            // } else {\r\n            //     newLink.strokeWidth = 4;\r\n            // }\r\n\r\n            newLink.strokeWidth = 2;\r\n\r\n            applyTheme2Link(newLink, node);\r\n            model.addLinkData(newLink);\r\n\r\n            var newGroup = {\r\n                isGroup: true,\r\n                group: parent.data.group,\r\n                parent: parent.data.key,\r\n                key: \"g_\" + parent.data.key,\r\n                level: parent.data.level\r\n            }\r\n            model.addNodeData(newGroup);\r\n            model.setDataProperty(parent.data, \"group\", newGroup.key);\r\n        }\r\n\r\n        //update group\r\n        var nodeGroup = node.containingGroup;\r\n        if (nodeGroup && nodeGroup.data.parent == node.data.key) {\r\n            model.setDataProperty(nodeGroup.data, 'group', parent.data.group);\r\n        } else {\r\n            if (node.data.parent == null && node.data.isparent != null) {\r\n                //add group for root node\r\n                addGroupForNode(node, parent.data.group);\r\n            } else {\r\n                model.setDataProperty(node.data, \"group\", parent.data.group);\r\n            }\r\n        }\r\n\r\n        //update level\r\n        var diff = node.data.level - parent.data.level - 1;\r\n        helpers.travelParts(node, function(part) {\r\n            model.setDataProperty(part.data, 'level', part.data.level - diff);\r\n        });\r\n        model.commitTransaction('setNodeAsChildren');\r\n    }\r\n\r\n\r\n    // tdGetModelData(name,model) { //获取盘的model.modelData中的全局属性 \r\n    //     // if(myDiagram1){\r\n    //     //     myDiagram = myDiagram1\r\n    //     // }\r\n    //     var myDiagram = this.diagram\r\n    //     var  model = myDiagram.model\r\n    //     var defaultVal = {\r\n    //         currentType: 'tianpan',\r\n    //         currentThemeID: 0,\r\n    //         layerThickness: 100,\r\n    //         splitLayer: 1,\r\n    //         layout: 'inner',\r\n    //         tdDipanTextAngle: 'xuanzhuan'\r\n    //     };\r\n    //     console.log(\"getRootNodeData1111111111111111111111\")\r\n    //     var root = getRootNodeData(model);\r\n    //     if (typeof(name) != 'undefined' && name != null) { //返回指定的属性值\r\n    //         if (root) {\r\n    //             return root[name] || model.modelData[name] || defaultVal[name]\r\n    //         } else {\r\n    //             return model.modelData[name] || defaultVal[name];\r\n    //         }\r\n    //     }\r\n    //     //返回所有属性值\r\n    //     if (root) {\r\n    //         for (var key in defaultVal) {\r\n    //             if (root[key]) {\r\n    //                 defaultVal[key] = root[key];\r\n    //             } else {\r\n    //                 if (model.modelData && model.modelData[key]) {\r\n    //                     defaultVal[key] = model.modelData[key];\r\n    //                 }\r\n    //             }\r\n    //         }\r\n    //     } else {\r\n    //         for (var key in defaultVal) {\r\n    //             if (model.modelData && model.modelData[key]) {\r\n    //                 defaultVal[key] = model.modelData[key];\r\n    //             }\r\n    //         }\r\n    //     }\r\n    //     return defaultVal;\r\n    // }\r\n    deleteSelection (e) {\r\n        var myDiagram = this.diagram;\r\n        var cmd = myDiagram.commandHandler;\r\n        var node = myDiagram.selection.first();\r\n        \r\n        if (!node) {\r\n            return;\r\n        }\r\n        // var nodeCopy = JSON.parse(JSON.stringify(node.data))\r\n        if (node instanceof go.Group) {\r\n            return;\r\n        }\r\n        if (node.data.key == 1 || node.data.key == 'g_1') {\r\n            //root node or root group\r\n            return;\r\n        }\r\n    \r\n        var locateNode = null;\r\n        var tempArray = [\"next\",\"prev\",\"parent\"]\r\n        for(var i=0;i<tempArray.length;i++){\r\n            if(node.data[tempArray[i]]){\r\n                locateNode = myDiagram.findNodeForKey(node.data[tempArray[i]])\r\n                break;\r\n            }\r\n        }\r\n        // if (node.findNodesOutOf().first()) {\r\n        //     locateNode = node.findNodesOutOf().first();\r\n        // } else if (node.findNodesInto().first()) {\r\n        //     locateNode = node.findNodesInto().first();\r\n        // }\r\n    \r\n        myDiagram.startTransaction(\"deleteSelection1\");\r\n        try {\r\n    \r\n            if (node instanceof go.Link) {\r\n                return;\r\n            }\r\n            myDiagram.startTransaction('sub');\r\n\r\n            if(node.data.category == \"autoText\"){\r\n                myDiagram.model.removeNodeData(node.data)\r\n            }else{\r\n                this.deleteNode(node, e);\r\n            }\r\n\r\n    \r\n            myDiagram.commitTransaction('sub');\r\n            // myDiagram.model.removeNodeData(node.data);\r\n            go.CommandHandler.prototype.deleteSelection.call(cmd);\r\n    \r\n            // myDiagram.updateAllTargetBindings();\r\n    \r\n        } catch (ex) {\r\n            console.log(ex);\r\n            myDiagram.commitTransaction(\"deleteSelection1\");\r\n            return;\r\n        }\r\n        // myDiagram.updateAllTargetBindings();\r\n        myDiagram.commitTransaction(\"deleteSelection1\");\r\n        if (locateNode) {\r\n            myDiagram.select(locateNode);\r\n        }\r\n\r\n    }\r\n    //删除节点\r\n    deleteNode(node, e) {\r\n        console.log(\"deleteNodedeleteNodedeleteNodedeleteNode\")\r\n        var myDiagram = this.diagram;\r\n        var mainNode = null;\r\n        if (node instanceof go.Group) {\r\n            //查找第一个节点\r\n            node.memberParts.each(function(n) {\r\n                if (n.data.isparent) {\r\n                    mainNode = n;\r\n                }\r\n            })\r\n        }\r\n        node = mainNode == null ? node : mainNode;\r\n        if (node instanceof go.Node) {\r\n            var preNode = node.findNodesInto().first() ? node.findNodesInto().first() : null;\r\n            var nextNode = node.data.next ? myDiagram.findNodeForKey(node.data.next) : null;\r\n            if (nextNode) {\r\n                var nextNodeLink = nextNode.findLinksInto().first();\r\n            } else {\r\n                var nextNodeLink = null;\r\n            }\r\n\r\n            var intoLink = node.findLinksInto().first();\r\n            var tmpNodeData = {};\r\n            // _.extendOwn(tmpNodeData, node.data);\r\n            // tmpNodeData = helpers.extend(tmpNodeData, node.data);\r\n            tmpNodeData = JSON.parse(JSON.stringify(node.data));\r\n            var oldlink = node.findLinksInto().first() ? node.findLinksInto().first().data : null;\r\n            var link = {};\r\n            // link = _.extendOwn(link, oldlink);\r\n            // link = helpers.extend(link, oldlink);\r\n            if(oldlink){\r\n                delete oldlink.points;\r\n\r\n            }\r\n            link = JSON.parse(JSON.stringify(oldlink))\r\n            delete link.__gohashid;\r\n            delete link.points;\r\n            if (node.data.group) {\r\n                var nodeGroup = myDiagram.findNodeForKey(node.data.group);\r\n                // var nodeGroupData = nodeGroup.data;\r\n            } else {\r\n                var nodeGroup = null;\r\n                var nodeGroupData = null;\r\n            }\r\n\r\n            //如果不是根节点,除了根节点都有一条入边\r\n            // myDiagram.startTransaction(\"changeLinks\");\r\n            try {\r\n                if (node.data.isparent) {\r\n                    var nodes = [],\r\n                        groups = [],\r\n                        mylinks = [];\r\n                    myDiagram.nodes.each(function(n) {\r\n                        if (n.isMemberOf(nodeGroup) && n.data.key != node.data.key) {\r\n                            nodes.push(n.data);\r\n                            if (n.findLinksInto().count > 0) {\r\n                                mylinks.push(n.findLinksInto().first().data);\r\n                            }\r\n\r\n                        }\r\n                    });\r\n\r\n                    if (mainNode) {\r\n                        nodes.push(node.data);\r\n                    }\r\n                    myDiagram.model.removeNodeDataCollection(nodes);\r\n                    myDiagram.model.removeLinkDataCollection(mylinks);\r\n                    myDiagram.model.removeNodeData(nodeGroup.data);\r\n                }\r\n\r\n                if (preNode != null) {\r\n                    ////如果是父节点，则删除所有子孙节点,包括group\r\n\r\n                    //当前节点为第一个子节点\r\n                    if (preNode.data.key == tmpNodeData.parent) {\r\n                        //如果当前节点是最后一个子节点\r\n                        if (nextNode == null) {\r\n\r\n                            var parGroup = myDiagram.findNodeForKey(preNode.data.group);\r\n                            var grandNode = myDiagram.findNodeForKey(preNode.data.parent);\r\n                            if(preNode.data.category!==\"Root\"){//zyy增加判断\r\n                                if (grandNode) {\r\n                                    myDiagram.model.setDataProperty(preNode.data, \"group\", grandNode.data.group);\r\n                                } else {\r\n                                    if(parGroup && parGroup.data.group){\r\n                                        myDiagram.model.setDataProperty(preNode.data, \"group\", parGroup.data.group);\r\n                                    }else{\r\n                                        myDiagram.model.setDataProperty(preNode.data, \"group\", undefined);\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                            //父节点的isparent属性\r\n                            myDiagram.model.setDataProperty(preNode.data, \"isparent\", undefined);\r\n                            //var parGroup = myDiagram.findNodeForKey(preNode.data.group);\r\n                            if (parGroup) {\r\n                                myDiagram.model.removeNodeData(parGroup.data);\r\n                            }\r\n                        } else {\r\n                            link.from = preNode.data.key;\r\n                            link.to = nextNode.data.key;\r\n                            myDiagram.model.setDataProperty(nextNode.data, \"prev\", undefined);\r\n                            myDiagram.model.addLinkData(link);\r\n                            myDiagram.model.setDataProperty(myDiagram.model.findNodeDataForKey(tmpNodeData.parent), \"isparent\", nextNode.data.key);\r\n\r\n                        }\r\n                    } else {\r\n                        //\r\n                        myDiagram.model.setDataProperty(preNode.data, \"next\", nextNode == null ? null : nextNode.data.key);\r\n\r\n                        if (nextNode != null) {\r\n                            link.from = preNode.data.key;\r\n                            link.to = nextNode.data.key;\r\n                            myDiagram.model.setDataProperty(nextNode.data, \"prev\", preNode.data.key);\r\n                            myDiagram.model.addLinkData(link);\r\n                        }\r\n                    }\r\n\r\n                    //var parLink = node.findLinksInto().first();\r\n                    if (intoLink) {\r\n                        myDiagram.model.removeLinkData(intoLink.data);\r\n                    }\r\n                    if (nextNodeLink) {\r\n                        myDiagram.model.removeLinkData(nextNodeLink.data);\r\n                    }\r\n                }\r\n            } catch (ex) {\r\n                console.log(ex.message);\r\n            }\r\n\r\n        }\r\n        myDiagram.isModified = true;\r\n    }\r\n\r\n    addLevelNodeData(node) {\r\n        var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        var myDiagram = node.diagram;\r\n        var currentType = 'tianpan';\r\n        var toKey = node.data.next;\r\n        //delete the next link\r\n    \r\n        var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n        //var follower = {key: nextkey, text: nextkey, color: \"yellow\"};\r\n    \r\n        var follower = { key: nextkey, text: lang.trans(\"dce\"), color: \"yellow\" };\r\n        myDiagram.model.makeNodeDataKeyUnique(follower);\r\n        nextkey = follower.key;\r\n        var nextnode = null;\r\n        var nextlink = null;\r\n        var group = myDiagram.model.findNodeDataForKey(node.data.parent).group;\r\n        //找到下一个子节点\r\n        node.findNodesOutOf().each(function(n) {\r\n            if (n.data.level == node.data.level) {\r\n                nextnode = n;\r\n            }\r\n        });\r\n    \r\n        var nextlink = null;\r\n        //找到下一条边\r\n        node.findLinksOutOf().each(function(l) {\r\n            if (l.data.level == node.data.level) {\r\n                nextlink = l;\r\n            }\r\n        });\r\n        //ControlAutoLayout(false);\r\n        myDiagram.model.startTransaction();\r\n    \r\n        follower = applyTheme2Node(follower, node);\r\n        //delete the next link\r\n        var deleteLink = null;\r\n    \r\n        //if has next node\r\n        if (nextnode != null) {\r\n            follower.next = nextnode.data.key;\r\n            myDiagram.model.setDataProperty(nextnode.data, \"prev\", follower.key);\r\n        }\r\n    \r\n        if (group) {\r\n            follower.group = group;\r\n        }\r\n    \r\n    \r\n        follower.level = node.data.level;\r\n        if (currentType == \"tianpan\") {\r\n            follower.radius = node.data.radius;\r\n            //follower.fill = colorMap[follower.level % 5];\r\n            follower.fill = node.data.fill;\r\n        } else {\r\n            follower.radius = node.data.radius;\r\n            follower.fill = node.data.fill;\r\n            //follower.fill =go.Brush.randomColor(128, 240);\r\n            follower.dangle = node.data.dangle;\r\n            follower.dradius = node.data.dradius;\r\n            follower.sweep = node.data.sweep;\r\n            follower.layerThickness = node.data.layerThickness || 100;\r\n            follower.tdDipanTextAngle = node.data.tdDipanTextAngle || 'xuanzhuan';\r\n        }\r\n        follower.parent = node.data.parent;\r\n        follower.prev = node.data.key;\r\n        follower.strokeWidth = node.data.strokeWidth;\r\n        follower.stroke = node.data.stroke;\r\n        follower.font = node.data.font;\r\n        //follower.font = node.data.font;\r\n        follower.textStroke = node.findObject(\"TEXT\").stroke;\r\n        if (node.data.figure) {\r\n            follower.figure = node.data.figure;\r\n        }\r\n        follower.loc = node.data.loc;\r\n        if (currentType == 'tianpan') {\r\n    \r\n            var nextLocation = node.location.copy();\r\n            if (node.data.parent) {\r\n                var parentNode = myDiagram.findNodeForKey(node.data.parent);\r\n                if (parentNode) {\r\n                    nextLocation = computeNextLoc(node, parentNode);\r\n                }\r\n            }\r\n            follower.loc = go.Point.stringify(nextLocation);\r\n    \r\n        }\r\n        if (node.data.width) {\r\n            follower.width = node.data.width;\r\n        }\r\n        if (node.data.height) {\r\n            follower.height = node.data.height;\r\n        }\r\n        follower.category = node.data.category;\r\n        follower.newAdd = true;\r\n        // add a new node\r\n        myDiagram.model.addNodeData(follower);\r\n    \r\n        // add a link from the selected node to the new node\r\n        var linkToFollower = { from: node.data.key, to: follower.key };\r\n        linkToFollower.level = node.data.level;\r\n        linkToFollower.color = follower.fill;\r\n        linkToFollower.isTreeLink = true;\r\n        linkToFollower = applyTheme2Link(linkToFollower, node);\r\n    \r\n        // linkToFollower.strokeWidth = node.data.level == 1 ? 4 : Math.max(1, 3 - (linkToFollower.level - 1) * 0.5);\r\n        linkToFollower.strokeWidth = 2;\r\n        if (node.findLinksInto() && node.findLinksInto().first()) {\r\n            linkToFollower.color = node.findLinksInto().first().data.color;\r\n            linkToFollower.strokeWidth = node.findLinksInto().first().data.strokeWidth;\r\n            linkToFollower.toArrow = node.findLinksInto().first().data.toArrow;\r\n            linkToFollower.strokeDashArray = node.findLinksInto().first().data.strokeDashArray;\r\n        } else {\r\n            linkToFollower = applyTheme2Link(linkToFollower, node);\r\n        }\r\n        if (currentType == 'dipan') {\r\n            if (node.data.category == 'Root' || node.data.category == 'dipan') {\r\n                linkToFollower.category = 'dipan';\r\n            }\r\n        }\r\n        myDiagram.model.addLinkData(linkToFollower, node);\r\n    \r\n        myDiagram.model.setDataProperty(node.data, \"next\", nextkey);\r\n        if (nextlink != null) {\r\n            var copyLink = {};\r\n            // _.extendOwn(copyLink, nextlink.data);\r\n            // copyLink = helpers.extend(copyLink, nextlink.data);\r\n            delete nextlink.data.points\r\n            copyLink = JSON.parse(JSON.stringify(nextlink.data));\r\n\r\n            delete copyLink.__gohashid;\r\n            delete copyLink.points;\r\n            copyLink.from = follower.key;\r\n            copyLink.to = nextlink.data.to;\r\n            myDiagram.model.removeLinkData(nextlink.data);\r\n            myDiagram.model.addLinkData(copyLink);\r\n        }\r\n        myDiagram.model.commitTransaction();\r\n        myDiagram.isModified = true;\r\n        return follower;\r\n    }\r\n\r\n    addFollower(e, iskeyboard) {\r\n        if(!e){\r\n            var e = this.diagram.lastInput\r\n        }\r\n        var myDiagram = e.diagram;\r\n        var node = myDiagram.selection.first();\r\n        if (!node) return;\r\n        var diagram = node.diagram;\r\n        // var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        var isautolayout = true\r\n        if (node === null || !(node instanceof go.Node) || node instanceof go.Group) return;\r\n        if (node.findLinksInto().count == 0) return;\r\n        if (myDiagram.toolManager.textEditingTool.isActive) {\r\n            var tb = myDiagram.selection.first().findObject('TEXT');\r\n            tb.text = myDiagram.toolManager.textEditingTool.currentTextEditor.innerText;\r\n            myDiagram.toolManager.textEditingTool.stopTool();\r\n        }\r\n        if (!isautolayout) {\r\n            ControlAutoLayout(e, false);\r\n        } else {\r\n            if (node.data.level >= 3) {\r\n                ControlAutoLayout(e, false);\r\n                autoLayoutPart(node);\r\n            } else {\r\n                ControlAutoLayout(e, true);\r\n            }\r\n        }\r\n    \r\n        myDiagram.model.startTransaction('all');\r\n    \r\n        var follower = this.addLevelNodeData(node);\r\n        myDiagram.model.commitTransaction('all');\r\n    \r\n        if (typeof iskeyboard != 'undefined' && iskeyboard == true) { // check whether is a keyboard trigger the action\r\n            var newnode = diagram.findNodeForData(follower);\r\n            if (newnode) {\r\n                diagram.select(newnode);\r\n            }\r\n    \r\n            //myDiagram.scale = 0.6588944708324703;\r\n            myDiagram.isModified = true;\r\n    \r\n            var tb = myDiagram.selection.first().findObject('TEXT');\r\n            // // console.log(tb)\r\n            if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n            helpers.simulateEnterWithAlt(e);\r\n        }\r\n    }\r\n\r\n    startNewSpiral(iskeyboard) {\r\n        var myDiagram = this.diagram;\r\n        var e = myDiagram.lastInput;\r\n        var node = myDiagram.selection.first();\r\n        if (!node) return;\r\n        var diagram = node.diagram;\r\n        // var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        var isautolayout = true\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        if (node === null || !(node instanceof go.Node) || node instanceof go.Group) return;\r\n    \r\n        if (node.data.isparent && myDiagram.findNodeForKey(node.data.isparent) && !myDiagram.findNodeForKey(node.data.isparent).visible) {\r\n            return;\r\n        }\r\n        if (!isautolayout) {\r\n            ControlAutoLayout(e, false);\r\n        } else {\r\n            if (node.data.level >= 2) {\r\n                ControlAutoLayout(e, false);\r\n                autoLayoutPart(node);\r\n            } else {\r\n                ControlAutoLayout(e, true);\r\n            }\r\n        }\r\n        myDiagram.startTransaction();\r\n        myDiagram.startTransaction(\"addChildNodeData\");\r\n        var follower = this.addChildNodeData(node);\r\n        // var root = getRootNodeData(node.data, myDiagram.model, 0);\r\n        myDiagram.commitTransaction(\"addChildNodeData\");\r\n        myDiagram.commitTransaction();\r\n    \r\n        // select the new Node\r\n        if (typeof iskeyboard != 'undefined' && iskeyboard == true) {\r\n            var newnode = myDiagram.findNodeForData(follower);\r\n            if (newnode) {\r\n                myDiagram.centerRect(newnode.actualBounds);\r\n            }\r\n    \r\n            diagram.select(newnode); //需要居中\r\n            var tb = myDiagram.selection.first().findObject('TEXT');\r\n            if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n            helpers.simulateEnterWithAlt(e);\r\n        }\r\n    }\r\n\r\n    \r\n    //modify nodeDataArray\r\n    addChildNodeData(node) {\r\n        console.log(\"===================天盘\")\r\n        var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        var myDiagram = node.diagram;\r\n        var result = arguments[1] ? arguments[1] : null;\r\n        var currentType = 'tianpan';\r\n        // var nodeRoot = getRootNodeData(node.data, myDiagram.model);\r\n        // if (nodeRoot.category == \"Root\") {\r\n        //     currentType = 'dipan';\r\n        // } else {\r\n        //     currentType = 'tianpan';\r\n        // }\r\n        currentType = 'tianpan';\r\n        //myDiagram.startTransaction();\r\n        var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n        //var follower = {key: nextkey, text: nextkey};\r\n        var follower = { key: nextkey, text: lang.trans('dce') };\r\n        //if (result != null) {\r\n        myDiagram.model.makeNodeDataKeyUnique(follower);\r\n        nextkey = follower.key;\r\n        //}\r\n        //找到第一个子节点\r\n        var firstNode = myDiagram.findNodeForKey(node.data.isparent);\r\n        // node.findNodesOutOf().each(function(n) {\r\n        //     if (n.data.level > node.data.level) {\r\n        //         firstNode = n;\r\n        //     }\r\n        // });\r\n\r\n        var firstLink = null;\r\n        //找到第一条子边\r\n        node.findLinksOutOf().each(function(l) {\r\n            if (l.data.level > node.data.level) {\r\n                firstLink = l;\r\n            }\r\n        });\r\n        follower.level = node.data.level + 1;\r\n        follower.parent = node.data.key;\r\n        follower.prev = undefined;\r\n\r\n        //如果已经有子节点\r\n        if (node.data.isparent && firstNode != null) {\r\n\r\n            follower.next = firstNode.data.key;\r\n            myDiagram.model.setDataProperty(firstNode.data, \"prev\", follower.key);\r\n        }\r\n\r\n        if (result != null) {\r\n            //只是用来填充的节点\r\n            follower.istemp = true;\r\n            follower.text = \"\";\r\n        }\r\n\r\n\r\n\r\n        if (node.data.level == 0) {\r\n            follower.radius = Math.max(node.data.radius * 0.75, 100);\r\n        } else {\r\n            if (node.data.radius) {\r\n                follower.radius = Math.max(node.data.radius - 5, 50);\r\n            } else {\r\n                follower.radius = Math.max(InitialFontSize - node.data.level * 10, 50);\r\n            }\r\n\r\n        }\r\n        //如果当前节点属于某个group，根节点和普通主节点通用\r\n        if (firstNode != null) {\r\n            if (node.containingGroup) {\r\n                follower.group = node.containingGroup.data.key;\r\n            }\r\n\r\n        }\r\n        //如果当前节点属于某个group，根节点和普通主节点通用\r\n        // if (firstNode == null && currentType=='tianpan') {\r\n        if (firstNode == null) {\r\n            // add a group; make it a member of the same group as the selected node\r\n            var newGroup = {\r\n                isGroup: true,\r\n                group: node.data.group,\r\n                parent: node.data.key,\r\n                fill: \"rgba(0,0,0,0)\",\r\n                stroke: \"rgba(0,0,0,0)\",\r\n                strokeWidth: 0,\r\n                level: node.data.level\r\n            };\r\n            newGroup = applyTheme2Group(newGroup, node);\r\n            // if (node.data.category == \"dipan\" || node.data.category == \"Root\") {\r\n            //     newGroup.category = \"dipan\";\r\n\r\n\r\n            // }\r\n            myDiagram.model.addNodeData(newGroup);\r\n            //修改主节点的group为新的group\r\n            myDiagram.model.setGroupKeyForNodeData(node.data, newGroup.key);\r\n            follower.group = newGroup.key;\r\n        }\r\n\r\n\r\n        follower.fill = colorMap[follower.level % 5];\r\n        follower.category = node.data.category;\r\n\r\n        follower.loc = go.Point.stringify(computeChildLoc(node));\r\n\r\n\r\n\r\n        // follower.strokeWidth = node.data.strokeWidth;\r\n        follower.strokeWidth = 2;\r\n        if (node.data.figure) {\r\n            follower.figure = node.data.figure;\r\n        }\r\n\r\n        if (node.data.picture) {\r\n            follower.picture = node.data.picture;\r\n        }\r\n\r\n\r\n        if (node.data.width) {\r\n            follower.width = node.data.width;\r\n        }\r\n        if (node.data.height) {\r\n            follower.height = node.data.height;\r\n        }\r\n\r\n        follower = applyTheme2Node(follower, node);\r\n\r\n        follower.font = node.data.font;\r\n        follower.textStroke = node.findObject(\"TEXT\").stroke;\r\n        myDiagram.model.setDataProperty(node.data, \"isparent\", nextkey);\r\n        follower.newAdd = true;\r\n        myDiagram.model.addNodeData(follower);\r\n\r\n\r\n        // add a link from the selected node to the new node\r\n        var linkToFollower = { from: node.data.key, to: follower.key };\r\n\r\n        linkToFollower.level = follower.level;\r\n        //linkToFollower.color = follower.fill;\r\n        linkToFollower.isTreeLink = true;\r\n\r\n\r\n        // linkToFollower.strokeWidth = node.data.level <= 0 ? 4 : Math.max(1, 3 - (linkToFollower.level - 1) * 0.5);\r\n        linkToFollower.strokeWidth = 2;\r\n        var intoLink = null;\r\n        intoLink = node.findLinksInto().first();\r\n        if (firstLink != null) {\r\n            linkToFollower.toArrow = firstLink.data.toArrow;\r\n            linkToFollower.strokeDashArray = firstLink.data.strokeDashArray;\r\n            linkToFollower.color = firstLink.data.color;\r\n            linkToFollower.strokeWidth = 2;\r\n            // if (node.data.level == 0) {\r\n            //     linkToFollower.strokeWidth = 4;\r\n            // } else {\r\n            //     if (node.data.level == 1) {\r\n            //         linkToFollower.strokeWidth = Math.max(1, firstLink.data.strokeWidth - 1);\r\n            //     } else {\r\n            //         linkToFollower.strokeWidth = Math.max(1, firstLink.data.strokeWidth - 0.5);\r\n            //     }\r\n            // }\r\n            //linkToFollower.strokeWidth = node.data.level <= 0 ? 4 : (node.data.level == 1?node.data.strokeWidth -1:node.data.strokeWidth-0.5)  Math.max(1, 3 - (linkToFollower.level - 1) * 0.5));\r\n        } else if (intoLink != null) {\r\n            linkToFollower.toArrow = intoLink.data.toArrow;\r\n            linkToFollower.strokeDashArray = intoLink.data.strokeDashArray;\r\n            linkToFollower.color = intoLink.data.color;\r\n            linkToFollower.strokeWidth = 2;\r\n            // if (node.data.level == 0) {\r\n            //     linkToFollower.strokeWidth = 4;\r\n            // } else {\r\n            //     if (node.data.level == 1) {\r\n            //         linkToFollower.strokeWidth = Math.max(1, intoLink.data.strokeWidth - 1);\r\n            //     } else {\r\n            //         linkToFollower.strokeWidth = Math.max(1, intoLink.data.strokeWidth - 0.5);\r\n            //     }\r\n            // }\r\n        } else {\r\n            linkToFollower = applyTheme2Link(linkToFollower, node);\r\n        }\r\n\r\n        if (node.data.category == \"dipan\" || node.data.category == 'Root') { //处理天盘\r\n            linkToFollower.category = \"dipan\";\r\n        }\r\n\r\n        myDiagram.model.addLinkData(linkToFollower);\r\n        if (firstLink != null) {\r\n            var copyLink = {};\r\n            // _.extendOwn(copyLink, firstLink.data);\r\n            // copyLink = helpers.extend(copyLink, firstLink.data);\r\n            delete firstLink.data.points\r\n            copyLink = JSON.parse(JSON.stringify(firstLink.data))\r\n            delete copyLink.__gohashid;\r\n            delete copyLink.points;\r\n            copyLink.from = follower.key;\r\n            copyLink.to = firstLink.data.to;\r\n            myDiagram.model.removeLinkData(firstLink.data);\r\n            myDiagram.model.addLinkData(copyLink);\r\n            // myDiagram.model.setFromKeyForLinkData(firstLink.data, follower.key);\r\n        }\r\n        if (currentType == 'tianpan') {\r\n            //  if (!isautolayout || !isautoselect) {\r\n            //   ControlAutoLayout(false);\r\n            //   // if(node.data.isparent && myDiagram.findNodeForKey(node.data.isparent) && node.data.group){\r\n            //   //   node = myDiagram.findNodeForKey(node.data.group)\r\n            //   // }\r\n            //   if (node && node.containingGroup) {\r\n            //     node.containingGroup.layout.isOngoing = true;\r\n            //     node.containingGroup.layout.isValidLayout = false;\r\n            //   }else{\r\n            //     node.diagram.layout.isOngoing = true;\r\n            //     node.diagram.layout.isValidLayout = false;\r\n            //   }\r\n            // }\r\n        }\r\n        //myDiagram.commitTransaction(\"new spiral\");\r\n        myDiagram.isModified = true;\r\n        return follower;\r\n    }\r\n\r\n\r\n    moveWithinNodes(direction) {\r\n        var myDiagram = this.diagram;\r\n        var node = myDiagram.selection.first();\r\n        if(!node){\r\n            return;\r\n        }\r\n        if (!node) {\r\n            myDiagram.select(myDiagram.findNodeForKey(1));\r\n            return;\r\n        }\r\n        switch (direction) {\r\n            case 'left':\r\n                if (node.data.prev) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.prev);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'up':\r\n                if (node.data.parent) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.parent);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'right':\r\n                if (node.data.next) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.next);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'down':\r\n                if (node.data.isparent) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.isparent);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    selectText(e) {\r\n        var myDiagram = this.diagram\r\n        var node = myDiagram.selection.first();\r\n        if (!node) return;\r\n        // removeNodeRemarkTips();\r\n        var tb = myDiagram.selection.first().findObject('TEXT');\r\n        if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n        helpers.simulateEnterWithAlt(e);\r\n    }\r\n\r\n    //快捷键\r\n    dokeyDownFn (e) {\r\n        // console.log('myDiagram:', diagram);\r\n        var diagram = this.diagram\r\n        var that = this;\r\n        var myDiagram = this.diagram;\r\n        var e = myDiagram.lastInput;\r\n        var cmd = myDiagram.commandHandler;\r\n        if (e.event.altKey) {\r\n            if (e.key == \"Q\") {\r\n                autoLayoutAll();\r\n                return;\r\n            } else if (e.key == \"R\") {\r\n                centerNode();\r\n                return;\r\n            } else if (e.key == \"C\") {\r\n                centerCurrentNode();\r\n                return;\r\n            } else if (e.key == \"A\") {\r\n                zoomToFit();\r\n                return;\r\n            }\r\n        }\r\n        if (e.event.keyCode >= 65 && e.event.keyCode <= 90 && !e.event.altKey && !e.event.ctrlKey && !e.event.shiftKey) {\r\n            e.bubbles = false;\r\n            this.selectText(e, diagram);\r\n            return true;\r\n    \r\n        }\r\n        // console.log('catched in dokeydown ' + e.event.keyCode);\r\n        // console.log('catched in dokeydown ' + e.key);\r\n        if (e.event.keyCode === 13) { // could also check for e.control or e.shift\r\n            var node = myDiagram.selection.first();\r\n            if (node && node.data.parent) {\r\n                this.addFollower(e, true);\r\n            }\r\n            if (node && !node.data.parent) {\r\n                that.startNewSpiral(true);\r\n            }\r\n        } else if (e.event.keyCode === 9) { // could also check for e.control or e.shift\r\n            that.startNewSpiral(true);\r\n        } else if (e.key === \"t\") { // could also check for e.control or e.shift\r\n            if (cmd.canCollapseSubGraph()) {\r\n                cmd.collapseSubGraph();\r\n            } else if (cmd.canExpandSubGraph()) {\r\n                cmd.expandSubGraph();\r\n            }\r\n        } else if (e.key == \"Del\") {\r\n            e.diagram.commandHandler.deleteSelection();\r\n        } else if (e.event.keyCode == 113) { //F2,不知道为什么失效了，重新赋予功能\r\n            // selectText();\r\n            this.selectText(e, diagram);\r\n        } else if (e.event.keyCode == 37) { //左\r\n            this.moveWithinNodes('left', diagram);\r\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        } else if (e.event.keyCode == 38) { //上\r\n            this.moveWithinNodes('up', diagram);\r\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        } else if (e.event.keyCode == 39) { //右\r\n            this.moveWithinNodes('right', diagram);\r\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        } else if (e.event.keyCode == 40) { //下\r\n            this.moveWithinNodes('down', diagram);\r\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        } else {\r\n            // call base method with no arguments\r\n            go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        }\r\n        e.bubbles = false; //阻止事件冒泡到dom\r\n    }\r\n    \r\n    // 生成base64图片\r\n    downloadImage() {\r\n        var myDiagram = this.diagram;\r\n        var imgdata = myDiagram.makeImageData({\r\n            scale: 1.0,\r\n            background: \"#ffffff\",\r\n            type: \"image/png\",\r\n            maxSize: new go.Size(9000, 9000)\r\n        });\r\n\r\n        return imgdata;\r\n    }\r\n\r\n   \r\n    getNodeSelectionAdornmentTemplate() {\r\n        return $(go.Adornment, \"Spot\",\r\n            $(go.Panel, \"Auto\",\r\n                $(go.Shape, { figure: \"Circle\", fill: 'rgba(255,0,120,0.2)', stroke: \"#767678\", strokeWidth: 12 },\r\n                    new go.Binding(\"stroke\", \"\", function(e, obj) {\r\n                        if (e.stroke) {\r\n                            return tinycolor(e.stroke).saturate().toString()\r\n                        } else {\r\n                            return \"#767678\";\r\n                        }\r\n                    }),\r\n                    // new go.Binding(\"fill\",\"\",function(e,obj){\r\n                    //   var radBrush = $(go.Brush, \"Radial\", { 0: \"rgba(248,248,242,0)\", 1: 'RGB(255,242,0)' });\r\n                    //   return radBrush;\r\n                    // })\r\n                    // ,\r\n                    new go.Binding(\"strokeWidth\", \"\", function(e, obj) {\r\n                        if (e.strokeWidth) {\r\n                            return e.strokeWidth + 5;\r\n                        } else {\r\n                            return 6;\r\n                        }\r\n    \r\n                    }),\r\n                    new go.Binding(\"width\", \"\", function(e, obj) {\r\n                        return e.radius || 150;\r\n                    }),\r\n                    new go.Binding(\"height\", \"\", function(e, obj) {\r\n                        return e.radius || 150;\r\n                    })\r\n                ),\r\n                $(go.Placeholder) // this represents the selected Node\r\n    \r\n            ),\r\n            // the button to create a \"next\" node, at the top-right corner\r\n            $(\"Button\", {\r\n                    name: \"AddChild\",\r\n                    toolTip: $(go.Adornment, \"Auto\",\r\n                        $(go.Shape, { fill: \"#FFFFCC\" }),\r\n                        $(go.TextBlock, { textAlign: 'center', margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\r\n                            new go.Binding(\"text\", \"\", function(d) {\r\n                                return \"增加子节点\";\r\n                            }))\r\n                    ),\r\n                    alignment: go.Spot.Top,\r\n                    alignmentFocus: go.Spot.Bottom,\r\n                    width: 30,\r\n                    height: 30,\r\n                    click: function (e) {\r\n                        e.diagram.__trtd.startNewSpiral()\r\n                    } // this function is defined below\r\n                },\r\n                $(go.Shape, \"PlusLine\", { stroke: '#770077', desiredSize: new go.Size(15, 15) })\r\n            ),\r\n    \r\n            $(\"Button\", {\r\n                    name: \"AddLevel\",\r\n                    toolTip: $(go.Adornment, \"Auto\",\r\n                        $(go.Shape, { fill: \"#FFFFCC\" }),\r\n                        $(go.TextBlock, { textAlign: 'center', margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\r\n                            new go.Binding(\"text\", \"\", function(d) {\r\n                                return \"增加同级节点\";\r\n                            }))\r\n                    ),\r\n                    alignment: new go.Spot(1, 0.5, 15, 0),\r\n                    width: 30,\r\n                    height: 30,\r\n                    click: function (e) {\r\n                        e.diagram.__trtd.addFollower(e)\r\n                    } // this function is defined below\r\n                },\r\n                $(go.Shape, \"PlusLine\", { stroke: \"#227700\", desiredSize: new go.Size(15, 15) }),\r\n                new go.Binding(\"visible\", \"level\", function(level) {\r\n                    return level != 0; // hidden this button if current node is root node\r\n    \r\n                })\r\n            ),\r\n            // $(go.Panel, \"Auto\", {        // 放大镜\r\n            //         name: \"ButtonIcon1\",\r\n            //         alignment: new go.Spot(0, 1, 5, -5),\r\n            //         //alignment: go.Spot.BottomLeft,\r\n            //         //alignmentFocus: go.Spot.BottomLeft,\r\n            //         width: 60,\r\n            //         height: 60,\r\n            //         isActionable: true,\r\n            //         click: expandCollapse // this function is defined below\r\n            //     },\r\n    \r\n            //     $(go.Shape, \"Circle\", {\r\n            //         fill: \"rgba(1,1,1,0)\",\r\n            //         strokeWidth: 0,\r\n            //         stroke: \"green\",\r\n            //         width: 50,\r\n            //         height: 50\r\n            //     }),\r\n            //     $(go.Shape, {\r\n            //             '_para1': true,\r\n            //             name: \"ButtonIcon\",\r\n            //             fill: \"red\",\r\n            //             strokeWidth: 2,\r\n            //             stroke: \"#767678\",\r\n            //             geometryString: icons[\"zoomout\"], // default value for isTreeExpanded is true\r\n            //             desiredSize: new go.Size(30, 30)\r\n            //         },\r\n            //         new go.Binding(\"geometryString\", \"\", function(d, button) {\r\n            //             // console.log('dddddd:', d);\r\n            //             // console.log('button:', button);\r\n            //             // var myDiagram = d.diagram;\r\n            //             // var node = myDiagram.selection.first();\r\n            //             // if (node[\"_controlExpand\"]) {\r\n            //             //     return icons[\"zoomout\"];\r\n            //             // } else {\r\n            //             //     return icons[\"zoomin\"];\r\n            //             // }\r\n            //             return icons[\"zoomin\"];\r\n            //         })\r\n            //     )\r\n            // )\r\n        );\r\n    } // end Adornment\r\n\r\n    // 给子节点添加序号\r\n    orderChildNode(obj) {\r\n        var myDiagram = this.diagram;\r\n        var arr = [];\r\n        var node = myDiagram.selection.first();\r\n        console.log(\"node\", node);\r\n        if (node) {\r\n            myDiagram.startTransaction();\r\n            console.log(\"node.data\", node.data);\r\n            if (node.data.isparent) {\r\n                var first = myDiagram.model.findNodeDataForKey(node.data.isparent);\r\n                arr.push(first);\r\n                pushChildKeyToArr(first, arr, this);\r\n\r\n                var re = /^(\\d+\\、+)|(\\d+\\.+)/g;\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    if (re.test(arr[i].text)) {\r\n                        myDiagram.model.setDataProperty(arr[i], \"text\", (arr[i].text).replace(re, (i + 1) + \".\"));\r\n                    } else {\r\n                        if(arr[i].text == ''){\r\n                            myDiagram.model.setDataProperty(arr[i], \"text\", (i + 1));                                \r\n                        }else{\r\n                            myDiagram.model.setDataProperty(arr[i], \"text\", (i + 1) + \".\" + arr[i].text);\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                console.log(\"无子节点！\");\r\n            }\r\n            myDiagram.commitTransaction();\r\n        };\r\n    }\r\n\r\n    clearOrderChildNode(obj) {\r\n        var myDiagram = this.diagram;\r\n        var arr = [];\r\n        var node = myDiagram.selection.first();\r\n        console.log(\"node\", node);\r\n        if (node) {\r\n            myDiagram.startTransaction();\r\n            console.log(\"node.data\", node.data);\r\n            if (node.data.isparent) {\r\n                var first = myDiagram.model.findNodeDataForKey(node.data.isparent);\r\n                arr.push(first);\r\n                pushChildKeyToArr(first, arr, this);\r\n\r\n                var re = /^(\\d+\\、+)|(\\d+\\.+)/g;\r\n                for (var i = 0; i < arr.length; i++) {\r\n                    if (re.test(arr[i].text)) {\r\n                        myDiagram.model.setDataProperty(arr[i], \"text\", (arr[i].text).replace(re, \"\"));\r\n                    }\r\n                }\r\n            } else {\r\n                console.log(\"无子节点！\");\r\n            }\r\n            myDiagram.commitTransaction();\r\n        };\r\n    }\r\n}\r\n\r\n//临时扇区转换为正式扇区\r\nfunction changeTemp2normal(myDiagram) {\r\n\r\n    var node = myDiagram.selection.first();\r\n    if (node.data.istemp) {\r\n        myDiagram.model.startTransaction();\r\n        var tmpNode = myDiagram.findNodeForKey(node.data.parent);\r\n        myDiagram.model.setDataProperty(node.data, \"istemp\", undefined);\r\n        var lastNode = null; //记录这一级扇区\r\n        while (tmpNode) {\r\n            if (tmpNode.data.istemp) {\r\n                myDiagram.model.setDataProperty(tmpNode.data, \"istemp\", undefined);\r\n                myDiagram.model.setDataProperty(tmpNode.data, \"text\", \"双击编辑内容\");\r\n                lastNode = tmpNode;\r\n            } else {\r\n                if (lastNode) {\r\n                    myDiagram.model.setDataProperty(tmpNode.data, \"isparent\", lastNode.data.key);\r\n                }\r\n                break;\r\n            }\r\n            tmpNode = myDiagram.findNodeForKey(tmpNode.data.parent);\r\n        }\r\n        myDiagram.model.commitTransaction();\r\n        myDiagram.isModified = true;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nfunction applyTheme2Node(follower,node) {\r\n\r\n    node.diagram.model.setDataProperty(follower, 'strokeWidth', node.diagram.__trtd.tdCurrentTheme.borderWidth);\r\n    node.diagram.model.setDataProperty(follower, 'stroke', node.diagram.__trtd.tdCurrentTheme.borderColor);\r\n    if (node.diagram.__trtd.tdCurrentTheme.colorRange == null) {\r\n        node.diagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n    } else if (node.diagram.__trtd.tdCurrentTheme.colorRange instanceof Array) {\r\n        var tmpColor = \"white\";\r\n        if (follower.level >= node.diagram.__trtd.tdCurrentTheme.colorRange.length) {\r\n            tmpColor = node.diagram.__trtd.tdCurrentTheme.colorRange[follower.level % node.diagram.__trtd.tdCurrentTheme.colorRange.length];\r\n        } else {\r\n            tmpColor = node.diagram.__trtd.tdCurrentTheme.colorRange[follower.level];\r\n        }\r\n        node.diagram.model.setDataProperty(follower, 'fill', tmpColor);\r\n    } else if (node.diagram.__trtd.tdCurrentTheme.colorRange == \"random\") {\r\n        //层级颜色一样的随机色\r\n        if (follower.prev) {\r\n            var preNode = node.diagram.findNodeForKey(follower.prev);\r\n            if (preNode) {\r\n                node.diagram.model.setDataProperty(follower, 'fill', preNode.data.fill);\r\n            } else {\r\n                node.diagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n            }\r\n\r\n        } else {\r\n            node.diagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n        }\r\n    } else {\r\n        if (node.diagram.__trtd.tdCurrentTheme.colorRange == \"white\") {\r\n            node.diagram.model.setDataProperty(follower, 'fill', \"white\");\r\n        } else {\r\n            node.diagram.model.setDataProperty(follower, 'fill', \"rgba(0,0,0,0)\");\r\n        }\r\n\r\n    }\r\n    return follower;\r\n}\r\n\r\n//生成地盘的figure形状\r\nfunction makeAnnularWedge(data, layerThickness) {\r\n    var sweep = data.sweep ? data.sweep : 360;\r\n    var layerThickness = data.layerThickness || 100;\r\n    var radius = data.dradius ? data.dradius : 100;\r\n    var p = new go.Point(radius + layerThickness, 0).rotate(-sweep / 2);\r\n    var q = new go.Point(radius, 0).rotate(sweep / 2);\r\n    var geo = new go.Geometry()\r\n        .add(new go.PathFigure(p.x, p.y)\r\n            .add(new go.PathSegment(go.PathSegment.Arc, -sweep / 2, sweep, 0, 0, radius + layerThickness, radius + layerThickness))\r\n            .add(new go.PathSegment(go.PathSegment.Line, q.x, q.y))\r\n            .add(new go.PathSegment(go.PathSegment.Arc, sweep / 2, -sweep, 0, 0, radius, radius).close()));\r\n    geo.normalize();\r\n    return geo;\r\n}\r\n\r\nfunction getRootNodeData(model,nodeData,level) {\r\n    var parent, root = nodeData;\r\n    if (!level) {\r\n        level = 0;\r\n    }\r\n    while (root.parent) {\r\n        if (root.level == level) {\r\n            break;\r\n        }\r\n        parent = model.findNodeDataForKey(root.parent);\r\n        if (parent) {\r\n            root = parent;\r\n        }\r\n    }\r\n    return root;\r\n}\r\n\r\n\r\nfunction getNodeContextMenu() {\r\n   \r\n\r\n    let style = {\r\n        // width: 120,\r\n        // height: 30,\r\n        // margin: 2,\r\n        // font: \"bold 14px sans-serif\",\r\n        // margin: 3,\r\n    }\r\n\r\n    return $(go.Adornment, \"Vertical\",\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"应用样式到所有同级节点\"), {\r\n                click: function(e, obj) {\r\n                    menus.applyStyle2Level(e, obj);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"应用样式到同级节点\"), {\r\n                click: function(e, obj) {\r\n                    menus.applyStyle2CurLevel(e, obj);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"应用样式到子节点\"), {\r\n                click: function(e, obj) {\r\n                    menus.applyStyle2ChiLevel(e, obj);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"添加\"), {\r\n                click: function(e, obj) {\r\n                    menus.addFollower(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"添加子节点\"), {\r\n                click: function(e) {\r\n                    menus.startNewSpiral();\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"定位当前节点\"), style, {\r\n                click: centerCurrentNode\r\n            }),\r\n\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除\"), style, {\r\n                click: function(e, obj) {\r\n                    console.log('eeeeeeeeee:', e);\r\n                    e.diagram.commandHandler.deleteSelection();\r\n                }\r\n            }),\r\n        // $(\"ContextMenuButton\",\r\n        //     $(go.TextBlock, \"添加图片\"), style, {\r\n        //         click: function(e, obj) {\r\n        //             insertPicture();\r\n        //         }\r\n        //     }),\r\n        // $(\"ContextMenuButton\",\r\n        //     $(go.TextBlock, \"移除图片\"), style, {\r\n        //         click: function(e, obj) {\r\n        //             removeNodePicture();\r\n        //         }\r\n        //     }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"清空文本\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if (node) {\r\n                        myDiagram.startTransaction();\r\n                        //node.data.text=\"\";\r\n                        myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n                        myDiagram.commitTransaction();\r\n                    }\r\n                    //removeNodePicture();\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除 DEL\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if (node) {\r\n                        yunpan.yunpandel(e)\r\n                    }\r\n                    //removeNodePicture();\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"增加 CTRL+X/Y\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if (node) {\r\n                        if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n                            yunpan.addy(e)\r\n                        }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n                            yunpan.addx(e)\r\n                        }; \r\n                    }\r\n                    //removeNodePicture();\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除 DEL\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if (node) {\r\n                        yunpan.yunpandel(e)\r\n                    }\r\n                    //removeNodePicture();\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"增加同级节点\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(myDiagram.selection.first().data.istemp){\r\n                        return\r\n                    }\r\n                    dipan.addFollowerGround(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"增加子节点\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(node.data.parent){\r\n                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                        if(parentNode.data.istemp){\r\n                            return\r\n                        }\r\n                    }\r\n                    dipan.addNewCircle(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(node.data.parent){\r\n                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                        if(parentNode.data.istemp){\r\n                            return\r\n                        }\r\n                    }\r\n                    dipan.addNewCircle(e);\r\n                }\r\n            }),\r\n            $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"复制副本\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(myDiagram.selection.first().data.istemp){\r\n                        return\r\n                    }\r\n                    dipan.addFollowerGround(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"权限设置\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(node.data.parent){\r\n                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                        if(parentNode.data.istemp){\r\n                            return\r\n                        }\r\n                    }\r\n                    dipan.addNewCircle(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除\"), style, {\r\n                click: function(e, obj) {\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    if(node.data.parent){\r\n                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                        if(parentNode.data.istemp){\r\n                            return\r\n                        }\r\n                    }\r\n                    dipan.addNewCircle(e);\r\n                }\r\n            })\r\n\r\n    );\r\n}\r\n\r\n\r\n// function cxcommand (obj, val) {\r\n//     var diagram = obj.diagram;\r\n//     var myDiagram = obj.diagram;\r\n//     if (!(diagram.currentTool instanceof go.ContextMenuTool)) return;\r\n//     switch (val) {\r\n//         // case \"Paste\": diagram.commandHandler.pasteSelection(diagram.lastInput.documentPoint); break;\r\n//         case \"addChildNodeMenu\":\r\n//         diagram.__trtd.startNewSpiral();\r\n//             break;\r\n//         case \"addLevelNodeMenu\":\r\n//         diagram.__trtd.addFollower(obj);\r\n//             break;\r\n//         case \"deleteNodeMenu\":\r\n//             myDiagram.toolManager.textEditingTool.doCancel();\r\n//             myDiagram.commandHandler.deleteSelection();\r\n//             break;\r\n//         case \"addNodePictureMenu\":\r\n//             // jQuery(\"#insertimage\").modal('show');\r\n//             // document.getElementById('insertimage').modal('show');\r\n//             break; //特殊处理\r\n//         case \"removeNodePictureMenu\":\r\n//             removeNodePicture(obj);\r\n//             break;\r\n//         case \"clearNodeTextMenu\":\r\n//             var node = myDiagram.selection.first();\r\n//             if (node) {\r\n//                 myDiagram.startTransaction();\r\n//                 myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n//                 myDiagram.commitTransaction();\r\n//             };\r\n//             break;\r\n//         case \"locateRootNodeMenu\":\r\n//             centerNode(obj);\r\n//             break;\r\n//         case \"showAllNodesMenu\":\r\n//             zoomToFit(obj);\r\n//             break;\r\n//         case \"removeOutCycleMenu\":\r\n//             removeOutCycle(obj);\r\n//             break;\r\n//         case \"centerPictureMenu\":\r\n//             centerPicture(obj);\r\n//             break;\r\n//         case \"equalWidthHeightPictureMenu\":\r\n//             equalWidthHeightPicture(obj);\r\n//             break;\r\n//         case \"bringToTopMenu\":\r\n//             bringToLayer(\"Foreground\", obj);\r\n//             break;\r\n//         case \"bringToBackgroundMenu\":\r\n//             bringToLayer(\"Background\", obj);\r\n//             break;\r\n//         case \"bringUpMenu\":\r\n//             bringToLayer(null, obj);\r\n//             break;\r\n//         case \"layoutGroupMenu\":\r\n//             autoLayoutAll(true, obj);\r\n//             break;\r\n\r\n//         case \"insertTextMenu\":\r\n//             insertTextNode(obj);\r\n//             break;\r\n//         case \"duplicateNode\":\r\n//             duplicateNode(obj);\r\n//             break; // 复制节点\r\n//         case \"insertTianpanMenu\":\r\n//             myDiagram.toolManager.clickCreatingTool.insertPart(myDiagram.lastInput.documentPoint);\r\n//             break;\r\n//         //固定节点\r\n//         case \"fixPictureMenu\":   \r\n//         case \"activePictureMenu\":\r\n//             var node = myDiagram.findPartAt(myDiagram.lastInput.documentPoint, false);\r\n//             // var node = myDiagram.selection.first();\r\n//             myDiagram.startTransaction();\r\n//             myDiagram.model.setDataProperty(node.data, \"selectable\", node.data.selectable != undefined ? (!node.data.selectable) : false);\r\n//             myDiagram.commitTransaction();\r\n//             break;\r\n//         case \"orderChildNode\":\r\n//             obj.diagram.__trtd.orderChildNode(obj);\r\n//             break;\r\n//         case \"clearOrderChildNode\":\r\n//             obj.diagram.__trtd.clearOrderChildNode(obj);\r\n//             break;\r\n//         case \"delYunpanAxis\":\r\n//             yunpan.yunpandel(obj);\r\n//             break;\r\n//         case \"addYunpanAxis\":\r\n//             var node = myDiagram.selection.first();\r\n//             if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n//                 yunpan.addy(obj)\r\n//             }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n//                 yunpan.addx(obj)\r\n//             }; \r\n//             break;\r\n//         case \"addLevelDipanNode\":\r\n//             if(myDiagram.selection.first().data.istemp){\r\n//                 return\r\n//             }\r\n//             obj.addFollowerGround();\r\n//             break;\r\n//         case \"addChildDipanNode\":\r\n//             var node = myDiagram.selection.first();\r\n//                 if(node.data.parent){\r\n//                     var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n//                     if(parentNode.data.istemp){\r\n//                         return\r\n//                     }\r\n//                 }\r\n//             obj.addNewCircle(obj);\r\n//             break;\r\n//         case \"deleteDipanNode\":\r\n//         // myDiagram.commandHandler.deleteSelection();\r\n//         obj.deleteSelection();\r\n//         break;\r\n//     }\r\n//     diagram.currentTool.stopTool();\r\n// }\r\n\r\n\r\n\r\n\r\n\r\n   /***\r\n     * 判断Node descendant是否是node的后代，如果是返回true, 否则返回false\r\n     * @param descendent go.Node type\r\n     * @param node go.Node Type\r\n     */\r\n    function isDescendant(descendant, node) {\r\n        var diagram = node.diagram,\r\n            cur = descendant;\r\n        //此处若出现bug，请告知，谢谢\r\n        while (cur.data.parent && cur.data.parent != node.data.key) {\r\n            cur = diagram.findNodeForKey(cur.data.parent);\r\n        }\r\n\r\n        return (cur.data.parent != null);\r\n    }\r\n\r\n    /***\r\n     * disconnect node (including his descendants) from diagram\r\n     * @param node go.Node type\r\n     */\r\n    function disconnectFromTreeStructure(node) {\r\n        if (node.data.parent == null) {\r\n            //if it's root node\r\n            return;\r\n        }\r\n        var diagram = node.diagram,\r\n            model = node.diagram.model;\r\n        if (node.data.prev) {\r\n            //it's not the first child of it's parent\r\n            var preNode = diagram.findNodeForKey(node.data.prev);\r\n            if (node.data.next) {\r\n                var nextNode = diagram.findNodeForKey(node.data.next);\r\n                model.setDataProperty(preNode.data, \"next\", nextNode.data.key);\r\n                model.setDataProperty(nextNode.data, \"prev\", preNode.data.key);\r\n                var link = preNode.findLinksTo(node).first();\r\n                model.setToKeyForLinkData(link.data, nextNode.data.key);\r\n\r\n                var link = node.findLinksTo(nextNode).first();\r\n                model.removeLinkData(link.data);\r\n            } else {\r\n                model.setDataProperty(preNode.data, \"next\", null);\r\n                var link = preNode.findLinksTo(node).first();\r\n                model.removeLinkData(link.data);\r\n            }\r\n\r\n        } else {\r\n            //it's the first child of it's parent\r\n            var parNode = diagram.findNodeForKey(node.data.parent);\r\n            if (node.data.next) {\r\n                var nextNode = diagram.findNodeForKey(node.data.next);\r\n                model.setDataProperty(parNode.data, \"isparent\", nextNode.data.key);\r\n                model.setDataProperty(nextNode.data, \"prev\", null);\r\n\r\n                var link = parNode.findLinksTo(node).first();\r\n                model.setToKeyForLinkData(link.data, nextNode.data.key);\r\n\r\n                link = node.findLinksTo(nextNode).first();\r\n                model.removeLinkData(link.data);\r\n            } else {\r\n                if (!parNode) {\r\n                    return;\r\n                }\r\n                model.setDataProperty(parNode.data, \"isparent\", null);\r\n                var link = parNode.findLinksTo(node).first();\r\n                if (link) {\r\n                    model.removeLinkData(link.data);\r\n                }\r\n\r\n\r\n                //remove group if parent node have children\r\n                var parGroup = parNode.containingGroup;\r\n                if (parGroup) {\r\n                    model.setDataProperty(parNode.data, 'group', parGroup.data.group);\r\n                    model.removeNodeData(parGroup.data);\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n        model.setDataProperty(node.data, 'parent', null);\r\n        model.setDataProperty(node.data, 'prev', null);\r\n        model.setDataProperty(node.data, 'next', null);\r\n    } //end removing from original tree structure\r\n\r\n    function applyTheme2Link(linkToFollower, node) {\r\n        var myDiagram = node.diagram;\r\n        var tdCurrentTheme = myDiagram.__trtd.tdCurrentTheme\r\n        if (tdCurrentTheme.linkColor != null) {\r\n            // linkToFollower.color = tdCurrentTheme.linkColor;\r\n            myDiagram.model.setDataProperty(linkToFollower, 'color', tdCurrentTheme.linkColor);\r\n        }\r\n    \r\n        return linkToFollower;\r\n    }\r\n    \r\n    /***\r\n     * add group for node\r\n     * @param node go.Node\r\n     * @param parentGroupKey\r\n     */\r\n    function addGroupForNode(node, parentGroupKey) {\r\n        if (node.data.group != null || node.data.isparent == null) {\r\n            return;\r\n        }\r\n        var child = diagram.findNodeForKey(node.data.isparent);\r\n        if (!child) {\r\n            return;\r\n        }\r\n        var diagram = node.diagram;\r\n        var model = diagram.model;\r\n\r\n        var group = { isGroup: true, parent: node.data.key, key: \"g_\" + node.data.key, group: parentGroupKey, level: node.data.level };\r\n        model.addNodeData(group);\r\n        model.setDataProperty(node.data, \"group\", group.key);\r\n\r\n        // set group for his child.\r\n\r\n        var childGroup = child.containingGroup;\r\n        if (childGroup) {\r\n            model.setDataProperty(childGroup.data, \"group\", group.key);\r\n        } else {\r\n            model.setDataProperty(child.data, \"group\", group.key);\r\n        }\r\n        while (child.data.next) {\r\n            child = diagram.findNodeForKey(child.data.next);\r\n            childGroup = child.containingGroup;\r\n            if (childGroup) {\r\n                model.setDataProperty(childGroup.data, \"group\", group.key);\r\n            } else {\r\n                model.setDataProperty(child.data, \"group\", group.key);\r\n            }\r\n        }\r\n    }    \r\n\r\n    function ControlAutoLayout(e, flag) {\r\n        var myDiagram = e.diagram;\r\n        var diagram = e.diagram;\r\n        var node = diagram.selection.first();\r\n        if (node) {\r\n            var root = getRootNodeData( diagram.model, node.data, 0);\r\n            diagram.startTransaction(\"ControlAutoLayout\");\r\n            helpers.tdTravelTdpData(root, diagram.model, [], function(d) {\r\n\r\n                if (diagram.findNodeForKey(d.key).containingGroup && diagram.findNodeForKey(d.key).containingGroup.layout) {\r\n                    diagram.findNodeForKey(d.key).containingGroup.layout.isInitial = flag;\r\n                    diagram.findNodeForKey(d.key).containingGroup.layout.isOngoing = flag;\r\n                }\r\n            })\r\n            if (root.group && diagram.findNodeForKey(root.group)) {\r\n                diagram.findNodeForKey(root.group).layout.isInitial = flag;\r\n                diagram.findNodeForKey(root.group).layout.isOngoing = flag;\r\n            } else {\r\n                diagram.layout.isInitial = flag;\r\n                diagram.layout.isOngoing = flag;\r\n            }\r\n        } else {\r\n            diagram.nodes.each(function(node) {\r\n                if (diagram.findNodeForKey(node.data.key).layout) {\r\n                    diagram.findNodeForKey(node.data.key).layout.isInitial = flag;\r\n                    diagram.findNodeForKey(node.data.key).layout.isOngoing = flag;\r\n                }\r\n            });\r\n            diagram.layout.isInitial = flag;\r\n            diagram.layout.isOngoing = flag;\r\n        }\r\n        diagram.commitTransaction(\"ControlAutoLayout\");\r\n    }    \r\n\r\n//设置局部布局\r\nfunction autoLayoutPart(node) {\r\n    if (!node) return;\r\n    var group = node.containingGroup;\r\n    if (group) {\r\n        group.layout.isInitial = true;\r\n        group.layout.isOngoing = true;\r\n    }\r\n}\r\n\r\nfunction applyTheme2Group(group, node) {\r\n    var tdCurrentTheme = node.diagram.__trtd.tdCurrentTheme\r\n    if (tdCurrentTheme.groupStrokeWidth) {\r\n        node.diagram.model.setDataProperty(group, 'strokeWidth', tdCurrentTheme.groupStrokeWidth);\r\n        // group.strokeWidth = tdCurrentTheme.groupStrokeWidth;\r\n    }\r\n    if (tdCurrentTheme.groupStroke) {\r\n        group.stroke = tdCurrentTheme.groupStroke;\r\n        node.diagram.model.setDataProperty(group, 'stroke', tdCurrentTheme.groupStroke);\r\n    }\r\n    if (tdCurrentTheme.groupColor) {\r\n        group.fill = tdCurrentTheme.groupColor;\r\n        node.diagram.model.setDataProperty(group, 'fill', tdCurrentTheme.groupColor);\r\n    }\r\n    return group;\r\n}\r\n\r\nfunction computeChildLoc(root) {\r\n    if (root.data.isparent) {\r\n        var rootLoc = root.location.copy();\r\n        var rootPoint = new go.Point(0, 0);\r\n        var firstChild = root.diagram.findNodeForKey(root.data.isparent);\r\n        var firstLoc = firstChild.location.copy();\r\n        var relativeFirstLoc = new go.Point(firstLoc.x - rootLoc.x, firstLoc.y - rootLoc.y);\r\n\r\n        var relativeMidLoc = relativeFirstLoc.copy().rotate(-90);\r\n        var midLoc = new go.Point(relativeMidLoc.x + rootLoc.x, relativeMidLoc.y + rootLoc.y);\r\n        return midLoc;\r\n    }\r\n    var rootLoc = root.location.copy();\r\n    var offset = computeOffset(root.actualBounds.width + 100, 225);\r\n    rootLoc.offset(offset[0], offset[1]);\r\n\r\n    return rootLoc;\r\n}\r\n\r\nfunction computeNextLoc(node, root) {\r\n    /* 计算根据中心节点顺时针旋转一定角度得到的下一个节点位置 */\r\n    var rootLoc = root.location.copy();\r\n    var curLoc = node.location.copy();\r\n    var relativeLoc = new go.Point(curLoc.x - rootLoc.x, curLoc.y - rootLoc.y);\r\n    var rootPoint = new go.Point(0, 0);\r\n    var depth = 20;\r\n\r\n    if (node.data.next) { // 如果存在下一个节点，则新节点位于当前节点和下一个节点之间，稍微偏差一点\r\n        var nextNode = node.diagram.findNodeForKey(node.data.next);\r\n        var nextLoc = nextNode.location.copy();\r\n        var relativeNextLoc = new go.Point(nextLoc.x - rootLoc.x, nextLoc.y - rootLoc.y);\r\n\r\n        var relativeMidLoc = new go.Point((relativeLoc.x + relativeNextLoc.x) / 2, (relativeLoc.y + relativeNextLoc.y) / 2);\r\n        var angle = rootPoint.directionPoint(relativeMidLoc) - rootPoint.directionPoint(relativeLoc);\r\n        relativeMidLoc = relativeLoc.rotate(angle);\r\n        var offset = computeOffset(depth, rootPoint.directionPoint(relativeMidLoc));\r\n        relativeMidLoc.offset(offset[0], offset[1]);\r\n        var midLoc = new go.Point(relativeMidLoc.x + rootLoc.x, relativeMidLoc.y + rootLoc.y);\r\n        return midLoc;\r\n    }\r\n\r\n    //角度由前一个节点和当前节点一致\r\n    if (node.data.prev && node.diagram.findNodeForKey(node.data.prev)) {\r\n        var prevLoc = node.diagram.findNodeForKey(node.data.prev).location.copy();\r\n        var relativeLocPrev = new go.Point(prevLoc.x - rootLoc.x, prevLoc.y - rootLoc.y);\r\n        var angle = rootPoint.directionPoint(relativeLoc) - rootPoint.directionPoint(relativeLocPrev);\r\n        console.log('angle:' + angle);\r\n        if (angle > 45) {\r\n            angle = 45;\r\n        }\r\n    } else {\r\n        var angle = 60;\r\n    }\r\n    var lastLoc = relativeLoc.rotate(angle);\r\n    var offset = computeOffset(depth, rootPoint.directionPoint(lastLoc));\r\n    lastLoc.offset(offset[0], offset[1]);\r\n    lastLoc = new go.Point(lastLoc.x + rootLoc.x, lastLoc.y + rootLoc.y);\r\n    return lastLoc;\r\n}\r\n\r\nfunction computeOffset(newR, newStartAngle) {\r\n    //console.log(\"newStartAngle:\"+newStartAngle);\r\n    var ctl2, dy, dx; //需要调整\r\n    if (newStartAngle >= 0 && newStartAngle <= 90) {\r\n        dy = newR * Math.sin(newStartAngle * Math.PI / 180);\r\n        dx = newR * Math.cos(newStartAngle * Math.PI / 180);\r\n        return [dx, dy];\r\n    } else if (newStartAngle > 90 && newStartAngle <= 180) {\r\n        dy = newR * Math.sin((180 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((180 - newStartAngle) * Math.PI / 180);\r\n        return [-dx, dy];\r\n    } else if (newStartAngle > 180 && newStartAngle <= 270) {\r\n        dy = newR * Math.sin((newStartAngle - 180) * Math.PI / 180);\r\n        dx = newR * Math.cos((newStartAngle - 180) * Math.PI / 180);\r\n        return [-dx, -dy];\r\n    } else if (newStartAngle > 270 && newStartAngle <= 360) {\r\n        dy = newR * Math.sin((360 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((360 - newStartAngle) * Math.PI / 180);\r\n        return [dx, -dy];\r\n    }\r\n}\r\n\r\nfunction pushChildKeyToArr(data, arr, node) {\r\n    var myDiagram = node.diagram;\r\n    if (data.next) {\r\n        var obj = myDiagram.model.findNodeDataForKey(data.next);\r\n        arr.push(obj);\r\n        return pushChildKeyToArr(obj, arr, node);\r\n    } else {\r\n        return arr;\r\n    }\r\n}\r\n\r\n\r\nTrtd.go = go;\r\n\r\n// if (typeof window !== 'undefined') {\r\n// \tif(window.Trtd){\r\n//         window.Trtd.dipan = Trtd;\r\n//     } else{\r\n//         window.Trtd = {\r\n//             dipan: Trtd\r\n//         }\r\n//     }\r\n// }\r\n\r\nmodule.exports = Trtd;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/tianpan.js","// 返回图片天盘节点模板\r\nvar $ = go.GraphObject.make;\r\n\r\nmodule.exports = function createPictureNodeTemplate (diagram) {\r\n    // var $ = go.GraphObject.make;\r\n\r\n    return $(go.Node, \"Auto\", {\r\n            \"_controlExpand\": true,\r\n            layerName: \"default\",\r\n            locationSpot: go.Spot.Center,\r\n            resizeCellSize: new go.Size(10, 10),\r\n            locationObjectName: \"SHAPE\",\r\n            resizable: true,\r\n            resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n            rotatable: false,\r\n            //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n            doubleClick: function (e, node) {\r\n                interactions.selectText(e, node)\r\n            },\r\n            //toMaxLinks: 1,\r\n            layoutConditions: go.Part.LayoutStandard,\r\n            //layoutConditions:~go.Part.LayoutAdded,    \r\n            // fromLinkable: true, toLinkable: true,\r\n            alignment: go.Spot.Center,\r\n            alignmentFocus: go.Spot.Center,\r\n            resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n\r\n            contextMenu: $(go.Adornment),\r\n            selectionAdornmentTemplate: diagram.__trtd.getNodeSelectionAdornmentTemplate()\r\n        //layoutConditions: go.Part.LayoutStandard & ~go.Part.LayoutNodeSized & ~go.Part.LayoutAdded\r\n        },\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        $(go.Panel, \"Spot\",\r\n            $(go.Picture, // the icon showing the logo\r\n                // You should set the desiredSize (or width and height)\r\n                // whenever you know what size the Picture should be.\r\n                { name: \"SHAPE\" }, {\r\n                    sourceCrossOrigin: function(pict) {\r\n                        return \"Anonymous\";\r\n                    }\r\n                },\r\n                new go.Binding(\"source\", \"picture\", function(v){\r\n                    \r\n                    return v+\"?\"+Date.now()\r\n\r\n                }).makeTwoWay(function(v){\r\n                    if(v){\r\n                        v = v.replace(/\\?.*$/g,\"\")\r\n                        return v\r\n                    }else{\r\n                        return \"\"\r\n                    }\r\n                }),\r\n                new go.Binding(\"width\", \"width\", function(v, d) {\r\n                    return v;\r\n                }).makeTwoWay(function(v) {\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"height\", \"height\", function(v, d) {\r\n                    return v;\r\n                }).makeTwoWay(function(v) {\r\n                    return v;\r\n                })\r\n            ),\r\n            $(go.TextBlock, {\r\n                    name: \"TEXT\",\r\n                    alignment: new go.Spot(0.5, 0.5),\r\n                    font: \"bold 18px 幼圆\",\r\n                    //margin: 3, editable: true,\r\n                    stroke: \"black\",\r\n                    isMultiline: true,\r\n                    overflow: go.TextBlock.OverflowClip,\r\n                    wrap: go.TextBlock.WrapDesiredSize,\r\n                    textAlign: \"center\",\r\n                    spacingAbove: 4,\r\n                    spacingBelow: 4,\r\n                    portId: \"TEXT\",\r\n                    stretch: go.GraphObject.Fill\r\n                        //,width:100\r\n                },\r\n                new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                    return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                    return tdTransToNum(v, 4);\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                    return tdTransToNum(v, 4);\r\n                }).makeTwoWay(),\r\n                //new go.Binding(\"width\",\"width\",function(v){return v/2 * Math.sqrt(2)+7;}).ofObject(\"SHAPE\"),\r\n                new go.Binding(\"maxSize\", \"width\", function(v) {\r\n                    var va = v / 2 * Math.sqrt(2);\r\n                    return new go.Size(va, va);\r\n                }).ofObject(\"SHAPE\"),\r\n                // new go.Binding(\"height\",\"width\",function(v){return v/2 * Math.sqrt(2);;}).ofObject(\"SHAPE\"),\r\n                new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n                new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n                new go.Binding(\"font\", \"font\").makeTwoWay()\r\n            )\r\n        ), {\r\n            toolTip: $(go.Adornment, \"Auto\",\r\n                $(go.Shape, { fill: \"#FFFFCC\" }),\r\n                $(go.TextBlock, { margin: 4 }, // the tooltip shows the result of calling nodeInfo(data)\r\n                    new go.Binding(\"text\", \"\", function(d) {\r\n                        return d.text;\r\n                    })\r\n                )\r\n            )\r\n        }\r\n    );\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createPictureNodeTemplate.js","var $ = go.GraphObject.make\r\nvar svg = require('../datas/svg.template');\r\n\r\n// 返回svg节点\r\nmodule.exports = function createNodeSvgTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 2,\r\n        stroke: \"black\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Spot\",{\r\n                name: \"NODE\",\r\n                \"_controlExpand\": true,\r\n                layerName: \"Background\",\r\n                locationSpot: go.Spot.Center,\r\n                resizeCellSize: new go.Size(10, 10),\r\n                locationObjectName: \"BACKGROUND\",\r\n                resizable: true,\r\n                resizeObjectName: \"BACKGROUND\", // user can resize the Shape\r\n                rotatable: true,\r\n                rotateObjectName: \"BACKGROUND\", // rotate the Shape without rotating the label\r\n                click: function(e, node){\r\n                    // console.log(node.data);\r\n                },\r\n                doubleClick: function (e, node) {\r\n                    doubleClickCreateNodeType(e);\r\n                },\r\n                selectable: true,\r\n                selectionObjectName:\"BACKGROUND\",\r\n                movable: true,\r\n                angle: 0,\r\n                //toMaxLinks: 1,\r\n                layoutConditions: go.Part.LayoutStandard,\r\n                //layoutConditions:~go.Part.LayoutAdded,\r\n                // fromLinkable: true, toLinkable: true,\r\n                alignment: go.Spot.Center,\r\n                alignmentFocus: go.Spot.Center,\r\n                resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n                // rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n                contextMenu: $(go.Adornment),\r\n                // contextMenu: $(go.Adornment),\r\n            },\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n            new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n            new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n            new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n            $(go.Shape, {\r\n                name: \"SHAPE\",\r\n                geometryString: svg.threeWheel,\r\n                fill: \"black\",\r\n                strokeWidth: 5, \r\n                stroke: \"black\",\r\n                minSize: new go.Size(50, 50),\r\n                },\r\n                new go.Binding(\"fill\", \"fill\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                    // var va = (v / 2) * Math.sqrt(2);\r\n                    // console.log(\"desiredSize\",v)\r\n                    return v\r\n                }).ofObject(\"BACKGROUND\"),\r\n                new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    // var va = (v / 2) * Math.sqrt(2);\r\n                    // console.log(\"desiredSize\",v)\r\n                    return v\r\n                }).ofObject(\"BACKGROUND\"),\r\n                new go.Binding(\"geometryString\", \"geometryValue\", function(v) {\r\n                    return svg[v];\r\n                }),\r\n            ),\r\n            $(go.Shape, \"Rectangle\",{\r\n                name: 'BACKGROUND',\r\n                fill: \"rgba(1,1,1,0)\",\r\n                // width: 450,\r\n                // height: 450,\r\n                stroke: \"rgba(1,1,1,0)\",\r\n                // minSize: new go.Size(50, 50),\r\n                },\r\n                new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                    // console.log(\"vd m\", v, d )\r\n                    if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                    return go.Size.parse(v)\r\n                }).makeTwoWay(function(v) {\r\n                    return go.Size.stringify(v)\r\n                }),\r\n                new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                // new go.Binding(\"desiredSize\", \"height\", function(v) {\r\n                //     var radius = parseInt(v ? v : 100);\r\n                //     var size = new go.Size(radius, radius);\r\n                //     return size;\r\n                // }).makeTwoWay(function(v) {\r\n                //     return v.height;\r\n                // }),\r\n                // background: \"#555\",\r\n                // stroke: \"red\"}\r\n            ),\r\n    );\r\n}\r\n\r\nfunction doubleClickCreateNodeType(e){\r\n    // console.log('eeeeeeeeeeeeeee:', e);\r\n    var myDiagram = e.diagram;\r\n    myDiagram.startTransaction();\r\n    var text = { text: \"双击编辑文本\", category: 'text' };\r\n    text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n    myDiagram.model.addNodeData(text);\r\n    myDiagram.commitTransaction()\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createNodeSvgTemplate.js","var $ = go.GraphObject.make;\r\n\r\nmodule.exports = // 返回天盘模板\r\nfunction createNodeTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 2,\r\n        stroke: \"black\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n\r\n    return $(go.Node, \"Spot\", {\r\n        \"_controlExpand\": true,\r\n        layerName: \"default\",\r\n        locationSpot: go.Spot.Center,\r\n        resizeCellSize: new go.Size(10, 10),\r\n        locationObjectName: \"SHAPE\",\r\n        resizable: true,\r\n        resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n        rotatable: false,\r\n        location: new go.Point(0, 0),\r\n        click: function(e, node) {\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeClickListener){\r\n                node.diagram.__trtd.nodeClickListener(node)\r\n            }\r\n            // showNodeToolBar(e,node);\r\n        },\r\n        //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n        doubleClick: function (e, node){\r\n            e.diagram.__trtd.selectText(e, node)\r\n        },\r\n        toMaxLinks: 1,\r\n        layoutConditions: go.Part.LayoutStandard,\r\n        //layoutConditions:~go.Part.LayoutAdded,\r\n        // fromLinkable: true, toLinkable: true,\r\n        alignment: go.Spot.Center,\r\n        alignmentFocus: go.Spot.Center,\r\n        resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n        // contextMenu: $(go.Adornment),\r\n        contextMenu: $(go.Adornment),\r\n        selectionAdornmentTemplate: diagram.__trtd.getNodeSelectionAdornmentTemplate(),\r\n        mouseOver: function(e, node) {\r\n            // if(node.data.hyperlink){\r\n            //   var textObj = node.findObject('TEXT');\r\n            //   textObj.isUnderline = true;\r\n            // }\r\n\r\n            diagram.__trtd.showNodeRemarkTips(e, node);\r\n        },\r\n        mouseLeave: function(e, node) {\r\n            // if(node.data.hyperlink) {\r\n            //   var textObj = node.findObject('TEXT');\r\n            //   textObj.isUnderline = false;\r\n            // }\r\n            diagram.__trtd.removeNodeRemarkTips();\r\n        },\r\n        mouseDragEnter: function(e, obj) {\r\n            var node = obj.part;\r\n            var selnode = e.diagram.selection.first();\r\n            if (!(selnode instanceof go.Node) || selnode.category == \"3\" || selnode.category == \"text\" || selnode.key == 1) {\r\n                return;\r\n            }\r\n            //var sat = node.selectionAdornmentTemplate;\r\n            //var adorn = sat.copy();\r\n            //adorn.adornedObject = node;\r\n            //node.addAdornment(\"dragEnter\", adorn);\r\n\r\n            //if (!mayWorkFor(selnode, node)) return;\r\n            var shape = node.findObject(\"SHAPE\");\r\n            if (shape) {\r\n                shape._prevFill = shape.fill; // remember the original brush\r\n                shape.fill = \"darkred\";\r\n            }\r\n\r\n        },\r\n        mouseDragLeave: function(e, obj) {\r\n            var node = obj.part;\r\n            var shape = node.findObject(\"SHAPE\");\r\n            if (shape && shape._prevFill) {\r\n                shape.fill = shape._prevFill; // restore the original brush\r\n            }\r\n            //node.removeAdornment(\"dragEnter\");\r\n        },\r\n        mouseDrop: function(e, obj) {\r\n            var node = obj.part;\r\n            var selnode = e.diagram.selection.first();\r\n            if (!(selnode instanceof go.Node) || selnode.data.category == \"3\" || selnode.data.category == \"text\" || selnode.data.key == 1) {\r\n                return;\r\n            }\r\n\r\n            if (node.data.isparent) {\r\n                var child = e.diagram.findNodeForKey(node.data.isparent);\r\n                while (child.data.next) {\r\n                    child = e.diagram.findNodeForKey(child.data.next);\r\n                }\r\n                if (child.data.key == selnode.data.key) {\r\n                    //最后一个子节点拖放到父节点上时，不做任何操作\r\n                    return;\r\n                }\r\n                e.diagram.__trtd.setNodeAsSibling(selnode, child);\r\n            } else {\r\n                e.diagram.__trtd.setNodeAsChildren(selnode, node);\r\n            }\r\n        }},\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n        new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n        $(go.Shape, {\r\n                strokeDashArray: null,\r\n                // strokeDashOffset:10,\r\n                name: \"SHAPE\",\r\n                figure: \"Circle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                fromLinkable: true,\r\n                toLinkable: true,\r\n                cursor: \"pointer\",\r\n                minSize: new go.Size(50, 50),\r\n                strokeWidth: 2,\r\n                stroke: \"black\",\r\n                portId: \"\"\r\n\r\n            },\r\n            new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n                try {\r\n                    var val = [parseInt(v.split(\" \")[0]), parseInt(v.split(\" \")[1])];\r\n                } catch (e) {\r\n                    var val = null;\r\n                }\r\n                return val;\r\n            }).makeTwoWay(function(v) {\r\n                return v[0] + \" \" + v[1];\r\n            }), //保留，设置边线样式\r\n            new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n                return v instanceof go.Brush ? v.color : v;\r\n            }).makeTwoWay(),\r\n            // new go.Binding(\"fill\", \"isSelected\", function(s, obj) { return s ? \"red\" : obj.part.data.color; }).ofObject()),\r\n            new go.Binding(\"desiredSize\", \"radius\", function(v) {\r\n                //alert(v);\r\n                var radius = parseInt(v ? v : 100);\r\n                var size = new go.Size(radius, radius);\r\n                return size;\r\n            }).makeTwoWay(function(v) {\r\n                return v.width;\r\n            }),\r\n            new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay(),\r\n\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                return d;\r\n            }).makeTwoWay(function(d) {\r\n                return d;\r\n            }),\r\n            new go.Binding(\"figure\", \"figure\").makeTwoWay(), {\r\n                figure: properties.figure,\r\n                fill: properties.fill,\r\n                strokeWidth: properties.strokeWidth,\r\n                stroke: properties.stroke\r\n            }\r\n        ),\r\n        $(go.Shape, {\r\n                name: \"SHAPE_Back\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(128,128,128,0)\",\r\n                fromLinkable: true,\r\n                toLinkable: true,\r\n                strokeWidth: 0\r\n            },\r\n            new go.Binding(\"desiredSize\", \"width\", function(v) {\r\n                var va = (v / 2) * Math.sqrt(2);\r\n                return new go.Size(va - 3, va - 3);\r\n            }).ofObject(\"SHAPE\")\r\n        ),\r\n    \r\n        $(go.Panel, \"Table\",\r\n            $(go.RowColumnDefinition, { column: 0, width: 0 }\r\n                // new go.Binding('width','hyperlink',function(v){\r\n                //   return v?10:0;\r\n                // })\r\n            ),\r\n            $(go.Shape, 'Rectangle', {\r\n                row: 0,\r\n                column: 0,\r\n                // width:10,\r\n                fill: 'rgba(0,255,0,0)',\r\n                strokeWidth: 0\r\n            }),\r\n            $(go.Panel, \"Auto\", { row: 1, column: 0 },\r\n                $(go.Shape, \"RoundedRectangle\", { fill: \"rgba(0,0,0,0)\", strokeWidth: 0 }),\r\n                $(go.Picture, {\r\n                        alignment: go.Spot.Left,\r\n                        click: function(e) {\r\n                            alert('picture clicked');\r\n                        },\r\n                        name: 'Picture',\r\n                        // source: 'media/images/Katong/little-boy-black.png',\r\n                        desiredSize: new go.Size(10, 10)\r\n                    }\r\n\r\n                    // new go.Binding(\"source\", \"key\", findHeadShot)\r\n                )\r\n            ),\r\n            $(go.Shape, 'Rectangle', {\r\n                row: 2,\r\n                column: 0,\r\n                // width:10,\r\n                fill: 'rgba(0,0,0,0)',\r\n                strokeWidth: 0\r\n            }),\r\n            $(go.Panel, \"Auto\", { row: 0, column: 1, rowSpan: 3 },\r\n                $(go.TextBlock, {\r\n                        // stretch: go.GraphObject.Vertical,\r\n                        name: \"TEXT\",\r\n                        alignment: new go.Spot(0.5, 0.5),\r\n                        font: \"bold 18px 幼圆\",\r\n                        // editable: true,\r\n                        //margin: 3, editable: true,\r\n                        stroke: \"black\",\r\n                        isMultiline: true,\r\n                        overflow: go.TextBlock.OverflowClip,\r\n                        wrap: go.TextBlock.WrapDesiredSize,\r\n                        textAlign: \"center\",\r\n                        spacingAbove: 4,\r\n                        spacingBelow: 4,\r\n                        portId: \"TEXT\",\r\n                        stretch: go.GraphObject.Fill,\r\n                        click: function(e, node) {\r\n\r\n                        }\r\n                    },\r\n                    new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                        return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n                    }).makeTwoWay(),\r\n                    new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                        return tdTransToNum(v, 4);\r\n                    }).makeTwoWay(),\r\n                    new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                        return tdTransToNum(v, 4);\r\n                    }).makeTwoWay(),\r\n                    new go.Binding(\"width\", \"width\", function(v) {\r\n                        var va = v / 2 * Math.sqrt(2);\r\n                        return va;\r\n                    }).ofObject(\"SHAPE\"),\r\n                    new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n                    new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n                    new go.Binding(\"font\", \"font\").makeTwoWay()\r\n                )\r\n            )\r\n        )\r\n    );\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createNodeTemplate.js","var svg = {\n    'threeWheel': 'M 225 0 C 100.736 0 0 100.735 0 225 s 100.736 225 225 225 c 124.265 0 225.001 -100.734 225.001 -225 C 450.002 100.735 349.265 0 225 0 Z M 225 1.515 c 62.006 0 118.106 25.257 158.591 66.037 c -38.634 133.172 -160.888 157.047 -160.888 157.047 l 0.047 0.083 h -0.051 C 123.453 130.609 19.61 161.966 9.597 165.291 C 35.716 70.857 122.255 1.515 225 1.515 Z M 1.517 225 c 0 -20.075 2.663 -39.524 7.627 -58.035 c 6.686 -2.295 111.992 -36.362 212.807 58.54 c -3.347 10.815 -36.032 125.634 54.089 217.118 c -16.395 3.83 -33.479 5.859 -51.04 5.859 C 101.575 448.482 1.517 348.428 1.517 225 Z M 277.292 442.318 c -89.298 -94.891 -57.746 -204.506 -53.915 -216.53 l 0.076 0.135 c 0 0 126.301 -26.492 161.022 -157.465 c 39.584 40.319 64.008 95.575 64.008 156.542 C 448.483 330.418 375.489 418.773 277.292 442.318 Z',\n    'fireWheel': 'M225.000,450.000 C100.736,450.000 -0.000,349.264 -0.000,225.000 C-0.000,100.736 100.736,-0.000 225.000,-0.000 C349.264,-0.000 450.000,100.736 450.000,225.000 C450.000,349.264 349.264,450.000 225.000,450.000 ZM225.000,448.000 C338.085,448.000 431.498,363.821 446.026,254.709 C432.978,302.699 389.123,338.000 337.000,338.000 C274.592,338.000 224.000,287.408 224.000,225.000 C224.000,163.696 174.304,114.000 113.000,114.000 C51.696,114.000 2.000,163.696 2.000,225.000 C2.000,348.159 101.841,448.000 225.000,448.000 ZM225.000,2.000 C111.915,2.000 18.502,86.179 3.974,195.291 C17.022,147.301 60.877,112.000 113.000,112.000 C175.408,112.000 226.000,162.592 226.000,225.000 C226.000,286.304 275.696,336.000 337.000,336.000 C398.304,336.000 448.000,286.304 448.000,225.000 C448.000,225.000 448.000,225.000 448.000,225.000 C448.000,101.841 348.159,2.000 225.000,2.000 Z',\n    'goldWheel': 'M449.993,0.008 L225.395,287.495 L355.004,449.995 L94.004,449.995 L224.597,287.502 L-0.008,0.008 L449.993,0.008 Z',\n    'waterWheel': 'M268.000,443.000 C299.658,443.000 328.270,429.976 348.785,409.000 L351.564,409.000 C330.601,431.167 300.917,445.000 268.000,445.000 C204.487,445.000 153.000,393.513 153.000,330.000 C153.000,282.847 181.389,242.341 222.000,224.593 L222.000,224.508 C263.076,207.589 292.000,167.180 292.000,120.000 C292.000,57.592 241.408,7.000 179.000,7.000 C148.889,7.000 121.551,18.800 101.296,38.000 L98.382,38.000 C119.136,17.594 147.595,5.000 179.000,5.000 C242.513,5.000 294.000,56.487 294.000,120.000 C294.000,167.153 265.611,207.659 225.000,225.407 L225.000,225.478 C183.921,242.396 155.000,282.817 155.000,330.000 C155.000,392.408 205.592,443.000 268.000,443.000 Z'\n}\n\nmodule.exports = svg;\n\n\n// WEBPACK FOOTER //\n// ./src/datas/svg.template.js","    var helpers = require('../helpers/helpers.gojs')\r\n\r\n    \r\n    function adustOliveText(d){\r\n            setTimeout(function(){\r\n              try{\r\n                console.log(\"check overflow\")\r\n                if(!d.text) return;\r\n                if(d.text && d.text.trim() == \"\") return;\r\n                if(d.lineCount %2 != 0){\r\n                  if(d.text[d.text.length-1] == \"\\n\"){\r\n                    d.text = d.text.substring(0, d.text.length-1)\r\n                    return;\r\n                  }\r\n                  d.text = d.text+\"\\n\"\r\n                }\r\n                // if(d && d.lineCount!=null && d.lineCount%2 != 0){\r\n                //   if(d.text && d.text[d.text.length-1] != \"\\n\"){\r\n                //     d.text+=\"\\n\"\r\n                //   }\r\n                // }\r\n              }catch(e){\r\n                console.error(e)\r\n              }\r\n            },100)\r\n    }\r\n\r\n\r\n    function adjustTextAngle(obj, shi, xu, group){\r\n        var groupTextAngle = group.data.textAngle|| \"vertical\" // \"vertical\"\r\n        var textAngle;\r\n        if(obj.data.order%2==0){ // 偶数\r\n            // 偶数实线在上\r\n            if(shi){\r\n\r\n                if(!shi.data.nangle){\r\n                    textAngle = groupTextAngle\r\n                }else{\r\n                    textAngle = shi.data.textAngle || groupTextAngle\r\n                }\r\n                // if(!shi.data.nloc){\r\n                //     shi.location = obj.location.copy().offset(obj.naturalBounds.width/2, -obj.naturalBounds.height/2)\r\n                // }\r\n                if(textAngle == \"horizontal\"){\r\n                    // if(!shi.data.nloc){\r\n                        shi.locationSpot = new go.Spot(1, 1, 0, 0)\r\n                    // }\r\n                    shi.angle = 0\r\n                    // \r\n                    // if(shi.data.textAlign == null){\r\n                        // shi.findObject(\"TEXT\").textAlign = \"center\";\r\n                        // }\r\n                    }\r\n                    shi.__location = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                    shi.__location = computeNewRotateLoc(group.location, shi.__location, obj.angle)\r\n                    if(!shi.data.nloc){\r\n                        shi.location = obj.location.copy().offset(obj.naturalBounds.width/2, -obj.naturalBounds.height/2)\r\n                        shi.location = computeNewRotateLoc(group.location, shi.location, obj.angle)\r\n                        // shi.location = shi.__location.copy()\r\n                        // delete shi.__offset\r\n                        delete shi.__switchOrder\r\n                    }else{\r\n                        \r\n                        if(!shi.__offset){\r\n                            shi.__offset = shi.__location.copy().subtract(shi.location)\r\n                        }else{\r\n                            shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                            // if(shi.__switchOrder){\r\n                            //     shi.__offset.x = -shi.__offset.x\r\n                            //     shi.__offset.y = -shi.__offset.y\r\n                            //     shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                            //     delete shi.__switchOrder\r\n                            //     shi.__offset = shi.__location.copy().subtract(shi.location)\r\n                            // }else{\r\n                            //     shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                            // }\r\n                            // xu.location = xu.__location.copy().offset(-Math.abs(xu.__offset.x), -Math.abs(xu.__offset.y))\r\n                            // xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        }\r\n                    }\r\n                if(textAngle == \"vertical\"){\r\n                    // if(!shi.data.nloc){\r\n                        shi.locationSpot = new go.Spot(0.5, 1, 0, 0)\r\n                    // }\r\n                    shi.angle = obj.angle\r\n                    // if(shi.data.textAlign == null){\r\n                        // obj.diagram.model.setDataProperty(shi.data,\"textAlign\", \"left\")\r\n                        // shi.findObject(\"TEXT\").textAlign = \"center\";\r\n                    // }\r\n                        \r\n                }\r\n            }\r\n            if(xu){\r\n                if(!xu.data.nangle){\r\n                    textAngle = groupTextAngle\r\n                }else{\r\n                    textAngle = xu.data.textAngle || groupTextAngle\r\n                }\r\n\r\n                if(textAngle == \"horizontal\"){\r\n                    // if(!xu.data.nloc){\r\n                        xu.locationSpot = new go.Spot(0, 0, 0, 0)\r\n                    // }\r\n                    xu.angle = 0\r\n                    // obj.diagram.model.setDataProperty(xu.data,\"textAlign\", \"left\")\r\n                    // if(xu.data.textAlign == null){\r\n                        // xu.findObject(\"TEXT\").textAlign = \"center\"\r\n                    // }\r\n                }\r\n                console.log(\"xuxuxuxuxxuxu\", xu.data.order)\r\n                xu.__location = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                xu.__location = computeNewRotateLoc(group.location, xu.__location, obj.angle)\r\n                if(!xu.data.nloc){\r\n                    xu.location = obj.location.copy().offset(obj.naturalBounds.width/2, obj.naturalBounds.height/2)\r\n                    xu.location = computeNewRotateLoc(group.location, xu.location, obj.angle)\r\n                    // xu.location = xu.__location.copy()\r\n                    // delete xu.__offset\r\n                    delete xu.__switchOrder\r\n                }else{\r\n                    \r\n                    if(!xu.__offset){\r\n                        xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                    }else{\r\n                        xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        // if(xu.__switchOrder){\r\n                        //     xu.__offset.x = -xu.__offset.x\r\n                        //     xu.__offset.y = -xu.__offset.y\r\n                        //     xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        //     delete xu.__switchOrder\r\n                        //     xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                        // }else{\r\n                        //     xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        // }\r\n                        // xu.location = xu.__location.copy().offset(-Math.abs(xu.__offset.x), -Math.abs(xu.__offset.y))\r\n                        // xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                    }\r\n                }\r\n                // if(xu.data.key == \"9fe41098-8d5a-e18f-b79a-b4693eacd39d\"){\r\n                //     console.log(`location: ${go.Point.stringify(xu.location)}\r\n                //     __location: ${go.Point.stringify(xu.__location)}\r\n                //     __offset: ${go.Point.stringify(xu.__offset)}\r\n                //     `)\r\n                // }\r\n                if(textAngle == \"vertical\"){\r\n                    // if(!xu.data.nloc){\r\n                        xu.locationSpot = new go.Spot(0.5, 0, 0, 0)\r\n                    // }\r\n                    xu.angle = obj.angle\r\n                    // obj.diagram.model.setDataProperty(xu.data,\"textAlign\", \"left\")\r\n                    // if(xu.data.textAlign == null){\r\n                        // xu.findObject(\"TEXT\").textAlign = \"center\"\r\n                    // }\r\n                }\r\n\r\n            }\r\n        }else{ // 奇数\r\n            // 奇数实线在下\r\n            if(shi){\r\n                if(!shi.data.nangle){\r\n                    textAngle = groupTextAngle\r\n                }else{\r\n                    textAngle = shi.data.textAngle || groupTextAngle\r\n                }\r\n                shi.__location = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                shi.__location = computeNewRotateLoc(group.location, shi.__location, obj.angle)\r\n                if(!shi.data.nloc){\r\n                    shi.location = obj.location.copy().offset(obj.naturalBounds.width/2, obj.naturalBounds.height/2)\r\n                    shi.location = computeNewRotateLoc(group.location, shi.location, obj.angle)\r\n                    // shi.location = shi.__location.copy()\r\n                    // delete shi.__offset\r\n                    delete shi.__switchOrder \r\n                }else{\r\n                   \r\n                    if(!shi.__offset){\r\n                        shi.__offset = shi.__location.copy().subtract(shi.location)\r\n                    }\r\n                    else{\r\n                        shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                        // if(shi.__switchOrder){\r\n                        //     shi.__offset.x = -shi.__offset.x\r\n                        //     shi.__offset.y = -shi.__offset.y\r\n                        //     shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                        //     delete shi.__switchOrder\r\n                        //     shi.__offset = shi.__location.copy().subtract(shi.location)\r\n                        // }else{\r\n                        //     shi.location = shi.__location.copy().subtract(shi.__offset)\r\n                        // }\r\n                        // xu.location = xu.__location.copy().offset(-Math.abs(xu.__offset.x), -Math.abs(xu.__offset.y))\r\n                        // xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                    }\r\n                }\r\n                if(textAngle == \"horizontal\"){\r\n                    // if(!shi.data.nloc){\r\n                        shi.locationSpot = new go.Spot(0, 0, 0, 0)\r\n                    // }\r\n                    shi.angle = 0\r\n                    // obj.diagram.model.setDataProperty(shi.data,\"textAlign\", \"left\")\r\n                    // if(shi.data.textAlign == null){\r\n                        // shi.findObject(\"TEXT\").textAlign = \"center\";\r\n                    // }\r\n                }\r\n                if(textAngle == \"vertical\"){\r\n                    // if(!shi.data.nloc){\r\n                    shi.locationSpot = new go.Spot(0.5, 0, 0, 0)\r\n                    // }\r\n                    shi.angle = obj.angle\r\n                    // if(shiTextColl[index].data.textAlign == null){\r\n                        // obj.diagram.model.setDataProperty(shiTextColl[index].data,\"textAlign\", \"left\")\r\n                        // shiTextColl[index].findObject(\"TEXT\").textAlign = \"center\";\r\n                    // }   \r\n                }\r\n            }\r\n            if(xu){\r\n                if(!xu.data.nangle){\r\n                    textAngle = groupTextAngle\r\n                }else{\r\n                    textAngle = xu.data.textAngle || groupTextAngle\r\n                }\r\n                xu.__location = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                xu.__location = computeNewRotateLoc(group.location, xu.__location, obj.angle)\r\n                if(!xu.data.nloc){\r\n                    xu.location = obj.location.copy().offset(obj.naturalBounds.width/2, -obj.naturalBounds.height/2)\r\n                    xu.location = computeNewRotateLoc(group.location, xu.location, obj.angle)\r\n                    // xu.location = xu.__location.copy()\r\n                    // delete xu.__offset\r\n                    delete xu.__switchOrder\r\n                }else{\r\n                    \r\n                    if(!xu.__offset){\r\n                        xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                    }else{\r\n                        xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        // if(xu.__switchOrder){\r\n                        //     xu.__offset.x = -xu.__offset.x\r\n                        //     xu.__offset.y = -xu.__offset.y\r\n                        //     xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        //     delete xu.__switchOrder\r\n                        //     xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                        // }else{\r\n                        //     xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                        // }\r\n                        // xu.location = xu.__location.copy().offset(-Math.abs(xu.__offset.x), -Math.abs(xu.__offset.y))\r\n                        // xu.location = xu.__location.copy().subtract(xu.__offset)\r\n                    }\r\n                }\r\n                // if(xu.data.key == \"9fe41098-8d5a-e18f-b79a-b4693eacd39d\"){\r\n                //     console.log(`location: ${go.Point.stringify(xu.location)}\r\n                //     __location: ${go.Point.stringify(xu.__location)}\r\n                //     __offset: ${go.Point.stringify(xu.__offset)}\r\n                //     `)\r\n                // }\r\n                if(textAngle == \"horizontal\"){\r\n                    // obj.diagram.model.setDataProperty(xu.data,\"textAlign\", \"right\")\r\n                    // if(xu.data.textAlign == null){\r\n                        // xu.findObject(\"TEXT\").textAlign = \"center\";\r\n                    // }\r\n                    // if(!xu.data.nloc){\r\n                        xu.locationSpot = new go.Spot(1, 1, 0, 0)\r\n                    // }\r\n                    xu.angle = 0\r\n                }\r\n\r\n                if(textAngle == \"vertical\"){\r\n                    // if(!xu.data.nloc){\r\n                        xu.locationSpot = new go.Spot(0.5, 1, 0, 0)\r\n                    // }\r\n                    xu.angle = obj.angle\r\n                    // obj.diagram.model.setDataProperty(xuTextColl[index].data,\"textAlign\", \"left\")\r\n                    // if(xuTextColl[index].data.textAlign == null){\r\n                        // xuTextColl[index].findObject(\"TEXT\").textAlign = \"center\"\r\n                    // }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function layoutWaveGroup(it,diagram,group){\r\n\r\n        var collection = []\r\n        // var group = this.group\r\n        var oliveWidth = group.data.oliveWidth\r\n        var oliveHeight = group.data.oliveHeight\r\n        var shiStroke = group.data.shiStroke\r\n        var xuStroke = group.data.xuStroke\r\n        var centerStroke = group.data.centerStroke || \"#3f5369\"\r\n        var oliveType = group.data.oliveType||\"Ellipse\"\r\n        var haveTail = group.data.haveTail||false\r\n        var textAngle = group.data.textAngle|| \"vertical\" // \"vertical\"\r\n        // group.location = new go.Point(0,0)\r\n        var maxWidth = 0;\r\n        var maxHeight = 0;\r\n        var line;\r\n        var waveTotalSize = oliveWidth*2/3\r\n        var shiTextColl = []\r\n        var xuTextColl = []\r\n        var centerTextColl = []\r\n        var shiStrokeWidth, xuStrokeWidth,shiStrokeDashArray,xuStrokeDashArray\r\n        var autogroupConfig; // 自动布局配置\r\n        // 增加波形双螺旋的开放尾部\r\n        // var tailOlive = {\"category\":\"waveTail\", \r\n        //     \"text\":\"       \", \r\n        //     \"level\":0, \"key\": helpers.guid(), \r\n        //     \"group\":node.data.group, \r\n        //     \"loc\":node.data.loc,\r\n        //     \"desiredSize\":node.data.desiredSize, \r\n        //     \"order\": 2000,\r\n        // }\r\n\r\n        // if(oliveType == \"Wave\" && haveTail){\r\n        //     // 查找是否包含尾部\r\n        //     while(it.next()){\r\n        //         var node = it.value;\r\n        //         if(node.data.role == \"waveTail\"){\r\n\r\n        //         }\r\n        //     }\r\n        //     it.reset(); // 重置索引\r\n        // }\r\n\r\n        while (it.next()) {\r\n            var node = it.value;\r\n                // var item = git.value;\r\n            //   console.log(\"item:\",item)\r\n         \r\n            //   console.log(node.data)\r\n              if(node.data.role == \"shiText\"){\r\n                shiTextColl.push(node)\r\n              }\r\n              if(node.data.role == \"xuText\"){\r\n                xuTextColl.push(node)\r\n              }\r\n              if(node.data.role == \"centerText\"){\r\n                centerTextColl.push(node)\r\n              }\r\n            if (node instanceof go.Node) {\r\n            // position the node . . .\r\n                if(node.data.category == \"line\"){\r\n                    line = node;\r\n                    node.location = group.location.copy().offset(0,0)\r\n                    node.angle = group.angle\r\n                }\r\n                if(node.data.category == \"wave\"){\r\n                    // node.width = oliveWidth\r\n                    // node.desiredSize = new go.Size(200,100)\r\n\r\n                    if(oliveType == \"Ellipse\"){\r\n                        node.diagram.model.setDataProperty(node.data, \"oliveType\",\"Ellipse\")\r\n                        node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${oliveWidth} ${oliveHeight}`)\r\n                    }else{\r\n                        // 设置橄榄类型为波形\r\n                        node.diagram.model.setDataProperty(node.data, \"oliveType\",\"Wave\")\r\n                        // 设置波形的尾部开放\r\n                        if(node.data.role == \"waveTail\"){\r\n                            node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${oliveWidth/2} ${oliveHeight}`)\r\n                            node.diagram.model.setDataProperty(node.data, \"selectable\",false)\r\n                        }else{\r\n                            node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${oliveWidth} ${oliveHeight}`)\r\n                        }\r\n                    }\r\n                    \r\n                    // if(node.findObject(\"TEXT\").lineCount %2 != 0){\r\n                    //     if(node.data.text && node.data.text[node.data.text.length-1] != \"\\n\"){\r\n                    //         node.data.text+=\"\\n\"\r\n                    //       }\r\n                    //     node.diagram.model.setDataProperty(node.data, \"text\",node.data.text)\r\n                    // }\r\n                    // if(node.data.role == \"waveTail\"){\r\n                    //     node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${oliveWidth/2} ${oliveHeight}`)\r\n                    //     node.diagram.model.setDataProperty(node.data, \"selectable\",false)\r\n                    // }else{\r\n                    //     node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${oliveWidth} ${oliveHeight}`)\r\n                    // }\r\n\r\n                    // if(node.naturalBounds.width > maxWidth){\r\n                    //     maxWidth = node.naturalBounds.width;\r\n                    //   }\r\n                    // if(node.naturalBounds.height > maxHeight){\r\n                    // maxHeight = node.naturalBounds.height;\r\n                    // }\r\n                    // if(node.measuredBounds.height > maxHeight){\r\n                    // maxHeight = node.measuredBounds.height;\r\n                    // }\r\n                    // if(node.findObject(\"main\").height > maxHeight){\r\n                    // maxHeight = node.findObject(\"main\").height;\r\n                    // }\r\n                    node.angle = group.angle\r\n                    waveTotalSize+=node.naturalBounds.width\r\n                    collection.push(node)\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        waveTotalSize = collection.length*oliveWidth + oliveWidth*2/3\r\n        if(haveTail){\r\n            waveTotalSize = collection.length*oliveWidth \r\n        }\r\n        console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n        line.findObject(\"SHAPE\").width = waveTotalSize\r\n        line.diagram.model.setDataProperty(line.data,\"stroke\", centerStroke)\r\n        // line.centerStroke\r\n        // line.height = 4\r\n        // if(group.resizeObject.width != waveTotalSize){\r\n            group.containingGroup.layout.isOngoing = true;\r\n            group.containingGroup.layout.isValidLayout = false;\r\n        // }\r\n        \r\n        // autogroupConfig = group.group.nonauto||\"\";\r\n        // var autogroupConfigObj = {}\r\n        // autogroupConfig = autogroupConfig.split(\",\")\r\n        // for(var i=0;i<autogroupConfig.length;i++){\r\n        //     autogroupConfigObj[autogroupConfig[i]] = true;\r\n        // }\r\n        group.resizeObject.width = waveTotalSize\r\n        group.resizeObject.height = oliveHeight\r\n        group.waveCount = collection.length;\r\n        xuStrokeWidth = group.data.xuStrokeWidth\r\n        shiStrokeWidth = group.data.shiStrokeWidth\r\n        shiStrokeDashArray = group.data.shiStrokeDashArray\r\n        xuStrokeDashArray = group.data.xuStrokeDashArray\r\n        collection = collection.sort(function(a,b){\r\n            // console.log(`Number(a.data.order)${Number(a.data.order)} > Number(b.data.order) ${Number(b.data.order)}`,Number(a.data.order) > Number(b.data.order))\r\n            return Number(a.data.order) - Number(b.data.order)\r\n        })\r\n        // shiTextColl.sort(function(a,b){\r\n        //     return a.data.order - b.data.order\r\n        // })\r\n        // xuTextColl.sort(function(a,b){\r\n        //     return a.data.order - b.data.order\r\n        // })\r\n        // centerTextColl.sort(function(a,b){\r\n        //     return a.data.order - b.data.order\r\n        // })\r\n        var lastOlive = null;// 记录最后一个橄榄的位置，用于增加开放尾部\r\n        var oldOrder = null;\r\n        collection.forEach(function(obj,index){\r\n            // obj.data.order = index + 1;\r\n            var newOrder = index +1 \r\n            // console.log(\"orderorderorderorderorderorderorderorderorderorder\",newOrder,obj.data.order)\r\n            // var oldOrder = obj.__oldOrder\r\n            if(!obj.__oldOrder){\r\n                oldOrder = obj.data.order\r\n            }else{\r\n                oldOrder = obj.__oldOrder\r\n            }\r\n            delete obj.__oldOrder\r\n            shiTextColl[index] = obj.diagram.findNodeForKey(obj.data.shiText)\r\n            xuTextColl[index] = obj.diagram.findNodeForKey(obj.data.xuText)\r\n            if(!obj.data.isNew && obj.data.role != \"waveTail\"){\r\n                if(oldOrder%2 != newOrder%2){\r\n                    if(shiTextColl[index].data.nloc){\r\n                        obj.diagram.model.setDataProperty(shiTextColl[index].data,\"nloc\", null)\r\n                        shiTextColl[index].__oldLocation = shiTextColl[index].location\r\n                    }\r\n                    else{\r\n                        // 之前是自动布局，如果有记录相对位置，则恢复\r\n                        // if(shiTextColl[index].__offset){\r\n                        //     obj.diagram.model.setDataProperty(shiTextColl[index].data,\"nloc\", true)\r\n                        //     // xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                        //     // shiTextColl[index].location = shiTextColl[index].__location.copy().subtract(shiTextColl[index].__offset)\r\n                        //     // delete shiTextColl[index].__oldLocation\r\n                        // }\r\n                    }\r\n\r\n                    if(xuTextColl[index].data.nloc){\r\n                        obj.diagram.model.setDataProperty(xuTextColl[index].data,\"nloc\", null)\r\n                        xuTextColl[index].__oldLocation = xuTextColl[index].location\r\n                    }else{\r\n                        // if(xuTextColl[index].__offset){\r\n                        //     obj.diagram.model.setDataProperty(xuTextColl[index].data,\"nloc\", true)\r\n                        //     // xu.__offset = xu.__location.copy().subtract(xu.location)\r\n                        //     // xuTextColl[index].location = xuTextColl[index].__location.copy().subtract(xuTextColl[index].__offset)\r\n                        //     // delete shiTextColl[index].__oldLocation\r\n                        // }\r\n                    }\r\n                    // shiTextColl[index].__switchOrder = true;\r\n                    // xuTextColl[index].__switchOrder = true;\r\n                    // obj.diagram.model.setDataProperty(xuTextColl[index].data,\"nloc\", null)\r\n                    // shiTextColl[index].__offset.x = -shiTextColl[index].__offset.x\r\n                    // shiTextColl[index].__offset.y = -shiTextColl[index].__offset.y\r\n                }\r\n            }\r\n\r\n            obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n            if(!obj.data.nalign){\r\n                obj.diagram.model.setDataProperty(obj.data,\"textAlign\", \"center\")\r\n            }\r\n            if(shiStroke){\r\n                obj.diagram.model.setDataProperty(obj.data,\"shiStroke\", shiStroke)\r\n            }\r\n            if(xuStroke){\r\n                obj.diagram.model.setDataProperty(obj.data,\"xuStroke\", xuStroke)\r\n            }\r\n            if(xuStrokeWidth){\r\n                obj.diagram.model.setDataProperty(obj.data,\"xuStrokeWidth\", xuStrokeWidth)\r\n            }\r\n            if(shiStrokeWidth){\r\n                obj.diagram.model.setDataProperty(obj.data,\"shiStrokeWidth\", shiStrokeWidth)\r\n            }\r\n            if(shiStrokeDashArray){\r\n                obj.diagram.model.setDataProperty(obj.data,\"shiStrokeDashArray\", shiStrokeDashArray)\r\n            }\r\n            if(xuStrokeDashArray){\r\n                obj.diagram.model.setDataProperty(obj.data,\"xuStrokeDashArray\", xuStrokeDashArray)\r\n            }\r\n            \r\n            // obj.diagram.model.setDataProperty(obj.data,\"text\", obj.data.text+\" \"+newOrder)\r\n            obj.location = group.location.copy().offset(oliveWidth*(newOrder-1),0)\r\n            // obj.location = new go.Point(300*(obj.data.order-1),0)\r\n            // obj.\r\n            // var group = a.findNodeDataForKey(m.group)\r\n            var initCenterText = false\r\n            if(group.data.centerTextAngle == \"independent\"){\r\n                if(!obj.data.centerText){\r\n                    var loc = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                    loc = computeNewRotateLoc(group.location, loc, obj.angle)\r\n                    var centerText = {\r\n                        \"text\":obj.data.text,\r\n                        \"minSize\":`${oliveWidth-30} 30`,\r\n                        \"deletable\":false,\r\n                        textAlign: obj.data.textAlign,\r\n                        \"font\":obj.data.font || \"18px 'Microsoft YaHei'\", \r\n                        textStroke:obj.data.textStroke,\r\n                        \"category\":\"autoText\", \r\n                        \"key\": helpers.guid(), \"width\": oliveWidth-30, \r\n                        \"role\":\"centerText\", \"level\":0, \"group\": obj.data.group, \r\n                        \"order\": newOrder,\r\n                        \"visible\": false,\r\n                        \"layerName\":\"Foreground\",\r\n                        locationSpot: go.Spot.stringify(new go.Spot(0.5, 0.5, 0, 0)),\r\n                        \"selectable\": false,\r\n                        \"olive\": obj.data.key,\r\n                        \"loc\": go.Point.stringify(loc),\r\n                        angle: 0\r\n                        }\r\n                    obj.diagram.model.addNodeData(centerText)\r\n                    // var objCenterText = obj.diagram.model.findNodeDataForKey(centerText.key)\r\n                    obj.diagram.model.setDataProperty(obj.data,\"centerText\", centerText.key)\r\n                    initCenterText = true;\r\n                }\r\n                var objCenterText = obj.diagram.findNodeForKey(obj.data.centerText)\r\n                if(objCenterText){\r\n                    if(!objCenterText.data.nalign){\r\n                        obj.diagram.model.setDataProperty(objCenterText.data,\"textAlign\", \"center\")\r\n                    }\r\n                    if(!obj.data.nangle){\r\n                        if(textAngle == \"vertical\"){\r\n                            obj.diagram.model.setDataProperty(objCenterText.data,\"visible\", false)\r\n                            obj.diagram.model.setDataProperty(obj.data,\"textVisible\", true)\r\n                        }\r\n                        if(textAngle == \"horizontal\"){\r\n                            obj.diagram.model.setDataProperty(objCenterText.data,\"visible\", true)\r\n                            obj.diagram.model.setDataProperty(obj.data,\"textVisible\", false)\r\n                            obj.diagram.model.setDataProperty(objCenterText.data,\"angle\", 0)\r\n                        }\r\n\r\n                    }\r\n                    if(!initCenterText){\r\n                        var loc = obj.location.copy().offset(obj.naturalBounds.width/2, 0)\r\n                        loc = computeNewRotateLoc(group.location, loc, obj.angle)\r\n                        obj.diagram.model.setDataProperty(objCenterText.data,\"loc\", go.Point.stringify(loc))\r\n                    }\r\n                    obj.diagram.model.setDataProperty(objCenterText.data,\"order\", newOrder)\r\n                    if(!objCenterText.data.nwidth){\r\n                        obj.diagram.model.setDataProperty(objCenterText.data,\"width\", oliveWidth-30)\r\n                    }\r\n                    obj.diagram.model.setDataProperty(objCenterText.data,\"minSize\", `${oliveWidth-30} 30`)\r\n                    // obj.diagram.model.setDataProperty(objCenterText,\"selectable\", true)\r\n                    // if(group.data.centerTextMode == \"followLine\"){\r\n                    //     obj.diagram.model.setDataProperty(objCenterText.data,\"textStroke\", centerStroke)\r\n                    // }else{\r\n                    //     // obj.diagram.model.setDataProperty(objCenterText.data,\"textStroke\", \"black\")\r\n                    // }\r\n                    if(helpers.checkPhone()){\r\n                        objCenterText.layerName = \"Background\"\r\n                    }\r\n                }\r\n            }\r\n            // if(group.data.centerTextMode == \"followLine\"){\r\n            //     obj.diagram.model.setDataProperty(obj.data,\"textStroke\", centerStroke)\r\n            // }else{\r\n            //     obj.diagram.model.setDataProperty(obj.data,\"textStroke\", \"black\")\r\n            // }\r\n            // if(textAngle == \"vertical\"){\r\n                if(obj.text && obj.text.trim() != \"\"){\r\n                    adustOliveText(obj.findObject(\"TEXT\"))\r\n                }\r\n            // }\r\n            if(shiTextColl[index]){\r\n\r\n                if(!shiTextColl[index].desiredSize.width){\r\n                    shiTextColl[index].updateTargetBindings()\r\n                }\r\n\r\n                obj.diagram.model.setDataProperty(shiTextColl[index].data,\"showBorder\", true)\r\n                if(!shiTextColl[index].data.nwidth){\r\n                    obj.diagram.model.setDataProperty(shiTextColl[index].data,\"width\", oliveWidth)\r\n                }\r\n                obj.diagram.model.setDataProperty(shiTextColl[index].data,\"minSize\", `${oliveWidth-30} 30`)\r\n                // obj.diagram.model.setDataProperty(shiTextColl[index].data,\"textAlign\", null)\r\n                // delete shiTextColl[index].data.textAlign\r\n                // 判断是否自动对齐\r\n                // if(!shiTextColl[index].data.nalign){\r\n                //     obj.diagram.model.setDataProperty(shiTextColl[index].data,\"textAlign\", \"center\")\r\n                // }\r\n                // // obj.diagram.model.setDataProperty(shiTextColl[index].data,\"showBorder\", true)\r\n                // if(!shiTextColl[index].__oldOrder){\r\n                //     shiTextColl[index].__oldOrder = shiTextColl[index].data.order\r\n                // }\r\n                // if(shiTextColl[index].__oldOrder ){\r\n                //     // order变化前后奇偶不同\r\n                //     if(oldOrder%2 != newOrder%2){\r\n                //         // shiTextColl[index].__switchOrder = true;\r\n                //         // shiTextColl[index].__offset.x = -shiTextColl[index].__offset.x\r\n                //         // shiTextColl[index].__offset.y = -shiTextColl[index].__offset.y\r\n                //     }\r\n                // }\r\n                // delete shiTextColl[index].__oldOrder\r\n                obj.diagram.model.setDataProperty(shiTextColl[index].data,\"order\", newOrder)\r\n                if(!shiTextColl[index].data.ncolor){\r\n                    obj.diagram.model.setDataProperty(shiTextColl[index].data,\"textStroke\", shiStroke)\r\n                }\r\n                // obj.diagram.model.setDataProperty(shiTextColl[index].data,\"order\", newOrder)\r\n                // if(!shiTextColl[index].data.ncolor){\r\n                //     obj.diagram.model.setDataProperty(shiTextColl[index].data,\"textStroke\", shiStroke)\r\n                // }\r\n            }\r\n            if(xuTextColl[index]) {\r\n                if(!xuTextColl[index].desiredSize.width){\r\n                    xuTextColl[index].updateTargetBindings()\r\n                }\r\n\r\n                obj.diagram.model.setDataProperty(xuTextColl[index].data,\"minSize\", `${oliveWidth-30} 30`)\r\n                obj.diagram.model.setDataProperty(xuTextColl[index].data,\"showBorder\", true)\r\n                if(!xuTextColl[index].data.nwidth){\r\n                    obj.diagram.model.setDataProperty(xuTextColl[index].data,\"width\", oliveWidth)\r\n                }\r\n                // if(!xuTextColl[index].data.nalign){\r\n                //     obj.diagram.model.setDataProperty(xuTextColl[index].data,\"textAlign\", \"center\")\r\n                // }\r\n                // obj.diagram.model.setDataProperty(xuTextColl[index].data,\"textAlign\", null)\r\n                // delete xuTextColl[index].data.textAlign\r\n                // if(!xuTextColl[index].__oldOrder){\r\n                //     xuTextColl[index].__oldOrder = xuTextColl[index].data.order\r\n                // }\r\n                // if(xuTextColl[index].__oldOrder){\r\n                //     // order变化前后奇偶不同\r\n                //     if(xuTextColl[index].__oldOrder%2 != newOrder%2){\r\n                //         // xuTextColl[index].__switchOrder = true;\r\n                //         // xuTextColl[index].__offset.x = -xuTextColl[index].__offset.x\r\n                //         // xuTextColl[index].__offset.y = -xuTextColl[index].__offset.y\r\n                //     }\r\n                // }\r\n                // delete xuTextColl[index].__oldOrder\r\n                obj.diagram.model.setDataProperty(xuTextColl[index].data,\"order\", newOrder)\r\n                if(!xuTextColl[index].data.ncolor){\r\n                    obj.diagram.model.setDataProperty(xuTextColl[index].data,\"textStroke\", xuStroke)\r\n                }\r\n                // obj.diagram.model.setDataProperty(xuTextColl[index].data,\"order\", newOrder)\r\n                // if(!xuTextColl[index].data.ncolor){\r\n                //     obj.diagram.model.setDataProperty(xuTextColl[index].data,\"textStroke\", xuStroke)\r\n                // }\r\n            }\r\n            obj.__location = computeNewRotateLoc(group.location, obj.location.copy(), obj.angle)\r\n            adjustTextAngle(obj, shiTextColl[index],xuTextColl[index],group)\r\n            \r\n            obj.location = obj.__location\r\n            lastOlive = obj;\r\n            obj.diagram.model.setDataProperty(obj.data,\"isNew\", null)\r\n        })\r\n        \r\n    }\r\n\r\n    // define a custom grid layout that makes sure the length of each lane is the same\r\n    // and that each lane is broad enough to hold its subgraph\r\n    function WaveGroupLayout() {\r\n        go.Layout.call(this);\r\n        // go.GridLayout.call(this);\r\n        // this.cellSize = new go.Size(1, 1);\r\n        // this.wrappingColumn = Infinity;\r\n        // this.wrappingWidth = Infinity;\r\n        // this.spacing = new go.Size(0, 0);\r\n        // this.alignment = go.GridLayout.Position;\r\n      }\r\n      go.Diagram.inherit(WaveGroupLayout, go.Layout);\r\n  \r\n      function computeNewRotateLoc(rotateCenter,currentLoc, angle){\r\n          if(rotateCenter.equals(currentLoc)) return currentLoc\r\n        // 计算选择中心点到（0,0）点的偏移\r\n        var offset = new go.Point(0,0).subtract(rotateCenter.copy())\r\n        // 将原来的点偏移到相对0,0点的位置\r\n        var nodeOrigin = currentLoc.copy().offset(offset.x, offset.y)\r\n        var newNodeOrigin = nodeOrigin.rotate(angle)\r\n        var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y)\r\n        return newNodeLoc\r\n        // console.log(\"newNodeLoc\", newNodeLoc)\r\n      }\r\n      \r\n      WaveGroupLayout.prototype.doLayout = function(coll) {\r\n          console.log(\"WaveGroupLayout.doLayout\")\r\n        var diagram = this.diagram;\r\n        diagram.model.startTransaction(\"WaveGroupLayout\")\r\n        \r\n          // COLL might be a Diagram or a Group or some Iterable<Part>\r\n        var it = this.collectParts(coll).iterator;\r\n        var group = this.group\r\n        layoutWaveGroup(it, diagram, group)\r\n\r\n        go.Layout.prototype.doLayout.call(this, coll);\r\n        // diagram.model.addNodeData(tailOlive)\r\n        \r\n        diagram.model.commitTransaction(\"WaveGroupLayout\");\r\n        // setTimeout(()=>{\r\n        //     diagram.updateAllTargetBindings()\r\n        // })\r\n        return;\r\n        // return;\r\n        // var diagram = this.diagram;\r\n        if (diagram === null) return;\r\n        diagram.startTransaction(\"PoolLayout\");\r\n        // make sure all of the Group Shapes are big enough\r\n        // var minsize = computeMinPoolSize();\r\n        // diagram.findTopLevelGroups().each(function(lane) {\r\n        //   if (!(lane instanceof go.Group)) return;\r\n        //   var shape = lane.selectionObject;\r\n        //   if (shape !== null) {  // change the desiredSize to be big enough in both directions\r\n        //     var sz = computeLaneSize(lane);\r\n        //     shape.width = (!isNaN(shape.width)) ? Math.max(shape.width, sz.width) : sz.width;\r\n        //     shape.height = (isNaN(shape.height) ? minsize.height : Math.max(shape.height, minsize.height));\r\n        //     var cell = lane.resizeCellSize;\r\n        //     if (!isNaN(shape.width) && !isNaN(cell.width) && cell.width > 0) shape.width = Math.ceil(shape.width / cell.width) * cell.width;\r\n        //     if (!isNaN(shape.height) && !isNaN(cell.height) && cell.height > 0) shape.height = Math.ceil(shape.height / cell.height) * cell.height;\r\n        //   }\r\n        // });\r\n        // now do all of the usual stuff, according to whatever properties have been set on this GridLayout\r\n        go.GridLayout.prototype.doLayout.call(this, coll);\r\n        diagram.commitTransaction(\"PoolLayout\");\r\n      };\r\n      // end PoolLayout class\r\n\r\n      module.exports = WaveGroupLayout\r\n      module.exports.layoutWaveGroup = layoutWaveGroup\r\n      module.exports.adjustTextAngle = adjustTextAngle\n\n\n// WEBPACK FOOTER //\n// ./src/layout/waveGroupLayout.js","var $ = go.GraphObject.make;\r\nvar helpers = require('../helpers/helpers.gojs')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar nodeTemplateFactory = require('../nodeTemplate/factory')\r\nclass Trtd {\r\n    constructor(div, config){\r\n        console.log('trtd base')\r\n        this.config = config;\r\n        this.textDoubleClick = config.textDoubleClick\r\n\t\tthis.modelChangedListener = config.modelChangedListener;\r\n\t\tthis.showContextMenuListener = config.showContextMenuListener;\r\n\t\tthis.hideContextMenuListener = config.hideContextMenuListener;\r\n\t\tthis.dealFireTextCallback = config.dealFireTextCallback;\r\n\t\tthis.exportAsSubFigureCallback = config.exportAsSubFigureCallback; // 将选中内容创建为子盘\r\n\t\tthis.ViewportBoundsChangedListener = config.ViewportBoundsChangedListener;\r\n\t\tthis.InitialLayoutCompleted = config.InitialLayoutCompleted;\r\n        this.cxElement = config.cxElement; // 外部传入的菜单dom元素\r\n        this.deleteCallback = config.deleteCallback; // 删除回调\r\n        this.canAddAxisGroup = config.canAddAxisGroup == null?true:config.canAddAxisGroup \r\n        this.createFigure = config.createFigure; // 外部创建figure方法，异步调用，返回盘的id，写入节点的figure属性，一般为id\r\n        this.openFigure = config.openFigure; // 外部打开figure方法，根据节点的figure属性打开盘\r\n        \r\n        this.useDefaultContext = config.useDefaultContext == null?true:config.useDefaultContext;\r\n        // if()\r\n        this.defaultCxElement = null; // 默认菜单dom元素\r\n        this.type = config.type;\r\n\r\n        this.div = div;\r\n        this.containerDivId = config.containerDivId||\"mainbox\"; // diagram的div父级div的id，菜单会建在这下面\r\n\t\tthis.diagram = {};\r\n        if(config.model != null && typeof(config.model) == \"object\" ){\r\n            console.log(\"dsfdf\")\r\n            config.model = JSON.stringify(config.model)\r\n        }\r\n        this.model = config.model;\r\n        this.tpid = config.tpid||Date.now();\r\n        this.InitialFontSize = 18\r\n        this.tdCurrentTheme = {\r\n            id: 6,\r\n            borderWidth: 2,\r\n            borderColor: \"black\",\r\n            groupColor: \"rgba(0,0,0,0)\",\r\n            groupStroke: \"rgba(0,0,0,0)\",\r\n            groupStrokeWidth: 0,\r\n            themeName: \"黑白\",\r\n            linkColor: \"black\",\r\n            colorRange: \"white\"\r\n        }\r\n        this.nodeClickListener = config.nodeClickListener;\r\n        this.nodeDoubleClickListener = config.nodeDoubleClickListener;\r\n        this.isModified = false; // 是否保存\r\n        this.lastModified = 0; // 保存的序号，每一次modified事件加1，不再变化时执行真实保存，用于提高性能\r\n        this.modifiedIndex = 0; // 保存的序号，每一次modified事件加1，不再变化时执行真实保存，用于提高性能\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n    initDiagram(){\r\n        console.log(\"基类方法，子类需要实现，用来初始化画布\")\r\n    }\r\n    addNodeTemplate(){\r\n        console.log(\"基类方法，子类需要实现，用来初始化节点模板\")\r\n    }\r\n\r\n\r\n    /**\r\n     *  设置缩放比例\r\n     * @param value\r\n     */\r\n    resetZoom(value) {\r\n        // console.log(value)\r\n        this.diagram.commandHandler.resetZoom(value);\r\n    }\r\n    getDefaultCustomMenuDivStr(){\r\n        console.log(\"基类方法，子类需要实现，设置默认自定义菜单\")\r\n        return `\r\n        <ul>\r\n            <li trtd_action=\"addLevelNodeMenu\"><a class=\"i18n\" data-lang=\"insertsl\">插入同级节点</a></li>\r\n            <li trtd_action=\"addChildNodeMenu\"><a class=\"i18n\" data-lang=\"icn\">插入子节点</a></li>\r\n            <li trtd_action=\"duplicateNode\"><a class=\"i18n\" data-lang=\"duplicateNode\">复制节点</a></li>\r\n            <li trtd_action=\"deleteNodeMenu\"><a class=\"i18n\" data-lang=\"remove\">删除</a></li>\r\n            <li trtd_action=\"orderChildNode\"><a class=\"i18n\" data-lang=\"ordernode\">子节点编号</a></li>\r\n            <li trtd_action=\"clearOrderChildNode\"><a class=\"i18n\" data-lang=\"clearordernode\">取消子节点编号</a></li>\r\n            <li trtd_action=\"clearNodeTextMenu\"><a class=\"i18n\" data-lang=\"emptynodetext\">清空节点文本</a></li>\r\n            <li trtd_action=\"insertTianpanMenu\"><a class=\"i18n\" data-lang=\"insertnodetianpan\">插入天盘节点</a></li>\r\n            <li trtd_action=\"insertTextMenu\"><a class=\"i18n\" data-lang=\"inserttext\">插入文本</a></li>\r\n            <li trtd_action=\"locateRootNodeMenu\"><a class=\"i18n\" data-lang=\"locaterootnode\">定位根节点</a></li>\r\n            <li trtd_action=\"showAllNodesMenu\"><a class=\"i18n\" data-lang=\"displayallnodes\">显示所有节点</a></li>\r\n            <li trtd_action=\"fixPictureMenu\"><a class=\"i18n\" data-lang=\"fixnode\">固定节点</a></li>\r\n            <li trtd_action=\"activePictureMenu\"><a class=\"i18n\" data-lang=\"cancelfix\">取消固定</a></li>\r\n        \r\n            <li trtd_action=\"delYunpanAxis\"><a class=\"i18n\" data-lang=\"cancelfix\">删除 CTRL+DEL</a></li>\r\n            <li trtd_action=\"addYunpanAxis\"><a class=\"i18n\" data-lang=\"cancelfix\">增加 CTRL+X/Y</a></li>\r\n            <li trtd_action=\"addFollowerGround\"><a class=\"i18n\" data-lang=\"insertsl\">增加同级节点</a></li>\r\n            <li trtd_action=\"addNewCircle\"><a class=\"i18n\" data-lang=\"icn\">增加子节点</a></li>\r\n            <li trtd_action=\"apiDeleteSelection\"><a class=\"i18n\" data-lang=\"remove\">删除</a></li>\r\n        </ul>\r\n        `\r\n    }\r\n\r\n    getShowContextMenus(node){\r\n        console.log(\"基类方法，子类需要实现，显示默认自定义带单时控制哪些菜单需要显示\")\r\n\r\n        var showIds = '';\r\n\r\n        if (!node || node.data.isGroup) {\r\n            // myDiagram.clearSelection();\r\n            showIds = \"locateRootNodeMenu,showAllNodesMenu,insertTextMenu,insertTianpanMenu\";\r\n            // if(myDiagram.model.modelData.currentType == \"dipan\"){\r\n            //     cxElement.getElementsByClassName('removeOutCycleMenu')[0].style.display = 'block';\r\n            // }\r\n        } else {\r\n                if (!(node instanceof go.Group) && (!node.data.category || node.data.category == \"\" || node.data.category == \"0\" || node.data.category == \"1\" || node.data.category == \"4\")) { //天盘节点,非group\r\n                    showIds = \"addLevelNodeMenu,addChildNodeMenu,deleteNodeMenu,orderChildNode,clearOrderChildNode,\" + \"clearNodeTextMenu,duplicateNode\";\r\n                    console.log(\"2111\")\r\n                    if(node.selectable){\r\n                        showIds += \"fixPictureMenu\"\r\n                    }else{\r\n                        showIds += \"activePictureMenu\"\r\n                    }\r\n                }\r\n\r\n\r\n                if( node.data.category == \"8\" ||  node.data.category == \"text\"||  node.data.category == \"addtextTemplate\"){\r\n                    showIds = \"deleteNodeMenu,\" + \"duplicateNode\";\r\n                }\r\n\r\n                if( node.data.category === \"yunpanx\"||node.data.category === \"yunpany\"){\r\n                    console.log(\"222222222222\")\r\n                    showIds = \"delYunpanAxis,\" + \"addYunpanAxis\";\r\n                }\r\n\r\n                if( node.data.category === \"dipan\"){\r\n                    showIds = \"addFollowerGround,\" + \"addChildDipanNode,\"+\"deleteDipanNode\";\r\n                }\r\n                \r\n\r\n\r\n                // for (var _i2 = 0; _i2 < showIds.split(',').length; _i2++) {\r\n                //     if (showIds.split(',')[_i2]&&showIds.split(',')[_i2]!==\"fixPictureMenu\"&&showIds.split(',')[_i2]!==\"activePictureMenu\") {\r\n                //         helpers.getElementByAttr(cxElement,\"li\",\"trtd_action\",showIds.split(',')[_i2])[0].style.display = 'block'\r\n                //         // cxElement.getElementsByClassName(showIds.split(',')[_i2])[0].style.display = 'block';\r\n                //     }else if(showIds.split(',')[_i2]!==\"fixPictureMenu\"||showIds.split(',')[_i2]!==\"activePictureMenu\"){\r\n                //         if (node.selectable) {\r\n                //             cxElement.getElementsByClassName('fixPictureMenu')[0].style.display = 'block';\r\n                //             cxElement.getElementsByClassName('activePictureMenu')[0].style.display = 'none';\r\n                //         } else {\r\n                //             cxElement.getElementsByClassName('fixPictureMenu')[0].style.display = 'none';\r\n                //             cxElement.getElementsByClassName('activePictureMenu')[0].style.display = 'block';\r\n                //         }\r\n                //     }\r\n                // }\r\n            }\r\n\r\n        return showIds\r\n    }\r\n    insertPicture(source){\r\n        this.apiInsertPicture(source)\r\n    }\r\n    apiInsertPicture(source){\r\n        console.log(\"基类方法，子类需要实现，对外接口，插入图片\")\r\n        // console.log(source)\r\n        var myDiagram = this.diagram\r\n        var currentType = this.diagram.model.modelData.currentType;\r\n        // var globalProperties = tdGetModelData(null, myDiagram.model);\r\n        //var layerThickness = parseInt(globalProperties['layerThickness']); //默认值100\r\n        // 获取扇形半径\r\n       \r\n        // var layerThickness = myDiagram.model.modelData.layerThickness;\r\n        //获取中心圆半径\r\n        // var rootNodeRadius = parseInt(myDiagram.model.findNodeDataForKey(1).layerThickness);\r\n        // var tdDipanTextAngle = globalProperties['tdDipanTextAngle'];\r\n        var node = myDiagram.selection.first();\r\n        if (node && node.data.category == 'dipan' && !rootKey) return; //地盘节点不允许插入将诶点\r\n        // if(node) return; // 暂时关闭节点插入图片功能\r\n        myDiagram.model.startTransaction('setSourceOfPicture');\r\n        try{\r\n            var documentPoint = JSON.parse(localStorage.getItem(\"TRTD_documentPoint\"))\r\n            if(!documentPoint) documentPoint = myDiagram.lastInput.documentPoint\r\n        }catch(err){\r\n            var documentPoint = myDiagram.lastInput.documentPoint\r\n        }\r\n        if (node) {\r\n            // myDiagram.model.setDataProperty(node.data,'lastCategory', node.data.category);  //保存添加图片前的类别，以便移除图片时恢复\r\n            // if (node.data.category != \"3\" && node.data.category != 'text') {\r\n            //     myDiagram.model.setCategoryForNodeData(node.data, \"4\");\r\n            // }\r\n            if (node.data.category == '3') { //文字节点暂时不能添加图片\r\n                myDiagram.model.setDataProperty(node.data, \"picture\", source);\r\n            }\r\n        } else {\r\n            // var e = myDiagram.lastInput;\r\n            var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n            var follower = { key: nextkey, text: \"\", category: \"3\" };\r\n            myDiagram.model.makeNodeDataKeyUnique(follower);\r\n            follower.loc = go.Point.stringify(documentPoint);\r\n\r\n            //follower.picture = obj.children[0].src;\r\n            follower.picture = source;\r\n            myDiagram.model.addNodeData(follower);\r\n        }\r\n\r\n        myDiagram.model.commitTransaction('setSourceOfPicture');\r\n    }\r\n    apiGetTheme(){\r\n        var model = this.diagram.model;\r\n        var themeText = \"\"\r\n        for(var i=0;i<model.nodeDataArray.length;i++){\r\n            if(model.nodeDataArray[i].role == \"theme\" || model.nodeDataArray[i].role == \"themeText\"|| model.nodeDataArray[i].subRole == \"themeText\" ){\r\n                if(model.nodeDataArray[i].text){\r\n                    themeText = model.nodeDataArray[i].text\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if(!themeText){\r\n            var root = model.findNodeDataForKey(1)\r\n            if(root){\r\n                themeText = root.text\r\n            }\r\n        }\r\n        return themeText\r\n    }\r\n    apiGetThemeNode(){\r\n        var model = this.diagram.model;\r\n        var themeText = null\r\n        var it = this.diagram.nodes;\r\n        var tmp;\r\n        while(it.next()){\r\n            tmp = it.value;\r\n            if(tmp.data.role == \"theme\" || tmp.data.role == \"themeText\"|| tmp.data.subRole == \"themeText\"){\r\n                themeText = tmp\r\n                break;\r\n            }     \r\n        }\r\n        // for(var i=0;i<model.nodeDataArray.length;i++){\r\n        //     if(model.nodeDataArray[i].role == \"theme\" || model.nodeDataArray[i].role == \"themeText\"|| model.nodeDataArray[i].subRole == \"themeText\"){\r\n        //         themeText = model.nodeDataArray[i]\r\n        //         break;\r\n        //     }\r\n        // }\r\n        if(!themeText){\r\n            var root = this.diagram.findNodeForKey(1)\r\n            if(root){\r\n                themeText = root\r\n            }\r\n        }\r\n        return themeText\r\n    }\r\n\r\n    insertFigure(source, figureId) { //rootKey表示属于某个地盘节点的背景\r\n        // console.log(source)\r\n        var myDiagram = this.diagram\r\n        var currentType = this.diagram.model.modelData.currentType;\r\n        // var globalProperties = tdGetModelData(null, myDiagram.model);\r\n        //var layerThickness = parseInt(globalProperties['layerThickness']); //默认值100\r\n        // 获取扇形半径\r\n       \r\n        // var layerThickness = myDiagram.model.modelData.layerThickness;\r\n        //获取中心圆半径\r\n        // var rootNodeRadius = parseInt(myDiagram.model.findNodeDataForKey(1).layerThickness);\r\n        // var tdDipanTextAngle = globalProperties['tdDipanTextAngle'];\r\n        var node = myDiagram.selection.first();\r\n        // if (node && node.data.category == 'dipan' && !rootKey) return; //地盘节点不允许插入将诶点\r\n        if(node) return; // 暂时关闭节点插入图片功能\r\n        myDiagram.model.startTransaction('setSourceOfPicture');\r\n        try{\r\n            var documentPoint = JSON.parse(localStorage.getItem(\"TRTD_documentPoint\"))\r\n        }catch(err){\r\n            var documentPoint = myDiagram.lastInput.documentPoint\r\n        }\r\n        if (node) {\r\n            // myDiagram.model.setDataProperty(node.data,'lastCategory', node.data.category);  //保存添加图片前的类别，以便移除图片时恢复\r\n            if (node.data.category != \"3\" && node.data.category != 'text') {\r\n                myDiagram.model.setCategoryForNodeData(node.data, \"4\");\r\n            }\r\n            if (node.data.category != 'text') { //文字节点暂时不能添加图片\r\n                myDiagram.model.setDataProperty(node.data, \"picture\", source);\r\n            }\r\n        } else {\r\n            // var e = myDiagram.lastInput;\r\n            var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n            var follower = { key: nextkey, text: \"\", category: \"3\" };\r\n            myDiagram.model.makeNodeDataKeyUnique(follower);\r\n            follower.loc = go.Point.stringify(documentPoint);\r\n            follower.figureId = figureId;\r\n\r\n            //follower.picture = obj.children[0].src;\r\n            follower.picture = source;\r\n            myDiagram.model.addNodeData(follower);\r\n        }\r\n\r\n        myDiagram.model.commitTransaction('setSourceOfPicture');\r\n\r\n    }\r\n\r\n\r\n\r\n// 复制单个节点\r\napiDuplicateNode() {\r\n    var myDiagram = this.diagram;\r\n    var node = myDiagram.selection.first();\r\n    if (!node) return;\r\n    myDiagram.startTransaction();\r\n    var newData = myDiagram.model.copyNodeData(node.data);\r\n    var location = node.location.copy();\r\n    location.offset(50, -50);\r\n    newData.loc = go.Point.stringify(location);\r\n    newData.level = 0;\r\n    newData = clearRelProperty(newData);\r\n    myDiagram.model.addNodeData(newData);\r\n    myDiagram.commitTransaction();\r\n    // 清除节点的关系属性，比如父节点索引，子节点索引等\r\n    function clearRelProperty(data) {\r\n        data.level = 0;\r\n        delete data.prev;\r\n        delete data.isparent;\r\n        delete data.next;\r\n        delete data.group;\r\n        delete data.parent;\r\n        delete data.role\r\n        delete data.group\r\n        delete data.dimKey\r\n        delete data.subRole\r\n        delete data.order\r\n        delete data.figure\r\n        delete data.iconVisible\r\n        delete data.deletable\r\n        delete data.theta\r\n        delete data.orderX\r\n        delete data.orderY\r\n        delete data.dimX\r\n        delete data.dimY\r\n        return data;\r\n    }\r\n}\r\n\r\n    apiPreviewImage(background=\"white\", scale=1){\r\n        console.log(\"基类方法，子类需要实现，对外接口，预览图片，生成base64\")\r\n        var myDiagram = this.diagram;\r\n        var imageParas = {\r\n            scale: scale,\r\n            // background: \"rgba(0,0,0,0)\",\r\n            background: background,\r\n            type: \"image/png\",\r\n            maxSize: new go.Size(9000, 9000)\r\n        }\r\n        var list = new go.List(go.GraphObject);\r\n\r\n        var node = myDiagram.selection.first()\r\n        var isSelected = false\r\n        if(node ){\r\n            while(node.containingGroup){\r\n                node = node.containingGroup\r\n            }\r\n            if(node.data.isGroup){\r\n                isSelected = true\r\n            }\r\n            \r\n        }\r\n\r\n        if(isSelected){\r\n            var it = node.findSubGraphParts().iterator;\r\n            while(it.next()){\r\n                var p = it.value;\r\n                var temp = p.findObject(\"figure\")\r\n                if(temp){\r\n                    temp.visible = false;\r\n                }\r\n                if (!(p instanceof go.Group)) {\r\n                    list.add(p);\r\n                    if( p instanceof go.Node){\r\n                        if(p.data.role == \"centerText\"){\r\n                            p.layerName = \"Foreground\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }else{\r\n            myDiagram.nodes.each(function(p) {\r\n                var temp = p.findObject(\"figure\")\r\n                if(temp){\r\n                    temp.visible = false;\r\n                }\r\n                if (!(p instanceof go.Group)) {\r\n                    list.add(p);\r\n                    if( p instanceof go.Node){\r\n                        if(p.data.role == \"centerText\"){\r\n                            p.layerName = \"Foreground\"\r\n                        }\r\n                    }\r\n                }\r\n            })\r\n        }\r\n        \r\n        myDiagram.links.each(function(p) {\r\n            list.add(p);\r\n        })\r\n        imageParas.parts = list.iterator;\r\n\r\n        var imgdata = myDiagram.makeImageData(imageParas);\r\n        myDiagram.nodes.each(function(p) {\r\n            var temp = p.findObject(\"figure\")\r\n            if(p.data.figure && temp){\r\n                temp.visible = true;\r\n            }\r\n            // if (!(p instanceof go.Group)) {\r\n            //     list.add(p);\r\n            //     if( p instanceof go.Node){\r\n            //         if(p.data.role == \"centerText\"){\r\n            //             p.layerName = \"Foreground\"\r\n            //         }\r\n            //     }\r\n            // }\r\n        })\r\n        return imgdata;\r\n    }\r\n    apiDeleteSelection(){\r\n        console.log(\"基类方法，子类需要实现，对外接口，删除选中的节点\")\r\n        this.diagram.toolManager.textEditingTool.doCancel();\r\n        this.diagram.commandHandler.deleteSelection();\r\n    }\r\n    apiUndo () {\r\n        this.diagram.commandHandler.undo();\r\n    }\r\n    apiRedo () {\r\n        this.diagram.commandHandler.redo();\r\n    }\r\n    saveModel(e){\r\n        // if (e.isTransactionFinished) {\r\n            // console.log('model changed and has been saved to localstorage');\r\n             helpers.saveModelToLocalStorage(this.tpid, this.diagram.model)\r\n            // helpers.checkModel(e.model)\r\n        // }\r\n    }\r\n\r\n    addNodeTemplateBase(){\r\n        var myDiagram = this.diagram\r\n        this.diagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        this.diagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n\r\n        // myDiagram.nodeTemplateMap.add(\"cbian\",  nodeTemplateFactory(\"cbian\",{diagram:this.diagram}).getNodeTemplate())\r\n        myDiagram.nodeTemplateMap.add(\"pic\",  nodeTemplateFactory(\"pic\",{diagram:this.diagram}).getNodeTemplate())\r\n        myDiagram.nodeTemplateMap.add(\"autoText\", nodeTemplateFactory(\"autoText\",{diagram:myDiagram}).getNodeTemplate());\r\n        myDiagram.groupTemplateMap.add(\"picGroup\", nodeTemplateFactory(\"picGroup\",{diagram:myDiagram}).getNodeTemplate());\r\n    }\r\n    // 添加水罗盘，三门系统\r\n    addWater(){\r\n        console.log(\"addWater\")\r\n        var diagram = this.diagram\r\n        var node = diagram.selection.first();\r\n        var group = null\r\n        if(node && node.data.category == \"axisGroup\"){\r\n            group=node.data.key;\r\n        }\r\n        var e = diagram.lastInput\r\n        diagram.startTransaction(\"addCbian\")\r\n        var groupKey = helpers.guid()\r\n        \r\n        var basePoint = e.documentPoint\r\n        var groupData = {\"category\":\"picGroup\", \r\n         \"role\":\"cbian\", \"isGroup\":true, \"level\":0, \r\n        \"key\":groupKey, \"loc\":go.Point.stringify(basePoint), \"deletable\":true}\r\n        if(group){\r\n            groupData.group = group\r\n        }\r\n        \r\n        var picData = { \"group\":groupKey, \"text\":\"\", \r\n        \"resizable\":false, \"category\":\"pic\", \r\n        \"loc\":go.Point.stringify(basePoint),\r\n        \"picture\":\"https://static.365trtd.com/system/water/water.png\", \"width\":150, \"height\":150}\r\n        // \"picture\":\"https://static.365trtd.com/system/cbian/cbian.png\", \"width\":150, \"height\":150}\r\n        \r\n        var themeData = {\"text\":\"总结\", \"deletable\":true,  \"fill\":\"black\", \"iconVisible\":false, \r\n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(3,-3)), \r\n        \"movable\":true, \"group\":groupKey}\r\n        var timeData = {\"text\":\"时间\", \"deletable\":true,  \"fill\":\"black\", \"iconVisible\":false, \r\n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(150, 0)), \r\n        \"movable\":true, \"group\":groupKey}\r\n        var energeData = {\"text\":\"能量\", \"deletable\":true, \"fill\":\"black\", \"iconVisible\":false, \r\n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(0, -150)), \r\n        \"movable\":true, \"group\":groupKey}\r\n        var text1Data = {\"text\":\"总结1\", \"deletable\":true,  \"textStroke\":\"#0e399d\", \"iconVisible\":false, \r\n        \"locationSpot\":\"0 0 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(155*Math.cos(30*Math.PI/180), -150*Math.sin(30*Math.PI/180))), \r\n        \"movable\":true, \"group\":groupKey}\r\n        var text2Data = {\"text\":\"总结2\", \"deletable\":true, \"textStroke\":\"#FFC000\", \"iconVisible\":false, \r\n        \"locationSpot\":\"0 0.5 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(145*Math.cos(45*Math.PI/180), -150*Math.sin(45*Math.PI/180))), \r\n        \"movable\":true, \"group\":groupKey}\r\n        var text3Data = {\"text\":\"总结3\", \"deletable\":true, \"textStroke\":\"#cb1c27\", \"iconVisible\":false, \r\n        \"locationSpot\":\"0 1 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \r\n        \"loc\":go.Point.stringify(basePoint.copy().offset(145*Math.cos(70*Math.PI/180), -140*Math.sin(70*Math.PI/180))), \r\n        \"movable\":true, \"group\":groupKey}\r\n\r\n        diagram.model.addNodeData(text1Data)\r\n        diagram.model.addNodeData(text2Data)\r\n        diagram.model.addNodeData(text3Data)\r\n        diagram.model.addNodeData(themeData)\r\n        diagram.model.addNodeData(timeData)\r\n        diagram.model.addNodeData(energeData)\r\n        diagram.model.addNodeData(picData)\r\n        diagram.model.addNodeData(groupData)\r\n        \r\n    //     {\"text\":\"自由文本\",\r\n    //     \"deletable\":true, \r\n    //     \"role\":\"freeText\",\r\n    //     \"fill\":\"black\", \r\n    //     \"iconVisible\":false, \r\n    //     \"locationSpot\":\"0.5 0.5 0 0\", \r\n    //     \"textAlign\":\"center\", \r\n    //     \"category\":\"autoText\", \r\n    //     \"loc\": go.Point.stringify(e.documentPoint), \r\n    //     \"movable\":true, \"group\":node.data.key\r\n    //    }\r\n\r\n        diagram.commitTransaction(\"addWater\")\r\n    \r\n    }\r\n\r\n    initDiagramBase(div, config){\r\n        console.log(\"基类初始化画布，子类修改diagram\")\r\n        var myDiagram = this.diagram;\r\n        var that = this;\r\n        \r\n    // function onTextChanged(){}\r\n        // function saveModel() {}\r\n        var myDiagram = this.diagram;\r\n\r\n        function onTextChanged(e) {\r\n            e.diagram.isModified = true;\r\n            console.log(\"onTextChanged\")\r\n        }\r\n        \r\n        // //var $ = go.GraphObject.make; \r\n        // function saveModel(e) {\r\n        //     // console.log(e)\r\n        //     if (e.isTransactionFinished) {\r\n        //         console.log('model changed and has been saved to localstorage');\r\n        //         helpers.saveModelToLocalStorage(that.tpid, that.diagram.model)\r\n        //         helpers.checkModel(e.model)\r\n        //     }\r\n        // }\r\n        var defaultConfig = {\r\n            initialContentAlignment: go.Spot.Center,\r\n            initialAutoScale: go.Diagram.Uniform,\r\n            initialDocumentSpot: go.Spot.Center,\r\n            initialViewportSpot: go.Spot.Center,\r\n            \"toolManager.hoverDelay\": 100,\r\n            padding: -20,\r\n            click: function(e) {\r\n                // closeToolbarWindow();\r\n                // removeNodeToolBar();\r\n                console.log(\"eeee:\",e)\r\n                localStorage.setItem(\"TRTD_documentPoint\",go.Point.stringify(e.documentPoint))\r\n            },\r\n            \"dragSelectingTool.isEnabled\": false,\r\n            \"draggingTool.isCopyEnabled\": false,\r\n            // \"rotatingTool.snapAngleEpsilon\": 10,\r\n            \"commandHandler.archetypeGroupData\": { text: \"Group\", isGroup: true, color: \"blue\" },\r\n        \r\n            // enable undo & redo\r\n            allowDrop: true,\r\n            \"undoManager.isEnabled\": true,\r\n            \"undoManager.maxHistoryLength\": 20,\r\n            \"toolManager.mouseWheelBehavior\": go.ToolManager.WheelZoom,\r\n            maxScale: 5.0,\r\n            minScale: 0.2,\r\n            hasVerticalScrollbar: false,\r\n            hasHorizontalScrollbar: false,\r\n            scrollMode: go.Diagram.InfiniteScroll,\r\n            scrollMargin: 50,\r\n            \"animationManager.isEnabled\": false,\r\n        \r\n            //rotatingTool: go.GraphObject.make(TopRotatingTool),  // defined below\r\n            \r\n            maxSelectionCount: 1,\r\n            InitialLayoutCompleted:(e)=>{\r\n                console.info(\"hhhhhhhhhhhhhhhhhhhh InitialLayoutCompleted\")\r\n                e.diagram.animationManager.isEnabled = true\r\n                if(that.InitialLayoutCompleted){\r\n                    that.InitialLayoutCompleted(e)\r\n                }\r\n            },\r\n            // make sure users can only create trees\r\n\r\n            validCycle: go.Diagram.CycleDestinationTree,\r\n        \r\n            \"ModelChanged\": function(e){\r\n                if (!e.isTransactionFinished) {\r\n                    return;\r\n                }\r\n                // return;\r\n                that.isModified = true;\r\n                that.lastModified = Date.now();\r\n                that.modifiedIndex += 1;\r\n                setTimeout(()=>{\r\n                    // 如果已经保存则不处理\r\n                    if(!that.isModified) {\r\n                        console.log(\"已经保存，跳过\",diff,\",\",that.modifiedIndex)\r\n                        return;\r\n                    };\r\n                    // var now = Date.now()\r\n                    var diff = Date.now() - that.lastModified\r\n                    if(diff >=1000){\r\n                        console.log(\"大于1000毫秒需要保存\",diff,\",\",that.modifiedIndex)\r\n                        that.modifiedIndex = 0\r\n                        that.isModified = false\r\n                        that.saveModel(e)\r\n                        if(that.modelChangedListener){\r\n                            that.modelChangedListener(e.model)\r\n                        }\r\n                    }\r\n                },1100)\r\n\r\n            },\r\n        \r\n            \"TextEdited\": onTextChanged, //在下面定义\r\n            contextMenu: $(go.Adornment),\r\n            ViewportBoundsChanged:(e)=>{\r\n                // console.log(\"ViewportBoundsChangedListener\", e)\r\n                if(that.ViewportBoundsChangedListener){\r\n                    that.ViewportBoundsChangedListener(e)\r\n                }\r\n            }\r\n        }\r\n        \r\n        var diagramConfig = Object.assign(defaultConfig, config.diagramConfig);\r\n        delete diagramConfig.type;\r\n        delete diagramConfig.tpid;\r\n        delete diagramConfig.model;\r\n        delete diagramConfig.modelChangedListener; // 这里需要优化，传入的参数不一定能够在diagram里配置\r\n        delete diagramConfig.mouseOverListener;\r\n\t\tdelete diagramConfig.clickListener;\r\n        this.diagram = $(go.Diagram, div, diagramConfig);\r\n        this.diagram.__trtd = this;\r\n        var myDiagram = this.diagram;\r\n\r\n        var forelayer = myDiagram.findLayer(\"Foreground\");\r\n        myDiagram.addLayerBefore(go.GraphObject.make(go.Layer, { name: \"default\" }), forelayer);\r\n        myDiagram.addLayerBefore(go.GraphObject.make(go.Layer, { name: \"overflow\" }), forelayer);\r\n        for (var i = 10; i >= 0; i--) {\r\n            myDiagram.addLayerBefore(go.GraphObject.make(go.Layer, { name: i.toString() }), forelayer);\r\n        }\r\n        //myDiagram.toolManager.draggingTool.computeEffectiveCollection = computeEffectiveCollection;\r\n        myDiagram.toolManager.draggingTool.computeEffectiveCollection = computeEffectiveCollection;\r\n        // myDiagram.toolManager.dragSelectingTool.isPartialInclusion = true;\r\n        \r\n        myDiagram.toolManager.rotatingTool.handleArchetype =\r\n                $(go.Panel, \"Auto\",\r\n                    $(go.Shape, \"BpmnActivityLoop\", { width: 30, height: 30, stroke: \"green\", fill: \"transparent\" }),\r\n                    $(go.Shape, \"Rectangle\", {\r\n                        width: 30,\r\n                        height: 30,\r\n                        stroke: \"green\",\r\n                        fill: \"transparent\",\r\n                        strokeWidth: 0\r\n                    })\r\n                );\r\n\r\n        myDiagram.toolManager.linkReshapingTool.handleArchetype =\r\n            $(go.Shape, \"Circle\", {\r\n                width: 30,\r\n                height: 30,\r\n                fill: \"lightblue\",\r\n                stroke: \"dodgerblue\"\r\n            });        \r\n\r\n        // only allow new links between ports of the same group\r\n        myDiagram.toolManager.linkingTool.linkValidation = sameGroup;\r\n        // only allow reconnecting an existing link to a port of the same color\r\n        myDiagram.toolManager.relinkingTool.linkValidation = sameGroup;\r\n        myDiagram.commandHandler.doKeyDown = (e)=>{\r\n            this.dokeyDownFn(e)\r\n        }\r\n        myDiagram.commandHandler.deleteSelection = function(){\r\n            console.log(\"deleteSelectiondeleteSelection\")\r\n            var node = that.diagram.selection.first();\r\n            if (!node) {\r\n                return;\r\n            }\r\n            // 不允许删除主题\r\n            if(node.data.role == \"theme\" || node.data.role == \"themeText\"|| node.data.subRole == \"themeText\"){\r\n                return;\r\n            }\r\n            var nodeCopy = JSON.parse(JSON.stringify(node.data))\r\n            that.deleteSelection();\r\n            if(that.deleteCallback){\r\n                that.deleteCallback(nodeCopy)\r\n            }\r\n        }\r\n        myDiagram.commandHandler.redo = function() {\r\n            var cmd = myDiagram.commandHandler;\r\n            //myDiagram.currentTool.doCancel();\r\n            //go.CommandHandler.prototype.redo.call(cmd);\r\n            myDiagram.clearSelection();\r\n            go.CommandHandler.prototype.redo.call(cmd);\r\n        };\r\n        myDiagram.commandHandler.undo = function() {\r\n            var cmd = myDiagram.commandHandler;\r\n\r\n            myDiagram.clearSelection();\r\n            if (myDiagram.toolManager) {\r\n                myDiagram.toolManager.textEditingTool.doCancel();\r\n            }\r\n            go.CommandHandler.prototype.undo.call(cmd);\r\n        };\r\n\r\n        myDiagram.toolManager.clickCreatingTool.archetypeNodeData = {\r\n            category: \"autoText\",\r\n            text: \"双击编辑文本\",\r\n            level: 0,\r\n            radius: 120,\r\n        };\r\n\r\n        this.addNodeTemplateBase()\r\n        this.addDiagramContextMenu();\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n    removeNodeRemarkTips() {\r\n        var doms = document.getElementById('tooltip');\r\n        if (doms) {\r\n            doms.parentNode.removeChild(doms);\r\n        }\r\n    }\r\n\r\n    showNodeRemarkTips(e, node) {\r\n        var info = document.getElementById('tooltip');\r\n        if (!info || info.length == 0) {\r\n            let str = document.createElement('div');\r\n            str.setAttribute('id', 'tooltip');\r\n            str.setAttribute('style', 'word-wrap: break-word;word-break: break-all');\r\n            document.body.appendChild(str);\r\n            info = document.getElementById('tooltip');\r\n        }\r\n        var box = document.getElementById(\"tooltip\");\r\n    \r\n        if (!node.data.istemp && (node.data.text && node.data.text.trim() == \"\") && (node.data.remark && node.data.remark.trim() == \"\" || typeof(node.data.remark) == 'undefined')) return;\r\n    \r\n        if (node.data.istemp) {\r\n            var toolTipText = lang.trans('tempnodetips');\r\n        } else if(node.category === \"y\"||(node.category === \"LogicXor\"&&node.data.loc.split(' ')[1] === \"5\")){\r\n            var toolTipText =\"最右新增\";\r\n        }else if(node.category === \"x\"||(node.category === \"LogicXor\"&&node.data.loc.split(' ')[0] === \"-20\")){\r\n            var toolTipText =\"最上新增\";\r\n        }else {\r\n            var toolTipText = node.data.text + \"<br><hr>\";\r\n            toolTipText += node.data.remark ? node.data.remark : \"\";\r\n        }\r\n    \r\n        box.innerHTML = toolTipText;\r\n        // box.style.left = e.viewPoint.x + \"px\";\r\n        // box.style.top = e.viewPoint.y + \"px\";\r\n        if(node.category === \"y\"||node.category === \"x\"||node.category === \"LogicXor\"){\r\n            box.style.left = (e.event.clientX + 10) + \"px\";\r\n            box.style.top = (e.event.clientY - 10) + \"px\";\r\n        }else{\r\n            box.style.left = (e.event.clientX + 50) + \"px\";\r\n            box.style.top = (e.event.clientY - 50) + \"px\";\r\n        }\r\n        box.style.position = \"fixed\";\r\n        box.style.zIndex = 5555;\r\n        box.style.backgroundColor = \"#FFFFE1\";\r\n        // $(\"#tooltip\")[0].innerHtml = \"<p>aaaaaaaaa<br>bbbbbbbbbbbbb</p>\";\r\n    }\r\n\r\n    nodeResizeAdornmentTemplate () {\r\n        return $(go.Adornment, \"Spot\",\r\n            $(go.Placeholder), // takes size and position of adorned object\r\n            $(go.Shape, \"Circle\", // left resize handle\r\n                {\r\n                    alignment: go.Spot.TopLeft,\r\n                    alignmentFocus: go.Spot.BottomRight,\r\n                    cursor: \"col-resize\",\r\n                    desiredSize: new go.Size(30, 30),\r\n                    fill: \"lightblue\",\r\n                    stroke: \"dodgerblue\"\r\n                }),\r\n            $(go.Shape, \"Circle\", // right resize handle\r\n                {\r\n                    alignment: go.Spot.BottomRight,\r\n                    alignmentFocus: go.Spot.TopLeft,\r\n                    cursor: \"col-resize\",\r\n                    desiredSize: new go.Size(30, 30),\r\n                    fill: \"lightblue\",\r\n                    stroke: \"dodgerblue\"\r\n                })\r\n        )\r\n    }\r\n    // 创建默认菜单 this.defaultCxElement\r\n    customMenu () {\r\n        console.log(\"第一步创建默认的自定义菜单\")\r\n        if(this.defaultCxElement){\r\n            console.log(\"使用默认菜单，已经存在\")\r\n            return this.defaultCxElement;\r\n        }\r\n        console.log(this.useDefaultContext)\r\n        // 不使用默认菜单\r\n        if(!this.useDefaultContext){\r\n            \r\n            return null;\r\n        }\r\n        // 添加菜单选项\r\n        var str = this.getDefaultCustomMenuDivStr()\r\n        \r\n        let div = document.createElement('div');\r\n        // div.setAttribute('id', 'contextMenu');\r\n        div.setAttribute('class', 'context-menu');\r\n        div.innerHTML = str;\r\n        // document.getElementsByClassName('mainbox')[0].appendChild(div);\r\n        var mainbox = document.getElementById(this.containerDivId)\r\n        mainbox.appendChild(div);\r\n        let contextMeluDom = mainbox.getElementsByClassName('context-menu')[0]\r\n        this.defaultCxElement = contextMeluDom\r\n        this.bindMenuEventListener(contextMeluDom)\r\n        return contextMeluDom\r\n    }\r\n\r\n    bindMenuEventListener(cxElement){\r\n        let menuList = cxElement.getElementsByTagName('li');\r\n        console.log(\"创建的自定义菜单需要绑定一些事件\")\r\n        for(let i = 0; i < menuList.length; i++){\r\n            menuList[i].addEventListener('click', () => {\r\n                let val = menuList[i].getAttribute('trtd_action');\r\n                // cxcommand(this, val);\r\n                console.log(\"menuList[i].addEventListener('click'\")\r\n                this.diagram.__trtd[val]();\r\n                this.diagram.currentTool.stopTool();\r\n                return false\r\n                // setTimeout(()=>{\r\n                //     this.diagram.toolManager.contextMenuTool.hideContextMenu()\r\n                // },100)\r\n            })\r\n        }\r\n    }\r\n\r\n    addDiagramContextMenu(){\r\n      \r\n        // console.log(\"基类 addDiagramContextMenu\")\r\n        console.log(\"第二步 将自定义菜单与diagram绑定\")\r\n        // console.log(objNode)\r\n       \r\n\r\n        var that = this;\r\n        var myDiagram = this.diagram;\r\n        var cxTool = myDiagram.toolManager.contextMenuTool;\r\n        // This is the actual HTML context menu:\r\n\r\n        // var mainbox = document.getElementById('mainbox')\r\n        // mainbox.appendChild(div);\r\n        \r\n        // let menuList = mainbox.getElementsByClassName('context-menu')[0].getElementsByTagName('li');\r\n        // var cxElement = mainbox.getElementsByClassName('context-menu')[0]\r\n        console.log(this.cxElement)\r\n        \r\n        if(!this.cxElement){ // 外部没有传入菜单元素，则使用默认的菜单\r\n            if(!this.defaultCxElement){\r\n                this.defaultCxElement = this.customMenu()\r\n            }\r\n            var cxElement = this.defaultCxElement\r\n        }else{\r\n            var cxElement = this.cxElement\r\n        }\r\n        if(!cxElement){\r\n            return;\r\n        }\r\n        // We don't want the div acting as a context menu to have a (browser) context menu!\r\n        cxElement.addEventListener(\"contextmenu\", function(e) {\r\n            // this.onfocus();\r\n            e.preventDefault();\r\n            return false;\r\n        }, false);\r\n        // cxElement.addEventListener(\"blur\", function(e) {\r\n        //     cxTool.stopTool();\r\n        //     // maybe start another context menu\r\n        //     if (cxTool.canStart()) {\r\n        //         myDiagram.currentTool = cxTool;\r\n        //         cxTool.doMouseUp();\r\n        //     }\r\n        // }, false);\r\n        cxElement.tabIndex = \"1\";\r\n        // This is the override of ContextMenuTool.showContextMenu:\r\n        // This does not not need to call the base method.\r\n        cxTool.showContextMenu = function(contextmenu, obj) {\r\n            console.log('thisthisthis:', this.diagram);\r\n            console.log('thisthisthis:', this.diagram.model);\r\n    \r\n            console.log('this:', this.diagram.selection);\r\n            var diagram = this.diagram;\r\n            // console.log('diagram:', diagram);\r\n            if (diagram === null) return;\r\n            // Hide any other existing context menu\r\n            if (contextmenu !== this.currentContextMenu) {\r\n                this.hideContextMenu();\r\n            }\r\n\r\n            var node = myDiagram.findPartAt(myDiagram.lastInput.documentPoint, false);\r\n            this.currentContextMenu = contextmenu;\r\n            var mousePt = diagram.lastInput.viewPoint;\r\n            console.log(diagram.lastInput)\r\n            cxElement.style.left = mousePt.x + \"px\";\r\n            cxElement.style.top = mousePt.y + \"px\";\r\n            // console.log(diagram.lastInput.Dr.clientX)\r\n            // console.log(mousePt.x)\r\n            \r\n            // cxElement.style.left = diagram.lastInput.Dr.clientX + \"px\";\r\n            // cxElement.style.top = diagram.lastInput.Dr.clientY + \"px\";\r\n\r\n            if(that.showContextMenuListener){\r\n                return that.showContextMenuListener(this.diagram, node)\r\n            }\r\n\r\n            // ===========================================================\r\n            // Show only the relevant buttons given the current state.\r\n            var showMenus = that.getShowContextMenus(node)\r\n            let liL = cxElement.getElementsByTagName('li')\r\n            if(showMenus){\r\n                console.log(showMenus.split(',').length)\r\n                for(let i = 0; i < liL.length; i++){\r\n                    liL[i].style.display = 'none';\r\n                }\r\n                for(let i = 0; i < showMenus.split(',').length; i++){\r\n                    try{\r\n                        if(helpers.getElementByAttr(cxElement,\"li\",\"trtd_action\",showMenus.split(',')[i])[0]){\r\n                            helpers.getElementByAttr(cxElement,\"li\",\"trtd_action\",showMenus.split(',')[i])[0].style.display = 'block'\r\n                        }\r\n                        \r\n                    }catch(e){\r\n                        console.error(e)\r\n                        continue\r\n                    }\r\n                    // cxElement.getElementsByClassName(showIds.split(',')[i])[0].style.display = 'block';\r\n                }\r\n            }else{\r\n                if(showMenus == \"\"){\r\n                    for(let i = 0; i < liL.length; i++){\r\n                        liL[i].style.display = 'block';\r\n                    }\r\n                }else{\r\n                    for(let i = 0; i < liL.length; i++){\r\n                        liL[i].style.display = 'none';\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Now show the whole context menu element\r\n            cxElement.style.display = \"block\";\r\n            // we don't bother overriding positionContextMenu, we just do it here:\r\n\r\n            // cxElement.style.left = x+10 + \"px\";\r\n            // cxElement.style.top = y-40 + \"px\";\r\n            // Remember that there is now a context menu showing\r\n            \r\n        }\r\n            // This is the corresponding override of ContextMenuTool.hideContextMenu:\r\n            // This does not not need to call the base method.\r\n        cxTool.hideContextMenu = function() {\r\n            if (this.currentContextMenu === null) return;\r\n            this.currentContextMenu = null;\r\n            cxElement.style.display = \"none\";\r\n            if(that.hideContextMenuListener){\r\n                return that.hideContextMenuListener(myDiagram)\r\n            }\r\n        }\r\n    }\r\n\r\n    getNodeContextMenu() {\r\n        return $(go.Adornment)\r\n\r\n        let style = {\r\n            // width: 120,\r\n            // height: 30,\r\n            // margin: 2,\r\n            // font: \"bold 14px sans-serif\",\r\n            // margin: 3,\r\n        }\r\n    \r\n        return $(go.Adornment, \"Vertical\",\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"应用样式到所有同级节点\"), {\r\n                    click: function(e, obj) {\r\n                        menus.applyStyle2Level(e, obj);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"应用样式到同级节点\"), {\r\n                    click: function(e, obj) {\r\n                        menus.applyStyle2CurLevel(e, obj);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"应用样式到子节点\"), {\r\n                    click: function(e, obj) {\r\n                        menus.applyStyle2ChiLevel(e, obj);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"添加\"), {\r\n                    click: function(e, obj) {\r\n                        menus.addFollower(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"添加子节点\"), {\r\n                    click: function(e) {\r\n                        menus.startNewSpiral(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"定位当前节点\"), style, {\r\n                    click: function(e){\r\n\r\n                    }\r\n                }),\r\n    \r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"删除\"), style, {\r\n                    click: function(e, obj) {\r\n                        console.log('eeeeeeeeee:', e);\r\n                        e.diagram.commandHandler.deleteSelection();\r\n                    }\r\n                }),\r\n            // $(\"ContextMenuButton\",\r\n            //     $(go.TextBlock, \"添加图片\"), style, {\r\n            //         click: function(e, obj) {\r\n            //             insertPicture();\r\n            //         }\r\n            //     }),\r\n            // $(\"ContextMenuButton\",\r\n            //     $(go.TextBlock, \"移除图片\"), style, {\r\n            //         click: function(e, obj) {\r\n            //             removeNodePicture();\r\n            //         }\r\n            //     }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"清空文本\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if (node) {\r\n                            myDiagram.startTransaction();\r\n                            //node.data.text=\"\";\r\n                            myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n                            myDiagram.commitTransaction();\r\n                        }\r\n                        //removeNodePicture();\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"删除 DEL\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if (node) {\r\n                            yunpan.yunpandel(e)\r\n                        }\r\n                        //removeNodePicture();\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"增加 CTRL+X/Y\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if (node) {\r\n                            if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n                                yunpan.addy(e)\r\n                            }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n                                yunpan.addx(e)\r\n                            }; \r\n                        }\r\n                        //removeNodePicture();\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"删除 DEL\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if (node) {\r\n                            yunpan.yunpandel(e)\r\n                        }\r\n                        //removeNodePicture();\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"增加同级节点\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(myDiagram.selection.first().data.istemp){\r\n                            return\r\n                        }\r\n                        dipan.addFollowerGround(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"增加子节点\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(node.data.parent){\r\n                            var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                            if(parentNode.data.istemp){\r\n                                return\r\n                            }\r\n                        }\r\n                        dipan.addNewCircle(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"删除\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(node.data.parent){\r\n                            var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                            if(parentNode.data.istemp){\r\n                                return\r\n                            }\r\n                        }\r\n                        dipan.addNewCircle(e);\r\n                    }\r\n                }),\r\n                $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"复制副本\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(myDiagram.selection.first().data.istemp){\r\n                            return\r\n                        }\r\n                        dipan.addFollowerGround(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"权限设置\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(node.data.parent){\r\n                            var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                            if(parentNode.data.istemp){\r\n                                return\r\n                            }\r\n                        }\r\n                        dipan.addNewCircle(e);\r\n                    }\r\n                }),\r\n            $(\"ContextMenuButton\",\r\n                $(go.TextBlock, \"删除\"), style, {\r\n                    click: function(e, obj) {\r\n                        var myDiagram = e.diagram;\r\n                        var node = myDiagram.selection.first();\r\n                        if(node.data.parent){\r\n                            var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                            if(parentNode.data.istemp){\r\n                                return\r\n                            }\r\n                        }\r\n                        dipan.addNewCircle(e);\r\n                    }\r\n                })\r\n    \r\n        );\r\n    }\r\n\r\n    dokeyDownFn() {   \r\n            //快捷键\r\n            // function dokeyDownFn (myDiagram) {\r\n            var myDiagram = this.diagram;\r\n            var diagram = this.diagram;\r\n            var e = this.diagram.lastInput;\r\n            var cmd = myDiagram.commandHandler;\r\n            var node = myDiagram.selection.first();\r\n\r\n            if (e.event.altKey) {\r\n                if (e.key == \"Q\") {\r\n                    autoLayoutAll();\r\n                    return;\r\n                } else if (e.key == \"R\") {\r\n                    centerNode();\r\n                    return;\r\n                } else if (e.key == \"C\") {\r\n                    centerCurrentNode();\r\n                    return;\r\n                } else if (e.key == \"A\") {\r\n                    zoomToFit();\r\n                    return;\r\n                }\r\n            }\r\n            if (e.event.keyCode >= 65 && e.event.keyCode <= 90 && !e.event.altKey && !e.event.ctrlKey && !e.event.shiftKey) {\r\n                // e.bubbles = true;\r\n                e.bubbles = false;\r\n                diagram.__trtd.selectText(e);\r\n                return true;\r\n            }\r\n\r\n            if (e.event.keyCode === 13) { // could also check for e.control or e.shift\r\n                if (node && node.data.category == 'Root' ) {\r\n                    diagram.__trtd.addFollowerGround();\r\n                } else if(node && node.data.category == 'dipan'){\r\n                    diagram.__trtd.addFollowerGround();\r\n                }\r\n\r\n            } else if (e.event.keyCode === 9) { // could also check for e.control or e.shift\r\n                if (node && node.data.category == 'Root') {\r\n\r\n                    diagram.__trtd.addNewCircle();\r\n                } else if(node && node.data.category == 'dipan'){\r\n                    diagram.__trtd.addNewCircle();\r\n                }\r\n            } else if (e.key === \"t\") { // could also check for e.control or e.shift\r\n                if (cmd.canCollapseSubGraph()) {\r\n                    cmd.collapseSubGraph();\r\n                } else if (cmd.canExpandSubGraph()) {\r\n                    cmd.expandSubGraph();\r\n                }\r\n            } else if (e.key == \"Del\") {\r\n                if (myDiagram.selection.count == 0) {\r\n                    return;\r\n                }\r\n                diagram.__trtd.deleteSelection();\r\n            } else if (e.event.keyCode == 113) { //F2,覆盖地盘默认行为\r\n                diagram.__trtd.selectText();\r\n            } else if (e.event.keyCode == 37) { //左\r\n                diagram.__trtd.moveWithinNodes('left');\r\n            } else if (e.event.keyCode == 38) { //上\r\n                diagram.__trtd.moveWithinNodes('up');\r\n            } else if (e.event.keyCode == 39) { //右\r\n                diagram.__trtd.moveWithinNodes('right');\r\n            } else if (e.event.keyCode == 40) { //下\r\n                diagram.__trtd.moveWithinNodes('down');\r\n            } else {\r\n                // call base method with no arguments\r\n                go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n            }\r\n            e.bubbles = false; //阻止事件冒泡到dom\r\n        // };\r\n\r\n        // return this.dokeyDownFn(this);\r\n    }\r\n}\r\n\r\nfunction computeEffectiveCollection(parts) {\r\n    console.log(\"computeEffectiveCollection\")\r\n    var coll = new go.Set();\r\n    var node = parts.first();\r\n    if (node) {\r\n        if(node.containingGroup && node.containingGroup.data.category == \"labelGroup\"){\r\n            var it = node.containingGroup.findSubGraphParts().iterator;\r\n            coll.add(node.containingGroup)\r\n            while(it.next()){\r\n                var n = it.value;\r\n                coll.add(n)\r\n            }\r\n        }else{\r\n            helpers.travelParts(node, function(p) {\r\n                coll.add(p);\r\n            })\r\n        }\r\n    } else {\r\n        coll.addAll(parts);\r\n    }\r\n    var tool = this;\r\n\r\n    return go.DraggingTool.prototype.computeEffectiveCollection.call(this, coll);\r\n};\r\n\r\nfunction sameGroup(fromnode, fromport, tonode, toport) {\r\n    //a node has 2 outer links at most\r\n    if (fromnode.findLinksOutOf().count >= 2) return;\r\n    //root node has 1 outer links at most\r\n    if (fromnode.findLinksOutOf().count >= 1 && fromnode.data.key == 1) return;\r\n    return fromnode.data.group === tonode.data.group;\r\n    // this could look at the fromport.fill and toport.fill instead,\r\n    // assuming that the ports are Shapes, which they are because portID was set on them,\r\n    // and that there is a data Binding on the Shape.fill\r\n}\r\n\r\nfunction cxcommand (obj, val) {\r\n    var diagram = obj.diagram;\r\n    var myDiagram = obj.diagram;\r\n    if (!(diagram.currentTool instanceof go.ContextMenuTool)) return;\r\n    switch (val) {\r\n        // case \"Paste\": diagram.commandHandler.pasteSelection(diagram.lastInput.documentPoint); break;\r\n        case \"addChildNodeMenu\":\r\n            tdAddChildNode(obj);\r\n            break;\r\n        case \"addLevelNodeMenu\":\r\n            tdAddLevelNode(obj);\r\n            break;\r\n        case \"changeDipanBgMenu\":\r\n            changeDipanBackgroundImg();\r\n            break;\r\n        case \"removeDipanBgMenu\":\r\n            removeDipanBackgroundImg(obj);\r\n            break;\r\n        case \"deleteNodeMenu\":\r\n            myDiagram.toolManager.textEditingTool.doCancel();\r\n            myDiagram.commandHandler.deleteSelection();\r\n            break;\r\n        case \"addNodePictureMenu\":\r\n            // jQuery(\"#insertimage\").modal('show');\r\n            // document.getElementById('insertimage').modal('show');\r\n            break; //特殊处理\r\n        case \"removeNodePictureMenu\":\r\n            removeNodePicture(obj);\r\n            break;\r\n        case \"clearNodeTextMenu\":\r\n            var node = myDiagram.selection.first();\r\n            if (node) {\r\n                myDiagram.startTransaction();\r\n                myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n                myDiagram.commitTransaction();\r\n            };\r\n            break;\r\n        case \"locateRootNodeMenu\":\r\n            centerNode(obj);\r\n            break;\r\n        case \"showAllNodesMenu\":\r\n            zoomToFit(obj);\r\n            break;\r\n        case \"removeOutCycleMenu\":\r\n            removeOutCycle(obj);\r\n            break;\r\n        case \"centerPictureMenu\":\r\n            centerPicture(obj);\r\n            break;\r\n        case \"equalWidthHeightPictureMenu\":\r\n            equalWidthHeightPicture(obj);\r\n            break;\r\n        case \"bringToTopMenu\":\r\n            bringToLayer(\"Foreground\", obj);\r\n            break;\r\n        case \"bringToBackgroundMenu\":\r\n            bringToLayer(\"Background\", obj);\r\n            break;\r\n        case \"bringUpMenu\":\r\n            bringToLayer(null, obj);\r\n            break;\r\n        case \"layoutGroupMenu\":\r\n            autoLayoutAll(true, obj);\r\n            break;\r\n\r\n        case \"insertTextMenu\":\r\n            insertTextNode(obj);\r\n            break;\r\n        case \"duplicateNode\":\r\n            duplicateNode(obj);\r\n            break; // 复制节点\r\n        case \"insertTianpanMenu\":\r\n            myDiagram.toolManager.clickCreatingTool.insertPart(myDiagram.lastInput.documentPoint);\r\n            break;\r\n        //固定节点\r\n        case \"fixPictureMenu\":   \r\n        case \"activePictureMenu\":\r\n            //var node = myDiagram.findPartAt(myDiagram.lastInput.documentPoint, false);\r\n            var node = myDiagram.selection.first();\r\n            myDiagram.startTransaction();\r\n            myDiagram.model.setDataProperty(node.data, \"selectable\", node.data.selectable != undefined ? (!node.data.selectable) : false);\r\n            myDiagram.commitTransaction();\r\n            break;\r\n        case \"orderChildNode\":\r\n            orderChildNode(obj);\r\n            break;\r\n        case \"clearOrderChildNode\":\r\n            clearOrderChildNode(obj);\r\n            break;\r\n        case \"delYunpanAxis\":\r\n            // yunpan.yunpandel(obj);\r\n            break;\r\n        case \"addYunpanAxis\":\r\n            // var node = myDiagram.selection.first();\r\n            // if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n            //     yunpan.addy(obj)\r\n            // }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n            //     yunpan.addx(obj)\r\n            // }; \r\n            break;\r\n        case \"addLevelDipanNode\":\r\n            if(myDiagram.selection.first().data.istemp){\r\n                return\r\n            }\r\n            obj.addFollowerGround();\r\n            break;\r\n        case \"addChildDipanNode\":\r\n            var node = myDiagram.selection.first();\r\n                if(node.data.parent){\r\n                    var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                    if(parentNode.data.istemp){\r\n                        return\r\n                    }\r\n                }\r\n            obj.addNewCircle(obj);\r\n            break;\r\n        case \"deleteDipanNode\":\r\n        // myDiagram.commandHandler.deleteSelection();\r\n        obj.deleteSelection();\r\n        break;\r\n    }\r\n    diagram.currentTool.stopTool();\r\n}\r\n\r\n\r\n\r\n\r\n// module.exports.Trtd = Trtd;\r\nmodule.exports.Trtd = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/trtd.js","\r\n// var sampleNodeTemplate = require('./sampleNodeTemplate')\r\nvar waveNodeTemplate = require('./waveNodeTemplate')\r\n// var waveTailNodeTemplate = require('./waveTailNodeTemplate')\r\nvar waveGroupNodeTemplate = require('./waveGroupNodeTemplate')\r\nvar axisGroupNodeTemplate = require('./axisGroupNodeTemplate')\r\nvar iconTextNodeTemplate = require('./iconTextNodeTemplate')\r\nvar autoTextNodeTemplate = require('./autoTextNodeTemplate')\r\nvar labelGroupNodeTemplate = require('./labelGroupNodeTemplate')\r\n// var cbianNodeTemplate = require('./cbianNodeTemplate')\r\nvar picNodeTemplate = require('./picNodeTemplate')\r\nvar picGroupNodeTemplate = require('./picGroupNodeTemplate')\r\nvar yunGroupNodeTemplate = require('./yunGroupNodeTemplate')\r\nvar yunpanGroupNodeTemplate = require('./yunpanGroupNodeTemplate')\r\nvar shapeNodeTemplate = require('./shapeNodeTemplate')\r\nvar shapeTextNodeTemplate = require('./shapeTextNodeTemplate')\r\n\r\nmodule.exports =  function(nodeType, options){\r\n    var temp = `${nodeType}NodeTemplate`\r\n    console.log(\"factory:\",temp)\r\n    var nodeTemplateClass = eval(temp)\r\n    return new nodeTemplateClass(options)\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/factory.js","\n\tvar localization = {\n\t\t\"trtd\":{\n\t\t\t// \"en\":\"Spherical Revolving World\",\n\t\t\t\"en\":\"Turn Round TD\",\n\t\t\t\"chn\":\"圆转天地\"\n\t\t},\n\t\t\"save\":{\n\t\t\t\"en\":\"Save\",\n\t\t\t\"chn\":\"保存\"\n\t\t},\n\t\t\"preview\":{\n\t\t\t\"en\":\"Preview\",\n\t\t\t\"chn\":\"预览\"\n\t\t},\n\t\t\"logout\":{\n\t\t\t\"en\":\"Log out\",\n\t\t\t\"chn\":\"退出\"\n\t\t},\n\t\t\"menu\":{\n\t\t\t\"en\":\"Menu\",\n\t\t\t\"chn\":\"菜单\"\n\t\t},\n\t\t\"usual\":{\n\t\t\t\"en\":\"Common\",\n\t\t\t\"chn\":\"常用\"\n\t\t},\n\t\t\"thinking\":{\n\t\t\t\"en\":\"Train of Thought\",\n\t\t\t\"chn\":\"思路\"\n\t\t},\n\t\t\"appearance\":{\n\t\t\t\"en\":\"Appearance\",\n\t\t\t\"chn\":\"外观\"\n\t\t},\n\t\t\"view\":{\n\t\t\t\"en\":\"View\",\n\t\t\t\"chn\":\"视图\"\n\t\t},\n\t\t\"insertll\":{\n\t\t\t\"en\":\"Insert the Lower Leve\",\n\t\t\t\"chn\":\"插入下级\"\n\t\t},\n\t\t\"insertsl\":{\n\t\t\t\"en\":\"Insert Sibling Level\",\n\t\t\t\"chn\":\"插入同级\"\n\t\t},\n\t\t\"undo\":{\n\t\t\t\"en\":\"Undo\",\n\t\t\t\"chn\":\"撤销\"\n\t\t},\n\t\t\"redo\":{\n\t\t\t\"en\":\"Redo\",\n\t\t\t\"chn\":\"重做\"\n\t\t},\n\t\t\"cte\":{\n\t\t\t\"en\":\"Click to edit\",\n\t\t\t\"chn\":\"单击编辑\"\n\t\t},\n\t\t\"dce\":{\n\t\t\t\"en\":\"Double Click to Edit\",\n\t\t\t\"chn\":\"双击编辑内容\"\n\t\t},\n\t\t\"centertheme\":{\n\t\t\t\"en\":\"Central Theme\",\n\t\t\t\"chn\":\"中心主题\"\n\t\t},\n\t\t\"edit\":{\n\t\t\t\"en\":\"Edit\",\n\t\t\t\"chn\":\"编辑\"\n\t\t},\n\t\t\"remove\":{\n\t\t\t\"en\":\"Delete\",\n\t\t\t\"chn\":\"删除\"\n\t\t},\n\t\t\"radius\":{\n\t\t\t\"en\":\"Size\",\n\t\t\t\"chn\":\"大小\"\n\t\t},\n\t\t\"shape\":{\n\t\t\t\"en\":\"Shape\",\n\t\t\t\"chn\":\"形状\"\n\t\t},\n\t\t\"borderwidth\":{\n\t\t\t\"en\":\"Border Width\",\n\t\t\t\"chn\":\"边框宽度\"\n\t\t},\n\t\t\"noborder\":{\n\t\t\t\"en\":\"No Border\",\n\t\t\t\"chn\":\"无边框\"\n\t\t},\n\t\t\"borderstyle\":{\n\t\t\t\"en\":\"Border Style\",\n\t\t\t\"chn\":\"边框样式\"\n\t\t},\n\t\t\"fillcolor\":{\n\t\t\t\"en\":\"Fill Color\",\n\t\t\t\"chn\":\"填充色\"\n\t\t},\n\t\t\"bordercolor\":{\n\t\t\t\"en\":\"Border Color\",\n\t\t\t\"chn\":\"边框颜色\"\n\t\t},\n\t\t\"image\":{\n\t\t\t\"en\":\"Pictures\",\n\t\t\t\"chn\":\"图片\"\n\t\t},\n\t\t\"insert\":{\n\t\t\t\"en\":\"Insert\",\n\t\t\t\"chn\":\"插入\"\n\t\t},\n\t\t\"delete\":{\n\t\t\t\"en\":\"Remove\",\n\t\t\t\"chn\":\"移除\"\n\t\t},\n\t\t\"remark\":{\n\t\t\t\"en\":\"Comment\",\n\t\t\t\"chn\":\"备注\"\n\t\t},\n\t\t\"removeallnode\":{\n\t\t\t\"en\":\"Empty Nodes\",\n\t\t\t\"chn\":\"清空节点\"\n\t\t},\n\t\t\"removeallline\":{\n\t\t\t\"en\":\"Delete Lines\",\n\t\t\t\"chn\":\"清空连线\"\n\t\t},\n\t\t\"arrangelayout\":{\n\t\t\t\"en\":\"Arrange layout\",\n\t\t\t\"chn\":\"整理布局\"\n\t\t},\n\t\t\"previewSubPan\":{\n\t\t\t\"en\":\"Preview SubPan\",\n\t\t\t\"chn\":\"预览子盘\"\n\t\t},\n        \"arrowstyle\":{\n            \"en\":\"Arrow Style\",\n            \"chn\":\"箭头样式\"\n        },\n        \"linkstyle\":{\n            \"en\":\"Link Style\",\n            \"chn\":\"弧样式\"\n        },\n\t\t\"clearText\":{\n\t\t\t\"en\":\"Clear Text\",\n\t\t\t\"chn\":\"清空文本\"\n\t\t},\n\t\t\"tdautolayout\":{\n\t\t\t// \"en\":\"Auto-placement of the TianPan\",\n\t\t\t\"en\":\"Auto layout\",\n\t\t\t\"chn\":\"天盘自动布局\"\n\t\t},\n\t\t\"jumptonewnode\":{\n\t\t\t// \"en\":\"Automatically Redirect to the New Nodes\",\n\t\t\t\"en\":\"Auto locate\",\n\t\t\t\"chn\":\"自动跳转到新的节点\"\n\t\t},\n\t\t\"theme\":{\n\t\t\t\"en\":\"Subject\",\n\t\t\t\"chn\":\"主题\"\n\t\t},\n\t\t\"backcolor\":{\n\t\t\t\"en\":\"Background Color\",\n\t\t\t\"chn\":\"背景颜色\"\n\t\t},\n\t\t\"objofaction\":{\n\t\t\t\"en\":\"Object\",\n\t\t\t\"chn\":\"作用对象\"\n\t\t},\n\t\t\"oneobj\":{\n\t\t\t\"en\":\"Single Node\",\n\t\t\t\"chn\":\"单个节点\"\n\t\t},\n\t\t\"sibobj\":{\n\t\t\t\"en\":\"Sibling Nodes\",\n\t\t\t\"chn\":\"同级节点\"\n\t\t},\n\t\t\"allsibobj\":{\n\t\t\t\"en\":\"All Sibling Nodes\",\n\t\t\t\"chn\":\"所有同级节点\"\n\t\t},\n\t\t\"allnodes\":{\n\t\t\t\"en\":\"All Nodes\",\n\t\t\t\"chn\":\"所有节点\"\n\t\t},\n\t\t\"shade\":{\n\t\t\t\"en\":\"Shade\",\n\t\t\t\"chn\":\"阴影\"\n\t\t},\n\t\t\"font\":{\n\t\t\t\"en\":\"Font\",\n\t\t\t\"chn\":\"字体\"\n\t\t},\n\t\t\"fontsize\":{\n\t\t\t\"en\":\"Font Size\",\n\t\t\t\"chn\":\"字号\"\n\t\t},\n\t\t\"compactdegree\":{\n\t\t\t\"en\":\"Compact Level\",\n\t\t\t\"chn\":\"紧凑程度\"\n\t\t},\n\t\t\"compact\":{\n\t\t\t\"en\":\"Compact\",\n\t\t\t\"chn\":\"紧凑\"\n\t\t},\n\t\t\"sparse\":{\n\t\t\t\"en\":\"Sparse\",\n\t\t\t\"chn\":\"稀疏\"\n\t\t},\n\t\t\"eq\":{\n\t\t\t\"en\":\"Equal Interval\",\n\t\t\t\"chn\":\"等间距\"\n\t\t},\n\t\t\"spread\":{\n\t\t\t\"en\":\"Spread\",\n\t\t\t\"chn\":\"展开\"\n\t\t},\n\t\t\"firstl\":{\n\t\t\t\"en\":\"First Layer\",\n\t\t\t\"chn\":\"第一层\"\n\t\t},\n\t\t\"secondl\":{\n\t\t\t\"en\":\"Second Layer\",\n\t\t\t\"chn\":\"第二层\"\n\t\t},\n\t\t\"threel\":{\n\t\t\t\"en\":\"Third Layer\",\n\t\t\t\"chn\":\"第三层\"\n\t\t},\n\t\t\"fourl\":{\n\t\t\t\"en\":\"Fourth Layer\",\n\t\t\t\"chn\":\"第四层\"\n\t\t},\n\t\t\"fifthl\":{\n\t\t\t\"en\":\"Fifth Layer\",\n\t\t\t\"chn\":\"第五层\"\n\t\t},\n\t\t\"localnodes\":{\n\t\t\t\"en\":\"Location Nodes\",\n\t\t\t\"chn\":\"定位节点\"\n\t\t},\n\t\t\"rootnode\":{\n\t\t\t\"en\":\"Root Node\",\n\t\t\t\"chn\":\"根节点\"\n\t\t},\n\t\t\"currentnode\":{\n\t\t\t\"en\":\"Current Nodes\",\n\t\t\t\"chn\":\"当前节点\"\n\t\t},\n\t\t\"displayallnodes\":{\n\t\t\t\"en\":\"Display All Nodes\",\n\t\t\t\"chn\":\"显示所有节点\"\n\t\t},\n\t\t\"return\":{\n\t\t\t\"en\":\"Back\",\n\t\t\t\"chn\":\"返回\"\n\t\t},\n\t\t\"tianpan\":{\n\t\t\t\"en\":\"TianPan\",\n\t\t\t\"chn\":\"天盘\"\n\t\t},\n\t\t\"dipan\":{\n\t\t\t\"en\":\"DiPan\",\n\t\t\t\"chn\":\"地盘\"\n\t\t},\n\t\t\"open\":{\n\t\t\t\"en\":\"Open\",\n\t\t\t\"chn\":\"打开\"\n\t\t},\n\t\t\"saveas\":{\n\t\t\t\"en\":\"Save As\",\n\t\t\t\"chn\":\"另存为\"\n\t\t},\n\t\t\"help\":{\n\t\t\t\"en\":\"Help\",\n\t\t\t\"chn\":\"帮助\"\n\t\t},\n\t\t\"new\":{\n\t\t\t\"en\":\"New\",\n\t\t\t\"chn\":\"新建\"\n\t\t},\n\t\t\"commontemplate\":{\n\t\t\t\"en\":\"Common template\",\n\t\t\t\"chn\":\"常用模板\"\n\t\t},\n\t\t\"openlocalfile\":{\n\t\t\t\"en\":\"Open local file\",\n\t\t\t\"chn\":\"打开本地文件\"\n\t\t},\n\t\t\"importtext\":{\n\t\t\t\"en\":\"Import outline text\",\n\t\t\t\"chn\":\"导入大纲文本\"\n\t\t},\n\t\t\"recentlyfile\":{\n\t\t\t\"en\":\"Recently used files\",\n\t\t\t\"chn\":\"最近使用的文件\"\n\t\t},\n\t\t\"exportdata\":{\n\t\t\t\"en\":\"Export Data\",\n\t\t\t\"chn\":\"另存为txt数据\"\n\t\t},\n\t\t\"exporttext\":{\n\t\t\t\"en\":\"Export Outline Text\",\n\t\t\t\"chn\":\"导出大纲文本\"\n\t\t},\n\t\t\"exportimg\":{\n\t\t\t\"en\":\"Export Pictures\",\n\t\t\t\"chn\":\"导出图片\"\n\t\t},\n\t\t\"websupport\":{\n\t\t\t\"en\":\"Website Support\",\n\t\t\t\"chn\":\"网站支持\"\n\t\t},\n\t\t\"techsupport\":{\n\t\t\t\"en\":\"Technical Support\",\n\t\t\t\"chn\":\"技术支持\"\n\t\t},\n\t\t\"techsupportqq\":{\n\t\t\t\"en\":\"Technical Support to QQ Groups\",\n\t\t\t\"chn\":\"技术支持QQ群\"\n\t\t},\n\t\t\"shortcutkey\":{\n\t\t\t\"en\":\"Shortcut Key\",\n\t\t\t\"chn\":\"快捷键\"\n\t\t},\n\t\t\"addchildnode\":{\n\t\t\t\"en\":\"Add Child\",\n\t\t\t\"chn\":\"增加子节点\"\n\t\t},\n\t\t\"addsibnode\":{\n\t\t\t\"en\":\"Add Sibling\",\n\t\t\t\"chn\":\"增加同级节点\"\n\t\t},\n\t\t\"key\":{\n\t\t\t\"en\":\"Key\",\n\t\t\t\"chn\":\"键\"\n\t\t},\n\t\t\"or\":{\n\t\t\t\"en\":\"Or\",\n\t\t\t\"chn\":\"或\"\n\t\t},\n\t\t\"confirmedittext\":{\n\t\t\t\"en\":\"Confirm the completion of editing text\",\n\t\t\t\"chn\":\"编辑完文字确认\"\n\t\t},\n\t\t\"editnewline\":{\n\t\t\t\"en\":\"Edit text newline\",\n\t\t\t\"chn\":\"编辑文字换行\"\n\t\t},\n\t\t\"canceltextedit\":{\n\t\t\t\"en\":\"Cancel Text Editing\",\n\t\t\t\"chn\":\"取消编辑文字\"\n\t\t},\n\t\t\"activetextedit\":{\n\t\t\t\"en\":\"Activate Text Editing\",\n\t\t\t\"chn\":\"激活编辑文字\"\n\t\t},\n\t\t\"sanpak\":{\n\t\t\t\"en\":\"Select a node and press any key\",\n\t\t\t\"chn\":\"选中节点后按任意字母键\"\n\t\t},\n\t\t\"auxview\":{\n\t\t\t\"en\":\"Auxiliary View\",\n\t\t\t\"chn\":\"辅助查看\"\n\t\t},\n\t\t\"focusselectnode\":{\n\t\t\t\"en\":\"Focus on selected nodes\",\n\t\t\t\"chn\":\"聚焦选中节点\"\n\t\t},\n\t\t\"locateselectednode\":{\n\t\t\t\"en\":\"Locate selected nodes\",\n\t\t\t\"chn\":\"定位选中节点\"\n\t\t},\n\t\t\"locaterootnode\":{\n\t\t\t\"en\":\"Locate Root Nodes\",\n\t\t\t\"chn\":\"定位根节点\"\n\t\t},\n\t\t\"bigcanvas\":{\n\t\t\t\"en\":\"Enlarge Canvas\",\n\t\t\t\"chn\":\"放大画布\"\n\t\t},\n\t\t\"smallcanvas\":{\n\t\t\t\"en\":\"Narrow Canvas\",\n\t\t\t\"chn\":\"缩小画布\"\n\t\t},\n\t\t\"switchnode\":{\n\t\t\t\"en\":\"Switch selected nodes\",\n\t\t\t\"chn\":\"切换选择的节点\"\n\t\t},\n\t\t\"mttnsn\":{\n\t\t\t\"en\":\"Move to the next sibling node\",\n\t\t\t\"chn\":\"移动到下一个同级节点\"\n\t\t},\n\t\t\"mttlsn\":{\n\t\t\t\"en\":\"Move to the last sibling node\",\n\t\t\t\"chn\":\"移动到上一个节点\"\n\t\t},\n\t\t\"mttfsn\":{\n\t\t\t\"en\":\"Move to the first child node\",\n\t\t\t\"chn\":\"移动到第一个节点\"\n\t\t},\n\t\t\"mtfn\":{\n\t\t\t\"en\":\"Move to Father Node\",\n\t\t\t\"chn\":\"移动到父节点\"\n\t\t},\n\t\t\"direckey\":{\n\t\t\t\"en\":\"Direction Key\",\n\t\t\t\"chn\":\"方向键\"\n\t\t},\n\t\t\"servicetd\":{\n\t\t\t\"en\":\"Send Feedback\",\n\t\t\t\"chn\":\"我要给圆转天地提意见\"\n\t\t},\n\t\t\"cbottc\":{\n\t\t\t\"en\":\"Change background of the DiPan\",\n\t\t\t\"chn\":\"更换地盘背景\"\n\t\t},\n\t\t\"rbottc\":{\n\t\t\t\"en\":\"Remove background of the DiPan\",\n\t\t\t\"chn\":\"移除地盘背景\"\n\t\t},\n\t\t\"icn\":{\n\t\t\t\"en\":\"Insert child nodes\",\n\t\t\t\"chn\":\"插入子节点\"\n\t\t},\n\t\t\"addnodepic\":{\n\t\t\t\"en\":\"Add Node Pictures\",\n\t\t\t\"chn\":\"添加节点图片\"\n\t\t},\n\t\t\"removepicture\":{\n\t\t\t\"en\":\"Remove Pictures\",\n\t\t\t\"chn\":\"移除图片\"\n\t\t},\n\t\t\"emptynodetext\":{\n\t\t\t\"en\":\"Empty Node Text\",\n\t\t\t\"chn\":\"清空节点文本\"\n\t\t},\n\t\t\"insertnodetianpan\":{\n\t\t\t\"en\":\"Insert Nodes of TianPan\",\n\t\t\t\"chn\":\"插入天盘节点\"\n\t\t},\n\t\t\"inserttext\":{\n\t\t\t\"en\":\"Insert Text\",\n\t\t\t\"chn\":\"插入文本\"\n\t\t},\n\t\t\"centerpicture\":{\n\t\t\t\"en\":\"Center Pictures\",\n\t\t\t\"chn\":\"居中图片\"\n\t\t},\n\t\t\"ewah\":{\n\t\t\t\"en\":\"Equal Width and Hight\",\n\t\t\t\"chn\":\"等宽高\"\n\t\t},\n\t\t\"bringtofront\":{\n\t\t\t\"en\":\"Bring to Front\",\n\t\t\t\"chn\":\"置于顶层\"\n\t\t},\n\t\t\"bringtobottom\":{\n\t\t\t\"en\":'Bring to Bottom',\n\t\t\t\"chn\":\"置于底层\"\n\t\t},\n\t\t\"bringforward\":{\n\t\t\t\"en\":\"Bring Forward\",\n\t\t\t\"chn\":\"上移一层\"\n\t\t},\n\t\t\"fixnode\":{\n\t\t\t\"en\":\"Fixed Nodes\",\n\t\t\t\"chn\":\"固定节点\"\n\t\t},\n\t\t\"cancelfix\":{\n\t\t\t\"en\":\"Cancel Fixed\",\n\t\t\t\"chn\":\"取消固定\"\n\t\t},\n\t\t//strings:\"Theme Colors,Standard Colors,Web Colors,Theme Colors,Back to Palette,History,No history yet.\"\n\t\t\"themecolor\":{\n\t\t\t\"en\":\"Theme Colors\",\n\t\t\t\"chn\":\"主题颜色\"\n\t\t},\n\t\t\"standardcolor\":{\n\t\t\t\"en\":\"Standard Colors\",\n\t\t\t\"chn\":\"标准颜色\"\n\t\t},\n\t\t\"webcolor\":{\n\t\t\t\"en\":\"Web Colors\",\n\t\t\t\"chn\":\"更多颜色\"\n\t\t},\n\t\t\"backtop\":{\n\t\t\t\"en\":\"Back to Palette\",\n\t\t\t\"chn\":\"返回主题颜色\"\n\t\t},\n\t\t\"history\":{\n\t\t\t\"en\":\"History\",\n\t\t\t\"chn\":\"历史\"\n\t\t},\n\t\t\"nohistory\":{\n\t\t\t\"en\":\"No history yet\",\n\t\t\t\"chn\":\"暂无历史\"\n\t\t},\n\t\t\"week\":{\n\t\t\t\"en\":\"Week\",\n\t\t\t\"chn\":\"最近一周\"\n\t\t},\n\t\t\"Jan\":{\n\t\t\t\"en\":\"January\",\n\t\t\t\"chn\":\"一月\"\n\t\t},\n\t\t\"Feb\":{\n\t\t\t\"en\":\"February\",\n\t\t\t\"chn\":\"二月\"\n\t\t},\n\t\t\"Mar\":{\n\t\t\t\"en\":\"March\",\n\t\t\t\"chn\":\"三月\"\n\t\t},\n\t\t\"Apr\":{\n\t\t\t\"en\":\"April\",\n\t\t\t\"chn\":\"四月\"\n\t\t},\n\t\t\"May\":{\n\t\t\t\"en\":\"May\",\n\t\t\t\"chn\":\"五月\"\n\t\t},\n\t\t\"Jun\":{\n\t\t\t\"en\":\"June\",\n\t\t\t\"chn\":\"六月\"\n\t\t},\n\t\t\"Jul\":{\n\t\t\t\"en\":\"July\",\n\t\t\t\"chn\":\"七月\"\n\t\t},\n\t\t\"Aug\":{\n\t\t\t\"en\":\"August\",\n\t\t\t\"chn\":\"八月\"\n\t\t},\n\t\t\"Sep\":{\n\t\t\t\"en\":\"September\",\n\t\t\t\"chn\":\"九月\"\n\t\t},\n\t\t\"Oct\":{\n\t\t\t\"en\":\"October\",\n\t\t\t\"chn\":\"十月\"\n\t\t},\n\t\t\"Nov\":{\n\t\t\t\"en\":\"November\",\n\t\t\t\"chn\":\"十一月\"\n\t\t},\n\t\t\"Dec\":{\n\t\t\t\"en\":\"December\",\n\t\t\t\"chn\":\"十二月\"\n\t\t},\n\t\t\"insertimg\":{\n\t\t\t\"en\":\"Insert Pictures\",\n\t\t\t\"chn\":\"插入图片\"\n\t\t},\n\t\t\"imglist\":{\n\t\t\t\"en\":\"Pictures list\",\n\t\t\t\"chn\":\"图片列表\"\n\t\t},\n\t\t\"uploadimg\":{\n\t\t\t\"en\":\"Upload Picture\",\n\t\t\t\"chn\":\"上传图片\"\n\t\t},\n\t\t\"katong\":{\n\t\t\t\"en\":\"Cartoon Picture\",\n\t\t\t\"chn\":\"卡通图片\"\n\t\t},\n\t\t\"numbericon\":{\n\t\t\t\"en\":\"Number Icons\",\n\t\t\t\"chn\":\"数字图片\"\n\t\t},\n\t\t\"qipao\":{\n\t\t\t\"en\":\"Bubble\",\n\t\t\t\"chn\":\"气泡\"\n\t\t},\n\t\t\"custompic\":{\n\t\t\t\"en\":\"Custom Picture\",\n\t\t\t\"chn\":\"自定义图片\"\n\t\t},\n\t\t\"picture\":{\n\t\t\t\"en\":\"Picture\",\n\t\t\t\"chn\":\"图片\"\n\t\t},\n\t\t\"cancel\":{\n\t\t\t\"en\":\"Cancel\",\n\t\t\t\"chn\":\"取消\"\n\t\t},\n\t\t\"ok\":{\n\t\t\t\"en\":\"Ok\",\n\t\t\t\"chn\":\"确定\"\n\t\t},\n\t\t\"previewimg\":{\n\t\t\t\"en\":\"Preview Pictures\",\n\t\t\t\"chn\":\"预览图片\"\n\t\t},\n\t\t\"copyimg\":{\n\t\t\t\"en\":\"Copy Picture\",\n\t\t\t\"chn\":\"复制图片\"\n\t\t},\n\t\t\"copyimgsucces\":{\n\t\t\t\"en\":\"Already Copy Picture Into Clipboard\",\n\t\t\t\"chn\":\"成功复制图片到粘贴板\"\n\t\t},\n\t\t\"dragtoupload\":{\n\t\t\t\"en\":\"Drag to Upload Picture\",\n\t\t\t\"chn\":\"拖拽到此处上传\"\n\t\t},\n\t\t\"linkaddress\":{\n\t\t\t\"en\":\"Link Address\",\n\t\t\t\"chn\":\"链接地址\"\n\t\t},\n\t\t\"insertremark\":{\n\t\t\t\"en\":\"Insert Comment\",\n\t\t\t\"chn\":\"插入备注\"\n\t\t},\n\t\t\"insertlink\":{\n\t\t\t'en':\"Insert Link\",\n\t\t\t\"chn\":\"插入链接\"\n\t\t},\n\t\t\"copy\":{\n\t\t\t\"en\":\"copy\",\n\t\t\t\"chn\":\"复制\"\n\t\t},\n\t\t\"picdin\":{\n\t\t\t\"en\":\"Picture definition\",\n\t\t\t\"chn\":\"图片清晰度\"\n\t\t},\n\t\t\"hsacc\":{\n\t\t\t\"en\":\"Hierarchical Subject\",\n\t\t\t\"chn\":\"天盘层级主题\"\n\t\t},\n\t\t\"mtwtb\":{\n\t\t\t\"en\":\"Bold Border Subject\",\n\t\t\t\"chn\":\"天盘白字粗变主题\"\n\t\t},\n\t\t\"officetheme\":{\n\t\t\t\"en\":\"Office Subject\",\n\t\t\t\"chn\":\"Office主题\"\n\t\t},\n\t\t\"lctheme\":{\n\t\t\t\"en\":\"Light-coloured Subject\",\n\t\t\t\"chn\":\"浅色主题\"\n\t\t},\n\t\t\"web2theme\":{\n\t\t\t\"en\":\"web2.0 Subject\",\n\t\t\t\"chn\":\"Web2.0主题\"\n\t\t},\n\t\t\"metrotheme\":{\n\t\t\t\"en\":\"Metro Subject\",\n\t\t\t\"chn\":\"Metro主题\"\n\t\t},\n\t\t\"retrotheme\":{\n\t\t\t\"en\":\"Retro Subject\",\n\t\t\t\"chn\":\"复古主题\"\n\t\t},\n\t\t\"bustheme\":{\n\t\t\t\"en\":\"Business Subject\",\n\t\t\t\"chn\":\"商业主题\"\n\t\t},\n\t\t\"hiet1\":{\n\t\t\t\"en\":\"Hierachy Subject 1\",\n\t\t\t\"chn\":\"层次主题1\"\n\t\t},\n\t\t\"hiet2\":{\n\t\t\t\"en\":\"Hierachy Subject 2\",\n\t\t\t\"chn\":\"层次主题2\"\n\t\t},\n\t\t\"eayth\":{\n\t\t\t\"en\":\"Earlier Version Subject\",\n\t\t\t\"chn\":\"旧版主题\"\n\t\t},\n\t\t\"blankth\":{\n\t\t\t\"en\":\"Pure-black Subject\",\n\t\t\t\"chn\":\"纯黑色主题\"\n\t\t},\n\t\t\"transthe\":{\n\t\t\t\"en\":\"Transparent Subject\",\n\t\t\t\"chn\":\"透明主题\"\n\t\t},\n\t\t\"randomdipan\":{\n\t\t\t\"en\":\"Random Subject of the DiPan\",\n\t\t\t\"chn\":\"随机地盘主题\"\n\t\t},\n\t\t\"radomcolor1\":{\n\t\t\t\"en\":\"Random Colour 1\",\n\t\t\t\"chn\":\"随机色彩1\"\n\t\t},\n\t\t\"radomcolor2\":{\n\t\t\t\"en\":\"Random Colour 1\",\n\t\t\t\"chn\":\"随机色彩2\"\n\t\t},\n\t\t\"mylocalfile\":{\n\t\t\t\"en\":\"My local file\",\n\t\t\t\"chn\":\"我的本地文件\"\n\t\t},\n\t\t\"ut2c\":{\n\t\t\t\"en\":\"Up to 20 characters\",\n\t\t\t\"chn\":\"最多20个字符\"\n\t\t},\n\t\t\"success\":{\n\t\t\t\"en\":\"Success\",\n\t\t\t\"chn\":\"成功\"\n\t\t},\n\t\t\"danger\":{\n\t\t\t\"en\":\"Fail\",\n\t\t\t\"chn\":\"失败\"\n\t\t},\n\t\t\"info\":{\n\t\t\t\"en\":\"Info\",\n\t\t\t\"chn\":\"提示\"\n\t\t},\n\t\t\"strf\":{\n\t\t\t\"en\":\"Save the file in:Menu->Open->Recently used file\",\n\t\t\t\"chn\":\"文件保存在:菜单->打开->最近使用文件中\"\n\t\t},\n\t\t\"netonffline\":{\n\t\t\t\"en\":\"Network is not connected, commonly used template download failed\",\n\t\t\t\"chn\":\"网络未连接，常用模板下载失败\"\n\t\t},\n\t\t\"cantcheckver\":{\n\t\t\t\"en\":\"The network is not connected, the version of the test failed\",\n\t\t\t\"chn\":\"网络未连接，版本检测失败\"\n\t\t},\n\t\t\"spacebar\":{\n\t\t\t\"en\":\"Space bar\",\n\t\t\t\"chn\":\"空格键\"\n\t\t},\n\t\t\"supportmail\":{\n\t\t\t\"en\":\"Support Mail\",\n\t\t\t\"chn\":\"技术支持邮箱\"\n\t\t},\n\t\t\"updatesuccess\":{\n\t\t\t\"en\":\"Update sucess\",\n\t\t\t\"chn\":\"更新成功\"\n\t\t},\n\t\t\"blankText\":{\n\t\t\t\"en\":\"Blank text\",\n\t\t\t\"chn\":\"空白文本\"\n\t\t},\n\n\t  /**simditor\n\t  \t*\n\t  \t**/\n\t  \t'blockquote': {\n\t  \t\t'en':'Block Quote',\n\t  \t\t'chn':'引用'\n\t  \t},\n\t    'bold': {\n\t    \t'en':'Bold',\n\t    \t'chn':'加粗文字'\n\t    },\n\t    'code': {\n\t    \t'en':'Code',\n\t    \t'chn':'插入代码'\n\t    },\n\t    'color': {\n\t    \t'en':'Text Color',\n\t    \t'chn':'文字颜色'\n\t    },\n\t    'coloredText': {\n\t    \t'en':'Colored Text',\n\t    \t'chn':'彩色文字'\n\t    },\n\t    'hr': {\n\t    \t'en':'Horizontal Line',\n\t    \t'chn':'分隔线'\n\t    },\n\t    'image': {\n\t    \t'en':'Insert Image',\n\t    \t'chn':'插入图片'\n\t    },\n\t    'externalImage': {\n\t    \t'en':'External Image',\n\t    \t'chn':'外链图片'\n\t    },\n\t    'uploadImage': {\n\t    \t'en':'Upload Image',\n\t    \t'chn':'上传图片'\n\t    },\n\t    'uploadFailed': {\n\t    \t'en':'Upload failed',\n\t    \t'chn':'上传失败了'\n\t    },\n\t    'uploadError': {\n\t    \t'en':'Error occurs during upload',\n\t    \t'chn':'上传出错了'\n\t    },\n\t    'imageUrl': {\n\t    \t'en':'Url',\n\t    \t'chn':'图片地址'\n\t    },\n\t    'imageSize': {\n\t    \t'en':'Size',\n\t    \t'chn':'图片尺寸'\n\t    },\n\t    'imageAlt': {\n\t    \t'en':'Alt',\n\t    \t'chn':'图片描述'\n\t    },\n\t    'restoreImageSize': {\n\t    \t'en':'Restore Origin Size',\n\t    \t'chn':'还原图片尺寸'\n\t    },\n\t    'uploading': {\n\t    \t'en':'Uploading',\n\t    \t'chn':'正在上传'\n\t    },\n\t    'indent': {\n\t    \t'en':'Indent',\n\t    \t'chn':'向右缩进'\n\t    },\n\t    'outdent': {\n\t    \t'en':'Outdent',\n\t    \t'chn':'向左缩进'\n\t    },\n\t    'italic': {\n\t    \t'en':'Italic',\n\t    \t'chn':'斜体文字'\n\t    },\n\t    'link': {\n\t    \t'en':'Insert Link',\n\t    \t'chn':'插入链接'\n\t    },\n\t    'linkText': {\n\t    \t'en':'Text',\n\t    \t'chn':'链接文字'\n\t    },\n\t    'linkUrl': {\n\t    \t'en':'Url',\n\t    \t'chn':'链接地址'\n\t    },\n\t    'linkTarget': {\n\t    \t'en':'Target',\n\t    \t'chn':'打开方式'\n\t    },\n\t    'openLinkInCurrentWindow': {\n\t    \t'en':'Open link in current window',\n\t    \t'chn':'在新窗口中打开'\n\t    },\n\t    'openLinkInNewWindow': {\n\t    \t'en':'Open link in new window',\n\t    \t'chn':'在当前窗口中打开'\n\t    },\n\t    'removeLink': {\n\t    \t'en':'Remove Link',\n\t    \t'chn':'移除链接'\n\t    },\n\t    'ol': {\n\t    \t'en':'Ordered List',\n\t    \t'chn':'有序列表'\n\t    },\n\t    'ul': {\n\t    \t'en':'Unordered List',\n\t    \t'chn':'无序列表'\n\t    },\n\t    'strikethrough': {\n\t    \t'en':'Strikethrough',\n\t    \t'chn':'删除线文字'\n\t    },\n\t    'table': {\n\t    \t'en':'Table',\n\t    \t'chn':'表格'\n\t    },\n\t    'deleteRow': {\n\t    \t'en':'Delete Row',\n\t    \t'chn':'删除行'\n\t    },\n\t    'insertRowAbove': {\n\t    \t'en':'Insert Row Above',\n\t    \t'chn':'在上面插入行'\n\t    },\n\t    'insertRowBelow': {\n\t    \t'en':'Insert Row Below',\n\t    \t'chn':'在下面插入行'\n\t    },\n\t    'deleteColumn': {\n\t    \t'en':'Delete Column',\n\t    \t'chn':'删除列'\n\t    },\n\t    'insertColumnLeft': {\n\t    \t'en':'Insert Column Left',\n\t    \t'chn':'在左边插入列'\n\t    },\n\t    'insertColumnRight': {\n\t    \t'en':'Insert Column Right',\n\t    \t'chn':'在右边插入列'\n\t    },\n\t    'deleteTable': {\n\t    \t'en':'Delete Table',\n\t    \t'chn':'删除表格'\n\t    },\n\t    'title': {\n\t    \t'en':'Title',\n\t    \t'chn':'标题'\n\t    },\n\t    'normalText': {\n\t    \t'en':'Text',\n\t    \t'chn':'普通文本'\n\t    },\n\t    'underline': {\n\t    \t'en':'Underline',\n\t    \t'chn':'下划线文字'\n\t    },\n\t    'alignment': {\n\t    \t'en':'Alignment',\n\t    \t'chn':'水平对齐'\n\t    },\n\t    'alignCenter': {\n\t    \t'en':'Align Center',\n\t    \t'chn':'居中'\n\t    },\n\t    'alignLeft': {\n\t    \t'en':'Align Left',\n\t    \t'chn':'居左'\n\t    },\n\t    'alignRight': {\n\t    \t'en':'Align Right',\n\t    \t'chn':'居右'\n\t    },\n\t    'selectLanguage': {\n\t    \t'en':'Select Language',\n\t    \t'chn':'选择程序语言'\n\t    },\n\t    'fontScale': {\n\t    \t'en':'Font Size',\n\t    \t'chn':'字体大小'\n\t    },\n\t    'fontScaleXLarge': {\n\t    \t'en':'X Large Size',\n\t    \t'chn':'超大字体'\n\t    },\n\t    'fontScaleLarge': {\n\t    \t'en':'Large Size',\n\t    \t'chn':'大号字体'\n\t    },\n\t    'fontScaleNormal': {\n\t    \t'en':'Normal Size',\n\t    \t'chn':'正常大小'\n\t    },\n\t    'fontScaleSmall': {\n\t    \t'en':'Small Size',\n\t    \t'chn':'小号字体'\n\t    },\n\t    'fontScaleXSmall': {\n\t    \t'en':'X Small Size',\n\t    \t'chn':'超小字体'\n\t    },\n\t    'savesuccess':{\n\t    \t'en':'Save successful',\n\t    \t'chn':'保存成功'\n\t    },\n\t    'failsuccess':{\n\t    \t'en':'Save failed',\n\t    \t'chn':'保存失败'\n\t    },\n\t\t'layoutmode':{\n\t    \t'en':'Layout Mode',\n\t    \t'chn':'布局方式'\n\t\t},\n\t\t'outequaldivid':{\n\t\t\t'en':'Divided by the last layer',\n\t\t\t'chn':'外圈均分'\n\t\t},\n\t\t'innerequaldivid':{\n\t\t\t'en':'Divided by the first layer',\n\t\t\t'chn':'内圈均分'\n\t\t},\n\t\t'givenlayer':{\n\t\t\t'en':'Designate',\n\t\t\t'chn':'指定层均分'\n\t\t},\n\t\t'textdirection':{\n\t\t\t'en':'Text Direction',\n\t\t\t'chn':'文字方向'\n\t\t},\n\t\t'textrotate':{\n\t\t\t'en':'Rotate',\n\t\t\t'chn':'旋转'\n\t\t},\n\t\t'textoutside':{\n\t\t\t'en':'Toward the outside',\n\t\t\t'chn':'放射'\n\t\t},\n\t\t'upwards':{\n\t\t\t'en':'Upwards',\n\t\t\t'chn':'正向'\n\t\t},\n\t\t'sectorthickness':{\n\t\t\t'en':'Sector thickness',\n\t\t\t'chn':'扇区宽度'\n\t\t},\n\t\t'thicknessrange':{\n\t\t\t'en':'Range 100~300',\n\t\t\t'chn':'范围 100~300'\n\t\t},\n\t\t'currentfile':{\n\t\t\t'en':\"Current File\",\n\t\t\t'chn':'编辑中'\n\t\t},\n\t\t'uploadsuccess':{\n\t\t\t'en':'Upload successful',\n\t\t\t'chn':'上传成功'\n\t\t},\n\t\t'deletenodeinfo':{\n\t\t\t'en':'Are you sure to delete the node and its child nodes?',\n\t\t\t'chn':'删除节点会删除它的所有子节点，确实要删除吗？'\n\t\t},\n\t\t'exporttdp':{\n\t\t\t'en':'Save as .tdp shared file',\n\t\t\t'chn':'另存为.tdp共享文件'\n\t\t},\n\t\t\"hypertype\":{\n\t\t\t\"en\":\"Type\",\n\t\t\t\"chn\":\"链接类型\"\n\t\t},\n\t\t\"url\":{\n\t\t\t\"en\":\"URL\",\n\t\t\t\"chn\":\"网址\"\n\t\t},\n\t\t\"localfile\":{\n\t\t\t\"en\":\"Local file\",\n\t\t\t\"chn\":\"本地文件\"\n\t\t},\n\t\t\"tiandipan\":{\n\t\t\t\"en\":\"Tianpan or Dipan\",\n\t\t\t\"chn\":\"天地盘\"\n\t\t},\n\t\t\"link\":{\n\t\t\t\"en\":\"Hyperlink\",\n\t\t\t\"chn\":\"链接\"\n\t\t},\n\t\toutlineeditor:{\n\t\t\ten: \"Outline Editor\",\n\t\t\tchn: \"大纲编辑\"\n\t\t},\n\t\tmodificationbuttons: {\n\t\t\ten: \"Modification Buttons\",\n\t\t\tchn: \"修改按钮\"\n\t\t},\n\t\tbrowsingbuttons: {\n\t\t\ten: \"Browsing Buttons\",\n\t\t\tchn: \"浏览按钮\"\n\t\t},\n\t\tshow: {\n\t\t\ten: \"Show\",\n\t\t\tchn: \"显示\"\n\t\t},\n\t\thide: {\n\t\t\ten: \"Hide\",\n\t\t\tchn:\"隐藏\"\n\t\t},\n\t\tnewnode: {\n\t\t\ten: \"New Node\",\n\t\t\tchn: \"新节点\"\n\t\t},\n\t\tmoveupnode: {\n\t\t\ten: \"Move up\",\n\t\t\tchn: \"上移节点\"\n\t\t},\n\t\tmovedownnode: {\n\t\t\ten: \"Move down\",\n\t\t\tchn: \"下移节点\"\n\t\t},\n\t\tremovenode: {\n\t\t\ten: \"Remove\",\n\t\t\tchn: \"删除节点\"\n\t\t},\n\t\teditnode: {\n\t\t\ten: \"Edit Node\",\n\t\t\tchn: \"编辑节点\"\n\t\t},\n\t\tprevnode: {\n\t\t\ten: \"Select Previous\",\n\t\t\tchn: \"上一个节点\"\n\t\t},\n\t\tnextnode: {\n\t\t\ten: \"Select Next\",\n\t\t\tchn: \"下一个节点\"\n\t\t},\n\t\texpandnode: {\n\t\t\ten: \"Expand\",\n\t\t\tchn: \"展开节点\"\n\t\t},\n\t\tcollapsenode: {\n\t\t\ten: \"Collapse\",\n\t\t\tchn: \"折叠节点\"\n\t\t},\n\t\texpandall: {\n\t\t\ten: \"Expand All\",\n\t\t\tchn: \"全部展开\"\n\t\t},\n\t\tcollapseall: {\n\t\t\ten: \"Collapse All\",\n\t\t\tchn: \"全部折叠\"\n\t\t},\n\t\tpreview: {\n\t\t\ten: \"Preview\",\n\t\t\tchn: \"预览\"\n\t\t},\n\t\tcancel: {\n\t\t\ten: \"Cancel\",\n\t\t\tchn: \"取消\"\n\t\t},\n\t\tapply: {\n\t\t\ten: \"Apply\",\n\t\t\tchn: \"应用\"\n\t\t},\n\t\t'openpreviewimg':{\n\t\t\t'en':'Preview image is loading',\n\t\t\t'chn':'正在打开预览图片'\n\t\t},\n\t\t'tempnodetips':{\n\t\t\t'en':'This is a temp node',\n\t\t\t'chn':'这是临时节点'\n\t\t},\n\t\tbuildtdp:{\n\t\t\ten:'Build .tdp shared file',\n\t\t\tchn:'生成.tdp文件下载'\n        },\n\t\t'deleteconfirm':{\n\t\t\ten:'Are you sure to clear all the nodes?',\n\t\t\tchn:'确定要清空节点？'\n\t\t},\n\t\t\"selecttargertnode\": {\n\t\t\ten: \"Select Target Node\",\n\t\t\tcn: \"请选择目标节点\"\n\t\t},\n\t\t\"link2web\": {\n\t\t\ten: \"Link to Webpage\",\n\t\t\tcn: \"链接网页\"\n\t\t},\n\t\t\"link2node\": {\n\t\t\ten: \"Link to Node\",\n\t\t\tcn: \"链接节点\"\n\t\t},\n\t\t\"removelink\": {\n\t\t\ten: \"Remove Link\",\n\t\t\tcn: \"移除节点\"\n\t\t},\n\t\t\"addtemp\": {\n\t\t\ten: \"Add Template\",\n\t\t\tcn: \"添加模板\"\n\t\t},\n\t\tbuildtdp:{\n\t\t\ten:'Build .tdp shared file',\n\t\t\tchn:'生成.tdp文件下载'\n        },\n\t\t'deleteconfirm':{\n\t\t\ten:'Are you sure to clear all the nodes?',\n\t\t\tchn:'确定要清空节点？'\n        },\n\t\tsuccess:{\n        \ten:'Success',\n        \tchn:\"成功\"\n        },\n\t\twarning:{\n        \ten:'Warning',\n        \tchn:'警告'\n        },\n\t\terror:{\n        \ten:'Failed',\n        \tchn:'失败'\n\t\t},\n\t\t\t\t\"unsupportfile\": {\n\t\t\ten: \"Unsupported File!\",\n\t\t\tcn: \"不支持该导入文件\"\n\t\t}\n\t}\n\tvar trans = function(key){\n\t\treturn localization[key] ? (localization[key][localStorage.getItem(\"language\")] ? localization[key][localStorage.getItem(\"language\")] :localization[key]['chn']) : key;\n\t};\n\nmodule.exports = {trans:trans};\n\n\n// WEBPACK FOOTER //\n// ./src/assets/localization.js","// 'use strict';\n\nlet typeModules = {};\nconsole.log(\"hardcorelog   aaaaaaaaaaaaaaa\")\ntypeModules['tianpan'] = require(`./diagram/tianpan`)\ntypeModules['dipan'] = require(`./diagram/dipan`)\ntypeModules['jin'] = require(`./diagram/jin`)\ntypeModules['huo'] = require(`./diagram/huo`)\ntypeModules['shui'] = require(`./diagram/shui`)\ntypeModules['yunpan'] = require(`./diagram/yunpan`)\ntypeModules['wheel'] = require(`./diagram/wheel`)\ntypeModules['dspiral'] = require(`./diagram/dspiral`)\n// typeModules['yunpanhome'] = require(`./diagram/yunpanhome`)\n\n\nif(IS_PROD){\n    console.log(\"生产环境屏蔽调试日志\")\n    // console.log   = function(){\n        \n    // }\n}\n// console.error   = function(...messages){\n//     logger.error(`${JSON.stringify(messages)}`)\n// }\n\nclass Trtd {\n\tconstructor(div, config){\n\n\t\ttry{\n            if(config.model){\n                var tmpModel = go.Model.fromJson(config.model);\n                if(tmpModel && tmpModel.modelData && tmpModel.modelData.type){\n                    config.type = tmpModel.modelData.type\n                }\n            }\n        }catch(e){\n            console.error(e)\n        }\n\t\tconsole.log(\"type:\",config.type)\n\t\tvar trtdClass = typeModules[config.type]\n\t\treturn new trtdClass(div, config);\n\t}\n}\n\nTrtd.go = go;\n/*eslint-disable no-undef */\nTrtd.version = TRTD_VERSION\n/*eslint-enable no-undef */\nconsole.info(`Trtd version:${Trtd.version}`)\nwindow.localStorage.setItem(\"HARDCORE_VERSION\",Trtd.version)\nif (typeof window !== 'undefined') {\n\twindow.Trtd = Trtd;\n}\n\n// export default Trtd;\nmodule.exports = Trtd\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","\r\n/*\r\n*  Copyright (C) 1998-2015 by Northwoods Software Corporation. All Rights Reserved.\r\n*/\r\n\r\n// A custom Layout that lays out a chain of nodes in a spiral\r\n\r\n/**\r\n * @constructor\r\n * @extends Layout\r\n * @class\r\n * This layout assumes the graph is a chain of Nodes,\r\n * {@link #spacing} controls the spacing between nodes.\r\n */\r\n\r\n// 'use strict';\r\n\r\n// import * as go from 'gojs';\r\nvar $ = go.GraphObject.make;\r\nvar tdDebug = false;\r\nvar tdSpacing = 0.7;\r\nvar tdSpiralMode = 'sparse';\r\n\r\nfunction SpiralLayout() {\r\n    go.Layout.call(this);\r\n    this._radius = NaN;\r\n    this._spacing = 10;\r\n    this._clockwise = true;\r\n    this._pointlist = [];\r\n}\r\ngo.Diagram.inherit(SpiralLayout, go.Layout);\r\n\r\n/**\r\n * @ignore\r\n * Copies properties to a cloned Layout.\r\n * @this {SpiralLayout}\r\n * @param {Layout} copy\r\n * @override\r\n */\r\nSpiralLayout.prototype.cloneProtected = function(copy) {\r\n    go.Layout.prototype.cloneProtected.call(this, copy);\r\n\r\n    copy._radius = this._radius;\r\n    copy._spacing = this._spacing;\r\n    copy._clockwise = this._clockwise;\r\n};\r\n\r\n//根据基圆半径和角度参数确定螺旋线上的一个点\r\n//渐开线的参数方程\r\nfunction getInvolutePoint(radius, angle) {\r\n    var cos = Math.cos(angle);\r\n    var sin = Math.sin(angle);\r\n    var x = radius * (cos + angle * sin);\r\n    var y = radius * (sin - angle * cos);\r\n    return new go.Point(x, y);\r\n}\r\n\r\n//检查给定区域是否和nodes内所有节点重叠\r\nfunction checkCoveredWithNodes(rect, nodesRectList) {\r\n    var _cover = false;\r\n\r\n    var it = nodesRectList.iterator;\r\n    while (it.next()) {\r\n\r\n        if (Math.sqrt(rect.point.distanceSquaredPoint(it.value.point)) < (rect.radius + it.value.radius)) {\r\n            //console.log([\" node:\", it.value.node.data.key,'is in the radius ',node.actualBounds.width,' of:',node.data.key].join(\" \"));\r\n            _cover = true;\r\n            break;\r\n        }\r\n    }\r\n    return _cover;\r\n}\r\n\r\n/**\r\n * This method actually positions all of the Nodes, assuming that the ordering of the nodes\r\n * is given by a single link from one node to the next.\r\n * This respects the {@link #spacing} property to affect the layout.\r\n * @this {SpiralLayout}\r\n * @param {Diagram|Group|Iterable} coll the collection of Parts to layout.\r\n */\r\nSpiralLayout.prototype.doLayout = function(coll) {\r\n\r\n\r\n    if (this.network === null) {\r\n        this.network = this.makeNetwork(coll);\r\n    }\r\n    //console.log(\"begin new layout\");\r\n    var root = null;\r\n    var findFlag = false;\r\n    var v;\r\n    // find a root vertex -- one without any incoming edges\r\n    var it = this.network.vertexes.iterator;\r\n    var topNodes = [];\r\n    while (it.next()) {\r\n        //console.log(it.value.node.data.key+\":\"+it.value.node.data.text);\r\n        v = it.value;\r\n        if (!findFlag) {\r\n            if (root === null) root = v; // in case there are only circles\r\n            if (v.sourceEdges.count === 0) {\r\n                root = v;\r\n                findFlag = true;\r\n            }\r\n        } else {\r\n            if (v.sourceEdges.count === 0) {\r\n                topNodes.push(v);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    // couldn't find a root vertex\r\n    if (root === null) {\r\n        this.network = null;\r\n        return;\r\n    }\r\n\r\n    var cw = (this.clockwise ? 1 : -1);\r\n    var rad;\r\n\r\n    var angle = 2.5;\r\n    var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n    // now locate each of the following nodes, in order, along a spiral\r\n    var vert;\r\n    var x, y;\r\n    var _pointlist;\r\n    var _do = true;\r\n    var count = 0; //循环计数\r\n    var res;\r\n    var initialAngle = 5;\r\n    var edge, fromVert, dangle, index, dept, dl, nextedge, nextvert,\r\n        nodesDealed = new go.List(),\r\n        curRect, //当前节点的矩形区域\r\n        newPoint,\r\n        dia,\r\n        distance = 150,\r\n        equaldistance;\r\n    if (tdSpiralMode == 'terse') {\r\n        distance = 20;\r\n    }\r\n    if (tdSpiralMode == 'sparse') {\r\n        distance = 150;\r\n    }\r\n    var tmpR; //计算中间值\r\n    edge = root.destinationEdges.first();\r\n    vert = (edge !== null ? edge.toVertex : null);\r\n\r\n    root.node.rad = rad;\r\n    var childCount = 0;\r\n    var hasGroup = false;\r\n    while (vert !== null) {\r\n        childCount++;\r\n        if (vert.node.data['isGroup']) {\r\n            hasGroup = true;\r\n        }\r\n        nextedge = vert.destinationEdges.first();\r\n        nextvert = (nextedge !== null ? nextedge.toVertex : null);\r\n        edge = nextedge;\r\n        //fromVert = vert;\r\n        vert = nextvert;\r\n    }\r\n    edge = root.destinationEdges.first();\r\n    vert = (edge !== null ? edge.toVertex : null);\r\n\r\n    rad = 1;\r\n    var tmpPoint;\r\n    //找到第一个节点和根节点不相交的rad值\r\n    if (vert) {\r\n        tmpR = vert.node.actualBounds.width;\r\n        //var rootRect = new go.Rect(root.node.location.x - root.node.actualBounds.width / 2, root.node.location.y - root.node.actualBounds.height / 2, root.node.actualBounds.width, root.node.actualBounds.height);\r\n        var radiusDis = root.node.actualBounds.width / 2 + vert.node.actualBounds.width / 2;\r\n        while (true) {\r\n            tmpPoint = getInvolutePoint(rad, initialAngle);\r\n            tmpPoint = new go.Point(tmpPoint.x + root.node.location.x, tmpPoint.y + root.node.location.y);\r\n            if ((Math.sqrt(tmpPoint.distanceSquaredPoint(root.node.location))) > (radiusDis + 10)) { //+10 是为了防止第一个子节点和根节点接壤\r\n                break;\r\n            } else {\r\n                rad += 0.1;\r\n            }\r\n        }\r\n    }\r\n    var adjustAngleCount = 0;\r\n\r\n    while (_do) {\r\n\r\n        count++; //计数\r\n        //初始化参数\r\n        angle = initialAngle;\r\n        edge = root.destinationEdges.first();\r\n        //if (edge !== null && edge.link !== null) edge.link.curviness = rad;\r\n        root.node.data.angle = 0;\r\n        if (edge !== null && edge.link !== null) edge.link.curviness = cw * rad;\r\n        var curviness = edge == null ? 20 : edge.link.curviness;\r\n        // now locate each of the following nodes, in order, along a spiral\r\n        vert = (edge !== null ? edge.toVertex : null);\r\n\r\n        fromVert = root;\r\n        index = 0;\r\n        var angleOld; //增加angle时保留的原始值，用于恢复\r\n        x = 0, y = 0;\r\n        //_pointlist = [];\r\n        // _pointlist.push(root.node.data.key + \":(0,0)\");\r\n        if (vert) vert.node.data.angle = angle;\r\n        nodesDealed.clear();\r\n        //nodesDealed.add(new go.Rect(root.node.location.x - root.node.actualBounds.width / 2, root.node.location.y - root.node.actualBounds.height / 2, root.node.actualBounds.width, root.node.actualBounds.height));\r\n        nodesDealed.add({ point: root.node.location, radius: root.node.actualBounds.width / 2 });\r\n\r\n        //等弧长\r\n        //equaldistance = Math.sqrt(getInvolutePoint(rad, 5 * Math.PI / 2).distanceSquaredPoint(getInvolutePoint(rad, 5 * Math.PI / 2 - tdSpacing)));\r\n\r\n        //equaldistance = Math.sqrt(getInvolutePoint(rad, 5 * Math.PI / 2).distanceSquaredPoint(getInvolutePoint(rad, 5 * Math.PI / 2 - tdSpacing)));\r\n        if (tdSpiralMode == 'terse') {\r\n            equaldistance = Math.sqrt(getInvolutePoint(rad, 5).distanceSquaredPoint(getInvolutePoint(rad, 6)));\r\n        } else {\r\n            equaldistance = Math.sqrt(getInvolutePoint(rad, 5 * Math.PI / 2).distanceSquaredPoint(getInvolutePoint(rad, 5 * Math.PI / 2 - tdSpacing)));\r\n        }\r\n        //重新开始布局节点\r\n        while (vert !== null) {\r\n            index++;\r\n            root.node.data.rad = rad;\r\n            //console.log(vert.node.data.key + \":\" + vert.node.data.text);\r\n            // involute spiral\r\n            //循环判断是否有覆盖，如果覆盖增加基圆半径，重新计算下一个位置\r\n            dangle = 0.4;\r\n            angleOld = angle;\r\n            //for(dangle=0.1;dangle<=0.9;dangle+=0.1){\r\n            for (var i = 0; i <= 20; i++) {\r\n                //圆的渐开线参数方程算出下一个节点位置\r\n                newPoint = getInvolutePoint(rad, angle);\r\n                newPoint = new go.Point(newPoint.x + root.node.location.x, newPoint.y + root.node.location.y);\r\n                x = newPoint.x;\r\n                y = newPoint.y;\r\n\r\n                if (vert.node instanceof go.Group && edge.link.toNode !== vert.node) {\r\n                    var offset = edge.link.toNode.location.copy().subtract(vert.node.location);\r\n                    newPoint.x -= offset.x;\r\n                    newPoint.y -= offset.y;\r\n                }\r\n                //tmpR = vert.node.actualBounds.width / 2 * Math.sqrt(2);\r\n                tmpR = vert.node.actualBounds.width / 2;\r\n                //curRect = new go.Rect(newPoint.x - tmpR/ 2, newPoint.y - tmpR / 2, tmpR, tmpR);\r\n                curRect = { point: newPoint, radius: tmpR };\r\n                res = checkCoveredWithNodes(curRect, nodesDealed);\r\n                //res = checkCovered(vert.node, newPoint, this.network.vertexes,nodesDealed);\r\n                //  //检查覆盖\r\n                if (res) {\r\n                    adjustAngleCount++;\r\n                    if (angle >= fromVert.node.data.angle + Math.PI / 2) {\r\n                        angle = fromVert.node.data.angle + Math.PI / 2;\r\n                        break;\r\n                    }\r\n                    //if (angle <= fromVert.node.data.angle + 0.2) {\r\n                    //  angle = fromVert.node.data.angle + 0.2;\r\n                    //}\r\n                    if (tdSpiralMode != 'equidistant') { //等距模式，不自动调节距离\r\n                        angle = fromVert.node.data.angle + (i + 1) * Math.PI / 16; //加的算法\r\n                        //dia = Math.max(equaldistance,vert.node.actualBounds.width / 2+ nextvert.node.actualBounds.width / 2);\r\n                        dept = cw * Math.atan((vert.node.actualBounds.width / 2 + fromVert.node.actualBounds.width / 2 + distance) / Math.sqrt(vert.node.location.distanceSquaredPoint(root.node.location)));\r\n                        if (angle <= fromVert.node.data.angle + dept) { //保证最小间距\r\n                            angle = fromVert.node.data.angle + dept;\r\n                        }\r\n                    } else {\r\n                        break;\r\n                    }\r\n\r\n                } else {\r\n                    break;\r\n                }\r\n\r\n            }\r\n\r\n            //检查覆盖，如果增加angle的方式没有消除覆盖，则增加半径\r\n            if (res) {\r\n                rad += 1; //加的算法\r\n                //angle = angleOld;\r\n                break; //如果有覆盖，则增加基圆半径，保证没有覆盖\r\n                //console.log(\"rad:\"+rad);\r\n            }\r\n\r\n            nextedge = vert.destinationEdges.first();\r\n            nextvert = (nextedge !== null ? nextedge.toVertex : null);\r\n\r\n            vert.centerX = newPoint.x;\r\n            vert.centerY = newPoint.y;\r\n            vert.node.data.angle = angle;\r\n\r\n            edge.link.data.unautoLink = false;\r\n            edge.link.rad = rad;\r\n            edge.link.angle1 = fromVert.node.data.angle;\r\n            edge.link.angle2 = vert.node.data.angle;\r\n\r\n            var equalSpiral = false;\r\n            if ('0512' == '0512') {\r\n                //角度小于一圈，且节点个数小于等于4个时，为了优化线条，节点间距离拉大，节点距离通过angle控制\r\n                //if (childCount <= 6  ) {\r\n                if (tdSpiralMode != 'terse') { //紧凑模式下，不自动调节节点\r\n                    if (childCount <= 6) {\r\n                        if (childCount * 1.3 < 3 * Math.PI / 2 && !hasGroup) {\r\n                            angle += Math.min((3 * Math.PI / 2 / childCount), Math.PI / 2);\r\n                        } else {\r\n                            if (vert.node.data[\"isGroup\"]) {\r\n                                equalSpiral = true;\r\n                            } else {\r\n                                angle += 1.3;\r\n                            }\r\n\r\n                        }\r\n                        //angle += 0.9;\r\n                    } else { //角度大于一圈，时等间距\r\n                        equalSpiral = true;\r\n                    }\r\n                } else {\r\n                    equalSpiral = true;\r\n                }\r\n\r\n                if (equalSpiral) {\r\n                    if (nextvert == null) {\r\n                        dia = equaldistance;\r\n                        dept = cw * Math.atan((dia + distance) / Math.sqrt(newPoint.distanceSquaredPoint(root.node.location))); //why?\r\n                    } else {\r\n                        dia = Math.max(equaldistance, vert.node.actualBounds.width / 2 + nextvert.node.actualBounds.width / 2);\r\n                        dept = cw * Math.atan((dia + distance) / Math.sqrt(newPoint.distanceSquaredPoint(root.node.location))); //why?\r\n                    }\r\n                    angle += dept;\r\n                }\r\n            }\r\n\r\n            tmpR = vert.node.actualBounds.width;\r\n            nodesDealed.add(curRect);\r\n            //nodesDealed.add({point:new go.Point(vert.centerX, vert.centerY), radius:vert.node.actualBounds.width/2});\r\n            edge = nextedge;\r\n            fromVert = vert;\r\n            vert = nextvert;\r\n        }\r\n\r\n        if (vert == null) {\r\n            _do = false;\r\n        }\r\n    }\r\n\r\n    // console.log(root.node.data.key + \":total compute layout times:\" + count);\r\n    this.updateParts();\r\n\r\n    this.network = null;\r\n    if (tdDebug) {\r\n        console.log(\"spiral dolayout end \" + root.node.data.key);\r\n    }\r\n};\r\n\r\nSpiralLayout.prototype.commitLayout = function() {\r\n    this.network.vertexes.each(function(v) {\r\n        v.commit();\r\n    });\r\n    this.network.edges.each(function(v) {\r\n        v.commit();\r\n    });\r\n    if (tdDebug) {\r\n        console.log(\"spiral layout end \");\r\n    }\r\n    //this.invalidateLayout();\r\n};\r\n\r\n/**\r\n * @ignore\r\n * Compute the effective diameter of a Node.\r\n * @this {SpiralLayout}\r\n * @param {LayoutVertex} v\r\n * @return {number}\r\n */\r\nSpiralLayout.prototype.diameter = function(v) {\r\n    if (!v) return 0;\r\n    var b = v.bounds;\r\n    return Math.sqrt(b.width * b.width / 4 + b.height * b.height / 4);\r\n};\r\n\r\n/**\r\n * Gets or sets the radius distance.\r\n * The default value is NaN.\r\n * @name SpiralLayout#radius\r\n * @function.\r\n * @return {number}\r\n */\r\n\r\nObject.defineProperty(SpiralLayout.prototype, \"radius\", {\r\n    get: function() { return this._radius; },\r\n    set: function(val) {\r\n        if (typeof val !== \"number\") throw new Error(\"new value for SpiralLayout.radius must be a number, not: \" + val);\r\n        if (this._radius !== val) {\r\n            this._radius = val;\r\n            this.invalidateLayout();\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n * Gets or sets the spacing between nodes.\r\n * The default value is 100.\r\n * @name SpiralLayout#spacing\r\n * @function.\r\n * @return {number}\r\n */\r\nObject.defineProperty(SpiralLayout.prototype, \"spacing\", {\r\n    get: function() { return this._spacing; },\r\n    set: function(val) {\r\n        if (typeof val !== \"number\") throw new Error(\"new value for SpiralLayout.spacing must be a number, not: \" + val);\r\n        if (this._spacing !== val) {\r\n            this._spacing = val;\r\n            this.invalidateLayout();\r\n        }\r\n    }\r\n});\r\n\r\nfunction computeOffset(newR, newStartAngle) {\r\n    //console.log(\"newStartAngle:\"+newStartAngle);\r\n    var ctl2, dy, dx; //需要调整\r\n    if (newStartAngle >= 0 && newStartAngle <= 90) {\r\n        dy = newR * Math.sin(newStartAngle * Math.PI / 180);\r\n        dx = newR * Math.cos(newStartAngle * Math.PI / 180);\r\n        return [dx, dy];\r\n    } else if (newStartAngle > 90 && newStartAngle <= 180) {\r\n        dy = newR * Math.sin((180 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((180 - newStartAngle) * Math.PI / 180);\r\n        return [-dx, dy];\r\n    } else if (newStartAngle > 180 && newStartAngle <= 270) {\r\n        dy = newR * Math.sin((newStartAngle - 180) * Math.PI / 180);\r\n        dx = newR * Math.cos((newStartAngle - 180) * Math.PI / 180);\r\n        return [-dx, -dy];\r\n    } else if (newStartAngle > 270 && newStartAngle <= 360) {\r\n        dy = newR * Math.sin((360 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((360 - newStartAngle) * Math.PI / 180);\r\n        return [dx, -dy];\r\n    }\r\n}\r\n\r\nfunction computeControlPoint(p1, p2, p3) {\r\n\r\n    var result;\r\n    result = arguments[3] ? arguments[3] : triangleCircle(p1, p2, p3);\r\n    var radius = result[0];\r\n    var cent = new go.Point(result[1], result[2]);\r\n\r\n    //起始节点的弧度\r\n    var sweep = Math.abs(cent.directionPoint(p1) - cent.directionPoint(p3));\r\n    sweep = sweep > 180 ? 360 - sweep : sweep;\r\n    //console.log(\"sweep:\"+sweep);\r\n    var newR = radius / Math.cos(sweep / 3 * Math.PI / 180);\r\n    var geo = new go.Geometry(go.Geometry.Line);\r\n    geo.startX = cent.x;\r\n    geo.startY = cent.y;\r\n    geo.endX = p1.x;\r\n    geo.endY = p1.y;\r\n    geo.rotate(sweep / 3, cent.x, cent.y); //相对圆心旋转3分之1弧度\r\n    var newStartAngle = cent.direction(geo.endX, geo.endY);\r\n    var ctl1;\r\n    result = computeOffset(newR, newStartAngle);\r\n    ctl1 = cent.copy().offset(result[0], result[1]);\r\n\r\n    geo.rotate(sweep / 3, cent.x, cent.y); //相对圆心旋转3分之1弧度\r\n    newStartAngle = cent.direction(geo.endX, geo.endY);\r\n\r\n    var ctl2; //需要调整\r\n    result = computeOffset(newR, newStartAngle);\r\n    ctl2 = cent.copy().offset(result[0], result[1]);\r\n\r\n    return [ctl1, ctl2];\r\n}\r\n\r\n/**\r\n * Gets or sets whether the spiral should go clockwise or counter-clockwise.\r\n * The default value is true.\r\n * @name SpiralLayout#clockwise\r\n * @function.\r\n * @return {boolean}\r\n */\r\nObject.defineProperty(SpiralLayout.prototype, \"clockwise\", {\r\n    get: function() { return this._clockwise; },\r\n    set: function(val) {\r\n        if (typeof val !== \"boolean\") throw new Error(\"new value for SpiralLayout.clockwise must be a boolean, not: \" + val);\r\n        if (this._clockwise !== val) {\r\n            this._clockwise = val;\r\n            this.invalidateLayout();\r\n        }\r\n    }\r\n});\r\n\r\n/**\r\n 处理：如三点共线，则返回false；否则，返回true，并将计算得到的圆心与半径存放在center和radius众返回。\r\n    */\r\nfunction triangleCircle(p1, p2, p3) {\r\n    //检查三点是否共线\r\n    if (isThreePointsOnOneLine(p1, p2, p3))\r\n        return false;\r\n\r\n    var x1, x2, x3, y1, y2, y3, radius;\r\n\r\n    x1 = p1.x;\r\n    x2 = p2.x;\r\n    x3 = p3.x;\r\n    y1 = p1.y;\r\n    y2 = p2.y;\r\n    y3 = p3.y;\r\n\r\n    //求外接圆半径\r\n    var a = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n    var b = Math.sqrt((x1 - x3) * (x1 - x3) + (y1 - y3) * (y1 - y3));\r\n    var c = Math.sqrt((x2 - x3) * (x2 - x3) + (y2 - y3) * (y2 - y3));\r\n    var p = (a + b + c) / 2;\r\n    var S = Math.sqrt(p * (p - a) * (p - b) * (p - c));\r\n    radius = a * b * c / (4 * S);\r\n\r\n    //求外接圆圆心\r\n    var t1 = x1 * x1 + y1 * y1;\r\n    var t2 = x2 * x2 + y2 * y2;\r\n    var t3 = x3 * x3 + y3 * y3;\r\n    var temp = x1 * y2 + x2 * y3 + x3 * y1 - x1 * y3 - x2 * y1 - x3 * y2;\r\n    var x = (t2 * y3 + t1 * y2 + t3 * y1 - t2 * y1 - t3 * y2 - t1 * y3) / temp / 2;\r\n    var y = (t3 * x2 + t2 * x1 + t1 * x3 - t1 * x2 - t2 * x3 - t3 * x1) / temp / 2;\r\n\r\n\r\n    var result = [];\r\n    result = [radius, x, y];\r\n    return result;\r\n}\r\n\r\n/**\r\n 判断3个点是否共线\r\n    */\r\nfunction isThreePointsOnOneLine(p1, p2, p3) {\r\n    return false;\r\n}\r\n\r\n\r\nmodule.exports = SpiralLayout;\n\n\n// WEBPACK FOOTER //\n// ./src/layout/SpiralLayout.js","//\n\nvar $ = go.GraphObject.make;\nvar Base = require(\"./base\");\nvar helpers = require(\"../helpers/helpers.gojs\");\n\n// this is a Part.dragComputation function for limiting where a Node may be dragged\nfunction stayInGroup(part, pt, gridpt) {\n  // don't constrain top-level nodes\n  var grp = part.containingGroup;\n  if (grp === null) return pt;\n  // try to stay within the background Shape of the Group\n  var back = grp.resizeObject;\n  if (back === null) return pt;\n  // allow dragging a Node out of a Group if the Shift key is down\n  if (part.diagram.lastInput.shift) return pt;\n  var p1 = back.getDocumentPoint(go.Spot.TopLeft);\n  var p2 = back.getDocumentPoint(go.Spot.BottomRight);\n  var b = part.actualBounds;\n  var loc = part.location;\n  // find the padding inside the group's placeholder that is around the member parts\n  // var m = grp.placeholder.padding;\n  // now limit the location appropriately\n  var x = Math.max(p1.x, Math.min(pt.x, p2.x - b.width - 1)) + (loc.x - b.x);\n  var y = Math.max(p1.y, Math.min(pt.y, p2.y - b.height - 1)) + (loc.y - b.y);\n  return new go.Point(x, y);\n}\n\nclass WaveNodeTemplate extends Base {\n  constructor(options) {\n    super(options);\n    // this.nodeProperties = {}\n  }\n\n  makeGeo(data, shape, options) {\n    // this is much more efficient than calling go.GraphObject.make:\n    var { radiusX = 150, radiusY = 100 } = data;\n    radiusX = shape.part.findObject(\"main\").width / 2;\n    radiusY = shape.part.findObject(\"main\").height / 2;\n    // console.log(\"makeGeo999999999999999999999999999\",radiusX,radiusY)\n    var geo = new go.Geometry().add(\n      new go.PathFigure(0, 0) // start point\n        .add(\n          new go.PathSegment(\n            go.PathSegment.SvgArc,\n            radiusX * 2,\n            0,\n            radiusX,\n            radiusY,\n            0,\n            1,\n            options.clockwiseFlag ? 1 : 0\n          )\n        )\n    );\n    geo.defaultStretch = go.GraphObject.Fill;\n    return geo;\n  }\n\n  makeGeoWave(data, shape, options) {\n    // this is much more efficient than calling go.GraphObject.make:\n    var { radiusX = 150, radiusY = 100 } = data;\n    radiusX = shape.part.findObject(\"main\").width / 2;\n    radiusY = shape.part.findObject(\"main\").height / 2;\n    // console.log(\"makeGeo999999999999999999999999999\",radiusX,radiusY)\n    var seg = new go.PathSegment(\n      go.PathSegment.QuadraticBezier,\n      radiusX * 2,\n      0, //describe the end point\n      radiusX,\n      radiusY * (options.clockwiseFlag ? -1 : 1) // describe the only control point\n      // radiusX*2,0,radiusX, radiusY,0,1,options.clockwiseFlag?1:0\n    );\n\n    if (data.role == \"waveTail\") {\n      seg = new go.PathSegment(\n        go.PathSegment.QuadraticBezier,\n        radiusX,\n        radiusY * (options.clockwiseFlag ? -1 : 1), //describe the end point\n        radiusX / 2,\n        radiusY * (options.clockwiseFlag ? -1 : 1) // describe the only control point\n        // radiusX*2,0,radiusX, radiusY,0,1,options.clockwiseFlag?1:0\n      );\n\n      // seg = new go.PathSegment(go.PathSegment.Bezier,\n      //   radiusX, radiusY*(options.clockwiseFlag?-1:1), //describe the end point\n      //   x1, y1 ,//describe the first control point\n      //   x2, y2, // describe the second control point\n      //   radiusX, radiusY*(options.clockwiseFlag?-1:1), // describe the only control point\n      // // radiusX*2,0,radiusX, radiusY,0,1,options.clockwiseFlag?1:0\n      //     )\n    }\n\n    // seg.endX = radiusX\n    // seg.endY = 0\n    var geo = new go.Geometry().add(\n      new go.PathFigure(0, 0) // start point\n        .add(seg)\n    );\n    geo.defaultStretch = go.GraphObject.None;\n    return geo;\n  }\n\n  getShiHalfEllipseShape() {\n    return $(\n      go.Shape,\n      {\n        name: \"XU\",\n        strokeWidth: 2,\n        stroke: \"#cb1c27\",\n        fill: \"rgba(0,66,0,0)\",\n        // background: \"yellow\",\n        stretch: go.GraphObject.Uniform,\n        alignment: go.Spot.Bottom,\n        alignmentFocus: go.Spot.Bottom\n        // row:1, column:0,margin:0\n      },\n      // new go.Binding(\"alignment\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      new go.Binding(\"geometry\", \"\", (data, shape) => {\n        var clockwiseFlag = 0;\n        if (data.order % 2 == 0) {\n          clockwiseFlag = 1;\n        }\n        if (data.flip) {\n          // clockwiseFlag = 1;\n        }\n        // console.log(`data.oliveType: ${data.oliveType}`)\n        if (data.oliveType == \"Ellipse\") {\n          // console.log(``)\n          return this.makeGeo(data, shape, { clockwiseFlag: clockwiseFlag });\n        }\n        return this.makeGeoWave(data, shape, { clockwiseFlag: clockwiseFlag });\n      }),\n      new go.Binding(\"stroke\", \"shiStroke\").makeTwoWay(),\n      new go.Binding(\"strokeWidth\", \"shiStrokeWidth\").makeTwoWay(),\n      // new go.Binding(\"strokeDashArray\", \"shiStrokeDashArray\").makeTwoWay(),\n      new go.Binding(\"strokeDashArray\", \"shiStrokeDashArray\", function(v) {\n        return JSON.parse(v);\n      }).makeTwoWay(function(v) {\n        return JSON.stringify(v);\n      }),\n      new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\n        var size = new go.Size(v.width, v.height / 2);\n        // console.log(\"v:\",v)\n        return size;\n      }).ofObject(\"main\")\n    );\n  }\n\n  getXuHalfEllipseShape() {\n    return $(\n      go.Shape,\n      {\n        name: \"SHI\",\n        strokeWidth: 2,\n        stroke: \"#0e399d\",\n        fill: \"rgba(0,66,0,0)\",\n        // background: \"gray\",\n        stretch: go.GraphObject.Uniform,\n        alignment: go.Spot.Bottom,\n        strokeDashArray: [10, 5],\n        alignmentFocus: go.Spot.Bottom\n        // row:1, column:0,margin:0\n      },\n      // new go.Binding(\"alignment\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      new go.Binding(\"geometry\", \"\", (data, shape) => {\n        var clockwiseFlag = 1;\n        if (data.order % 2 == 0) {\n          clockwiseFlag = 0;\n        }\n        // if(data.flip){\n        //   clockwiseFlag = 0;\n        // }\n        // console.log(`data.oliveType1: ${data.oliveType}`)\n        if (data.oliveType == \"Ellipse\") {\n          // console.log(`data.oliveType2: ${data.oliveType}`)\n          return this.makeGeo(data, shape, { clockwiseFlag: clockwiseFlag });\n        }\n        // console.log(`data.oliveType3: ${data.oliveType}`)\n        return this.makeGeoWave(data, shape, { clockwiseFlag: clockwiseFlag });\n      }),\n      new go.Binding(\"stroke\", \"xuStroke\").makeTwoWay(),\n      new go.Binding(\"strokeWidth\", \"xuStrokeWidth\").makeTwoWay(),\n      // new go.Binding(\"strokeDashArray\", \"xuStrokeDashArray\").makeTwoWay(),\n      new go.Binding(\"strokeDashArray\", \"xuStrokeDashArray\", function(v) {\n        return JSON.parse(v);\n      }).makeTwoWay(function(v) {\n        return JSON.stringify(v);\n      }),\n      new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\n        var size = new go.Size(v.width, v.height / 2);\n        // console.log(\"v:\",v)\n        return size;\n      }).ofObject(\"main\")\n    );\n  }\n\n  getTailShiShape() {\n    return $(\n      go.Shape,\n      {\n        name: \"XU\",\n        strokeWidth: 2,\n        stroke: \"#cb1c27\",\n        fill: \"rgba(0,66,0,0)\",\n        // background: \"yellow\",\n        stretch: go.GraphObject.None,\n        alignment: go.Spot.Bottom,\n        alignmentFocus: go.Spot.Bottom\n        // row:1, column:0,margin:0\n      },\n      // new go.Binding(\"alignment\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      new go.Binding(\"geometry\", \"\", (data, shape) => {\n        var clockwiseFlag = 0;\n        if (data.order % 2 == 0) {\n          clockwiseFlag = 1;\n        }\n        if (data.flip) {\n          // clockwiseFlag = 1;\n        }\n\n        return this.makeGeoWave(data, shape, { clockwiseFlag: !clockwiseFlag });\n      }),\n      new go.Binding(\"stroke\", \"shiStroke\").makeTwoWay(),\n\n      new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\n        var size = new go.Size(v.width, v.height / 2);\n        // console.log(\"v:\",v)\n        return size;\n      }).ofObject(\"main\")\n    );\n  }\n\n  getTailXuShape() {\n    return $(\n      go.Shape,\n      {\n        name: \"TailXu\",\n        strokeWidth: 2,\n        stroke: \"#0e399d\",\n        fill: \"rgba(0,66,0,0)\",\n        // background: \"gray\",\n        stretch: go.GraphObject.None,\n        alignment: go.Spot.Bottom,\n        strokeDashArray: [10, 5],\n        alignmentFocus: go.Spot.Bottom\n        // row:1, column:0,margin:0\n      },\n      // new go.Binding(\"alignment\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\n      //   if(data.flip){\n      //     return go.Spot.Top\n      //   }\n      //   return go.Spot.Bottom\n      // }),\n      new go.Binding(\"geometry\", \"\", (data, shape) => {\n        var clockwiseFlag = 1;\n        if (data.order % 2 == 0) {\n          clockwiseFlag = 0;\n        }\n        // if(data.flip){\n        //   clockwiseFlag = 0;\n        // }\n        return this.makeGeoWave(data, shape, { clockwiseFlag: !clockwiseFlag });\n      }),\n      new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\n        var size = new go.Size(v.width, v.height / 2);\n        // console.log(\"v:\",v)\n        return size;\n      }).ofObject(\"main\")\n    );\n  }\n\n  getTextBuild() {\n    return $(\n      go.TextBlock,\n      {\n        name: \"TEXT\",\n        alignment: new go.Spot(0.5, 0.4),\n        font: \"18px 'Microsoft YaHei'\",\n        editable: false,\n        // flip:go.GraphObject.FlipHorizontal,\n        //margin: 3, editable: true,\n        // background: \"gray\",\n        angle: 0,\n        stroke: \"black\",\n        isMultiline: true,\n        textEdited: function(textBlock, oldv, newv) {\n          // if(textBlock.part.containingGroup.data.textAngle == \"horizontal\"){\n          var centerText = textBlock.part.diagram.model.findNodeDataForKey(\n            textBlock.part.data.centerText\n          );\n          if (centerText) {\n            console.log(\"centerTextcenterTextcenterTextcenterText\");\n            textBlock.part.diagram.model.startTransaction(\"text\");\n            textBlock.part.diagram.model.setDataProperty(\n              centerText,\n              \"text\",\n              newv\n            );\n            textBlock.part.diagram.model.commitTransaction(\"text\");\n          }\n          //   return;\n          // }\n          setTimeout(function() {\n            console.log(\"textEditedtextEditedtextEdited\", textBlock.lineCount);\n            if (!textBlock.text) return;\n            if (textBlock.text && textBlock.text.trim() == \"\") return;\n            if (textBlock.lineCount % 2 != 0) {\n              if (newv[newv.length - 1] == \"\\n\") {\n                textBlock.text = newv.substring(0, newv.length - 1);\n                return;\n              }\n              textBlock.text = newv + \"\\n\";\n            }\n          }, 100);\n\n          var enterCount = 0;\n          textBlock.part.containingGroup.layout.isValidLayout = false;\n          // for(var i=0;i<newv.length;i++){\n\n          // }\n          // textBlock.part.updateTargetBindings()\n\n          // if(textBlock.lineCount %2 != 0){\n          //   if(newv[newv.length-1] == \"\\n\"){\n          //     textBlock.text = newv.substring(0, newv.length-1)\n          //     return;\n          //   }\n          //   textBlock.text = newv+\"\\n\"\n          // }\n        },\n        overflow: go.TextBlock.OverflowClip,\n        wrap: go.TextBlock.WrapDesiredSize,\n        textAlign: \"center\",\n        spacingAbove: 4,\n        spacingBelow: 4,\n        portId: \"TEXT\",\n        stretch: go.GraphObject.Uniform\n      },\n      new go.Binding(\"visible\", \"textVisible\").makeTwoWay(),\n      new go.Binding(\"alignment\", \"\", function(v, textBlock) {\n        // console.log('textBlock', textBlock.lineCount)\n        // if(textBlock.lineCount%2 == 0){\n        //   return new go.Spot(0.5,0.5)\n        // }\n        return new go.Spot(0.5, 0.5);\n      }),\n      new go.Binding(\"textAlign\", \"textAlign\", function(v) {\n        // return ['start', 'center', 'end'].indexOf(v)>-1 ? v : \"center\";\n        return v;\n      }).makeTwoWay(),\n      new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\n        return helpers.tdTransToNum(v, 4);\n      }).makeTwoWay(),\n      new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\n        return helpers.tdTransToNum(v, 4);\n      }).makeTwoWay(),\n      new go.Binding(\"width\", \"width\", function(v) {\n        return v - 30;\n      }).ofObject(\"main\"),\n      // new go.Binding(\"height\", \"height\", function (v) {\n      //   return v;\n      // }).ofObject(\"SHAPE\"),\n      new go.Binding(\"text\", \"text\", function(text, d) {\n        // console.log(\"d.lineCount,d.lineCountd.lineCount\",text,d.lineCount)\n        // setTimeout(function(){\n        //   if(d && d.lineCount!=null && d.lineCount%2 != 0){\n        //     if(text && text[text.length-1] != \"\\n\"){\n        //       d.text+=\"\\n\"\n        //     }\n        //   }\n        // },100)\n        // setTimeout(function(){\n        //   try{\n        //     console.log(\"check overflow\")\n        //     if(!d.text) return;\n        //     if(d.text && d.text.trim() == \"\") return;\n        //     if(d.lineCount %2 != 0){\n        //       if(d.text[d.text.length-1] == \"\\n\"){\n        //         d.text = d.text.substring(0, d.text.length-1)\n        //         return;\n        //       }\n        //       d.text = d.text+\"\\n\"\n        //     }\n        //     // if(d && d.lineCount!=null && d.lineCount%2 != 0){\n        //     //   if(d.text && d.text[d.text.length-1] != \"\\n\"){\n        //     //     d.text+=\"\\n\"\n        //     //   }\n        //     // }\n        //   }catch(e){\n        //     console.error(e)\n        //   }\n        // },100)\n        return text;\n        // console.log(\"sdfsdfsdfsdfsdfdsfdsfsd\")\n        console.log(text, \":\", d.lineCount);\n        if (d.lineCount % 2 != 0) {\n          return text + \"\\n\";\n        } else {\n          return text;\n        }\n      }).makeTwoWay(function(text, d) {\n        console.log(\"text write write\", d.lineCount);\n        return text;\n        if (d.lineCount % 2 != 0) {\n          return text + \"\\n\";\n        } else {\n          return text;\n        }\n      }),\n      new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\n      new go.Binding(\"font\", \"font\").makeTwoWay()\n    );\n  }\n\n  getNodeSelectionAdornmentTemplate() {\n    return $(\n      go.Adornment,\n      \"Spot\",\n      {\n        // isShadowed: true,\n      },\n      $(\n        go.Panel,\n        \"Auto\",\n        $(\n          go.Shape,\n          {\n            isPanelMain: true,\n            fill: null,\n            stroke: \"dodgerblue\",\n            strokeWidth: 3\n          }\n          // new go.Binding(\"fill\",\"\",function(e,obj){\n          //   var radBrush = $(go.Brush, \"Radial\", { 0: \"rgba(248,248,242,0)\", 1: 'RGB(255,242,0)' });\n          //   return radBrush;\n          // })\n          //\n        ),\n        $(go.Placeholder) // this represents the selected Node\n      ),\n\n      // ),\n      // the button to create a \"next\" node, at the top-right corner\n      $(\n        \"CircleButton\",\n        {\n          name: \"AddChild\",\n          toolTip: $(\n            go.Adornment,\n            \"Auto\",\n            $(go.Shape, { fill: \"#FFFFCC\" }),\n            $(\n              go.TextBlock,\n              { textAlign: \"center\", margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\n              new go.Binding(\"text\", \"\", function(d) {\n                return \"增加橄榄\";\n              })\n            )\n          ),\n          alignment: go.Spot.Right,\n          alignmentFocus: go.Spot.Left,\n          width: 50,\n          height: 50,\n          click: function(e) {\n            e.diagram.__trtd.addOlive();\n          } // this function is defined below\n        },\n        $(go.Shape, \"PlusLine\", {\n          stroke: \"#770077\",\n          desiredSize: new go.Size(25, 25)\n        })\n      ),\n      $(\n        \"CircleButton\",\n        {\n          name: \"RemoveChild\",\n          toolTip: $(\n            go.Adornment,\n            \"Auto\",\n            $(go.Shape, { fill: \"#FFFFCC\" }),\n            $(\n              go.TextBlock,\n              { textAlign: \"center\", margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\n              new go.Binding(\"text\", \"\", function(d) {\n                return \"删除橄榄\";\n              })\n            )\n          ),\n          alignment: go.Spot.Left,\n          alignmentFocus: go.Spot.Right,\n          width: 50,\n          height: 50,\n          click: function(e) {\n            e.diagram.__trtd.deleteSelection();\n          } // this function is defined below\n        },\n        $(go.Shape, \"MinusLine\", {\n          stroke: \"#770077\",\n          desiredSize: new go.Size(25, 25)\n        })\n      ),\n      $(\n        \"Button\",\n        {\n          name: \"AddLevel\",\n          toolTip: $(\n            go.Adornment,\n            \"Auto\",\n            $(go.Shape, { fill: \"#FFFFCC\" }),\n            $(\n              go.TextBlock,\n              { textAlign: \"center\", margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\n              new go.Binding(\"text\", \"\", function(d) {\n                return \"增加同级节点\";\n              })\n            )\n          ),\n          alignment: new go.Spot(1, 0.5, 15, 0),\n          width: 30,\n          height: 30,\n          click: function(e) {\n            e.diagram.__trtd.addOlive();\n          } // this function is defined below\n        },\n        $(go.Shape, \"PlusLine\", {\n          stroke: \"#227700\",\n          desiredSize: new go.Size(15, 15)\n        }),\n        new go.Binding(\"visible\", \"level\", function(level) {\n          return level != 0; // hidden this button if current node is root node\n        })\n      )\n      // $(go.Panel, \"Auto\", {        // 放大镜\n      //         name: \"ButtonIcon1\",\n      //         alignment: new go.Spot(0, 1, 5, -5),\n      //         //alignment: go.Spot.BottomLeft,\n      //         //alignmentFocus: go.Spot.BottomLeft,\n      //         width: 60,\n      //         height: 60,\n      //         isActionable: true,\n      //         click: expandCollapse // this function is defined below\n      //     },\n\n      //     $(go.Shape, \"Circle\", {\n      //         fill: \"rgba(1,1,1,0)\",\n      //         strokeWidth: 0,\n      //         stroke: \"green\",\n      //         width: 50,\n      //         height: 50\n      //     }),\n      //     $(go.Shape, {\n      //             '_para1': true,\n      //             name: \"ButtonIcon\",\n      //             fill: \"red\",\n      //             strokeWidth: 2,\n      //             stroke: \"#767678\",\n      //             geometryString: icons[\"zoomout\"], // default value for isTreeExpanded is true\n      //             desiredSize: new go.Size(30, 30)\n      //         },\n      //         new go.Binding(\"geometryString\", \"\", function(d, button) {\n      //             // console.log('dddddd:', d);\n      //             // console.log('button:', button);\n      //             // var myDiagram = d.diagram;\n      //             // var node = myDiagram.selection.first();\n      //             // if (node[\"_controlExpand\"]) {\n      //             //     return icons[\"zoomout\"];\n      //             // } else {\n      //             //     return icons[\"zoomin\"];\n      //             // }\n      //             return icons[\"zoomin\"];\n      //         })\n      //     )\n      // )\n    );\n  }\n\n  nodeResizeAdornmentTemplate() {\n    return $(\n      go.Adornment,\n      \"Spot\",\n      $(go.Placeholder), // takes size and position of adorned object\n      // $(go.Shape, \"Circle\", // left resize handle\n      //     {\n      //         alignment: go.Spot.TopLeft,\n      //         alignmentFocus: go.Spot.BottomRight,\n      //         cursor: \"col-resize\",\n      //         desiredSize: new go.Size(30, 30),\n      //         fill: \"lightblue\",\n      //         stroke: \"dodgerblue\"\n      //     }),\n      $(\n        go.Shape,\n        \"Circle\", // right resize handle\n        {\n          alignment: go.Spot.BottomRight,\n          alignmentFocus: go.Spot.TopLeft,\n          cursor: \"col-resize\",\n          desiredSize: new go.Size(30, 30),\n          fill: \"lightblue\",\n          stroke: \"dodgerblue\"\n        }\n      )\n    );\n  }\n\n  getNodeTemplate() {\n    var diagram = this.diagram;\n    var that = this;\n    return $(\n      go.Node,\n      \"Spot\",\n      {\n        // isClipping: true,\n        __trtdNode: that,\n        layerName: \"overflow\",\n        zOrder: 5,\n        // copyable: false,\n        // dragComputation: stayInGroup,\n        movable: true,\n        resizable: false,\n        // locationObjectName: \"main\",\n        resizeObjectName: \"main\",\n        selectionObjectName: \"main\",\n        rotatable: false,\n        toolTip: that.getTooTip(),\n        resizeAdornmentTemplate: that.nodeResizeAdornmentTemplate(),\n        layoutConditions:\n          ~go.Part.LayoutStandard &\n          go.Part.LayoutRemoved &\n          go.Part.LayoutAdded &\n          go.Part.LayoutNodeSized,\n        locationSpot: go.Spot.LeftCenter,\n        \n        // toolTip:  // define a tooltip for each node that displays the color as text\n        // $(go.Adornment, \"Spot\",\n        //   $(go.TextBlock, { margin: 4 },\n        //     new go.Binding(\"text\", \"\", function(data,p){\n        //       // console.log(\"tooltip:\",p,data)\n        //       var tips = [\"双击编辑文字\",\"尝试按方向键快捷移动到下一个对象\",\"按回车键增加橄榄\"]\n        //       var isPhone = helpers.checkPhone()\n        //       if(isPhone){\n        //         return \"\"\n        //       }\n        //       var elt = Math.floor(tips.length * Math.random())\n        //       return tips[elt]\n        //     })\n        //   )\n        // ),  // end of Adornment\n        click: (e, node) => {\n          console.log(node.data);\n          if (!node.containingGroup) return;\n          var it = node.containingGroup.findSubGraphParts().iterator;\n          while (it.next()) {\n            var n = it.value;\n            if (\n              n.data.category == \"autoText\" &&\n              (n.data.role == \"xuText\" || n.data.role == \"shiText\")\n            ) {\n              if (n.data.order == node.data.order) {\n                // locateNode = n;\n                if (n.data.text == \"\" || n.data.text.trim() == \"\") {\n                  n.findObject(\"textBorder\").visible = true;\n                }\n                //   n.areaBackground = \"mediumslateblue\"\n              } else {\n                n.findObject(\"textBorder\").visible = false;\n              }\n            }\n          }\n        },\n        mouseOver: function(e, node) {\n          // if(node.data.hyperlink){\n          //   var textObj = node.findObject('TEXT');\n          //   textObj.isUnderline = true;\n          // }\n          if (!node.containingGroup) return;\n          // var it = node.containingGroup.findSubGraphParts().iterator;\n          // while (it.next()) {\n          //     var n = it.value;\n          //     if(n.data.category == \"autoText\"){\n          //         if(n.data.order == node.data.order){\n          //             // locateNode = n;\n          //             if(n.data.text == \"\" || n.data.text.trim() == \"\"){\n          //               n.findObject(\"textBorder\").visible = true;\n          //             }\n          //           //   n.areaBackground = \"mediumslateblue\"\n          //         }\n          //     }\n          // }\n\n          var shiText = node.diagram.findNodeForKey(node.data.shiText);\n          if (shiText) {\n            shiText.findObject(\"textBorder\").visible = true;\n          }\n          var xuText = node.diagram.findNodeForKey(node.data.xuText);\n          if (xuText) {\n            xuText.findObject(\"textBorder\").visible = true;\n          }\n          var centerText = node.diagram.findNodeForKey(node.data.centerText);\n          if (centerText) {\n            centerText.layerName = \"Background\";\n          }\n\n          // diagram.__trtd.showNodeRemarkTips(e, node);\n        },\n        contextMenu: $(go.Adornment),\n\n        mouseDragEnter: function(e, obj) {\n          var node = obj.part;\n          var selnode = e.diagram.selection.first();\n\n          // 常变\n          if (\n            selnode.data.category != \"wave\" &&\n            !(\n              selnode.data.category == \"picGroup\" &&\n              selnode.data.role == \"cbian\"\n            )\n          ) {\n            return;\n          }\n          var centerText = node.diagram.findNodeForKey(node.data.centerText);\n          if (centerText) {\n            centerText.layerName = \"Background\";\n          }\n          //var sat = node.selectionAdornmentTemplate;\n          //var adorn = sat.copy();\n          //adorn.adornedObject = node;\n          //node.addAdornment(\"dragEnter\", adorn);\n\n          //if (!mayWorkFor(selnode, node)) return;\n          var shape = node.findObject(\"main\");\n          if (shape) {\n            shape._prevFill = shape.fill; // remember the original brush\n            shape.fill = \"RGBA(146,208,80,0.5)\";\n          }\n        },\n        mouseDragLeave: function(e, obj) {\n          var node = obj.part;\n          var shape = node.findObject(\"main\");\n          if (shape && shape._prevFill) {\n            shape.fill = shape._prevFill; // restore the original brush\n          }\n          var centerText = node.diagram.findNodeForKey(node.data.centerText);\n          if (centerText) {\n            if (!helpers.checkPhone()) {\n              centerText.layerName = \"Foreground\";\n            }\n          }\n          //node.removeAdornment(\"dragEnter\");\n        },\n        mouseDrop: function(e, obj) {\n          var node = obj.part;\n          console.log(\"mouseDropmouseDropmouseDropmouseDrop\");\n          var selnode = e.diagram.selection.first();\n          if (!selnode) return;\n          // 常变\n          if (\n            selnode.data.category == \"picGroup\" &&\n            selnode.data.role == \"cbian\"\n          ) {\n            var it = selnode.findSubGraphParts().iterator;\n            var deleteObjs = [];\n            var cbian = {};\n            while (it.next()) {\n              var n = it.value;\n              if (n.data.category == \"autoText\") {\n                if (n.data.locationSpot == \"0 0 0 0\") {\n                  cbian.shiText = n.data.text;\n                }\n                if (n.data.locationSpot == \"0 0.5 0 0\") {\n                  cbian.centerText = n.data.text;\n                }\n                if (n.data.locationSpot == \"0 1 0 0\") {\n                  cbian.xuText = n.data.text;\n                }\n              }\n              deleteObjs.push(n.data);\n            }\n            e.diagram.startTransaction(\"mouseDrop\");\n            // 删除总结图\n            e.diagram.model.removeNodeDataCollection(deleteObjs);\n            var backupSelnode = JSON.parse(JSON.stringify(selnode.data));\n            e.diagram.model.removeNodeData(selnode.data);\n\n            // 添加新橄榄\n            e.diagram.__trtd.addOlive(node, cbian);\n            e.diagram.commitTransaction(\"mouseDrop\");\n            return;\n          }\n\n          if (selnode.data.category != \"wave\") {\n            return;\n          }\n          if (!node) {\n            // node.containingGroup.layout.isValidLayout = false\n            return;\n          }\n          if (selnode.data.group != obj.data.group) {\n            return;\n          }\n          e.diagram.startTransaction(\"mouseDrop\");\n          selnode.__oldOrder = selnode.data.order;\n          e.diagram.model.setDataProperty(\n            selnode.data,\n            \"order\",\n            node.data.order + 0.5\n          );\n          var xuText = e.diagram.findNodeForKey(selnode.data.xuText);\n          var shiText = e.diagram.findNodeForKey(selnode.data.shiText);\n          // shiText.__oldOrder = shiText.data.order\n          // xuText.__oldOrder = xuText.data.order\n          e.diagram.model.setDataProperty(\n            shiText,\n            \"order\",\n            node.data.order + 0.5\n          );\n          e.diagram.model.setDataProperty(\n            xuText,\n            \"order\",\n            node.data.order + 0.5\n          );\n          // node.containingGroup.layout.isValidLayout = false\n          e.diagram.commitTransaction(\"mouseDrop\");\n          return;\n          if (node.data.isparent) {\n            var child = e.diagram.findNodeForKey(node.data.isparent);\n            while (child.data.next) {\n              child = e.diagram.findNodeForKey(child.data.next);\n            }\n            if (child.data.key == selnode.data.key) {\n              //最后一个子节点拖放到父节点上时，不做任何操作\n              return;\n            }\n            e.diagram.__trtd.setNodeAsSibling(selnode, child);\n          } else {\n            e.diagram.__trtd.setNodeAsChildren(selnode, node);\n          }\n        },\n        mouseLeave: function(e, node) {\n          if (!node.containingGroup) return;\n          var it = node.containingGroup.findSubGraphParts().iterator;\n          while (it.next()) {\n            var n = it.value;\n            if (n.data.category == \"autoText\") {\n              // if(n.data.order == node.data.order+1){\n              //     locateNode = n;\n              // }\n              n.findObject(\"textBorder\").visible = false;\n              // n.areaBackground = null\n            }\n          }\n          try {\n            var centerText = e.diagram.findNodeForKey(node.data.centerText);\n            if (centerText) {\n              centerText.layerName = \"Foreground\";\n            }\n          } catch (e) {\n            console.error(\"wave node template error:\", e);\n          }\n        },\n        selectionAdornmentTemplate: this.getNodeSelectionAdornmentTemplate(),\n        doubleClick: function(e, node) {\n          if (!node) return;\n          if (!node.containingGroup) return;\n          if (\n            node.containingGroup.data.textAngle == \"horizontal\" &&\n            node.containingGroup.data.centerTextAngle == \"independent\"\n          ) {\n            // 如果文字方向为正向，且中线文字为正向\n            node.findObject(\"TEXT\").visible = true;\n            var centerText = node.diagram.findNodeForKey(node.data.centerText);\n            if (centerText) {\n              centerText.visible = false;\n            }\n          }\n          setTimeout(() => {\n            e.diagram.__trtd.selectText(e, node);\n          }, 100);\n        }\n      },\n      this.binding,\n      $(\n        go.Shape,\n        \"Rectangle\",\n        {\n          name: \"main\",\n          // layerName: \"overflow\",\n          fill: \"rgba(0,0,0,0)\",\n          stroke: null,\n          width: 300,\n        \n          height: 150\n        },\n        new go.Binding(\"areaBackground\", \"isHighlighted\", function(h, shape) {\n          // node.areaBackground = \"RGB(107,208,137)\"\n          if (h) return \"RGBA(146,208,80,0.5)\";\n          return null;\n          var c = shape.part.data.color;\n          return c ? c : \"white\";\n        }).ofObject(), // binding source is Node.isHighlighted\n        new go.Binding(\"fill\", \"fill\").makeTwoWay(),\n        // new go.Binding(\"fill\", \"fill\").makeTwoWay(),\n        new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\n          // console.log(\"vd m\", v, d )\n          // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\n          return go.Size.parse(v);\n        }).makeTwoWay(function(v) {\n          return go.Size.stringify(v);\n        })\n      ),\n      // $(go.Panel, \"Spot\",{\n      //   // isClipping: true,\n      //   background: \"green\",\n      //   position: new go.Point(0,0),\n      //   alignment: go.Spot.Center,\n      //   alignmentFocus: go.Spot.Center,\n      // },\n      // $(go.Shape, \"Rectangle\",{\n      //   alignment: go.Spot.Center,\n      //   alignmentFocus: go.Spot.Center,\n      // },\n      // new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\n      //     var size = new go.Size(v.width, v.height)\n      //     // console.log(\"v:\",v)\n      //     return size\n      //     }).ofObject(\"main\"),\n      // ),\n      this.getShiHalfEllipseShape(),\n      this.getXuHalfEllipseShape(),\n      // $(go.Adornment,\n      // { locationSpot: go.Spot.Top },\n      // $(go.Shape, \"BpmnActivityLoop\",\n      //   { width: 12, height: 12, cursor: \"pointer\",\n      //     background: \"transparent\", stroke: \"dodgerblue\", strokeWidth: 2 })\n      // ),\n      // ),\n\n      // $(go.Panel,\"Spot\",{\n      //   stretch: go.GraphObject.Uniform,\n      //   background:\"gray\",\n      //   // locationSpot: go.Spot.LeftCenter,\n      //   alignment: go.Spot.Right,\n      //   // strokeDashArray: [10, 5],\n      //   alignmentFocus: go.Spot.Left,\n      // },\n      //   this.getTailXuShape(),\n      //   this.getTailShiShape(),\n      // ),\n\n      // this.getUpHalfEllipseShape(),\n      this.getTextBuild(),\n      $(\n        go.Shape,\n        {\n          geometryString: \"M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z\",\n            // \"M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 29c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM12 8c-1.105 0-2 0.895-2 2s0.895 2 2 2h5.172l-8.586 8.586c-0.781 0.781-0.781 2.047 0 2.829 0.39 0.39 0.902 0.586 1.414 0.586s1.024-0.195 1.414-0.586l8.586-8.586v5.172c0 1.105 0.895 2 2 2s2-0.895 2-2v-12h-12z\",\n          visible: false,\n          name: \"figure\",\n          cursor: \"pointer\",\n          alignment: go.Spot.TopRight,\n          alignmentFocus: go.Spot.TopRight,\n          width: 14,\n          height: 14,\n          fill: \"green\",\n          toolTip: $(\n            \"ToolTip\",\n            $(\n              go.Panel,\n              \"Vertical\",\n              $(\n                go.Picture,\n                new go.Binding(\"source\", \"src\", function(s) {\n                  return \"images/\" + s + \".png\";\n                })\n              ),\n              $(go.TextBlock, {text:\"进入子盘\", margin: 3 })\n            )\n          ),\n          click: function(e) {\n            console.log(\"click figure\", e);\n            var node = e.targetObject.part;\n            e.diagram.__trtd.openFigure({\n              figure: node.data.figure,\n              title: node.data.text,\n              key: node.data.key,\n              node: node\n            });\n          }\n        },\n        // new go.Binding(\"geometry\", \"geo\", function(){\n\n        // })),\n        new go.Binding(\"visible\", \"figure\", function(v) {\n          console.log(\"----------------------\");\n          if (v) {\n            return true;\n          } else {\n            return false;\n          }\n        })\n      )\n    );\n  }\n}\n\nmodule.exports = WaveNodeTemplate;\n// export default WaveNodeTemplate\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/waveNodeTemplate.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\nvar waveGroupLayout = require(\"../layout/waveGroupLayout\")\r\n\r\nclass WaveNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n    \r\n    nodeResizeAdornmentTemplate () {\r\n        return $(go.Adornment, \"Spot\",\r\n            $(go.Placeholder), // takes size and position of adorned object\r\n            // $(go.Shape, \"Circle\", // left resize handle\r\n            //     {\r\n            //         alignment: go.Spot.TopLeft,\r\n            //         alignmentFocus: go.Spot.BottomRight,\r\n            //         cursor: \"col-resize\",\r\n            //         desiredSize: new go.Size(30, 30),\r\n            //         fill: \"lightblue\",\r\n            //         stroke: \"dodgerblue\"\r\n            //     }),\r\n            $(go.Shape, \"Circle\", // right resize handle\r\n                {\r\n                    alignment: go.Spot.BottomRight,\r\n                    alignmentFocus: go.Spot.TopLeft,\r\n                    cursor: \"col-resize\",\r\n                    desiredSize: new go.Size(30, 30),\r\n                    fill: \"lightblue\",\r\n                    stroke: \"dodgerblue\"\r\n                })\r\n        )\r\n    }\r\n\r\n    getNodeTemplate(){\r\n      var that = this\r\n      return $(go.Group, \"Spot\",\r\n      { selectionObjectName: \"PH\",\r\n        layerName: \"default\",\r\n        locationObjectName: \"PH\",\r\n        resizeObjectName:\"PH\",\r\n        // rotatable: false\r\n        resizable: true,\r\n        locationSpot: go.Spot.LeftCenter,\r\n        \r\n        // rotationSpot: go.Spot.LeftCenter,\r\n        alignment: go.Spot.Left,\r\n        alignmentFocus: go.Spot.Left,\r\n        // rotateObject:\"PH\",\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n          var it = node.findSubGraphParts().iterator;\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  n.findObject(\"textBorder\").visible = false;\r\n              }\r\n          }\r\n        },\r\n        selectionAdornmentTemplate: this.getNodeSelectionAdornmentTemplate(),\r\n        resizeAdornmentTemplate: that.nodeResizeAdornmentTemplate(),\r\n        mouseOver: function(e, node) {\r\n            console.log(\"group.......................\")\r\n            // if(node.data.hyperlink){\r\n            //   var textObj = node.findObject('TEXT');\r\n            //   textObj.isUnderline = true;\r\n            // }\r\n            // if(!node) return;\r\n            var it = node.findSubGraphParts().iterator;\r\n            while (it.next()) {\r\n                var n = it.value;\r\n                if(n.data.category == \"autoText\"&& (node.data.role == \"xuText\" || node.data.role == \"shiText\" )){\r\n                    // if(n.data.order == node.data.order){\r\n                        // locateNode = n;\r\n                        if(n.data.text == \"\"|| n.data.text.trim() == \"\"){\r\n                          n.findObject(\"textBorder\").visible = true;\r\n                        }\r\n                      //   n.areaBackground = \"mediumslateblue\"\r\n                    // }\r\n                }\r\n            }\r\n            // diagram.__trtd.showNodeRemarkTips(e, node);\r\n        },\r\n        mouseLeave: function(e, node) {\r\n          // if(!node) return;\r\n          var it = node.findSubGraphParts().iterator;\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  // if(n.data.order == node.data.order+1){\r\n                  //     locateNode = n;\r\n                  // }\r\n                  n.findObject(\"textBorder\").visible = false;\r\n                  // n.areaBackground = null\r\n              }\r\n          }\r\n        },\r\n        rotatable: true,\r\n        contextMenu: $(go.Adornment),\r\n        // resizable: true,\r\n        // layoutConditions: go.Part.LayoutStandard,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        layout: new waveGroupLayout()\r\n        // layout: $(go.GridLayout,{\r\n        //   spacing: new go.Size(0,0),\r\n        //   cellSize: go.Size.parse(300,150),\r\n        //   arrangement:go.GridLayout.LeftToRight,\r\n        //   alignment: go.GridLayout.Location,\r\n        //   comparer:function(pa, pb) {\r\n        //     var da = pa.data;\r\n        //     var db = pb.data;\r\n        //     if (da.order < db.order) return -1;\r\n        //     if (da.order > db.order) return 1;\r\n        //     return 0;\r\n        //   }\r\n        // }) \r\n      },\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,data){\r\n\r\n        return v;\r\n      }),\r\n      // new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n      new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n      new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n      new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n        $(go.Shape,  // using a Shape instead of a Placeholder\r\n          { name: \"PH\",\r\n          figure:\"Rectangle\",\r\n          // rotationSpot: go.Spot.LeftCenter,\r\n          // spot1: new go.Spot(0.01, 0.01),\r\n          // spot2: new go.Spot(0.99, 0.99),\r\n            // width: 600,\r\n            // height:300,\r\n            alignment: new go.Spot(0,0.5),\r\n            // locationSpot: go.Spot.LeftCenter,\r\n            stroke:\"#9aa8b6\" ,\r\n            strokeWidth: 0,\r\n            minSize: new go.Size(300,70),\r\n            maxSize: new go.Size(NaN,400),\r\n            fill: \"rgba(88,0,0,0)\" },\r\n          new go.Binding(\"desiredSize\", \"desiredSize\", function(v,data){\r\n            return go.Size.parse(v)\r\n          }).makeTwoWay(go.Size.stringify)\r\n        ),\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        // $(go.Placeholder,    // represents the area of all member parts,\r\n        //   { padding: 0}\r\n        // ),  // with some extra padding around them\r\n\r\n        // $(go.TextBlock,  // group title\r\n        //   { font: \"Bold 12pt Sans-Serif\" },\r\n        //   new go.Binding(\"text\", \"key\")\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = WaveNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/waveGroupNodeTemplate.js","'use script'\r\nvar $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\nvar axisGroupLayout = require(\"../layout/axisGroupLayout\")\r\n\r\nclass AxisNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n    \r\n    addFreeText(e, node){\r\n      console.log(\"eeeeeeeeeee\",e)\r\n      var data = {\"text\":\"自由文本\",\r\n      \"deletable\":true, \r\n      \"role\":\"freeText\",\r\n      \"fill\":\"black\", \r\n      \"iconVisible\":false, \r\n      \"locationSpot\":\"0.5 0.5 0 0\", \r\n      \"textAlign\":\"center\", \r\n      \"category\":\"autoText\", \r\n      \"loc\": go.Point.stringify(e.documentPoint), \r\n      \"movable\":true, \"group\":node.data.key\r\n     }\r\n     this.diagram.startTransaction(\"addFreeText\")\r\n     this.diagram.model.addNodeData(data);\r\n     this.diagram.commitTransaction(\"addFreeText\")\r\n    }\r\n\r\n    getNodeTemplate(){\r\n      var that = this\r\n      return $(go.Group, \"Auto\",\r\n      { selectionObjectName: \"PH\",\r\n      layerName: \"Background\",\r\n        locationObjectName: \"PH\",\r\n        locationSpot: go.Spot.BottomLeft ,\r\n        // rotationSpot: go.Spot.LeftCenter,\r\n        rotatable: false,\r\n        alignment: go.Spot.Left,\r\n        alignmentFocus: go.Spot.Left,\r\n        // rotateObject:\"PH\",\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n          var it = node.findSubGraphParts().iterator;\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  n.findObject(\"textBorder\").visible = false;\r\n              }\r\n          }\r\n          return;\r\n          if(node.isSelected) return;\r\n          var it = node.findSubGraphParts().iterator;\r\n          var n;\r\n          while (it.next()) {\r\n              n = it.value;\r\n              if(n.data.role == \"labelGroup\"){\r\n                  n.__trtdNode.switchBorder(n, true)\r\n                  break;\r\n              }\r\n          }\r\n          if(n){\r\n            setTimeout(function(){\r\n              n.__trtdNode.switchBorder(n, false)\r\n            },3000)\r\n          }\r\n        },\r\n        doubleClick: function (e, node){\r\n          that.addFreeText(e, node)\r\n        },\r\n        mouseOver: function(e, node) {\r\n          // if(node.data.hyperlink){\r\n          //   var textObj = node.findObject('TEXT');\r\n          //   textObj.isUnderline = true;\r\n          // }\r\n          // if(!node.containingGroup) return;\r\n          return;\r\n          if(that.diagram.selection.count >0) return;\r\n\r\n          var it = node.findSubGraphParts().iterator;\r\n          var n;\r\n          while (it.next()) {\r\n              n = it.value;\r\n              if(n.data.role == \"labelGroup\"){\r\n                  // n.__trtdNode.switchBorder(n, true)\r\n                  break;\r\n              }\r\n          }\r\n          // 给显示隐藏一个缓冲，以显得不那么突兀\r\n          if(n){\r\n            setTimeout(function(){\r\n              if(that.diagram.selection.count >0) return;\r\n              n.__trtdNode.switchBorder(n, true)\r\n              if(that.diagram.selection.count <=0) return;\r\n              setTimeout(function(){\r\n                n.__trtdNode.switchBorder(n, false)\r\n              },3000)\r\n            },100)\r\n          }\r\n          // diagram.__trtd.showNodeRemarkTips(e, node);\r\n      },\r\n      contextMenu: $(go.Adornment),\r\n      mouseLeave: function(e, node) {\r\n        // if(!node.containingGroup) return;\r\n        var it = node.findSubGraphParts().iterator;\r\n        while (it.next()) {\r\n            var n = it.value;\r\n            if(n.data.role == \"labelGroup\"){\r\n                // n.__trtdNode.switchBorder(n, false)\r\n                break;\r\n            }\r\n        }\r\n        // if(n){\r\n        //   setTimeout(function(){\r\n        //     n.__trtdNode.switchBorder(n, false)\r\n        //   },3000)\r\n        // }\r\n      },\r\n        // rotatable: true,\r\n        // resizable: true,\r\n        // layoutConditions: go.Part.LayoutStandard,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        layout: new axisGroupLayout()\r\n        // layout: $(go.GridLayout,{\r\n        //   spacing: new go.Size(0,0),\r\n        //   cellSize: go.Size.parse(300,150),\r\n        //   arrangement:go.GridLayout.LeftToRight,\r\n        //   alignment: go.GridLayout.Location,\r\n        //   comparer:function(pa, pb) {\r\n        //     var da = pa.data;\r\n        //     var db = pb.data;\r\n        //     if (da.order < db.order) return -1;\r\n        //     if (da.order > db.order) return 1;\r\n        //     return 0;\r\n        //   }\r\n        // }) \r\n      },\r\n      new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,data){\r\n\r\n        return v;\r\n      }),\r\n      // new go.Binding(\"desiredSize\", \"desiredSize\", go.Size.parse).makeTwoWay(go.Size.stringify),\r\n      new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n        $(go.Shape,  // using a Shape instead of a Placeholder\r\n          { name: \"PH\",\r\n          figure:\"Rectangle\",\r\n          // rotationSpot: go.Spot.LeftCenter,\r\n          // spot1: new go.Spot(0.01, 0.01),\r\n          // spot2: new go.Spot(0.99, 0.99),\r\n            // width: 600,\r\n            // height:300,\r\n            stroke:\"yellow\" ,\r\n            strokeWidth:0,\r\n            fill: \"rgba(0,0,0,0)\" },\r\n          // new go.Binding(\"desiredSize\", \"desiredSize\", function(v,data){\r\n          //   return go.Size.parse(v)\r\n          //   console.log('1111111111111111111111')\r\n          //   // for(var i=0;i<)\r\n          //   var model = data.part.diagram.model;\r\n          //   var group = data.part.data;\r\n          //   var maxWidth = 0;\r\n          //   var maxHeight = 0;\r\n          //   for(var i = 0;i<model.nodeDataArray.length;i++){\r\n          //     if(group.key != model.nodeDataArray[i].group){\r\n          //       continue;\r\n          //     }\r\n          //     if(model.nodeDataArray[i].desiredSize){\r\n          //       console.log(model.nodeDataArray[i].desiredSize)\r\n          //       var size = go.Size.parse(model.nodeDataArray[i].desiredSize)\r\n          //       if(size.width > maxWidth){\r\n          //         maxWidth = size.width;\r\n          //       }\r\n          //       if(size.height > maxHeight){\r\n          //         maxHeight = size.height;\r\n          //       }\r\n          //     }\r\n          //   }\r\n          //   // var group = that.diagram.findNodeForKey(data.part.data.key)\r\n          //   // var git = group.memberParts;\r\n          //   // var maxWidth = 0;\r\n          //   // var maxHeight = 0;\r\n          //   // while (git.next()) {\r\n          //   //   var item = git.value;\r\n          //   //   console.log(\"item:\",item)\r\n          //   //   if(item.naturalBounds.width > maxWidth){\r\n          //   //     maxWidth = item.naturalBounds.width;\r\n          //   //   }\r\n          //   //   if(item.naturalBounds.height > maxHeight){\r\n          //   //     maxHeight = item.naturalBounds.height;\r\n          //   //   }\r\n          //   //   console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n      \r\n          //   // }           \r\n          //   return go.Size.parse(`${maxWidth+100} ${maxHeight}`)         \r\n          //   // group.diagram.model.setDataProperty(group.data, \"desiredSize\", `${maxWidth+100} ${maxHeight}`) \r\n          // }).makeTwoWay(go.Size.stringify)\r\n        ),\r\n        \r\n        // $(go.Placeholder,    // represents the area of all member parts,\r\n        //   { padding: 0}\r\n        // ),  // with some extra padding around them\r\n\r\n        // $(go.TextBlock,  // group title\r\n        //   { font: \"Bold 12pt Sans-Serif\" },\r\n        //   new go.Binding(\"text\", \"key\")\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = AxisNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/axisGroupNodeTemplate.js","    // define a custom grid layout that makes sure the length of each lane is the same\r\n    // and that each lane is broad enough to hold its subgraph\r\n    function AxisGroupLayout() {\r\n        go.Layout.call(this);\r\n        // go.GridLayout.call(this);\r\n        // this.cellSize = new go.Size(1, 1);\r\n        // this.wrappingColumn = Infinity;\r\n        // this.wrappingWidth = Infinity;\r\n        // this.spacing = new go.Size(0, 0);\r\n        // this.alignment = go.GridLayout.Position;\r\n      }\r\n      go.Diagram.inherit(AxisGroupLayout, go.Layout);\r\n  \r\n      function computeNewRotateLoc(rotateCenter,currentLoc, angle){\r\n          if(rotateCenter.equals(currentLoc)) return currentLoc\r\n        // 计算选择中心点到（0,0）点的偏移\r\n        var offset = new go.Point(0,0).subtract(rotateCenter.copy())\r\n        // 将原来的点偏移到相对0,0点的位置\r\n        var nodeOrigin = currentLoc.copy().offset(offset.x, offset.y)\r\n        var newNodeOrigin = nodeOrigin.rotate(angle)\r\n        var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y)\r\n        return newNodeLoc\r\n        // console.log(\"newNodeLoc\", newNodeLoc)\r\n      }\r\n      AxisGroupLayout.prototype.doLayout = function(coll) {\r\n          console.log(\"AxisGroupLayout.doLayout\")\r\n        var diagram = this.diagram;\r\n        diagram.startTransaction(\"AxisGroupLayout\")\r\n          // COLL might be a Diagram or a Group or some Iterable<Part>\r\n         \r\n        var it = this.collectParts(coll).iterator;\r\n        var collection = []\r\n        var dataCollection =[]\r\n        var group = this.group\r\n        // group.location = new go.Point(0,0)\r\n        var maxWidth = 0;\r\n        var maxHeight = 0;\r\n        var centerLine, axisX, axisY,axisXText, axisYText, themeText, labelText1,labelText2,labelText3,labelGroup,waveGroup\r\n        var shiTextColl = []\r\n        var xuTextColl = []\r\n        var oliveWidth\r\n        var oliveHeight\r\n        while (it.next()) {\r\n            var node = it.value;\r\n                // var item = git.value;\r\n            //   console.log(\"item:\",item)\r\n\r\n            dataCollection.push(node.data)\r\n            if(node.data.category == \"wave\"){\r\n                collection.push(node)\r\n            }\r\n            if(!(node instanceof go.Node)){\r\n              continue;\r\n            }\r\n            // 处理文本节点的位置和定位位置\r\n            // if(node.data.category == \"text\"){\r\n              if(node.data.role == \"axisYText\"){\r\n                axisYText = node;\r\n              }\r\n              if(node.data.role == \"axisXText\"){\r\n                axisXText = node;\r\n              }\r\n              if(node.data.role == \"themeText\"){\r\n                themeText = node;\r\n              }\r\n              if(node.data.role == \"shiText\"){\r\n                shiTextColl.push(node)\r\n              }\r\n              if(node.data.role == \"xuText\"){\r\n                xuTextColl.push(node)\r\n              }\r\n            // }\r\n            // 处理label文本节点的位置和定位位置\r\n            // if(node.data.category == \"iconText\"){\r\n              if(node.data.role == \"labelText1\"){\r\n                labelText1 = node;\r\n              }\r\n              if(node.data.role == \"labelText2\"){\r\n                labelText2 = node;\r\n              }\r\n              if(node.data.role == \"labelText3\"){\r\n                labelText3 = node;\r\n              }\r\n              if(node.data.role == \"labelGroup\"){\r\n                labelGroup = node;\r\n              }\r\n            // }\r\n\r\n              if(node.naturalBounds.width > maxWidth){\r\n                maxWidth = node.naturalBounds.width;\r\n              }\r\n              if(node.naturalBounds.height > maxHeight){\r\n                maxHeight = node.naturalBounds.height;\r\n              }\r\n            \r\n            \r\n            if (node.data.category == \"line\") {\r\n                if(node.data.role == \"centerLine\"){\r\n                  centerLine = node;\r\n                }\r\n            }\r\n            if (node.data.group == group.key) {\r\n            // position the node . . .\r\n                if(node.data.category == \"line\"){\r\n                    if(node.data.role == \"axisX\") {\r\n                      node.angle = 0;\r\n                      axisX = node\r\n                    };\r\n                    if(node.data.role == \"axisY\") {\r\n                      axisY = node\r\n                      node.angle = 270;\r\n                    }\r\n                    node.location = group.location.copy().offset(0,0)\r\n                    // node.angle = 270\r\n                }\r\n                if(node.data.category == \"waveGroup\"){\r\n                    waveGroup = node;\r\n                    // node.angle = group.angle\r\n                    oliveWidth = node.data.oliveWidth\r\n                    oliveHeight = node.data.oliveHeight\r\n                    node.location = group.location.copy().offset(0,0)\r\n                    // node.layout.isOngoing = true;\r\n                    // node.layout.isValidLayout = false;\r\n                    // collection.push(node)\r\n                }\r\n\r\n            }\r\n        }\r\n        console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n        // line.width = 2000\r\n        // line.height = 4\r\n        if(axisY) {\r\n          axisY.angle = 270;\r\n        }\r\n        if(axisX) {\r\n          axisX.angle = 0\r\n        }\r\n        if(waveGroup){\r\n          // var x1 = centerLine.width * Math.cos(Math.abs(360-centerLine.angle%360) / 180 * Math.PI)\r\n          console.log(`waveGroup.width:${waveGroup.width}`)\r\n          var x1 = waveGroup.resizeObject.width * Math.cos(Math.abs(360-waveGroup.angle%360) / 180 * Math.PI)\r\n          var y1 = 10\r\n          var x2 = waveGroup.resizeObject.width * Math.sin(Math.abs(360-waveGroup.angle%360)/ 180 * Math.PI)\r\n          var y2 = 10\r\n          // axisX.desiredSize = new go.Size(x1, y1)\r\n          // axisY.desiredSize = new go.Size(x2, y2)\r\n          this.diagram.model.setDataProperty(axisX.data, \"desiredSize\",`${x1} ${y1}`)\r\n          this.diagram.model.setDataProperty(axisY.data, \"desiredSize\",`${x2} ${y2}`)\r\n          // this.diagram.model.setDataProperty(group.data, \"desiredSize\",`${x1} ${x2}`)\r\n\r\n          group.width = x1\r\n          group.height = x2\r\n          var shiStroke = waveGroup.data.shiStroke\r\n          var xuStroke = waveGroup.data.xuStroke\r\n          var centerStroke = waveGroup.data.centerStroke || \"#3f5369\"\r\n          if(axisXText){\r\n            axisXText.location = group.location.copy().offset(x1, 0)\r\n            axisXText.locationSpot = go.Spot.Top\r\n          }\r\n          if(axisYText){\r\n            axisYText.location = group.location.copy().offset(-10, -x2)\r\n            axisYText.locationSpot = go.Spot.Right\r\n          }\r\n          // this.diagram.model.setDataProperty(axisY.data, \"desiredSize\",axisY.width)\r\n        }\r\n\r\n \r\n        if(themeText){\r\n          // themeText.location = group.location.copy().offset(0, 0)\r\n          // themeText.locationSpot = new go.Spot(0.7,0,0,0)\r\n        }\r\n        // if(labelText1){\r\n        //   labelText1.location = group.location.copy().offset(0, -x2).offset(40,10)\r\n        // }\r\n        // if(labelText2){\r\n        //   labelText2.location = group.location.copy().offset(0, -x2).offset(40,80)\r\n        // }\r\n        // if(labelText3){\r\n        //   labelText3.location = group.location.copy().offset(0, -x2).offset(40,150)\r\n        // }\r\n        if(labelGroup){\r\n          var itl = labelGroup.findSubGraphParts().iterator;\r\n          while (itl.next()) {\r\n            var n = itl.value;\r\n            if(n.data.role == \"labelText1\"){\r\n              labelText1 = n\r\n            }\r\n            if(n.data.role == \"labelText2\"){\r\n              labelText2 = n\r\n            }\r\n            if(n.data.role == \"labelText3\"){\r\n              labelText3 = n\r\n            }\r\n          }\r\n          if(waveGroup){\r\n            waveGroup.labelText1 = labelText1\r\n            waveGroup.labelText2 = labelText2\r\n            waveGroup.labelText3 = labelText3\r\n          }\r\n          // var tmp1 = group.location.copy().offset(0, -x2).offset(30,0)\r\n          // labelGroup.location = tmp1\r\n          // labelGroup.diagram.model.setDataProperty(labelGroup.data,\"loc\",go.Point.stringify(tmp1))\r\n          // setTimeout(()=>{\r\n          //   diagram.startTransaction(\"labelGroup\");\r\n          //   labelGroup.layout.isOngoing = true;\r\n          //   labelGroup.layout.isValidLayout = false;\r\n          //   diagram.commitTransaction(\"labelGroup\");\r\n          // },350)\r\n          // labelGroup.location = group.location.copy().offset(0, -x2).offset(40,10)\r\n        }\r\n        if(shiStroke && labelText1){\r\n          this.diagram.model.setDataProperty(labelText1.data, \"fill\",shiStroke)\r\n        }\r\n        if(xuStroke && labelText2){\r\n          this.diagram.model.setDataProperty(labelText2.data, \"fill\",xuStroke)\r\n        }\r\n        if(centerStroke && labelText3){\r\n          this.diagram.model.setDataProperty(labelText3.data, \"fill\",centerStroke)\r\n        }\r\n        // collection.sort(function(a,b){\r\n        //     return a.data.order > b.data.order\r\n        // })\r\n        // shiTextColl.sort(function(a,b){\r\n        //     return a.data.order > b.data.order\r\n        // })\r\n        // xuTextColl.sort(function(a,b){\r\n        //     return a.data.order > b.data.order\r\n        // })\r\n        // for(var i=0;i<xuTextColl.length;i++){\r\n        //   xuTextColl[i].location = computeNewRotateLoc(collection[i].location, collection[i].location.copy().offset(collection[i].width/2,collection[i].height/2),collection[i].angle)\r\n        // }\r\n        // collection.forEach(function(obj){\r\n        //     obj.location = group.location.copy().offset(300*(obj.data.order-1),0)\r\n        //     // obj.location = new go.Point(300*(obj.data.order-1),0)\r\n        //     // obj.\r\n        //     // var group = a.findNodeDataForKey(m.group)\r\n        //     obj.location = computeNewRotateLoc(group.location, obj.location, obj.angle)\r\n        // })\r\n        go.Layout.prototype.doLayout.call(this, coll);\r\n        diagram.commitTransaction(\"AxisGroupLayout\");\r\n        // diagram.updateAllTargetBindings()\r\n        return;\r\n        // return;\r\n        // var diagram = this.diagram;\r\n        if (diagram === null) return;\r\n        diagram.startTransaction(\"PoolLayout\");\r\n        // make sure all of the Group Shapes are big enough\r\n        // var minsize = computeMinPoolSize();\r\n        // diagram.findTopLevelGroups().each(function(lane) {\r\n        //   if (!(lane instanceof go.Group)) return;\r\n        //   var shape = lane.selectionObject;\r\n        //   if (shape !== null) {  // change the desiredSize to be big enough in both directions\r\n        //     var sz = computeLaneSize(lane);\r\n        //     shape.width = (!isNaN(shape.width)) ? Math.max(shape.width, sz.width) : sz.width;\r\n        //     shape.height = (isNaN(shape.height) ? minsize.height : Math.max(shape.height, minsize.height));\r\n        //     var cell = lane.resizeCellSize;\r\n        //     if (!isNaN(shape.width) && !isNaN(cell.width) && cell.width > 0) shape.width = Math.ceil(shape.width / cell.width) * cell.width;\r\n        //     if (!isNaN(shape.height) && !isNaN(cell.height) && cell.height > 0) shape.height = Math.ceil(shape.height / cell.height) * cell.height;\r\n        //   }\r\n        // });\r\n        // now do all of the usual stuff, according to whatever properties have been set on this GridLayout\r\n        go.GridLayout.prototype.doLayout.call(this, coll);\r\n        diagram.commitTransaction(\"PoolLayout\");\r\n      };\r\n      // end PoolLayout class\r\n\r\n      module.exports = AxisGroupLayout\n\n\n// WEBPACK FOOTER //\n// ./src/layout/axisGroupLayout.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\n  \r\nclass IconTextTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n\r\n    makeGeo(data, shape, options) {\r\n      // this is much more efficient than calling go.GraphObject.make:\r\n      var {radiusX=150,radiusY=100} = data\r\n      var geo =  new go.Geometry()\r\n        .add(new go.PathFigure(0, 0)  // start point\r\n          .add(new go.PathSegment(go.PathSegment.SvgArc,\r\n          radiusX*2,0,radiusX, radiusY,0,1,options.clockwiseFlag?1:0\r\n              )\r\n            )\r\n          )\r\n          geo.defaultStretch = go.GraphObject.Fill;\r\n          return geo;\r\n    }\r\n\r\n    getShiHalfEllipseShape(){\r\n      return $(go.Shape, {name:\"XU\", stroke: \"red\", fill:\"rgba(0,66,0,0)\",\r\n        // background: \"yellow\",\r\n        stretch: go.GraphObject.Uniform,\r\n        alignment: go.Spot.Bottom,\r\n        alignmentFocus: go.Spot.Bottom,\r\n        // row:1, column:0,margin:0\r\n      },\r\n        // new go.Binding(\"alignment\",\"\",function(data, shape){\r\n        //   if(data.flip){\r\n        //     return go.Spot.Top\r\n        //   }\r\n        //   return go.Spot.Bottom\r\n        // }),\r\n        // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\r\n        //   if(data.flip){\r\n        //     return go.Spot.Top\r\n        //   }\r\n        //   return go.Spot.Bottom\r\n        // }),\r\n          new go.Binding(\"geometry\", \"\", (data, shape)=>{\r\n            var clockwiseFlag = 0;\r\n            if(data.order%2 == 0){\r\n              data.flip = true;\r\n            }\r\n            if(data.flip){\r\n              clockwiseFlag = 1;\r\n            }\r\n            return this.makeGeo(data, shape, {clockwiseFlag:clockwiseFlag})\r\n          }),\r\n          new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                var size = new go.Size(v.width, v.height/2)\r\n                // console.log(\"v:\",v)\r\n                return size\r\n            }).ofObject(\"main\")\r\n        )\r\n    }\r\n    getXuHalfEllipseShape(){\r\n      return $(go.Shape, {name:\"SHI\", stroke: \"blue\", fill:\"rgba(0,66,0,0)\",\r\n        // background: \"gray\",\r\n        stretch: go.GraphObject.Uniform,\r\n        alignment: go.Spot.Bottom,\r\n        strokeDashArray: [5, 5],\r\n        alignmentFocus: go.Spot.Bottom,\r\n        // row:1, column:0,margin:0\r\n      },\r\n          // new go.Binding(\"alignment\",\"\",function(data, shape){\r\n          //   if(data.flip){\r\n          //     return go.Spot.Top\r\n          //   }\r\n          //   return go.Spot.Bottom\r\n          // }),\r\n          // new go.Binding(\"alignmentFocus\",\"\",function(data, shape){\r\n          //   if(data.flip){\r\n          //     return go.Spot.Top\r\n          //   }\r\n          //   return go.Spot.Bottom\r\n          // }),\r\n          new go.Binding(\"geometry\", \"\", (data, shape)=>{\r\n            var clockwiseFlag = 1;\r\n            if(data.order%2 == 0){\r\n              data.flip = true;\r\n            }\r\n            if(data.flip){\r\n              clockwiseFlag = 0;\r\n            }\r\n            return this.makeGeo(data, shape, {clockwiseFlag:clockwiseFlag})\r\n          }),\r\n          new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                var size = new go.Size(v.width, v.height/2)\r\n                // console.log(\"v:\",v)\r\n                return size\r\n            }).ofObject(\"main\")\r\n        )\r\n    }\r\n    getTextBuild(){\r\n      return $(go.TextBlock, {\r\n              name: \"TEXT\",\r\n              alignment: new go.Spot(0.5, 0.4),\r\n              font: \"bold 18px 幼圆\",\r\n              editable: true,\r\n              // flip:go.GraphObject.FlipHorizontal,\r\n              //margin: 3, editable: true,\r\n              \r\n              stroke: \"black\",\r\n              isMultiline: true,\r\n              overflow: go.TextBlock.OverflowClip,\r\n              wrap: go.TextBlock.WrapDesiredSize,\r\n              textAlign: \"center\",\r\n              spacingAbove: 4,\r\n              spacingBelow: 4,\r\n              portId: \"TEXT\",\r\n              stretch: go.GraphObject.Uniform\r\n          },\r\n          new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n              return ['start', 'center', 'end'].indexOf(v)>-1 ? v : \"center\";\r\n          }).makeTwoWay(),\r\n          new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n              return helpers.tdTransToNum(v, 4);\r\n          }).makeTwoWay(),\r\n          new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n              return helpers.tdTransToNum(v, 4);\r\n          }).makeTwoWay(),\r\n          new go.Binding(\"width\", \"width\", function(v) {\r\n              return v-30;\r\n          }).ofObject(\"main\"),\r\n          // new go.Binding(\"height\", \"height\", function (v) {\r\n          //   return v;\r\n          // }).ofObject(\"SHAPE\"),\r\n          new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n          new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n          new go.Binding(\"font\", \"font\").makeTwoWay()\r\n      )\r\n    }\r\n    getNodeTemplate(){\r\n      return $(go.Node,\"Spot\",{\r\n        locationObjectName: \"TEXT\",\r\n        movable: true,\r\n        resizable: true,\r\n        resizeObjectName: \"TEXT\",\r\n        selectionObjectName:\"TEXT\",\r\n        // rotatable: false,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        locationSpot: go.Spot.LeftCenter,\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n        },\r\n        doubleClick: function (e, node){\r\n          e.diagram.__trtd.selectText(e, node)\r\n        },\r\n        resizeAdornmentTemplate:  // specify what resize handles there are and how they look\r\n        $(go.Adornment, \"Spot\",\r\n          $(go.Placeholder),  // takes size and position of adorned object\r\n          // $(go.Shape, \"Circle\",  // left resize handle\r\n          //   { alignment: go.Spot.Left, cursor: \"col-resize\",\r\n          //     desiredSize: new go.Size(9, 9), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n          $(go.Shape, \"Circle\",  // right resize handle\r\n            { alignment: go.Spot.Right, cursor: \"col-resize\",\r\n              desiredSize: new go.Size(9, 9), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n          // $(go.TextBlock, // show the width as text\r\n          //   { alignment: go.Spot.Top, alignmentFocus: new go.Spot(0.5, 1, 0, -2),\r\n          //     stroke: \"dodgerblue\" },\r\n          //   new go.Binding(\"text\", \"adornedObject\",\r\n          //                  function(shp) { return shp.naturalBounds.width.toFixed(0); })\r\n          //       .ofObject())\r\n        ),\r\n      },\r\n      new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n      // $(go.TextBlock,{\r\n      //   name:\"label\",\r\n      //   // height:30,\r\n        \r\n      //   alignment: go.Spot.Center,\r\n      //   verticalAlignment: go.Spot.Center,\r\n      //   // isMultiline: false,\r\n      //   overflow: go.TextBlock.OverflowEllipsis,\r\n      //   // overflow: go.TextBlock.OverflowClip,\r\n      //   // wrap: go.TextBlock.WrapDesiredSize,\r\n      //   wrap: go.TextBlock.wrap,\r\n      //   stretch: go.GraphObject.Fill,\r\n      //   maxLines: 1,\r\n      //   stroke: \"black\",\r\n      //   editable: true,\r\n      //   textAlign: \"start\",\r\n      //   font: \"18px 'Microsoft YaHei'\"\r\n      // },\r\n      // new go.Binding(\"text\", \"label\").makeTwoWay(),\r\n      // ),\r\n      $(go.TextBlock,{\r\n        name:\"TEXT\",\r\n        width:200, height:30,\r\n        maxSize: new go.Size(NaN, 70),\r\n        minSize: new go.Size(NaN, 70),\r\n        alignment: go.Spot.Center,\r\n        verticalAlignment: go.Spot.Center,\r\n        isMultiline: false,\r\n        overflow: go.TextBlock.OverflowEllipsis,\r\n        // overflow: go.TextBlock.OverflowClip,\r\n        // wrap: go.TextBlock.WrapDesiredSize,\r\n        // wrap: go.TextBlock.wrap,\r\n        stretch: go.GraphObject.Fill,\r\n        maxLines: 5,\r\n        stroke: \"black\",\r\n        editable: true,\r\n        textAlign: \"start\",\r\n        font: \"18px 'Microsoft YaHei'\"\r\n      },\r\n      new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n      new go.Binding(\"width\", \"width\", function(v) {\r\n          //alert(v);\r\n          return v;\r\n      }).makeTwoWay(function(v) {\r\n          return v;\r\n      }),\r\n      new go.Binding(\"height\", \"height\", function(v) {\r\n          //alert(v);\r\n          return v;\r\n      }).makeTwoWay(function(v) {\r\n          return v;\r\n      }),\r\n      ),\r\n      $(go.Panel,\"Vertical\",\r\n        {alignment: go.Spot.Left,\r\n        alignmentFocus: go.Spot.Right,\r\n        },\r\n        $(go.Shape,{\r\n          name:\"ICON\",\r\n          width:16,\r\n          height:16,\r\n          click: function(e){\r\n            console.log(\"icon click\")\r\n          },\r\n          figure:\"Diamond\",\r\n          fill:\"red\",\r\n          strokeWidth:0,\r\n          margin: 3\r\n        },\r\n\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"figure\", \"figure\").makeTwoWay(),\r\n        new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n          return v\r\n      }).makeTwoWay(),\r\n        new go.Binding(\"height\", \"height\", function(v) {\r\n            if(!v) v=30\r\n            return v*2/3;\r\n        }).ofObject(\"label\"),\r\n        new go.Binding(\"width\", \"height\", function(v) {\r\n          if(!v) v=30\r\n            return v*2/3;\r\n        }).ofObject(\"label\"),\r\n        ),\r\n      )\r\n      \r\n      // this.binding,\r\n      // $(go.Shape, \"Ellipse\",\r\n      // { name:\"main\",fill: \"lightgreen\", stroke: null, width: 300, height: 150 },\r\n      //   new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n      //       // console.log(\"vd m\", v, d )\r\n      //       // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n      //       return go.Size.parse(v)\r\n      //   }).makeTwoWay(function(v) {\r\n      //       return go.Size.stringify(v)\r\n      //   }),\r\n      // ),\r\n      // this.getShiHalfEllipseShape(),\r\n      // this.getXuHalfEllipseShape(),\r\n\r\n      // // this.getUpHalfEllipseShape(),\r\n      // this.getTextBuild()\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = IconTextTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/iconTextNodeTemplate.js","var $ = go.GraphObject.make;\nvar Base = require(\"./base\");\nvar helpers = require(\"../helpers/helpers.gojs\");\n\nclass AutoTextTemplate extends Base {\n  constructor(options) {\n    super(options);\n    // this.nodeProperties = {}\n  }\n\n\n\n  dealFireText(e, part) {\n    console.log(\"click fire button\");\n    // return\n    var diagram = e.diagram;\n    var node = diagram.selection.first();\n    var it = node.containingGroup.findSubGraphParts().iterator;\n    var centerNode;\n    while (it.next()) {\n      var n = it.value;\n      if (n.data.subRole == \"themeText\") {\n        centerNode = n;\n        // break;\n      }\n    }\n    // diagram.commandHandler.scrollToPart(centerNode);\n    function checkSameRadius(n, centerNode, node) {\n      if (n.data.dimKey == null) return false;\n      var maxRadius = Math.max(\n        Math.abs(node.data.orderX - centerNode.data.orderX),\n        Math.abs(node.data.orderY - centerNode.data.orderY)\n      );\n      if (\n        Math.abs(n.data.orderX - centerNode.data.orderX) == maxRadius ||\n        Math.abs(n.data.orderY - centerNode.data.orderY) == maxRadius\n      ) {\n        return true;\n      } else {\n        return false;\n      }\n      var r1 =\n        (n.data.orderX - centerNode.data.orderX) *\n          (n.data.orderX - centerNode.data.orderX) +\n        (n.data.orderY - centerNode.data.orderY) *\n          (n.data.orderY - centerNode.data.orderY);\n      var r2 =\n        (node.data.orderX - centerNode.data.orderX) *\n          (node.data.orderX - centerNode.data.orderX) +\n        (node.data.orderY - centerNode.data.orderY) *\n          (node.data.orderY - centerNode.data.orderY);\n      return r1 == r2;\n    }\n    var radius = Math.max(node.data.orderX, node.data.orderY);\n    radius = Math.abs(radius - centerNode.data.orderX);\n    // if(radius < 5) return;\n    it.reset();\n    while (it.next()) {\n      var n = it.value;\n\n      if (!checkSameRadius(n, centerNode, node)) {\n        //   centerNode= n;\n        // n.opacity = 0.1\n        // break;\n      } else {\n        var obj = n.findObject(\"TEXT\");\n        // obj.__font = obj.font;\n        // obj.font = \"30px 'Microsoft YaHei'\";\n        // n.findObject(\"TEXT\").font = \"40px 'Microsoft YaHei'\";\n      }\n    }\n    //   node.data.role == \"centerText\"\n    //   diagram.scrollToRect(node.naturalBounds)\n    var group = node.containingGroup;\n    var width = group.data.gridWidth;\n    radius = 10;\n    var rect = new go.Rect(\n      new go.Point(\n        centerNode.position.x - width * (radius + 1),\n        centerNode.position.y - width * (radius + 1)\n      ),\n      new go.Size(width * (radius + 1) * 2, width * (radius + 1) * 2)\n    );\n    // var rect = new go.Rect(go.Point.parse(\"1803.1413612565443 1348.6910994764396\"), new go.Size(700,700))\n    diagram.animationManager.isEnabled = false;\n    diagram.zoomToRect(rect);\n    diagram.centerRect(centerNode.actualBounds);\n    diagram.animationManager.isEnabled = true;\n    if (e.diagram.__trtd.dealFireTextCallback) {\n      e.diagram.__trtd.dealFireTextCallback(e, node);\n    }\n  }\n\n  getNodeSelectionAdornmentTemplate() {\n    var that = this;\n    return $(\n      go.Adornment,\n      \"Spot\",\n      {\n        // isShadowed: true,\n        isActionable: true\n      },\n      $(\n        go.Panel,\n        \"Auto\",\n        $(\n          go.Shape,\n          \"Rectangle\",\n          {\n            isPanelMain: true,\n            fill: null,\n            stroke: \"dodgerblue\",\n            strokeWidth: 3\n          }\n          // new go.Binding(\"fill\",\"\",function(e,obj){\n          //   var radBrush = $(go.Brush, \"Radial\", { 0: \"rgba(248,248,242,0)\", 1: 'RGB(255,242,0)' });\n          //   return radBrush;\n          // })\n          //\n        ),\n        $(go.Placeholder) // this represents the selected Node\n      ),\n\n      // ),\n      // the button to create a \"next\" node, at the top-right corner\n      //   $(\n      //     \"CircleButton\",\n      //     {\n      //       name: \"fireButton\",\n      //       visible: false,\n      //       toolTip: $(\n      //         \"ToolTip\",\n      //         $(\n      //           go.Panel,\n      //           \"Vertical\",\n\n      //           $(go.TextBlock, { text: \"碰撞火花\", margin: 3 })\n      //         )\n      //       ),\n      //     //   toolTip: $(\n      //     //     go.Adornment,\n      //     //     \"Auto\",\n      //     //     // $(go.Shape, { fill: \"#FFFFCC\" }),\n      //     //     $(\n      //     //       go.TextBlock,\n      //     //       { textAlign: \"center\", margin: new go.Margin(8, 4, 4, 4) }, // the tooltip shows the result of calling nodeInfo(data)\n      //     //       new go.Binding(\"text\", \"\", function(d) {\n      //     //         return \"碰撞火花\";\n      //     //       })\n      //     //     )\n      //     //   ),\n\n      //       alignment: new go.Spot(1, 0, 20, -20),\n      //       //   alignmentFocus: go.Spot.Left,\n      //       width: 50,\n      //       height: 50,\n      //       click: function(e) {\n      //         e.diagram.__trtd.addOlive();\n      //       } // this function is defined below\n      //     },\n      //     new go.Binding(\"visible\", \"\", function(v, obj){\n      //         console.log(\"showfireButton\", v, obj);\n      //         var node = obj.part;\n      //         // if(node.data.subRole == \"coreText\") return true;\n      //         return false;\n      //     }),\n      //     // $(go.Shape, \"FireHazard\", {\n      //     $(go.Shape, {\n      //       geometryString:\n      //         \"M854.35904 613.09952v44.52864c-0.6656 2.16576-1.46944 4.33152-1.92 6.54336-4.55168 23.53664-7.1168 47.68768-13.9776 70.528-20.36224 67.39968-58.5216 123.57632-112.01024 169.43616-41.25184 35.39968-87.68512 60.9024-140.75904 73.45152-17.44896 4.13696-35.34336 6.57408-53.0432 9.79968h-44.51328c-2.16576-0.6656-4.3776-1.67424-6.59456-1.8176-46.99136-2.93376-91.52512-15.16544-133.2992-36.51072-78.96576-40.22272-135.93088-100.11136-161.9456-186.27072-5.53984-18.41664-7.85408-37.71392-11.69408-56.62208v-42.48064c1.67424-10.4448 3.1232-20.97664 5.0944-31.41632 8.41728-45.58848 28.67712-85.9648 55.51104-123.22816 25.30304-35.072 52.18304-69.04832 76.1856-105.0112 25.94816-39.0144 38.5024-82.31936 31.13984-129.80224-1.44896-9.37984-2.80576-18.75968-4.22912-28.08832 0.95744-0.24576 1.92-0.44032 2.87744-0.7168 57.92256 60.70784 67.3536 135.2192 59.07968 215.74144 2.11456-2.26304 3.8912-3.84 5.24288-5.66272 49.16224-66.48832 70.28224-139.93984 54.25152-222.208-10.1888-52.33664-32.22016-99.3792-68.67456-138.496-15.83104-16.93696-34.97984-30.79168-52.6336-46.08h18.21696c1.50528 0.6144 2.90816 1.67424 4.4288 1.8176 32.0512 2.75968 62.1568 12.65152 90.83904 26.56256 65.59744 31.75424 118.77376 78.69952 163.25632 135.95648 65.3824 84.26496 107.88864 177.73056 116.31104 285.35296 3.2256 41.08288-0.96256 81.01376-11.91424 120.40192-4.13696 14.91456-9.96864 29.3376-15.3088 44.8768 21.21728-9.0368 37.34016-22.84544 49.79712-40.74496 37.1456-53.48864 47.53408-113.13664 39.1168-179.08224 2.73408 3.1744 4.13696 4.4288 5.08928 6.00576 22.3744 35.34848 39.1168 73.0624 47.85664 114.04288 3.47136 16.22016 5.49376 32.8192 8.22272 49.19296m-349.952-78.42816c-0.82944 0.5888-1.7408 1.19808-2.60096 1.792-1.16224 16.24576-2.0224 32.52224-3.59936 48.768-2.31424 24.78592-8.2432 48.6912-19.84 70.91712-14.17728 27.22816-37.88288 44.16-64.1536 57.63072-28.32896 14.6176-46.17216 35.49696-48.4864 68.4544-2.41664 33.8944 7.77728 62.37696 35.10272 83.20512 25.6 19.49696 55.50592 25.85088 87.21408 24.79104 50.60608-1.64864 88.32512-25.7024 103.43424-76.35968 10.85952-36.36224 9.088-72.97024 1.82784-109.568-9.92768-50.176-28.09344-96.94208-59.1872-137.92256-8.7296-11.45344-19.7632-21.17632-29.70624-31.70816\",\n      //       stroke: \"red\",\n      //       fill: \"red\",\n      //       desiredSize: new go.Size(25, 25)\n      //     })\n      //   ),\n\n      // $(go.Panel, \"Auto\", {        // 放大镜\n      //         name: \"ButtonIcon1\",\n      //         alignment: new go.Spot(0, 1, 5, -5),\n      //         //alignment: go.Spot.BottomLeft,\n      //         //alignmentFocus: go.Spot.BottomLeft,\n      //         width: 60,\n      //         height: 60,\n      //         isActionable: true,\n      //         click: expandCollapse // this function is defined below\n      //     },\n\n      //     $(go.Shape, \"Circle\", {\n      //         fill: \"rgba(1,1,1,0)\",\n      //         strokeWidth: 0,\n      //         stroke: \"green\",\n      //         width: 50,\n      //         height: 50\n      //     }),\n      $(\n        go.Panel,\n        \"Auto\",\n        {\n          // 放大镜\n          name: \"ButtonIcon1\",\n          visible: false,\n          //   alignment: new go.Spot(0, 1, 5, -5),\n          alignment: new go.Spot(1, 0, 20, -20),\n          //alignment: go.Spot.BottomLeft,\n          //alignmentFocus: go.Spot.BottomLeft,\n          width: 60,\n          height: 60,\n          isActionable: true,\n          toolTip: $(\n            \"ToolTip\",\n            $(\n              go.Panel,\n              \"Vertical\",\n              $(\n                go.Picture,\n                new go.Binding(\"source\", \"src\", function(s) {\n                  return \"images/\" + s + \".png\";\n                })\n              ),\n              $(go.TextBlock, { text: \"碰撞火花\", margin: 3 })\n            )\n          ),\n          cursor: \"pointer\",\n          click: function(e, part) {\n            //    if()\n\n            that.dealFireText(e, part);\n            // diagram.commandHandler.scrollToPart(centerNode)\n          } // this function is defined below\n        },\n        new go.Binding(\"visible\", \"\", function(e, obj) {\n          if (obj.part.data.subRole == \"coreText\") {\n            return true;\n          }\n          return false;\n        }),\n        $(go.Shape, \"Circle\", {\n          fill: \"rgba(1,1,1,0)\",\n          strokeWidth: 0,\n          stroke: \"green\",\n          width: 50,\n          height: 60\n        }),\n        $(\n          go.Shape,\n          {\n            //   _para1: true,\n\n            name: \"FireButton\",\n            fill: \"red\",\n            width: 30,\n            height: 40,\n            strokeWidth: 2,\n            stroke: \"red\"\n            //   geometryString: icons[\"zoomout\"], // default value for isTreeExpanded is true\n            //   desiredSize: new go.Size(30, 30),\n          },\n          new go.Binding(\"geometryString\", \"\", function(d, button) {\n            // console.log('dddddd:', d);\n            // console.log('button:', button);\n            // var myDiagram = d.diagram;\n            // var node = myDiagram.selection.first();\n            // if (node[\"_controlExpand\"]) {\n            //     return icons[\"zoomout\"];\n            // } else {\n            //     return icons[\"zoomin\"];\n            // }\n            return \"M854.35904 613.09952v44.52864c-0.6656 2.16576-1.46944 4.33152-1.92 6.54336-4.55168 23.53664-7.1168 47.68768-13.9776 70.528-20.36224 67.39968-58.5216 123.57632-112.01024 169.43616-41.25184 35.39968-87.68512 60.9024-140.75904 73.45152-17.44896 4.13696-35.34336 6.57408-53.0432 9.79968h-44.51328c-2.16576-0.6656-4.3776-1.67424-6.59456-1.8176-46.99136-2.93376-91.52512-15.16544-133.2992-36.51072-78.96576-40.22272-135.93088-100.11136-161.9456-186.27072-5.53984-18.41664-7.85408-37.71392-11.69408-56.62208v-42.48064c1.67424-10.4448 3.1232-20.97664 5.0944-31.41632 8.41728-45.58848 28.67712-85.9648 55.51104-123.22816 25.30304-35.072 52.18304-69.04832 76.1856-105.0112 25.94816-39.0144 38.5024-82.31936 31.13984-129.80224-1.44896-9.37984-2.80576-18.75968-4.22912-28.08832 0.95744-0.24576 1.92-0.44032 2.87744-0.7168 57.92256 60.70784 67.3536 135.2192 59.07968 215.74144 2.11456-2.26304 3.8912-3.84 5.24288-5.66272 49.16224-66.48832 70.28224-139.93984 54.25152-222.208-10.1888-52.33664-32.22016-99.3792-68.67456-138.496-15.83104-16.93696-34.97984-30.79168-52.6336-46.08h18.21696c1.50528 0.6144 2.90816 1.67424 4.4288 1.8176 32.0512 2.75968 62.1568 12.65152 90.83904 26.56256 65.59744 31.75424 118.77376 78.69952 163.25632 135.95648 65.3824 84.26496 107.88864 177.73056 116.31104 285.35296 3.2256 41.08288-0.96256 81.01376-11.91424 120.40192-4.13696 14.91456-9.96864 29.3376-15.3088 44.8768 21.21728-9.0368 37.34016-22.84544 49.79712-40.74496 37.1456-53.48864 47.53408-113.13664 39.1168-179.08224 2.73408 3.1744 4.13696 4.4288 5.08928 6.00576 22.3744 35.34848 39.1168 73.0624 47.85664 114.04288 3.47136 16.22016 5.49376 32.8192 8.22272 49.19296m-349.952-78.42816c-0.82944 0.5888-1.7408 1.19808-2.60096 1.792-1.16224 16.24576-2.0224 32.52224-3.59936 48.768-2.31424 24.78592-8.2432 48.6912-19.84 70.91712-14.17728 27.22816-37.88288 44.16-64.1536 57.63072-28.32896 14.6176-46.17216 35.49696-48.4864 68.4544-2.41664 33.8944 7.77728 62.37696 35.10272 83.20512 25.6 19.49696 55.50592 25.85088 87.21408 24.79104 50.60608-1.64864 88.32512-25.7024 103.43424-76.35968 10.85952-36.36224 9.088-72.97024 1.82784-109.568-9.92768-50.176-28.09344-96.94208-59.1872-137.92256-8.7296-11.45344-19.7632-21.17632-29.70624-31.70816\";\n          })\n        )\n      )\n      // )\n    );\n  }\n  clearBorder(node) {\n    if (node.data.showBorder) {\n      // if(node.data.text == \"\"){\n      node.findObject(\"textBorder\").visible = false;\n      // }\n    }\n  }\n\n  makeGeo(data, shape, options) {\n    // this is much more efficient than calling go.GraphObject.make:\n    var { radiusX = 150, radiusY = 100 } = data;\n    var geo = new go.Geometry().add(\n      new go.PathFigure(0, 0) // start point\n        .add(\n          new go.PathSegment(\n            go.PathSegment.SvgArc,\n            radiusX * 2,\n            0,\n            radiusX,\n            radiusY,\n            0,\n            1,\n            options.clockwiseFlag ? 1 : 0\n          )\n        )\n    );\n    geo.defaultStretch = go.GraphObject.Fill;\n    return geo;\n  }\n  getNodeTemplate() {\n    var properties = {\n      figure: \"Rectangle\",\n      fill: \"rgba(0,0,0,0)\",\n      strokeWidth: 1,\n      stroke: \"rgba(0,0,0,0)\",\n      fontSize: 15,\n      font: \"sans-serif\"\n    };\n    var that = this;\n    var diagram = this.diagram;\n    return $(\n      go.Node,\n      \"Spot\",\n      {\n        _controlExpand: true,\n        __trtdNode: that,\n        layerName: \"Foreground\",\n        zOrder: 10,\n        movable: true,\n        //   copyable: false,\n        visible: true,\n        locationSpot: go.Spot.Center,\n        resizeCellSize: new go.Size(10, 10),\n        toolTip: that.getTooTip(),\n        //   locationObjectName: \"textBorder\",\n        //   selectionObjectName: \"textBorder\",\n        resizable: true,\n        //   selectable: false,\n        //   clickable: false,\n        // resizeObjectName: \"SHAPE\", // user can resize the Shape\n        rotatable: false,\n        location: new go.Point(0, 0),\n        //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\n        // doubleClick: selectText,\n        toMaxLinks: 1,\n        mouseDrop: function(e, obj) {\n          var node = obj.part;\n          var selnode = e.diagram.selection.first();\n\n          // 常变\n          if (\n            selnode.data.category == \"picGroup\" &&\n            selnode.data.role == \"cbian\" &&\n            node.data.role == \"centerText\"\n          ) {\n            var oliveNode = e.diagram.findNodeForKey(node.data.olive);\n            if (!oliveNode) return;\n            var it = selnode.findSubGraphParts().iterator;\n            var deleteObjs = [];\n            var cbian = {};\n            while (it.next()) {\n              var n = it.value;\n              if (n.data.category == \"autoText\") {\n                if (n.data.locationSpot == \"0 0 0 0\") {\n                  cbian.shiText = n.data.text;\n                }\n                if (n.data.locationSpot == \"0 0.5 0 0\") {\n                  cbian.centerText = n.data.text;\n                }\n                if (n.data.locationSpot == \"0 1 0 0\") {\n                  cbian.xuText = n.data.text;\n                }\n              }\n              deleteObjs.push(n.data);\n            }\n            e.diagram.startTransaction(\"mouseDrop\");\n            // 删除总结图\n            e.diagram.model.removeNodeDataCollection(deleteObjs);\n            var backupSelnode = JSON.parse(JSON.stringify(selnode.data));\n            e.diagram.model.removeNodeData(selnode.data);\n\n            // 添加新橄榄\n            e.diagram.__trtd.addOlive(oliveNode, cbian);\n            e.diagram.commitTransaction(\"mouseDrop\");\n            return;\n          }\n\n          // 互换要点文字,只有云盘里的文字可以互换\n          if (\n            (selnode.data.subRole == \"coreText\" &&\n              node.data.subRole == \"coreText\") ||\n            (selnode.data.subRole == \"yunpanText\" &&\n              node.data.subRole == \"yunpanText\")\n          ) {\n            e.diagram.model.startTransaction(\"coreTextExchange\");\n            var selOrderX = selnode.data.orderX;\n            var selOrderY = selnode.data.orderY;\n            var selDimKey = selnode.data.dimKey;\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"orderX\",\n              node.data.orderX\n            );\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"orderY\",\n              node.data.orderY\n            );\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"dimKey\",\n              node.data.dimKey\n            );\n            e.diagram.model.setDataProperty(node.data, \"orderX\", selOrderX);\n            e.diagram.model.setDataProperty(node.data, \"orderY\", selOrderY);\n            e.diagram.model.setDataProperty(node.data, \"dimKey\", selDimKey);\n            e.diagram.model.commitTransaction(\"coreTextExchange\");\n          }\n          console.log(\"switch dim1\")\n          // 云盘互换维度\n          if(selnode.containingGroup && selnode.containingGroup.data.category == \"yunpanGroup\"){\n            if (\n              selnode.data.subRole == \"dimText\" &&\n              node.data.subRole == \"dimText\" &&\n              selnode.data.category == node.data.category\n            ) {\n              if (selnode.data.group != node.data.group) return;\n              // if (!selnode.containingGroup) return;\n              // if (selnode.containingGroup.data.category != \"yunpanGroup\") return;\n              if (\n                !(\n                  selnode.data.dimX == node.data.dimX ||\n                  selnode.data.dimY == node.data.dimY\n                )\n              ) {\n                return;\n              }\n              console.log(\"switch dim\")\n              e.diagram.model.startTransaction(\"dimTextExchange\");\n              var selOrderX = selnode.data.dimX;\n              var selOrderY = selnode.data.dimY;\n              var it = node.containingGroup.findSubGraphParts().iterator;\n              var nodeCoreTexts = [];\n              var selnodeCoreTexts = [];\n              var yunnodeCoreTexts = [];\n              var yunselnodeCoreTexts = [];\n              var normDim = \"X\";\n              if (selnode.data.dimX == 0) {\n                normDim = \"Y\";\n              }\n              var selOrder = selnode.data[\"dim\" + normDim];\n              var nodeOrder = node.data[\"dim\" + normDim];\n              while (it.next()) {\n                var n = it.value;\n                if (n.data.subRole == \"yunpanText\") {\n                  if (n.data[\"order\" + normDim] == nodeOrder) {\n                    yunnodeCoreTexts.push(n);\n                  }\n                  if (n.data[\"order\" + normDim] == selOrder) {\n                    yunselnodeCoreTexts.push(n);\n                  }\n                }\n              }\n              var tmpX, tmpY;\n              for (var i = 0; i < yunnodeCoreTexts.length; i++) {\n                e.diagram.model.setDataProperty(\n                  yunnodeCoreTexts[i].data,\n                  \"order\" + normDim,\n                  selOrder\n                );\n              }\n              for (var i = 0; i < yunselnodeCoreTexts.length; i++) {\n                e.diagram.model.setDataProperty(\n                  yunselnodeCoreTexts[i].data,\n                  \"order\" + normDim,\n                  nodeOrder\n                );\n              }\n              e.diagram.model.setDataProperty(\n                selnode.data,\n                \"dim\" + normDim,\n                nodeOrder\n              );\n              e.diagram.model.setDataProperty(\n                node.data,\n                \"dim\" + normDim,\n                selOrder\n              );\n              // e.diagram.model.setDataProperty(\n              //   node.data,\n              //   \"rho\" + normDim,\n              //   selOrder\n              // );\n              e.diagram.model.commitTransaction(\"dimTextExchange\");\n              return;\n            }\n          }\n      \n\n          // 互换维度\n          if (\n            selnode.data.subRole == \"dimText\" &&\n            node.data.subRole == \"dimText\"\n          ) {\n            e.diagram.model.startTransaction(\"dimTextExchange\");\n            var selDimId = selnode.data.dimid;\n            var selOrderX = selnode.data.dimX;\n            var selOrderY = selnode.data.dimY;\n            var it = node.containingGroup.findSubGraphParts().iterator;\n            var nodeCoreTexts = [];\n            var selnodeCoreTexts = [];\n            var yunnodeCoreTexts = [];\n            var yunselnodeCoreTexts = [];\n            var normDim = \"X\";\n            if (selnode.data.dimX == 0) {\n              normDim = \"Y\";\n            }\n            while (it.next()) {\n              var n = it.value;\n              if (n.data.dimKey == node.data.key) {\n                nodeCoreTexts.push(n);\n              }\n              if (n.data.dimKey == selnode.data.key) {\n                selnodeCoreTexts.push(n);\n              }\n              if (n.data.subRole == \"yunpanText\") {\n                if (n.data[\"order\" + normDim] == node.data[\"order\" + normDim]) {\n                  yunnodeCoreTexts.push(n);\n                }\n                if (\n                  n.data[\"order\" + normDim] == selnode.data[\"order\" + normDim]\n                ) {\n                  yunselnodeCoreTexts.push(n);\n                }\n              }\n            }\n            console.log(\n              \"selnodeCoreTextsselnodeCoreTextsselnodeCoreTexts\",\n              selnodeCoreTexts.length\n            );\n            var centerOrderX =\n              (node.containingGroup.__yunPointsX.length + 1) / 2;\n            var centerOrderY =\n              (node.containingGroup.__yunPointsY.length + 1) / 2;\n\n            if (selnode.data.dimX > centerOrderX) {\n              selnodeCoreTexts.sort(function(a, b) {\n                return a.data.orderX - b.data.orderX;\n              });\n            }\n            if (selnode.data.dimX == centerOrderX) {\n              if (selnode.data.dimY > centerOrderY) {\n                selnodeCoreTexts.sort(function(a, b) {\n                  return a.data.orderY - b.data.orderY;\n                });\n              } else {\n                selnodeCoreTexts.sort(function(a, b) {\n                  return b.data.orderY - a.data.orderY;\n                });\n              }\n            }\n            if (selnode.data.dimX < centerOrderX) {\n              selnodeCoreTexts.sort(function(a, b) {\n                return b.data.orderX - a.data.orderX;\n              });\n            }\n\n            if (node.data.dimX > centerOrderX) {\n              nodeCoreTexts.sort(function(a, b) {\n                return a.data.orderX - b.data.orderX;\n              });\n            }\n            if (node.data.dimX == centerOrderX) {\n              if (node.data.dimY > centerOrderY) {\n                nodeCoreTexts.sort(function(a, b) {\n                  return a.data.orderY - b.data.orderY;\n                });\n              } else {\n                nodeCoreTexts.sort(function(a, b) {\n                  return b.data.orderY - a.data.orderY;\n                });\n              }\n            }\n            if (node.data.dimX < centerOrderX) {\n              nodeCoreTexts.sort(function(a, b) {\n                return b.data.orderX - a.data.orderX;\n              });\n            }\n\n            var tmpX, tmpY;\n            for (var i = 0; i < selnodeCoreTexts.length; i++) {\n              tmpX = selnodeCoreTexts[i].data.orderX;\n              tmpY = selnodeCoreTexts[i].data.orderY;\n              e.diagram.model.setDataProperty(\n                selnodeCoreTexts[i].data,\n                \"orderX\",\n                nodeCoreTexts[i].data.orderX\n              );\n              e.diagram.model.setDataProperty(\n                selnodeCoreTexts[i].data,\n                \"orderY\",\n                nodeCoreTexts[i].data.orderY\n              );\n              e.diagram.model.setDataProperty(\n                nodeCoreTexts[i].data,\n                \"orderX\",\n                tmpX\n              );\n              e.diagram.model.setDataProperty(\n                nodeCoreTexts[i].data,\n                \"orderY\",\n                tmpY\n              );\n            }\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"dimid\",\n              node.data.dimid\n            );\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"dimX\",\n              node.data.dimX\n            );\n            e.diagram.model.setDataProperty(\n              selnode.data,\n              \"dimY\",\n              node.data.dimY\n            );\n            e.diagram.model.setDataProperty(node.data, \"dimid\", selDimId);\n            e.diagram.model.setDataProperty(node.data, \"dimX\", selOrderX);\n            e.diagram.model.setDataProperty(node.data, \"dimY\", selOrderY);\n            e.diagram.model.commitTransaction(\"dimTextExchange\");\n          }\n\n          if (selnode.data.category != \"wave\") {\n            return;\n          }\n          if (node.data.role != \"centerText\") {\n            return;\n          }\n          if (!node) {\n            // node.containingGroup.layout.isValidLayout = false\n            return;\n          }\n          if (selnode.data.group != obj.data.group) {\n            return;\n          }\n          e.diagram.startTransaction(\"mouseDrop\");\n          selnode.__oldOrder = selnode.data.order;\n          e.diagram.model.setDataProperty(\n            selnode.data,\n            \"order\",\n            node.data.order + 0.5\n          );\n          var xuText = e.diagram.model.findNodeDataForKey(selnode.data.xuText);\n          var shiText = e.diagram.model.findNodeDataForKey(\n            selnode.data.shiText\n          );\n          e.diagram.model.setDataProperty(\n            shiText,\n            \"order\",\n            node.data.order + 0.5\n          );\n          e.diagram.model.setDataProperty(\n            xuText,\n            \"order\",\n            node.data.order + 0.5\n          );\n          // node.containingGroup.layout.isValidLayout = false\n          e.diagram.commitTransaction(\"mouseDrop\");\n        },\n        mouseDragEnter: function(e, obj) {\n          var node = obj.part;\n          var selnode = e.diagram.selection.first();\n          if (!selnode) return;\n          if (\n            (selnode.data.subRole == \"coreText\" &&\n              node.data.subRole == \"coreText\") ||\n            (selnode.data.subRole == \"yunpanText\" &&\n              node.data.subRole == \"yunpanText\")\n          ) {\n            selnode.areaBackground = null;\n            node.areaBackground = \"RGB(107,208,137)\";\n          }\n          if (\n            selnode.data.subRole == \"dimText\" &&\n            node.data.subRole == \"dimText\"\n          ) {\n            selnode.areaBackground = null;\n            node.areaBackground = \"RGB(107,208,137)\";\n          }\n\n          if (node.data.role == \"centerText\") {\n            node.layerName = \"Background\";\n          }\n          // if (!(selnode instanceof go.Node)  || selnode.data.role != \"freeText\"  || selnode.category != \"autoText\" ||selnode.data.subRole != \"coreText\") {\n          //     return;\n          // }\n\n          // //var sat = node.selectionAdornmentTemplate;\n          // //var adorn = sat.copy();\n          // //adorn.adornedObject = node;\n          // //node.addAdornment(\"dragEnter\", adorn);\n\n          // //if (!mayWorkFor(selnode, node)) return;\n          // var shape = node.findObject(\"SHAPE\");\n          // if (shape) {\n          //     shape._prevFill = shape.fill; // remember the original brush\n          //     shape.fill = \"darkred\";\n          // }\n        },\n        mouseDragLeave: function(e, obj) {\n          var node = obj.part;\n          var selnode = e.diagram.selection.first();\n          // var shape = node.findObject(\"SHAPE\");\n          if (\n            (selnode.data.subRole == \"coreText\" &&\n              node.data.subRole == \"coreText\") ||\n            (selnode.data.subRole == \"yunpanText\" &&\n              node.data.subRole == \"yunpanText\")\n          ) {\n            node.areaBackground = null;\n          }\n          if (\n            selnode.data.subRole == \"dimText\" &&\n            node.data.subRole == \"dimText\"\n          ) {\n            node.areaBackground = null;\n          }\n          if (node.data.role == \"centerText\") {\n            node.layerName = \"Foreground\";\n          }\n          //node.removeAdornment(\"dragEnter\");\n        },\n        selectionChanged: node => {\n          console.log(\"selectionChanged\", node);\n\n          if (\n            node.data.category != \"autoText\" ||\n            node.data.orderX == null ||\n            node.data.orderY == null ||\n            node.data.role != \"freeText\" ||\n            (node.data.subRole != \"coreText\" &&\n              node.data.subRole != \"yunpanText\")\n          ) {\n            return;\n          }\n\n          if (\n            !node.containingGroup ||\n            (node.containingGroup.data.category != \"yunGroup\" &&\n              node.containingGroup.data.category != \"yunpanGroup\")\n          ) {\n            return;\n          }\n\n          if (node.containingGroup.data.beginSpark != \"line\") {\n            return;\n          }\n          if (\n            node.containingGroup.__yunPointsX &&\n            node.containingGroup.__yunPointsY\n          ) {\n            var centerOrderX =\n              (node.containingGroup.__yunPointsX.length + 1) / 2;\n            var centerOrderY =\n              (node.containingGroup.__yunPointsY.length + 1) / 2;\n            if (\n              node.data.orderX == centerOrderX &&\n              node.data.orderY == centerOrderY\n            ) {\n              // 中心文字不参与变色\n              return;\n            }\n            var orderX = node.data.orderX,\n              orderY = node.data.orderY;\n            if (orderX == centerOrderX) {\n              orderX = orderY;\n            }\n            if (orderY == centerOrderY) {\n              orderY = orderX;\n            }\n            var shapeStrokes = node.containingGroup.data.shapeStrokes;\n            var showShape = node.containingGroup.data.showShape; // 是否显示矩形\n            if (node.isSelected) {\n              if (node.containingGroup.data.snapType == \"between\") {\n                var diff =\n                  Math.max(\n                    Math.abs(node.data.orderX - centerOrderX),\n                    Math.abs(node.data.orderY - centerOrderY)\n                  ) + 1;\n              } else {\n                var diff = Math.max(\n                  Math.abs(node.data.orderX - centerOrderX),\n                  Math.abs(node.data.orderY - centerOrderY)\n                );\n              }\n              console.log(\"diff:\", diff, node.data.orderX, node.data.orderY);\n              var it = node.containingGroup.findSubGraphParts().iterator;\n\n              console.log(\"showShape\", showShape);\n              // var beginSpark = node.containingGroup.data.beginSpark; // 是否显示矩形\n              var shape = null;\n              while (it.next()) {\n                var n = it.value;\n                if (\n                  n.data.category == \"autoText\" &&\n                  n.data.orderX != null &&\n                  n.data.orderY != null &&\n                  n.data.role == \"freeText\"\n                ) {\n                  n.findObject(\"textBorder\").visible = false;\n                  // if((Math.abs(n.data.orderX-centerOrderX) == Math.abs(orderX-centerOrderX)\n                  //     || Math.abs(n.data.orderX-centerOrderY) == Math.abs(orderY-centerOrderY))\n                  // && !(Math.abs(n.data.orderX-centerOrderY) < Math.abs(orderY-centerOrderY)\n                  //     && Math.abs(n.data.orderX-centerOrderX) < Math.abs(orderX-centerOrderX))){\n                  //     n.areaBackground = \"red\"\n                  // }\n\n                  if (\n                    (Math.abs(n.data.orderX - centerOrderX) ==\n                      Math.abs(orderX - centerOrderX) &&\n                      Math.abs(n.data.orderY - centerOrderY) <=\n                        Math.abs(orderY - centerOrderY)) ||\n                    (Math.abs(n.data.orderX - centerOrderX) <=\n                      Math.abs(orderX - centerOrderX) &&\n                      Math.abs(n.data.orderY - centerOrderY) ==\n                        Math.abs(orderY - centerOrderY))\n                  ) {\n                    // n.findObject(\"place\").visible = true;\n                    // n.__backupFont = n.findObject(\"TEXT\").font\n                    // n.findObject(\"TEXT\").font = \"40px 'Microsoft YaHei'\";\n                    // n.__backupMaxSize = n.maxSize\n                    // n.maxSize = new go.Size(200,200)\n                    n.areaBackground = \"white\";\n                    n.zOrder = 999;\n                  }\n                }\n                if (n.data.category == \"shape\" && n.data.role == \"background\") {\n                  var obj = n.findObject(\"SHAPE\");\n                  // console.log(\"dfsdfsdfsdf\", obj)\n                  if (n.data.gridWidth == diff * 2) {\n                    shape = obj;\n                    // if(showShape){\n                    // n.visible = true\n                    // }\n                    if (!obj.__prestroke) {\n                      obj.__prestroke = obj.stroke;\n                      obj.stroke = \"rgba(255,0,0,0.5)\";\n                    }\n                  } else {\n                    if (obj.__prestroke) {\n                      obj.stroke = obj.__prestroke;\n                      delete obj.__prestroke;\n                    }\n                  }\n                }\n              }\n              if (!shape) {\n                if (node.containingGroup.data.snapType == \"between\") {\n                  var gridWidth = diff * 2;\n                } else {\n                  var gridWidth = diff * 2;\n                }\n                console.log(\"addShape\");\n                node.diagram.model.startTransaction(\"addShape\");\n                var shapeData = {\n                  deletable: true,\n                  role: \"background\",\n                  category: \"shape\",\n                  // \"loc\":\"-1532.0268216255727 9.121091688849674\",\n                  loc: go.Point.stringify(\n                    new go.Point(\n                      node.containingGroup.__yunPointsX[centerOrderX - 1],\n                      node.containingGroup.__yunPointsY[centerOrderY - 1]\n                    )\n                  ),\n                  movable: true,\n                  group: -19,\n                  key: helpers.guid(),\n                  orderX: 10,\n                  orderY: 10,\n                  gridWidth: gridWidth,\n                  stroke: shapeStrokes[diff - 1],\n                  visible: true,\n                  strokeDashArray: \"[0,0]\",\n                  strokeWidth: 3\n                  //   \"desiredSize\":\"1263 1263\"\n                };\n                node.diagram.model.addNodeData(shapeData);\n                node.diagram.model.commitTransaction(\"addShape\");\n                setTimeout(() => {\n                  var nod = node.diagram.findNodeForKey(shapeData.key);\n                  console.log(\"add shape add shape\");\n                  if (nod) {\n                    // nod.visible = true\n                    var obj = nod.findObject(\"SHAPE\");\n                    if (!obj.__prestroke) {\n                      obj.__prestroke = obj.stroke;\n                      obj.stroke = \"rgba(255,0,0,0.5)\";\n                    }\n                  }\n                }, 100);\n              }\n            } else {\n              var it = node.containingGroup.findSubGraphParts().iterator;\n              while (it.next()) {\n                var n = it.value;\n                n.opacity = 1;\n                // var textObj = n.findObject(\"TEXT\");\n                // if(textObj && textObj.__font){\n                //     textObj.font = textObj.__font;\n                //     delete textObj.__font\n                // }\n                // obj.__font = obj.font;\n                // obj.font = \"40px 'Microsoft YaHei'\";\n                if (\n                  n.data.category == \"autoText\" &&\n                  n.data.orderX != null &&\n                  n.data.orderY != null &&\n                  n.data.role == \"freeText\"\n                ) {\n                  // n.findObject(\"textBorder\").visible = false;\n                  // if((n.data.orderX == orderX || n.data.orderY == orderY)\n                  // && !(n.data.orderX < orderX && n.data.orderY <orderY )){\n                  //     n.areaBackground = \"red\"\n                  // }\n\n                  if (\n                    (Math.abs(n.data.orderX - centerOrderX) ==\n                      Math.abs(orderX - centerOrderX) &&\n                      Math.abs(n.data.orderY - centerOrderY) <=\n                        Math.abs(orderY - centerOrderY)) ||\n                    (Math.abs(n.data.orderX - centerOrderX) <=\n                      Math.abs(orderX - centerOrderX) &&\n                      Math.abs(n.data.orderY - centerOrderY) ==\n                        Math.abs(orderY - centerOrderY))\n                  ) {\n                    // n.findObject(\"textBorder\").visible = true;\n                    // n.findObject(\"place\").visible = false;\n                    // n.__backupMaxSize = n.maxSize\n                    // n.maxSize = n.__backupMaxSize\n                    // n.findObject(\"TEXT\").font = n.__backupFont\n                    // n.findObject(\"TEXT\").font = \"40px 'Microsoft YaHei'\";\n                    n.areaBackground = null;\n                    n.zOrder = NaN;\n                  }\n                }\n                if (n.data.category == \"shape\" && n.data.role == \"background\") {\n                  var obj = n.findObject(\"SHAPE\");\n                  // console.log(\"dfsdfsdfsdf\", obj)\n                  if (!showShape) {\n                    // n.visible = false\n                    obj.stroke = \"rgba(255,0,0,0)\";\n                  }\n                  if (n.data.gridWidth == diff * 2) {\n                    if (!obj.__prestroke) {\n                      obj.__prestroke = obj.stroke;\n                      obj.stroke = \"rgba(255,0,0,0.7)\";\n                    }\n                  } else {\n                    if (obj.__prestroke) {\n                      obj.stroke = obj.__prestroke;\n                      delete obj.__prestroke;\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        click: (e, node) => {\n          console.log(node.data);\n          // if(node.data.group && node.containingGroup.data.category == \"picGroup\"){\n          //     var it = node.containingGroup.findSubGraphParts().iterator;\n          //     var basePoint;\n          //     while(it.next()){\n          //         var n = it.value;\n          //         if(n.data.role == \"theme\"){\n          //             basePoint = n;\n          //             break;\n          //         }\n          //     }\n          //     if(basePoint){\n          //         console.log(`cbian ${node.data.role} offset: `, node.location.copy().subtract(basePoint.location))\n          //     }\n          // }\n          // if(node.data.role == \"centerText\"){\n          //     var waveNode = node.diagram.findNodeForKey(node.data.olive)\n          //     node.layerName = \"Background\"\n          //     if(waveNode){\n          //         node.diagram.select(waveNode)\n          //     }\n          // }\n          // e.diagram.model.startTransaction(\"click\")\n          // e.diagram.model.setDataProperty(node.data, \"dimKey\", -124)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -73)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -141)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -74)\n\n          // e.diagram.model.setDataProperty(node.data, \"dimKey\", -124)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -141)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -158)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -176)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -73)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -74)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -175)\n          // e.diagram.model.setDataProperty(node.data,\"dimKey\", -177)\n          // node.data.dimKey = -124\n          // node.data.dimKey = -141\n          // node.data.dimKey = -158\n          // node.data.dimKey = -176\n          // node.data.dimKey = -73\n          // node.data.dimKey = -74\n          // node.data.dimKey = -175\n          // node.data.dimKey = -177\n\n          // e.diagram.model.commitTransaction(\"click\")\n        },\n        //   rotateAdornmentTemplate:  // specify appearance of rotation handle\n        //   $(go.Adornment,\n        //     { locationSpot: go.Spot.Center },\n        //     $(go.Shape, \"BpmnActivityLoop\",\n        //       { width: 12, height: 12, cursor: \"pointer\",\n        //         background: \"transparent\", stroke: \"dodgerblue\", strokeWidth: 2 })\n        //     ),\n        mouseOver: function(e, node) {\n          // if(node.data.hyperlink){\n          //   var textObj = node.findObject('TEXT');\n          //   textObj.isUnderline = true;\n          // }\n          // console.log(\"mouseOvermouseOvermouseOver\")\n\n          if (node.data.text == \"\") {\n            node.findObject(\"textBorder\").visible = true;\n          }\n\n          if (node.data.showBorder) {\n            if (\n              node.data.text == \"\" &&\n              (node.data.role == \"xuText\" || node.data.role == \"shiText\")\n            ) {\n              node.findObject(\"textBorder\").visible = true;\n            }\n          }\n          if (node.data.role == \"centerText\") {\n            node.layerName = \"Background\";\n            // node.diagram.model.startTransaction(\"centerText\")\n            // node.diagram.model.setDataProperty(node.data,\"layerName\", \"Background\")\n            // node.diagram.model.commitTransaction(\"centerText\")\n          }\n          //   node.areaBackground = \"mediumslateblue\"\n          // }\n\n          // if(!node.containingGroup) return;\n          // var it = node.containingGroup.findSubGraphParts().iterator;\n          // while (it.next()) {\n          //     var n = it.value;\n          //     if(n.data.category == \"autoText\"){\n          //         if(n.data.order == node.data.order){\n          //             // locateNode = n;\n          //             n.areaBackground = \"mediumslateblue\"\n          //         }\n          //     }\n          // }\n          // diagram.__trtd.showNodeRemarkTips(e, node);\n        },\n        mouseLeave: function(e, node) {\n          //   if(node.data.text == \"\"){\n          // if(node.data.showBorder){\n          // if(node.data.text == \"\"){\n          node.findObject(\"textBorder\").visible = false;\n          // }\n          // }\n          if (node.data.role == \"centerText\") {\n            node.layerName = \"Foreground\";\n            // node.diagram.model.startTransaction(\"centerText\")\n            // node.diagram.model.setDataProperty(node.data,\"layerName\", \"Foreground\")\n            // node.diagram.model.commitTransaction(\"centerText\")\n          }\n          // node.areaBackground = null\n          //   }\n        },\n        //   layoutConditions: go.Part.LayoutStandard,\n        layoutConditions:\n          go.Part.LayoutStandard &\n          go.Part.LayoutRemoved &\n          go.Part.LayoutAdded &\n          ~go.Part.LayoutNodeSized,\n        //layoutConditions:~go.Part.LayoutAdded,\n        // fromLinkable: true, toLinkable: true,\n        alignment: go.Spot.Center,\n        alignmentFocus: go.Spot.Center,\n        contextMenu: $(go.Adornment),\n        // specify what resize handles there are and how they look\n        resizeAdornmentTemplate: $(\n          go.Adornment,\n          \"Spot\",\n          $(go.Placeholder), // takes size and position of adorned object\n          $(\n            go.Shape,\n            \"Circle\", // left resize handle\n            {\n              alignment: go.Spot.Left,\n              cursor: \"col-resize\",\n              desiredSize: new go.Size(9, 9),\n              fill: \"lightblue\",\n              stroke: \"dodgerblue\"\n            }\n          ),\n          $(\n            go.Shape,\n            \"Circle\", // right resize handle\n            {\n              alignment: go.Spot.Right,\n              cursor: \"col-resize\",\n              desiredSize: new go.Size(9, 9),\n              fill: \"lightblue\",\n              stroke: \"dodgerblue\"\n            }\n          ),\n          $(\n            go.Shape,\n            \"Circle\", // right resize handle\n            {\n              alignment: go.Spot.Top,\n              cursor: \"col-resize\",\n              desiredSize: new go.Size(9, 9),\n              fill: \"lightblue\",\n              stroke: \"dodgerblue\"\n            }\n          ),\n          $(\n            go.Shape,\n            \"Circle\", // right resize handle\n            {\n              alignment: go.Spot.Bottom,\n              cursor: \"col-resize\",\n              desiredSize: new go.Size(9, 9),\n              fill: \"lightblue\",\n              stroke: \"dodgerblue\"\n            }\n          )\n          // $(go.TextBlock, // show the width as text\n          //   { alignment: go.Spot.Top, alignmentFocus: new go.Spot(0.5, 1, 0, -2),\n          //     stroke: \"dodgerblue\" },\n          //   new go.Binding(\"text\", \"adornedObject\",\n          //                  function(shp) { return shp.naturalBounds.width.toFixed(0); })\n          //       .ofObject())\n        ),\n        doubleClick: function(e, node) {\n          if(e.diagram.__trtd.textDoubleClick){\n            return e.diagram.__trtd.textDoubleClick(e, node)\n          }\n          e.diagram.__trtd.selectText(e, node);\n        },\n\n        selectionAdornmentTemplate: this.getNodeSelectionAdornmentTemplate()\n      },\n      new go.Binding(\"locationSpot\", \"locationSpot\", function(v) {\n        return go.Spot.parse(v);\n      }).makeTwoWay(function(v) {\n        return go.Spot.stringify(v);\n      }),\n      new go.Binding(\"visible\", \"visible\").makeTwoWay(),\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\n      new go.Binding(\"movable\", \"movable\").makeTwoWay(),\n      new go.Binding(\"rotatable\", \"rotatable\").makeTwoWay(),\n      new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(\n        go.Point.stringify\n      ),\n      new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(),\n      new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\n      new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\n      new go.Binding(\"layerName\", \"layerName\", function(v, d) {\n        return v ? v : \"\";\n      }),\n      $(\n        go.TextBlock,\n        {\n          name: \"TEXT\",\n          alignment: new go.Spot(0, 0),\n          font: \"18px 'Microsoft YaHei'\",\n          editable: false,\n          //   areaBackground:\"gray\",\n          //margin: 3, editable: true,\n          //   background:\"yellow\",\n          stroke: \"black\",\n          isMultiline: true,\n          // overflow: go.TextBlock.OverflowEllipsis,\n          wrap: go.TextBlock.WrapDesiredSize,\n          textAlign: \"start\",\n          verticalAlignment: go.Spot.Center,\n          spacingAbove: 1,\n          spacingBelow: 1,\n          portId: \"TEXT\",\n          margin: 5,\n          maxSize: new go.Size(300, NaN),\n          minSize: new go.Size(50, 10),\n          stretch: go.GraphObject.UniformToFill,\n          textEdited: function(textBlock, oldv, newv) {\n            // // if(textBlock.part.containingGroup.data.textAngle == \"horizontal\"){\n            //   var centerText = textBlock.part.diagram.model.findNodeDataForKey(textBlock.part.data.centerText)\n            //   if(centerText){\n            //     console.log(\"centerTextcenterTextcenterTextcenterText\")\n            var part = textBlock.part;\n            if (\n              newv.trim() == \"\" &&\n              (part.data.role == \"shiText\" || part.data.role == \"xuText\")\n            ) {\n              textBlock.part.diagram.model.startTransaction(\"text\");\n              textBlock.part.diagram.model.setDataProperty(\n                textBlock.part.data,\n                \"nloc\",\n                null\n              );\n              textBlock.part.diagram.model.commitTransaction(\"text\");\n            }\n            //   }\n            // //   return;\n            // // }\n            // setTimeout(function(){\n            //   console.log(\"textEditedtextEditedtextEdited\",textBlock.lineCount)\n            //   if(!textBlock.text) return;\n            //   if(textBlock.text && textBlock.text.trim() == \"\") return;\n            //   if(textBlock.lineCount %2 != 0){\n            //     if(newv[newv.length-1] == \"\\n\"){\n            //       textBlock.text = newv.substring(0, newv.length-1)\n            //       return;\n            //     }\n            //     textBlock.text = newv+\"\\n\"\n            //   }\n            // },100)\n\n            // var enterCount = 0;\n            if (\n              textBlock.part.data.role &&\n              textBlock.part.data.role.indexOf(\"labelText\") > -1\n            ) {\n              textBlock.part.containingGroup.layout.isValidLayout = false;\n            }\n            // for(var i=0;i<newv.length;i++){\n\n            // }\n            // textBlock.part.updateTargetBindings()\n\n            // if(textBlock.lineCount %2 != 0){\n            //   if(newv[newv.length-1] == \"\\n\"){\n            //     textBlock.text = newv.substring(0, newv.length-1)\n            //     return;\n            //   }\n            //   textBlock.text = newv+\"\\n\"\n            // }\n          }\n        },\n        new go.Binding(\"areaBackground\", \"isHighlighted\", function(h, shape) {\n          // node.areaBackground = \"RGB(107,208,137)\"\n          if (h) return \"RGBA(146,208,80,0.5)\";\n          return null;\n          var c = shape.part.data.color;\n          return c ? c : \"white\";\n        }).ofObject(), // binding source is Node.isHighlighted\n        new go.Binding(\"background\", \"background\", function(v) {\n          return v;\n        }).makeTwoWay(),\n        new go.Binding(\"areaBackground\", \"areaBackground\", function(v) {\n          return v;\n        }).makeTwoWay(),\n        new go.Binding(\"textAlign\", \"textAlign\", function(v) {\n          return v;\n        }).makeTwoWay(),\n        new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\n          return helpers.tdTransToNum(v, 4);\n        }).makeTwoWay(),\n        new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\n          return helpers.tdTransToNum(v, 4);\n        }).makeTwoWay(),\n        new go.Binding(\"maxSize\", \"\", function(data, d, m) {\n          // console.log(\"maxSize\",v,m,d)\n          var width = 1000;\n          var height = NaN;\n          if (data.width) {\n            width = parseInt(data.width);\n          }\n          if (data.height) {\n            height = parseInt(data.height);\n          }\n\n          return new go.Size(width, height);\n        }),\n        new go.Binding(\"minSize\", \"minSize\", function(v) {\n          // console.log(\"maxSize\",v,m,d)\n\n          return go.Size.parse(v);\n        }),\n        // new go.Binding(\"width\", \"width\", function(v) {\n        //     return v;\n        // }).makeTwoWay(),\n        // new go.Binding(\"height\", \"height\", function(v) {\n        //     return v;\n        // }).makeTwoWay(),\n        // new go.Binding(\"height\", \"height\", function (v) {\n        //   return v;\n        // }).ofObject(\"SHAPE\"),\n        new go.Binding(\"text\", \"text\").makeTwoWay(),\n        new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\n        new go.Binding(\"font\", \"font\").makeTwoWay() \n      ),\n      $(\n        go.Panel,\n        \"Vertical\",\n        { alignment: go.Spot.Left, alignmentFocus: go.Spot.Right },\n        $(\n          go.Shape,\n          {\n            name: \"ICON\",\n            width: 16,\n            height: 16,\n            visible: false,\n            click: function(e) {\n              console.log(\"icon click\");\n            },\n            figure: \"Circle\",\n            fill: \"red\",\n            strokeWidth: 0,\n            margin: 3\n          },\n\n          new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(\n            go.Point.stringify\n          ),\n          new go.Binding(\"figure\", \"figure\").makeTwoWay(),\n          new go.Binding(\"visible\", \"iconVisible\").makeTwoWay(),\n          new go.Binding(\"fill\", \"fill\", function(v, obj) {\n            return v;\n          }).makeTwoWay()\n        )\n      ),\n      $(\n        go.Shape,\n        \"Rectangle\",\n        {\n          name: \"textBorder\",\n          stroke: \"green\",\n          strokeWidth: 3,\n          strokeDashArray: [10, 5],\n          visible: false,\n          fill: \"transparent\",\n          alignment: go.Spot.Center,\n          // alignmentFocus: go.Spot.Right,\n          width: 100,\n          height: 270\n        },\n        new go.Binding(\"stroke\", \"textStroke\"),\n        new go.Binding(\"desiredSize\", \"\", function(v, d) {\n          // console.log(\"vvvvvvvvvvvvv,\",v,d)\n          if (!helpers.checkPhone()) {\n            // return new go.Size(Math.max(d.part.naturalBounds.width,100)-3, Math.max(d.part.naturalBounds.height,100)-3);\n            return new go.Size(\n              d.part.naturalBounds.width - 3,\n              d.part.naturalBounds.height - 3\n            );\n          }\n          var olive = d.part.diagram.findNodeForKey(d.part.data.olive);\n          return new go.Size(\n            olive.naturalBounds.width - 3,\n            olive.naturalBounds.height\n          );\n          // return new go.Size(d.part.actualBounds.width-3, d.part.actualBounds.height-3);\n        })\n      ),\n      $(\n        go.Shape,\n        \"Circle\",\n        {\n          name: \"place\",\n          stroke: \"red\",\n          strokeWidth: 1,\n          strokeDashArray: null,\n          visible: false,\n          fill: \"transparent\",\n          alignment: go.Spot.Center,\n          // alignmentFocus: go.Spot.Right,\n          width: 50,\n          height: 50\n        },\n        new go.Binding(\"stroke\", \"placeStroke\")\n      ),\n      $(\n        go.Shape,\n        {\n          geometryString:\n            \"M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z\",\n          // \"M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 29c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM12 8c-1.105 0-2 0.895-2 2s0.895 2 2 2h5.172l-8.586 8.586c-0.781 0.781-0.781 2.047 0 2.829 0.39 0.39 0.902 0.586 1.414 0.586s1.024-0.195 1.414-0.586l8.586-8.586v5.172c0 1.105 0.895 2 2 2s2-0.895 2-2v-12h-12z\",\n          visible: false,\n          name: \"figure\",\n          cursor: \"pointer\",\n          alignment: new go.Spot(1, 0, 5, -5),\n          alignmentFocus: go.Spot.RightCenter,\n          width: 14,\n          height: 14,\n          fill: \"green\",\n          toolTip: $(\n            \"ToolTip\",\n            $(\n              go.Panel,\n              \"Vertical\",\n              $(\n                go.Picture,\n                new go.Binding(\"source\", \"src\", function(s) {\n                  return \"images/\" + s + \".png\";\n                })\n              ),\n              $(go.TextBlock, { text: \"进入子盘\", margin: 3 })\n            )\n          ),\n          click: function(e) {\n            console.log(\"click figure\", e);\n            var node = e.targetObject.part;\n            e.diagram.__trtd.openFigure({\n              figure: node.data.figure,\n              title: node.data.text,\n              key: node.data.key,\n              node: node\n            });\n          }\n        },\n        // new go.Binding(\"geometry\", \"geo\", function(){\n\n        // })),\n        new go.Binding(\"visible\", \"figure\", function(v) {\n          console.log(\"----------------------\");\n          if (v) {\n            return true;\n          } else {\n            return false;\n          }\n        })\n      )\n    );\n  }\n}\n\nmodule.exports = AutoTextTemplate;\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/autoTextNodeTemplate.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\n// var labelGroupLayout = require(\"../layout/labelGroupLayout\")\r\n\r\nclass LabelGroupNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n    \r\n    switchBorder(group,flag){\r\n      // group.diagram.startTransaction()\r\n      // group.findObject(\"groupBorder\").opacity = flag?1:0;\r\n      group.findObject(\"groupBorder\").opacity = flag?1:0;\r\n      // group.diagram.commitTransaction()\r\n    }\r\n\r\n    hiddenAllText(group){\r\n      // console.log(\"hiddenAllTexthiddenAllTexthiddenAllText\")\r\n      group.diagram.startTransaction()\r\n      var it = group.findSubGraphParts().iterator;\r\n      var oldStatus = null;\r\n      while (it.next()) {\r\n          var n = it.value;\r\n          if(oldStatus==null){\r\n            oldStatus = n.visible;\r\n          }\r\n          if(n.data.category == \"autoText\"){\r\n             group.diagram.model.setDataProperty(n.data,\"visible\", !oldStatus)\r\n          }\r\n      }\r\n      group.diagram.commitTransaction()\r\n    }\r\n\r\n    addLabelText(e, node){\r\n      \r\n      var data = {\"text\":\"说明：内容\",\r\n       \"deletable\":true, \r\n       \"fill\":\"black\", \r\n       \"iconVisible\":true, \r\n       \"locationSpot\":\"0 0 0 0\", \r\n       \"textAlign\":\"start\", \r\n       \"category\":\"autoText\", \r\n       \"loc\": `${node.location.x+30} ${node.location.y}`, \r\n       \"movable\":false, \"group\":node.data.key\r\n      }\r\n      this.diagram.startTransaction(\"addLabelText\")\r\n      this.diagram.model.addNodeData(data);\r\n      this.diagram.commitTransaction(\"addLabelText\")\r\n    }\r\n\r\n    getNodeTemplate(){\r\n      var that = this\r\n      return $(go.Group, \"Spot\",\r\n      { \r\n        __trtdNode: that,\r\n        // copyable: false,\r\n        // selectionObjectName: \"groupBorder\",\r\n        layerName: \"default\",\r\n        locationObjectName: \"groupBorder\",\r\n        zOrder: 5,\r\n        // margin:30,\r\n        // padding:30,\r\n        background:\"rgba(0,0,0,0)\",\r\n        rotatable: false,\r\n        minSize: new go.Size(200,100),\r\n        locationSpot: go.Spot.Center,\r\n        toolTip:  // define a tooltip for each node that displays the color as text\r\n        $(\"ToolTip\",\r\n          $(go.TextBlock, { margin: 4 },\r\n            new go.Binding(\"text\", \"\", function(data,p){\r\n              // console.log(\"tooltip:\",p,data)\r\n              return \"双击显示/隐藏\"\r\n            })\r\n          )\r\n        ),  // end of Adornment\r\n        // rotationSpot: go.Spot.LeftCenter,\r\n        // alignment: go.Spot.Left,\r\n        // alignmentFocus: go.Spot.Left,\r\n        // rotateObject:\"PH\",\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n        },\r\n        selectable: true,\r\n        // selectionAdornmentTemplate: this.getNodeSelectionAdornmentTemplate(),\r\n        doubleClick: function (e, node){\r\n            // that.addLabelText(e, node)\r\n            that.hiddenAllText(node)\r\n            that.switchBorder(node, false)\r\n            // that.diagram.clearSelection();\r\n        },\r\n        // rotatable: true,\r\n        mouseOver: function(e, node) {\r\n          // console.log(\"211111\")\r\n          // if(node.data.hyperlink){\r\n          //   var textObj = node.findObject('TEXT');\r\n          //   textObj.isUnderline = true;\r\n          // }\r\n          // if(node.data.text == \"\"){\r\n            // if(group.findObject(\"groupBorder\").visible){\r\n              that.switchBorder(node, true)\r\n            // }\r\n            // node.background = \"rgba(125,125,125,0.01)\"\r\n          // }\r\n\r\n          if(!node.containingGroup) return;\r\n          var it = node.containingGroup.findSubGraphParts().iterator;\r\n          node.diagram.startTransaction()\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  if(n.data.role && n.data.role.indexOf(\"labelText\")>-1){\r\n                      // locateNode = n;\r\n                      n.diagram.model.setDataProperty(n.data, \"minSize\", \"120 30\")\r\n                      // n.areaBackground = \"mediumslateblue\"\r\n                  }\r\n              }\r\n          }\r\n          node.diagram.commitTransaction()\r\n          // diagram.__trtd.showNodeRemarkTips(e, node);\r\n          },\r\n      mouseLeave: function(e, node) {\r\n        // if(node.data.text == \"\"){\r\n          // node.background = \"rgba(0,0,0,0)\"\r\n          that.switchBorder(node, false)\r\n        // }\r\n      },\r\n        // resizable: true,\r\n        // layoutConditions: go.Part.LayoutStandard,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        // layout: new waveGroupLayout()\r\n        layout: $(go.GridLayout,{\r\n          isInitial: false,\r\n          isOngoing: false,\r\n          spacing: new go.Size(0,0),\r\n          cellSize: go.Size.parse(300,150),\r\n          arrangement:go.GridLayout.LeftToRight,\r\n          wrappingColumn:1,\r\n          isRealtime: false,\r\n          alignment: go.GridLayout.Location,\r\n          // comparer:function(pa, pb) {\r\n          //   var da = pa.data;\r\n          //   var db = pb.data;\r\n          //   if (da.order < db.order) return -1;\r\n          //   if (da.order > db.order) return 1;\r\n          //   return 0;\r\n          // }\r\n        }) \r\n      },\r\n      new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,data){\r\n\r\n        return v;\r\n      }),\r\n      new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n      new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n      new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n\r\n      $(go.Placeholder,    // represents the area of all member parts,\r\n        { padding: 30,\r\n          alignment: go.Spot.Center,\r\n          // stroke: \"blue\",\r\n          // strokeWidth: 2,\r\n          name:\"placeholder\",\r\n        }\r\n      ),  // with some extra padding around them\r\n        // $(go.Shape,  // using a Shape instead of a Placeholder\r\n        //   { name: \"PH\",\r\n        //   figure:\"Rectangle\",\r\n        //   // rotationSpot: go.Spot.LeftCenter,\r\n        //   // spot1: new go.Spot(0.01, 0.01),\r\n        //   // spot2: new go.Spot(0.99, 0.99),\r\n        //   // areaBackground: \"red\",\r\n        //     // width: 600,\r\n        //     // height:300,\r\n        //     stroke:\"blue\" ,\r\n        //     strokeWidth: 2,\r\n        //     fill: \"rgba(0,0,0,0)\" \r\n        //   },\r\n        // ),\r\n\r\n        // new go.Binding(\"width\", \"width\").ofObject(\"\")\r\n        $(go.Shape,\"Rectangle\",{\r\n          name: \"groupBorder\",\r\n          stroke: \"green\",\r\n          strokeWidth: 3,\r\n          strokeDashArray: [10, 5],\r\n          visible:true,\r\n          opacity: 0,\r\n          // margin:30,\r\n          fill:null,\r\n          alignment: go.Spot.Center,\r\n          alignmentFocus: go.Spot.Center,\r\n          // width:200,\r\n          // height:150, \r\n      },\r\n      // new go.Binding(\"width\",\"width\").ofObject(\"placeholder\"),\r\n      // new go.Binding(\"height\",\"height\").ofObject(\"placeholder\"),\r\n      new go.Binding(\"desiredSize\",\"\", function(v,d){\r\n          // console.log(\"vvvvvvvvvvvvv,\",v,d)\r\n          // if(d.part.placeholder.measuredBounds.width < 200){\r\n          //   return new go.Size(200,200)\r\n          // }\r\n          // var width = Math.max(d.part.placeholder.measuredBounds.width, 200)\r\n          // var height = Math.max(d.part.placeholder.measuredBounds.height, 200)\r\n          return new go.Size(d.part.measuredBounds.width-3, d.part.measuredBounds.height-3);\r\n          // return d.part.placeholder.actualBounds;\r\n      }).ofObject(\"\")\r\n    )\r\n\r\n        // $(go.TextBlock,  // group title\r\n        //   { font: \"Bold 12pt Sans-Serif\" },\r\n        //   new go.Binding(\"text\", \"key\")\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = LabelGroupNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/labelGroupNodeTemplate.js","\r\n\r\nvar $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\n  \r\n\r\nclass PicNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n\r\n  \r\n\r\n    getNodeSelectionAdornmentTemplate(){\r\n      return  $(go.Adornment, \"Spot\",\r\n                $(go.Panel, \"Auto\",\r\n                    $(go.Shape, { fill: null, stroke: \"dodgerblue\", strokeWidth: 1 }),\r\n                    $(go.Placeholder) // this represents the selected Node\r\n\r\n                ),\r\n                //$(\"TreeExpanderButton\",\r\n                $(go.Panel, \"Vertical\", {\r\n                        name: \"ButtonIcon1\",\r\n                        alignment: new go.Spot(0, 1, -20, 20),\r\n                        alignmentFocus: go.Spot.Center,\r\n                        width: 60,\r\n                        height: 60,\r\n                        isActionable: true,\r\n                        // click: interactions.expandCollapse // this function is defined below\r\n                    },\r\n\r\n                    $(go.Shape, \"Circle\", {\r\n                        fill: \"rgba(1,1,1,0)\",\r\n                        strokeWidth: 0,\r\n                        stroke: \"green\",\r\n                        width: 50,\r\n                        height: 50\r\n                    })\r\n\r\n                )\r\n            ); // end Adornment;\r\n    }\r\n\r\n    nodeResizeAdornmentTemplate () {\r\n      return $(go.Adornment, \"Spot\",\r\n          $(go.Placeholder), // takes size and position of adorned object\r\n          $(go.Shape, \"Circle\", // left resize handle\r\n              {\r\n                  alignment: go.Spot.TopLeft,\r\n                  alignmentFocus: go.Spot.BottomRight,\r\n                  cursor: \"col-resize\",\r\n                  desiredSize: new go.Size(30, 30),\r\n                  fill: \"lightblue\",\r\n                  stroke: \"dodgerblue\"\r\n              }),\r\n          $(go.Shape, \"Circle\", // right resize handle\r\n              {\r\n                  alignment: go.Spot.BottomRight,\r\n                  alignmentFocus: go.Spot.TopLeft,\r\n                  cursor: \"col-resize\",\r\n                  desiredSize: new go.Size(30, 30),\r\n                  fill: \"lightblue\",\r\n                  stroke: \"dodgerblue\"\r\n              })\r\n      )\r\n  }\r\n\r\n    getNodeTemplate(){\r\n      var diagram = this.diagram\r\n      var that = this;\r\n      return $(go.Node, \"Spot\", {\r\n        name: \"NODE\",\r\n        \"_controlExpand\": true,\r\n        layerName: \"Background\",\r\n        locationSpot: go.Spot.BottomLeft,\r\n        resizeCellSize: new go.Size(10, 10),\r\n        locationObjectName: \"SHAPE\",\r\n        resizable: true,\r\n        resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n        rotatable: true,\r\n        rotateObjectName: \"SHAPE\", // rotate the Shape without rotating the label\r\n        doubleClick: function (e, node) {\r\n            // interactions.selectText(e, node)\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeDoubleClickListener){\r\n                node.diagram.__trtd.nodeDoubleClickListener(node)\r\n            }\r\n            \r\n        },\r\n        click: function(e, node) {\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeClickListener){\r\n                node.diagram.__trtd.nodeClickListener(node)\r\n            }\r\n            // showNodeToolBar(e,node);\r\n        },\r\n        selectable: true,\r\n        movable: true,\r\n        angle: 0,\r\n        //toMaxLinks: 1,\r\n        layoutConditions: go.Part.LayoutStandard,\r\n        //layoutConditions:~go.Part.LayoutAdded,\r\n        // fromLinkable: true, toLinkable: true,\r\n        alignment: go.Spot.Center,\r\n        alignmentFocus: go.Spot.Center,\r\n        resizeAdornmentTemplate: that.nodeResizeAdornmentTemplate(),\r\n        //rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n        contextMenu: diagram.__trtd.nodeContextMenu,\r\n        selectionAdornmentTemplate: that.getNodeSelectionAdornmentTemplate(),\r\n        contextMenu: $(go.Adornment),\r\n      },\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n        new go.Binding(\"resizable\", \"resizable\").makeTwoWay(),\r\n        new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        // $(go.TextBlock, // the text label\r\n        //     new go.Binding(\"text\", \"text\")),\r\n        $(go.Picture, // the icon showing the logo\r\n            // You should set the desiredSize (or width and height)\r\n            // whenever you know what size the Picture should be.\r\n   \r\n            { name: \"SHAPE\" ,\r\n            width: 400,\r\n            height:400,\r\n        }, {\r\n                successFunction: function(pict, evt) {\r\n                    if ((!pict.width || !pict.height) && (!pict.part.data.width || !pict.part.data.height)) {\r\n                        pict.width = pict.element.width;\r\n                        pict.height = pict.element.height;\r\n                    }\r\n                }\r\n            }, {\r\n                sourceCrossOrigin: function(pict) {\r\n                    return \"\";\r\n                }\r\n            },\r\n            new go.Binding(\"source\", \"picture\", function(v){\r\n                    \r\n                return v+\"?\"+Date.now()\r\n\r\n            }).makeTwoWay(function(v){\r\n                if(v){\r\n                    v = v.replace(/\\?.*$/g,\"\")\r\n                    return v\r\n                }else{\r\n                    return \"\"\r\n                }\r\n            }),\r\n            new go.Binding(\"width\", \"width\", function(v, d) {\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"height\", \"height\", function(v, d) {\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n            new go.Binding(\"opacity\", \"opacity\", function(v, d) {\r\n                return v ? parseFloat(v) : 1;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            })\r\n        )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = PicNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/picNodeTemplate.js","var $ = go.GraphObject.make;\r\nvar Base = require(\"./base\");\r\nvar helpers = require(\"../helpers/helpers.gojs\");\r\n\r\nclass PicGroupNodeTemplate extends Base {\r\n  constructor(options) {\r\n    super(options);\r\n    // this.nodeProperties = {}\r\n    var offsetBig = {\r\n      cbianText1: \"490.19843547330686 -207.92899577343746\",\r\n      cbianText2: \"179.32782881269065 -477.3356656420584\",\r\n      cbianText3: \"373.5304832720494 -373.95951083813827\",\r\n      axisXText: \"530 8\",\r\n      axisYText: \"-15 -517\"\r\n    };\r\n    var offsetSmall = {\r\n      cbianText1: \"131.233937586588 -72\",\r\n      cbianText2: \"46.592920782221995 -128.5569669100272\",\r\n      cbianText3: \"99.53048327204942 -103.06601717798208\",\r\n      axisXText: \"147 3\",\r\n      axisYText: \"-3 -147\"\r\n    };\r\n    this.cbianThemes = [\r\n      {\r\n        name: \"cbian1\",\r\n        type: \"small\",\r\n        textStrokes: [\"#0e399d\", \"#cb1c27\", \"#FFC000\"],\r\n        picture: \"https://static.365trtd.com/system/cbian/cbian.png\",\r\n        offsets: offsetSmall,\r\n        size: [150, 150],\r\n        pictureBig: \"https://static.365trtd.com/system/cbian/cbian1_big.png\",\r\n        offsetsBig: offsetBig,\r\n        sizeBig: [500, 500]\r\n      },\r\n      {\r\n        name: \"cbian_red\",\r\n        type: \"small\",\r\n        textStrokes: [\"red\", \"red\", \"red\"],\r\n        picture: \"https://static.365trtd.com/system/cbian/cbian_red.png\",\r\n        offsets: offsetSmall,\r\n        size: [150, 150],\r\n        pictureBig: \"https://static.365trtd.com/system/cbian/cbian_big_red.png\",\r\n        offsetsBig: offsetBig,\r\n        sizeBig: [500, 500]\r\n      },\r\n      {\r\n        name: \"cbian_blue\",\r\n        type: \"small\",\r\n        textStrokes: [\"blue\", \"blue\", \"blue\"],\r\n        picture: \"https://static.365trtd.com/system/cbian/cbian_blue.png\",\r\n        offsets: offsetSmall,\r\n        size: [150, 150],\r\n        pictureBig:\r\n          \"https://static.365trtd.com/system/cbian/cbian_big_blue.png\",\r\n        offsetsBig: offsetBig,\r\n        sizeBig: [500, 500]\r\n      },\r\n      {\r\n        name: \"cbian_green\",\r\n        type: \"small\",\r\n        textStrokes: [\"green\", \"green\", \"green\"],\r\n        picture: \"https://static.365trtd.com/system/cbian/cbian_green.png\",\r\n        offsets: offsetSmall,\r\n        size: [150, 150],\r\n        pictureBig:\r\n          \"https://static.365trtd.com/system/cbian/cbian_big_green.png\",\r\n        offsetsBig: offsetBig,\r\n        sizeBig: [500, 500]\r\n      }\r\n      // {\r\n      //   name: \"cbian1_big\",\r\n      //   type: \"big\",\r\n      //   textStrokes: [\"#0e399d\", \"#cb1c27\", \"#FFC000\"],\r\n      //   picture: \"https://static.365trtd.com/system/cbian/cbian1_big.png\",\r\n      //   offsets: offsetBig,\r\n      //   size:[500,500]\r\n      // }\r\n    ];\r\n  }\r\n\r\n  changeCbianSize(node, cbianType) {\r\n    if (!node) return;\r\n    if (!cbianType) return;\r\n    var cbianThemes = this.cbianThemes;\r\n    var cbianName = node.data.cbianName || \"cbian1\";\r\n    // var smallThemes = cbianThemes.filter((o)=>o.type == \"small\")\r\n    // var bigThemes = cbianThemes.filter((o)=>o.type == \"big\")\r\n    // var cbianName = node.data.cbianName || \"cbian1\";\r\n    var index = null,\r\n      theme = null;\r\n    for (var i = 0, len = cbianThemes.length; i < len; i++) {\r\n      if (cbianThemes[i].name == cbianName) {\r\n        index = i;\r\n        theme = cbianThemes[i];\r\n        break;\r\n      }\r\n    }\r\n    // var curTheme = cbianThemes[index];\r\n    // if(curTheme.type == \"small\"){\r\n\r\n    // }\r\n    if (index == null) {\r\n      return;\r\n    }\r\n    // var nextIndex = (index + 1) % cbianThemes.length;\r\n    var baseNode, cbianText1, cbianText2, cbianText3, axisXText, axisYText, pic;\r\n    if (theme) {\r\n      // var theme = cbianThemes[nextIndex];\r\n      var it = node.findSubGraphParts().iterator;\r\n      while (it.next()) {\r\n        var n = it.value;\r\n        if (n.data.role == \"theme\") {\r\n          baseNode = n;\r\n        }\r\n        if (n.data.role == \"cbianText1\") {\r\n          cbianText1 = n;\r\n        }\r\n        if (n.data.role == \"cbianText2\") {\r\n          cbianText2 = n;\r\n        }\r\n        if (n.data.role == \"cbianText3\") {\r\n          cbianText3 = n;\r\n        }\r\n        if (n.data.role == \"axisXText\") {\r\n          axisXText = n;\r\n        }\r\n        if (n.data.role == \"axisYText\") {\r\n          axisYText = n;\r\n        }\r\n        if (n.data.category == \"pic\") {\r\n          pic = n;\r\n        }\r\n      }\r\n    }\r\n    var diagram = node.diagram;\r\n    if (!baseNode) {\r\n      return;\r\n    }\r\n    var propertyPicture = \"picture\";\r\n    var propertySize = \"size\";\r\n    var propertyoffset = \"offsets\";\r\n    // var propertyPicture = \"picture\"\r\n    if (cbianType == \"big\") {\r\n      propertyPicture = \"pictureBig\";\r\n      propertySize = \"sizeBig\";\r\n      propertyoffset = \"offsetsBig\";\r\n    }\r\n    diagram.model.startTransaction();\r\n\r\n    diagram.model.setDataProperty(pic.data, \"picture\", theme[propertyPicture]);\r\n    diagram.model.setDataProperty(pic.data, \"width\", theme[propertySize][0]);\r\n    diagram.model.setDataProperty(pic.data, \"height\", theme[propertySize][1]);\r\n    diagram.model.setDataProperty(node.data, \"cbianType\", cbianType);\r\n    diagram.model.setDataProperty(node.data, \"cbianName\", cbianName);\r\n    window.localStorage.setItem(\"cbianName\", JSON.stringify(theme));\r\n\r\n    var nodeNameList = [\r\n      \"cbianText1\",\r\n      \"cbianText2\",\r\n      \"cbianText3\",\r\n      \"axisXText\",\r\n      \"axisYText\"\r\n    ];\r\n    for (var i = 0; i < nodeNameList.length; i++) {\r\n      var nodeName = nodeNameList[i];\r\n      var tmpPoint, tmpNode;\r\n      tmpNode = eval(nodeName);\r\n      tmpPoint = theme[propertyoffset][nodeName];\r\n      if (cbianText1 && tmpPoint) {\r\n        tmpPoint = go.Point.parse(tmpPoint);\r\n        diagram.model.setDataProperty(\r\n          tmpNode.data,\r\n          \"loc\",\r\n          go.Point.stringify(\r\n            baseNode.location.copy().offset(tmpPoint.x, tmpPoint.y)\r\n          )\r\n        );\r\n      }\r\n    }\r\n    diagram.model.commitTransaction();\r\n  }\r\n\r\n  changeCbianName(node, cbianName) {\r\n    if (!node) return;\r\n    if (!cbianName) return;\r\n    var cbianThemes = this.cbianThemes;\r\n\r\n    // var smallThemes = cbianThemes.filter((o)=>o.type == \"small\")\r\n    // var bigThemes = cbianThemes.filter((o)=>o.type == \"big\")\r\n    // var cbianName = node.data.cbianName || \"cbian1\";\r\n    var index = null,\r\n      theme = null;\r\n    for (var i = 0, len = cbianThemes.length; i < len; i++) {\r\n      if (cbianThemes[i].name == cbianName) {\r\n        index = i;\r\n        theme = cbianThemes[i];\r\n        break;\r\n      }\r\n    }\r\n    // var curTheme = cbianThemes[index];\r\n    // if(curTheme.type == \"small\"){\r\n\r\n    // }\r\n    if (index == null) {\r\n      return;\r\n    }\r\n    // var nextIndex = (index + 1) % cbianThemes.length;\r\n    var baseNode, cbianText1, cbianText2, cbianText3, axisXText, axisYText, pic;\r\n    if (theme) {\r\n      // var theme = cbianThemes[nextIndex];\r\n      var it = node.findSubGraphParts().iterator;\r\n      while (it.next()) {\r\n        var n = it.value;\r\n        if (n.data.role == \"theme\") {\r\n          baseNode = n;\r\n        }\r\n        if (n.data.role == \"cbianText1\") {\r\n          cbianText1 = n;\r\n        }\r\n        if (n.data.role == \"cbianText2\") {\r\n          cbianText2 = n;\r\n        }\r\n        if (n.data.role == \"cbianText3\") {\r\n          cbianText3 = n;\r\n        }\r\n        if (n.data.role == \"axisXText\") {\r\n          axisXText = n;\r\n        }\r\n        if (n.data.role == \"axisYText\") {\r\n          axisYText = n;\r\n        }\r\n        if (n.data.category == \"pic\") {\r\n          pic = n;\r\n        }\r\n      }\r\n    }\r\n    var diagram = node.diagram;\r\n    if (!baseNode) {\r\n      return;\r\n    }\r\n    var propertyPicture = \"picture\";\r\n    if (node.data.cbianType == \"big\") {\r\n      propertyPicture = \"pictureBig\";\r\n    }\r\n    diagram.model.startTransaction();\r\n\r\n    diagram.model.setDataProperty(pic.data, \"picture\", theme[propertyPicture]);\r\n    diagram.model.setDataProperty(node.data, \"cbianName\", cbianName);\r\n    window.localStorage.setItem(\"cbianName\", JSON.stringify(theme));\r\n    // window.localStorage.setItem(\"cbianType\",theme.type)\r\n    // console.log(\"cbian theme\")\r\n    if (cbianText1) {\r\n      diagram.model.setDataProperty(\r\n        cbianText1.data,\r\n        \"textStroke\",\r\n        theme.textStrokes[0]\r\n      );\r\n    }\r\n    if (cbianText2) {\r\n      diagram.model.setDataProperty(\r\n        cbianText2.data,\r\n        \"textStroke\",\r\n        theme.textStrokes[1]\r\n      );\r\n    }\r\n    if (cbianText3) {\r\n      diagram.model.setDataProperty(\r\n        cbianText3.data,\r\n        \"textStroke\",\r\n        theme.textStrokes[2]\r\n      );\r\n    }\r\n    diagram.model.commitTransaction();\r\n  }\r\n\r\n  getNodeSelectionAdornmentTemplate() {\r\n    return $(\r\n      go.Adornment,\r\n      \"Spot\",\r\n      $(\r\n        go.Panel,\r\n        \"Auto\",\r\n        $(go.Shape, { fill: null, stroke: \"dodgerblue\", strokeWidth: 1 }),\r\n        $(go.Placeholder) // this represents the selected Node\r\n      ),\r\n      //$(\"TreeExpanderButton\",\r\n      $(\r\n        go.Panel,\r\n        \"Vertical\",\r\n        {\r\n          name: \"ButtonIcon1\",\r\n          alignment: new go.Spot(0, 1, -20, 20),\r\n          alignmentFocus: go.Spot.Center,\r\n          width: 60,\r\n          height: 60,\r\n          isActionable: true\r\n          // click: interactions.expandCollapse // this function is defined below\r\n        },\r\n\r\n        $(go.Shape, \"Circle\", {\r\n          fill: \"rgba(1,1,1,0)\",\r\n          strokeWidth: 0,\r\n          stroke: \"green\",\r\n          width: 50,\r\n          height: 50\r\n        })\r\n      )\r\n    ); // end Adornment;\r\n  }\r\n\r\n  nodeResizeAdornmentTemplate() {\r\n    return $(\r\n      go.Adornment,\r\n      \"Spot\",\r\n      $(go.Placeholder), // takes size and position of adorned object\r\n      $(\r\n        go.Shape,\r\n        \"Circle\", // left resize handle\r\n        {\r\n          alignment: go.Spot.TopLeft,\r\n          alignmentFocus: go.Spot.BottomRight,\r\n          cursor: \"col-resize\",\r\n          desiredSize: new go.Size(30, 30),\r\n          fill: \"lightblue\",\r\n          stroke: \"dodgerblue\"\r\n        }\r\n      ),\r\n      $(\r\n        go.Shape,\r\n        \"Circle\", // right resize handle\r\n        {\r\n          alignment: go.Spot.BottomRight,\r\n          alignmentFocus: go.Spot.TopLeft,\r\n          cursor: \"col-resize\",\r\n          desiredSize: new go.Size(30, 30),\r\n          fill: \"lightblue\",\r\n          stroke: \"dodgerblue\"\r\n        }\r\n      )\r\n    );\r\n  }\r\n\r\n  addFreeText(e, node) {\r\n    console.log(\"eeeeeeeeeee\", e);\r\n    this.changeCbianThemeColor(e, node);\r\n    return;\r\n    var data = {\r\n      text: \"总结文本\",\r\n      deletable: true,\r\n      fill: \"black\",\r\n      iconVisible: false,\r\n      locationSpot: \"0 0.5 0 0\",\r\n      textAlign: \"left\",\r\n      category: \"autoText\",\r\n      loc: go.Point.stringify(e.documentPoint),\r\n      movable: true,\r\n      group: node.data.key\r\n    };\r\n    this.diagram.startTransaction(\"addFreeText\");\r\n    this.diagram.model.addNodeData(data);\r\n    this.diagram.commitTransaction(\"addFreeText\");\r\n  }\r\n\r\n  getNodeTemplate() {\r\n    var diagram = this.diagram;\r\n    var that = this;\r\n    return $(\r\n      go.Group,\r\n      \"Auto\",\r\n      {\r\n        __trtdNode: that,\r\n        // selectionObjectName: \"groupBorder\",\r\n        layerName: \"default\",\r\n        locationObjectName: \"placeholder\",\r\n        zOrder: 5,\r\n        // margin:30,\r\n        // padding:30,\r\n        background: \"rgba(0,0,0,0)\",\r\n        rotatable: false,\r\n        // minSize: new go.Size(200,100),\r\n        locationSpot: go.Spot.BottomLeft,\r\n        click: (e, node) => {\r\n          console.log(node.data);\r\n        },\r\n        layout: $(go.Layout),\r\n        doubleClick: function(e, node) {\r\n          // that.addLabelText(e, node)\r\n          var index = 0;\r\n          for (var i = 0; i < that.cbianThemes.length; i++) {\r\n            if (that.cbianThemes[i].name == node.data.cbianName) {\r\n              index = i;\r\n              break;\r\n            }\r\n          }\r\n          var nextIndex = (index + 1) % that.cbianThemes.length;\r\n          that.changeCbianName(node, that.cbianThemes[nextIndex].name);\r\n          // that.addFreeText(e, node);\r\n        },\r\n        contextMenu: $(go.Adornment),\r\n        layoutConditions:\r\n          go.Part.LayoutStandard &\r\n          go.Part.LayoutRemoved &\r\n          go.Part.LayoutAdded &\r\n          go.Part.LayoutNodeSized\r\n      },\r\n      new go.Binding(\"location\", \"loc\", function(v) {\r\n        // console.log(\"go.Point.parsego.Point.parsego.Point.parse\")\r\n        return go.Point.parse(v);\r\n      }).makeTwoWay(go.Point.stringify),\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v, data) {\r\n        return v;\r\n      }),\r\n      new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n      new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n      new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n      new go.Binding(\"layerName\", \"layerName\").makeTwoWay(),\r\n\r\n      $(\r\n        go.Placeholder, // represents the area of all member parts,\r\n        { padding: 30, alignment: go.Spot.Center, name: \"placeholder\" }\r\n      ) // with some extra padding around them\r\n    );\r\n  }\r\n}\r\n\r\nmodule.exports = PicGroupNodeTemplate;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/picGroupNodeTemplate.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\nvar yunGroupLayout = require(\"../layout/yunGroupLayout\")\r\n\r\nclass YunNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        this.defaultTextFont = \"20px 'Microsoft YaHei'\"\r\n        \r\n    }\r\n    \r\n\r\n    snapToGrid(data, node){\r\n\r\n      if(data.subRole == \"coreText\" || data.subRole == \"themeText\"){\r\n        return;\r\n      }\r\n      var p = go.Point.parse(data.loc)\r\n      if(node.__yunPointsX && node.__yunPointsY ){\r\n        if(p.x >= node.__yunPointsX[0] && p.x <= node.__yunPointsX[node.__yunPointsX.length-1] \r\n          && p.y >= node.__yunPointsY[node.__yunPointsY.length-1] && p.y <= node.__yunPointsY[0] ){\r\n            // 在画布格子范围内的位置才对齐网格\r\n            var minX=20000,minY=20000,tmp,orderX,orderY;\r\n            for(var i=0;i<node.__yunPointsX.length;i++){\r\n              tmp = Math.abs(p.x - node.__yunPointsX[i])\r\n              if(tmp< minX){\r\n                minX = tmp;\r\n                orderX = i+1;\r\n              }\r\n            }\r\n            for(var i=0;i<node.__yunPointsY.length;i++){\r\n              tmp = Math.abs(p.y - node.__yunPointsY[i])\r\n              if(tmp< minY){\r\n                minY = tmp;\r\n                orderY = i+1;\r\n              }\r\n            }\r\n\r\n            if(orderX!=null && orderY!=null){\r\n              // var x = node.__yunPointsX[orderX-1]\r\n              // var y = node.__yunPointsX[orderY-1]\r\n              // x = -1300\r\n              // y = -1300\r\n              // data.loc = \"-1688.105387366997 -121.19730986224602\"\r\n              data.orderX = orderX\r\n              data.orderY = orderY\r\n            }\r\n          }else{\r\n            delete data.orderX\r\n            delete data.orderY\r\n          }\r\n     }\r\n    }\r\n\r\n    addFreeText(e, node){\r\n      console.log(\"addFreeTextaddFreeText begin\",e)\r\n      var gridWidth = node.data.gridWidth\r\n      var p = e.documentPoint\r\n      var that = this;\r\n      var data = {\"text\":\"灵感\",\r\n      \"deletable\":true, \r\n      \"role\":\"freeText\",\r\n      \"fill\":\"black\", \r\n      \"iconVisible\":false, \r\n      \"locationSpot\":\"0.5 0.5 0 0\", \r\n      \"minSize\":`30 30`,\r\n      // \"width\":`${gridWidth-10}`,\r\n      font: that.defaultTextFont,\r\n      \"textAlign\":\"center\", \r\n      \"category\":\"autoText\", \r\n      \"loc\": go.Point.stringify(p), \r\n      \"movable\":true, \"group\":node.data.key\r\n     }\r\n    //  console.log()\r\n     \r\n\r\n      this.snapToGrid(data, node)\r\n     this.diagram.startTransaction(\"addFreeText\")\r\n     this.diagram.model.addNodeData(data);\r\n     this.diagram.commitTransaction(\"addFreeText\")\r\n     node.layout.isValidLayout = false\r\n     console.log(\"addFreeTextaddFreeText end\",e)\r\n    }\r\n\r\n    getNodeTemplate(){\r\n      var that = this\r\n      return $(go.Group, \"Auto\",\r\n      { selectionObjectName: \"PH\",\r\n      __trtdNode: that,\r\n      layerName: \"default\",\r\n      padding: 0,\r\n      margin: 0,\r\n      copyable: true,\r\n      zOrder: 15,\r\n        locationObjectName: \"PH\",\r\n        locationSpot: new go.Spot(0,1,0,-0),\r\n        // rotationSpot: go.Spot.LeftCenter,\r\n        rotatable: false,\r\n        alignment: go.Spot.Left,\r\n        alignmentFocus: go.Spot.Left,\r\n        // rotateObject:\"PH\",\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n          var it = node.findSubGraphParts().iterator;\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  n.findObject(\"textBorder\").visible = false;\r\n              }\r\n          }\r\n          node.layout.isValidLayout = false\r\n          return;\r\n          if(node.isSelected) return;\r\n          var it = node.findSubGraphParts().iterator;\r\n          var n;\r\n          while (it.next()) {\r\n              n = it.value;\r\n              if(n.data.role == \"labelGroup\"){\r\n                  n.__trtdNode.switchBorder(n, true)\r\n                  break;\r\n              }\r\n          }\r\n          if(n){\r\n            setTimeout(function(){\r\n              n.__trtdNode.switchBorder(n, false)\r\n            },3000)\r\n          }\r\n        },\r\n        doubleClick: function (e, node){\r\n          // that.addFreeText(e, node)\r\n        },\r\n        mouseOver: function(e, node) {\r\n          // if(node.data.hyperlink){\r\n          //   var textObj = node.findObject('TEXT');\r\n          //   textObj.isUnderline = true;\r\n          // }\r\n          // if(!node.containingGroup) return;\r\n          return;\r\n          // diagram.__trtd.showNodeRemarkTips(e, node);\r\n      },\r\n      contextMenu: $(go.Adornment),\r\n      mouseLeave: function(e, node) {\r\n        // if(!node.containingGroup) return;\r\n        var it = node.findSubGraphParts().iterator;\r\n        while (it.next()) {\r\n            var n = it.value;\r\n            if(n.data.role == \"labelGroup\"){\r\n                // n.__trtdNode.switchBorder(n, false)\r\n                break;\r\n            }\r\n        }\r\n        // if(n){\r\n        //   setTimeout(function(){\r\n        //     n.__trtdNode.switchBorder(n, false)\r\n        //   },3000)\r\n        // }\r\n      },\r\n        // rotatable: true,\r\n        // resizable: true,\r\n        // layoutConditions: go.Part.LayoutStandard,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        layout: new yunGroupLayout()\r\n        // layout: $(go.GridLayout,{\r\n        //   spacing: new go.Size(0,0),\r\n        //   cellSize: go.Size.parse(300,150),\r\n        //   arrangement:go.GridLayout.LeftToRight,\r\n        //   alignment: go.GridLayout.Location,\r\n        //   comparer:function(pa, pb) {\r\n        //     var da = pa.data;\r\n        //     var db = pb.data;\r\n        //     if (da.order < db.order) return -1;\r\n        //     if (da.order > db.order) return 1;\r\n        //     return 0;\r\n        //   }\r\n        // }) \r\n      },\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"zOrder\", \"zOrder\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"locationSpot\", \"\", function(data){\r\n        // console.log(\"data:\",data)\r\n        return new go.Spot(0,1,data.gridWidth,-data.gridHeight)\r\n      }),\r\n        \r\n        $(go.Shape,  // using a Shape instead of a Placeholder\r\n          { name: \"PH\",\r\n          figure:\"Rectangle\",\r\n          // rotationSpot: go.Spot.LeftCenter,\r\n          // spot1: new go.Spot(0.01, 0.01),\r\n          // spot2: new go.Spot(0.99, 0.99),\r\n            // width: 600,\r\n            // height:300,\r\n            stroke:\"yellow\" ,\r\n            strokeWidth:0,\r\n            fill: \"rgba(0,0,255,0.0)\" },\r\n          // new go.Binding(\"desiredSize\", \"desiredSize\", function(v,data){\r\n          //   return go.Size.parse(v)\r\n          //   console.log('1111111111111111111111')\r\n          //   // for(var i=0;i<)\r\n          //   var model = data.part.diagram.model;\r\n          //   var group = data.part.data;\r\n          //   var maxWidth = 0;\r\n          //   var maxHeight = 0;\r\n          //   for(var i = 0;i<model.nodeDataArray.length;i++){\r\n          //     if(group.key != model.nodeDataArray[i].group){\r\n          //       continue;\r\n          //     }\r\n          //     if(model.nodeDataArray[i].desiredSize){\r\n          //       console.log(model.nodeDataArray[i].desiredSize)\r\n          //       var size = go.Size.parse(model.nodeDataArray[i].desiredSize)\r\n          //       if(size.width > maxWidth){\r\n          //         maxWidth = size.width;\r\n          //       }\r\n          //       if(size.height > maxHeight){\r\n          //         maxHeight = size.height;\r\n          //       }\r\n          //     }\r\n          //   }\r\n          //   // var group = that.diagram.findNodeForKey(data.part.data.key)\r\n          //   // var git = group.memberParts;\r\n          //   // var maxWidth = 0;\r\n          //   // var maxHeight = 0;\r\n          //   // while (git.next()) {\r\n          //   //   var item = git.value;\r\n          //   //   console.log(\"item:\",item)\r\n          //   //   if(item.naturalBounds.width > maxWidth){\r\n          //   //     maxWidth = item.naturalBounds.width;\r\n          //   //   }\r\n          //   //   if(item.naturalBounds.height > maxHeight){\r\n          //   //     maxHeight = item.naturalBounds.height;\r\n          //   //   }\r\n          //   //   console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n      \r\n          //   // }           \r\n          //   return go.Size.parse(`${maxWidth+100} ${maxHeight}`)         \r\n          //   // group.diagram.model.setDataProperty(group.data, \"desiredSize\", `${maxWidth+100} ${maxHeight}`) \r\n          // }).makeTwoWay(go.Size.stringify)\r\n        ),\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        // $(go.Placeholder,    // represents the area of all member parts,\r\n        //   { padding: 0}\r\n        // ),  // with some extra padding around them\r\n\r\n        // $(go.TextBlock,  // group title\r\n        //   { font: \"Bold 12pt Sans-Serif\" },\r\n        //   new go.Binding(\"text\", \"key\")\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = YunNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/yunGroupNodeTemplate.js","// define a custom grid layout that makes sure the length of each lane is the same\r\n// and that each lane is broad enough to hold its subgraph\r\nfunction YunGroupLayout() {\r\n  go.Layout.call(this);\r\n  // go.GridLayout.call(this);\r\n  // this.cellSize = new go.Size(1, 1);\r\n  // this.wrappingColumn = Infinity;\r\n  // this.wrappingWidth = Infinity;\r\n  // this.spacing = new go.Size(0, 0);\r\n  // this.alignment = go.GridLayout.Position;\r\n}\r\ngo.Diagram.inherit(YunGroupLayout, go.Layout);\r\n\r\nfunction computeNewRotateLoc(rotateCenter, currentLoc, angle) {\r\n  if (rotateCenter.equals(currentLoc)) return currentLoc;\r\n  // 计算选择中心点到（0,0）点的偏移\r\n  var offset = new go.Point(0, 0).subtract(rotateCenter.copy());\r\n  // 将原来的点偏移到相对0,0点的位置\r\n  var nodeOrigin = currentLoc.copy().offset(offset.x, offset.y);\r\n  var newNodeOrigin = nodeOrigin.rotate(angle);\r\n  var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y);\r\n  return newNodeLoc;\r\n  // console.log(\"newNodeLoc\", newNodeLoc)\r\n}\r\nYunGroupLayout.prototype.doLayout = function(coll) {\r\n  console.log(\"YunGroupLayout.doLayout\");\r\n  var diagram = this.diagram;\r\n  diagram.startTransaction(\"YunGroupLayout\");\r\n  // COLL might be a Diagram or a Group or some Iterable<Part>\r\n\r\n  var it = this.collectParts(coll).iterator;\r\n  var collection = [];\r\n  var dataCollection = [];\r\n  var group = this.group;\r\n  var gridWidth = group.data.gridWidth;\r\n  var gridHeight = group.data.gridHeight;\r\n  // group.location = new go.Point(0,0)\r\n  var maxWidth = 0;\r\n  var maxHeight = 0;\r\n  var centerLine,\r\n    axisX,\r\n    axisY,\r\n    axisXText,\r\n    axisYText,\r\n    themeText,\r\n    labelText1,\r\n    labelText2,\r\n    labelText3,\r\n    labelGroup,\r\n    waveGroup;\r\n  var shiTextColl = [];\r\n  var xuTextColl = [];\r\n  var verticalLines = [];\r\n  var horizontalLines = [];\r\n  var freelLines = [];\r\n  var allLines = [];\r\n  var freeTexts = [];\r\n  var shapeNodes = [];\r\n  var snapType = group.data.snapType || \"grid\";\r\n  var showShape = group.data.showShape; // 是否显示矩形\r\n  var beginSpark = group.data.beginSpark; // 是否开始火花\r\n  var shapeStrokes = group.data.shapeStrokes; // 是否开始火花\r\n  var oliveWidth;\r\n  var oliveHeight;\r\n  while (it.next()) {\r\n    var node = it.value;\r\n    // var item = git.value;\r\n    //   console.log(\"item:\",item)\r\n\r\n    dataCollection.push(node.data);\r\n    if (node.data.category == \"wave\") {\r\n      collection.push(node);\r\n    }\r\n    if (!(node instanceof go.Node)) {\r\n      continue;\r\n    }\r\n\r\n    if (node.data.role == \"background\") {\r\n      shapeNodes.push(node);\r\n    }\r\n    // 处理文本节点的位置和定位位置\r\n    // if(node.data.category == \"text\"){\r\n    if (node.data.role == \"axisYText\") {\r\n      axisYText = node;\r\n    }\r\n    if (node.data.role == \"axisXText\") {\r\n      axisXText = node;\r\n    }\r\n    if (node.data.role == \"themeText\") {\r\n      themeText = node;\r\n    }\r\n    if (node.data.role == \"shiText\") {\r\n      shiTextColl.push(node);\r\n    }\r\n    if (node.data.role == \"xuText\") {\r\n      xuTextColl.push(node);\r\n    }\r\n    // }\r\n    // 处理label文本节点的位置和定位位置\r\n    // if(node.data.category == \"iconText\"){\r\n    if (node.data.role == \"labelText1\") {\r\n      labelText1 = node;\r\n    }\r\n    if (node.data.role == \"labelText2\") {\r\n      labelText2 = node;\r\n    }\r\n    if (node.data.role == \"labelText3\") {\r\n      labelText3 = node;\r\n    }\r\n    if (node.data.role == \"labelGroup\") {\r\n      labelGroup = node;\r\n    }\r\n    // }\r\n\r\n    if (node.naturalBounds.width > maxWidth) {\r\n      maxWidth = node.naturalBounds.width;\r\n    }\r\n    if (node.naturalBounds.height > maxHeight) {\r\n      maxHeight = node.naturalBounds.height;\r\n    }\r\n\r\n    if (node.data.role == \"freeText\") {\r\n      freeTexts.push(node);\r\n    }\r\n    if (node.data.category == \"line\") {\r\n      allLines.push(node);\r\n      if (node.data.role == \"verticalLine\") {\r\n        verticalLines.push(node);\r\n      }\r\n      if (node.data.role == \"horizontalLine\") {\r\n        horizontalLines.push(node);\r\n      }\r\n      if (node.data.role == \"freelLine\") {\r\n        freelLines.push(node);\r\n      }\r\n    }\r\n    if (node.data.group == group.key) {\r\n      // position the node . . .\r\n      if (node.data.category == \"line\") {\r\n        if (node.data.role == \"axisX\") {\r\n          node.angle = 0;\r\n          axisX = node;\r\n          node.location = group.location.copy().offset(0, 0);\r\n        }\r\n        if (node.data.role == \"axisY\") {\r\n          axisY = node;\r\n          node.angle = 270;\r\n          node.location = group.location.copy().offset(0, 0);\r\n        }\r\n        // node.angle = 270\r\n      }\r\n      // if(node.data.category == \"waveGroup\"){\r\n      //     waveGroup = node;\r\n      //     // node.angle = group.angle\r\n      //     oliveWidth = node.data.oliveWidth\r\n      //     oliveHeight = node.data.oliveHeight\r\n      //     node.location = group.location.copy().offset(0,0)\r\n      //     // node.layout.isOngoing = true;\r\n      //     // node.layout.isValidLayout = false;\r\n      //     // collection.push(node)\r\n      // }\r\n    }\r\n  }\r\n  console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`);\r\n\r\n  verticalLines.sort(function(a, b) {\r\n    return a.data.order - b.data.order;\r\n  });\r\n  horizontalLines.sort(function(a, b) {\r\n    return a.data.order - b.data.order;\r\n  });\r\n  freelLines.sort(function(a, b) {\r\n    return a.data.order - b.data.order;\r\n  });\r\n\r\n  if (snapType == \"between\") {\r\n    var x1 = verticalLines.length * gridWidth + gridWidth;\r\n    var x2 = horizontalLines.length * gridHeight + gridHeight;\r\n  } else {\r\n    var x1 = verticalLines.length * gridWidth;\r\n    var x2 = horizontalLines.length * gridHeight;\r\n  }\r\n\r\n  var allPointsX = [];\r\n  var allPointsY = [];\r\n  var centerOrderX = (horizontalLines.length + 1) / 2;\r\n  var centerOrderY = (verticalLines.length + 1) / 2;\r\n  allLines.forEach(function(obj, index) {\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n    if (obj.data.role == \"axisX\" || obj.data.role == \"axisY\") return;\r\n    // if(obj.data.subRole == \"dim\"){\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[0, 0]\")\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",3)\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"RGBA(164, 177, 198, 1)\")\r\n    // }else{\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[15, 10]\")\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n    // }\r\n  });\r\n\r\n  verticalLines.forEach(function(obj, index) {\r\n    var newOrder = index + 1;\r\n    obj.diagram.model.setDataProperty(obj.data, \"order\", newOrder);\r\n    obj.location = group.location.copy().offset(gridWidth * newOrder, 0);\r\n    obj.angle = 270;\r\n    obj.diagram.model.setDataProperty(obj.data, \"desiredSize\", `${x2 + 20} 10`);\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n    if (snapType == \"between\") {\r\n      if (newOrder < centerOrderX) {\r\n        allPointsX.push(obj.location.x - gridWidth / 2);\r\n      }\r\n      if (newOrder == centerOrderX) {\r\n        allPointsX.push(obj.location.x);\r\n      }\r\n      if (newOrder > centerOrderX) {\r\n        allPointsX.push(obj.location.x + gridWidth / 2);\r\n      }\r\n    } else {\r\n      allPointsX.push(obj.location.x);\r\n    }\r\n\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n  });\r\n  horizontalLines.forEach(function(obj, index) {\r\n    var newOrder = index + 1;\r\n    obj.diagram.model.setDataProperty(obj.data, \"order\", newOrder);\r\n    obj.location = group.location.copy().offset(0, -gridHeight * newOrder);\r\n    obj.angle = 0;\r\n    obj.diagram.model.setDataProperty(obj.data, \"desiredSize\", `${x1 + 20} 10`);\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n    if (snapType == \"between\") {\r\n      if (newOrder < centerOrderY) {\r\n        allPointsY.push(obj.location.y + gridHeight / 2);\r\n      }\r\n      if (newOrder == centerOrderY) {\r\n        allPointsY.push(obj.location.y);\r\n      }\r\n      if (newOrder > centerOrderY) {\r\n        allPointsY.push(obj.location.y - gridHeight / 2);\r\n      }\r\n    } else {\r\n      allPointsY.push(obj.location.y);\r\n    }\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n  });\r\n  // allPointsX.unshift(allPointsX[0]-gridWidth)\r\n  // allPointsX.push(allPointsX[allPointsX.length-1]+gridWidth)\r\n  // allPointsY.unshift(allPointsY[0]-gridLength)\r\n  // allPointsY.push(allPointsY[allPointsY.length-1]+gridLength)\r\n  this.group.__yunPointsX = allPointsX;\r\n  this.group.__yunPointsY = allPointsY;\r\n  freelLines.forEach(function(obj, index) {\r\n    // var newOrder = index+1;\r\n    // obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n    // obj.location = new go.Point(allPointsX[9], allPointsY[9])\r\n    // obj.angle = 315;\r\n    // obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${gridWidth*20-5} 10`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"selectable\",true)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"zOrder\",10)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",true)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showBeginArrow\",true)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"showEndArrow\",true)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"locationSpot\",`0.5 0.5 0 0`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[5, 5]\")\r\n    // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n  });\r\n\r\n  shapeNodes.forEach(function(obj, index) {\r\n    obj.diagram.model.setDataProperty(obj.data, \"visible\", true);\r\n    if (!showShape) {\r\n      obj.diagram.model.setDataProperty(obj.data, \"stroke\", \"rgba(255,0,0,0)\");\r\n    } else {\r\n      try {\r\n        obj.diagram.model.setDataProperty(\r\n          obj.data,\r\n          \"stroke\",\r\n          shapeStrokes[obj.data.gridWidth / 2 - 1]\r\n        );\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    }\r\n    if (obj.data.desiredSize) {\r\n      return;\r\n    }\r\n    obj.data.orderX = centerOrderX;\r\n    obj.data.orderY = centerOrderY;\r\n    obj.location = new go.Point(\r\n      allPointsX[obj.data.orderX - 1],\r\n      allPointsY[obj.data.orderY - 1]\r\n    );\r\n    var shapeWidth = obj.data.gridWidth || 2;\r\n    if (snapType == \"between\") {\r\n      var desiredSize = new go.Size(\r\n        gridWidth * (shapeWidth - 1),\r\n        gridHeight * (shapeWidth - 1)\r\n      );\r\n      obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\", gridWidth);\r\n    } else {\r\n      var desiredSize = new go.Size(\r\n        gridWidth * shapeWidth + 3,\r\n        gridHeight * shapeWidth + 3\r\n      );\r\n      obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\", 3);\r\n    }\r\n    // obj.desiredSize = desiredSize;\r\n    obj.diagram.model.setDataProperty(\r\n      obj.data,\r\n      \"desiredSize\",\r\n      go.Size.stringify(desiredSize)\r\n    );\r\n    // obj.diagram.model.setDataProperty(obj.data, \"visible\",true)\r\n    obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\", \"[0,0]\");\r\n  });\r\n\r\n  // var dist = Math.max(gridHeight,gridWidth)\r\n  freeTexts.forEach(function(obj, index) {\r\n    // var newOrder = index+1;\r\n    // obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n    // obj.location = group.location.copy()\r\n    // obj.angle = 315;\r\n    // obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${x1+20} 10`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"minSize\",`60 50`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth-10}`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth*3}`)\r\n    // delete obj.data.width\r\n    // obj.diagram.model.setDataProperty(obj.data, \"textAlign\",`center`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"locationSpot\",`0.5 0.5 0 0`)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n    // obj.diagram.model.setDataProperty(obj.data, \"font\", group.__trtdNode.defaultTextFont)\r\n\r\n    // if(node.__yunPointsY && node.__yunPointsX){\r\n    //       for(var i=0;i<allPointsX.length;i++){\r\n    //         if(obj)\r\n    //       }\r\n    //    }\r\n    // if(obj.data.text.indexOf(\"自由文本\") >-1){\r\n    //   console.log(\"ddd\",obj.data.text)\r\n    //   var order = obj.data.text.replace(\"自由文本\",\"\").split(\",\")\r\n    //   if(order.length == 2){\r\n    //     obj.data.orderX = order[0]\r\n    //     obj.data.orderY = order[1]\r\n    //     obj.location = new go.Point(allPointsX[obj.data.orderX-1], allPointsY[obj.data.orderY-1])\r\n    //   }\r\n    // }\r\n\r\n    // if(obj.data.text.length == 1){\r\n    //   if(obj.data.subRole == null){\r\n    //     obj.diagram.model.setDataProperty(obj.data, \"subRole\",\"coreText\")\r\n    //     obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n    //   }\r\n    // }\r\n\r\n    // if(obj.data.text.indexOf(\"维度\") >-1){\r\n    //   console.log(\"ddd\",obj.data.text)\r\n    //   // var order = obj.data.text.replace(\"维度\",\"\").split(\",\")\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"subRole\",\"dimText\")\r\n    //   // obj.diagram.model.setDataProperty(obj.data, \"dimKey\", null)\r\n    //   delete obj.data.dimKey\r\n    //   obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n    //   // obj.diagram.model.setDataProperty(obj.data, \"width\", null)\r\n    //   // obj.diagram.model.setDataProperty(obj.data, \"height\", null)\r\n    // }\r\n    obj.areaBackground = null;\r\n    // obj.diagram.model.setDataProperty(obj.data, \"height\", null)\r\n    // obj.diagram.model.setDataProperty(obj.data, \"width\", null)\r\n    // obj.findObject(\"place\").visible = false;\r\n    // console.log(\"verticalLines.length+1)/2verticalLines.length+1)/2\",(verticalLines.length+1)/2)\r\n    if (group.data.autoSnapText) {\r\n      // 计算普通文字位置\r\n      if (obj.data.orderX && obj.data.orderY) {\r\n        obj.location = new go.Point(\r\n          allPointsX[obj.data.orderX - 1],\r\n          allPointsY[obj.data.orderY - 1]\r\n        );\r\n\r\n        obj.location = new go.Point(\r\n          allPointsX[obj.data.orderX - 1],\r\n          allPointsY[obj.data.orderY - 1]\r\n        );\r\n      }\r\n      // 计算维度文字位置\r\n      if (\r\n        obj.data.subRole == \"dimText\" &&\r\n        obj.data.dimX != null &&\r\n        obj.data.dimY != null\r\n      ) {\r\n        console.log(\"dimText\");\r\n        var dimXLoc, dimYLoc;\r\n        dimXLoc = allPointsX[obj.data.dimX - 1];\r\n        dimYLoc = allPointsY[obj.data.dimY - 1];\r\n        // if (obj.data.rho == null) {\r\n        //   // 计算极坐标角度\r\n        //   if (obj.data.dimX == 0 && obj.data.dimY == 19) {\r\n        //     // fireTexts.dimText1 = n;\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 1);\r\n        //   }\r\n        //   if (obj.data.dimX == 10 && obj.data.dimY == 19) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 2);\r\n        //   }\r\n        //   if (obj.data.dimX == 19 && obj.data.dimY == 19) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 3);\r\n        //   }\r\n        //   if (obj.data.dimX == 19 && obj.data.dimY == 10) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 4);\r\n        //   }\r\n        //   if (obj.data.dimX == 19 && obj.data.dimY == 19) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 5);\r\n        //   }\r\n        //   if (obj.data.dimX == 10 && obj.data.dimY == 0) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 6);\r\n        //   }\r\n        //   if (obj.data.dimX == 0 && obj.data.dimY == 0) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 7);\r\n        //   }\r\n        //   if (obj.data.dimX == 0 && obj.data.dimY == 10) {\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"rho\", 8);\r\n        //   }\r\n        // }\r\n\r\n        if (obj.data.dimX >= allPointsX.length) {\r\n          dimXLoc = allPointsX[allPointsX.length - 1] + gridWidth;\r\n          // if(snapType != \"between\"){\r\n          //   dimXLoc += gridWidth/3\r\n          // }\r\n        }\r\n        if (obj.data.dimY >= allPointsY.length) {\r\n          dimYLoc = allPointsY[allPointsY.length - 1] - gridHeight;\r\n          // if(snapType != \"between\"){\r\n          //   dimYLoc -= gridHeight/3\r\n          // }\r\n        }\r\n        if (obj.data.dimX <= 0) {\r\n          dimXLoc = allPointsX[0] - gridWidth;\r\n          if (snapType != \"between\" && obj.data.dimY < allPointsY.length) {\r\n            dimXLoc -= gridWidth / 2;\r\n          }\r\n        }\r\n        if (obj.data.dimY <= 0) {\r\n          dimYLoc = allPointsY[0] + gridHeight;\r\n          if (snapType != \"between\" && obj.data.dimX < allPointsX.length) {\r\n            dimYLoc += gridHeight / 2;\r\n          }\r\n        }\r\n        obj.location = new go.Point(dimXLoc, dimYLoc);\r\n      }\r\n    }\r\n    if (\r\n      (obj.data.subRole != \"themeText\" && obj.data.orderY == centerOrderY) ||\r\n      obj.data.dimY == centerOrderY\r\n    ) {\r\n      // console.log(\"Ddddddd\")\r\n      obj.diagram.model.setDataProperty(obj.data, \"width\", gridWidth - 10);\r\n      // delete obj.data.height\r\n      obj.diagram.model.setDataProperty(obj.data, \"height\", null);\r\n    }\r\n    if (\r\n      (obj.data.subRole != \"themeText\" && obj.data.orderX == centerOrderX) ||\r\n      obj.data.dimX == centerOrderX\r\n    ) {\r\n      // console.log(\"Ddddddd\")\r\n      obj.diagram.model.setDataProperty(obj.data, \"height\", gridHeight - 10);\r\n      obj.diagram.model.setDataProperty(obj.data, \"width\", null);\r\n      // delete obj.data.width\r\n    }\r\n\r\n    if (\r\n      Math.abs(obj.data.orderX - centerOrderX) == 1 &&\r\n      Math.abs(obj.data.orderY - centerOrderY) == 1\r\n    ) {\r\n      // 中心节点\r\n      if (snapType != \"between\") {\r\n        obj.diagram.model.setDataProperty(obj.data, \"width\", gridWidth - 10);\r\n        obj.diagram.model.setDataProperty(obj.data, \"height\", gridHeight - 10);\r\n      }\r\n    }\r\n\r\n    if (obj.data.subRole == \"coreText\") {\r\n      var maxRadius = Math.max(\r\n        Math.abs(obj.data.orderX - centerOrderX),\r\n        Math.abs(obj.data.orderY - centerOrderY)\r\n      );\r\n      obj.diagram.model.setDataProperty(obj.data, \"theta\", maxRadius);\r\n    }\r\n\r\n    if (\r\n      Math.abs(obj.data.orderX - centerOrderX) == 0 &&\r\n      Math.abs(obj.data.orderY - centerOrderY) == 0\r\n    ) {\r\n      // 中心节点\r\n      // obj.diagram.model.setDataProperty(obj.data, \"textStroke\",`red`)\r\n      // obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n      // obj.diagram.model.setDataProperty(obj.data, \"subRole\", \"themeText\")\r\n      // obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n      // if(snapType == \"between\"){\r\n      //   obj.diagram.model.setDataProperty(obj.data, \"width\",gridWidth+gridWidth-10)\r\n      //   obj.diagram.model.setDataProperty(obj.data, \"height\",gridHeight+gridHeight-10)\r\n      // }else{\r\n      //   obj.diagram.model.setDataProperty(obj.data, \"width\",gridWidth-10)\r\n      //   obj.diagram.model.setDataProperty(obj.data, \"height\",gridHeight-10)\r\n      // }\r\n    }\r\n    // else{\r\n    //   // var list = verticalLines[0].layer.findObjectsNear(obj.location, dist)\r\n    //   // console.log(\"list\",list)\r\n    //   var x=obj.location.x,y=obj.location.y, xi,yi;\r\n    //     for(var i=0;i<allPointsX.length;i++){\r\n    //       if(x<allPointsX[i]){\r\n    //         x = allPointsX[i]\r\n    //         xi = i\r\n    //         break;\r\n    //       }\r\n    //     }\r\n    //     for(var i=0;i<allPointsY.length;i++){\r\n    //       if(y<=allPointsY[i]){\r\n    //         y = allPointsY[i]\r\n    //         yi = i;\r\n    //         break;\r\n    //       }\r\n    //     }\r\n\r\n    //     if(x != -9000 && y != 9000){\r\n    //       obj.location = new go.Point(x, y)\r\n    //       obj.data.orderX = xi + 1;\r\n    //       obj.data.orderY = yi + 1;\r\n    //     }\r\n    //     console.log(\"sdfdsfsd\")\r\n    // }\r\n\r\n    // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n  });\r\n\r\n  if (axisXText) {\r\n    // axisXText.location = group.location.copy().offset(x1+30, 0)\r\n    // axisXText.locationSpot = go.Spot.Top\r\n  }\r\n  if (axisYText) {\r\n    // axisYText.location = group.location.copy().offset(-10, -(x2+30))\r\n    // axisYText.locationSpot = go.Spot.Right\r\n  }\r\n  if (axisY) {\r\n    axisY.angle = 270;\r\n    this.diagram.model.setDataProperty(\r\n      axisY.data,\r\n      \"desiredSize\",\r\n      `${x2 + 30} 10`\r\n    );\r\n  }\r\n  if (axisX) {\r\n    axisX.angle = 0;\r\n    this.diagram.model.setDataProperty(\r\n      axisX.data,\r\n      \"desiredSize\",\r\n      `${x1 + 30} 10`\r\n    );\r\n  }\r\n  // line.width = 2000\r\n  // line.height = 4\r\n  group.width = x1 + gridWidth * 2;\r\n  group.height = x2 + gridHeight * 2;\r\n  // group.location = group.location.copy().offset(-gridWidth, gridHeight)\r\n  // this.diagram.model.setDataProperty(group.data, \"loc\",go.Point.stringify(group.location.copy().offset(-gridWidth, gridHeight)))\r\n  go.Layout.prototype.doLayout.call(this, coll);\r\n  diagram.commitTransaction(\"YunGroupLayout\");\r\n  // diagram.updateAllTargetBindings()\r\n  return;\r\n  // return;\r\n  // var diagram = this.diagram;\r\n  if (diagram === null) return;\r\n  diagram.startTransaction(\"PoolLayout\");\r\n  // make sure all of the Group Shapes are big enough\r\n  // var minsize = computeMinPoolSize();\r\n  // diagram.findTopLevelGroups().each(function(lane) {\r\n  //   if (!(lane instanceof go.Group)) return;\r\n  //   var shape = lane.selectionObject;\r\n  //   if (shape !== null) {  // change the desiredSize to be big enough in both directions\r\n  //     var sz = computeLaneSize(lane);\r\n  //     shape.width = (!isNaN(shape.width)) ? Math.max(shape.width, sz.width) : sz.width;\r\n  //     shape.height = (isNaN(shape.height) ? minsize.height : Math.max(shape.height, minsize.height));\r\n  //     var cell = lane.resizeCellSize;\r\n  //     if (!isNaN(shape.width) && !isNaN(cell.width) && cell.width > 0) shape.width = Math.ceil(shape.width / cell.width) * cell.width;\r\n  //     if (!isNaN(shape.height) && !isNaN(cell.height) && cell.height > 0) shape.height = Math.ceil(shape.height / cell.height) * cell.height;\r\n  //   }\r\n  // });\r\n  // now do all of the usual stuff, according to whatever properties have been set on this GridLayout\r\n  go.GridLayout.prototype.doLayout.call(this, coll);\r\n  diagram.commitTransaction(\"PoolLayout\");\r\n};\r\n// end PoolLayout class\r\n\r\nmodule.exports = YunGroupLayout;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/layout/yunGroupLayout.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\nvar yunGroupLayout = require(\"../layout/yunpanGroupLayout\")\r\n\r\nclass YunNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        this.defaultTextFont = \"20px 'Microsoft YaHei'\"\r\n        \r\n    }\r\n    \r\n\r\n    snapToGrid(data, node){\r\n\r\n      if(data.subRole == \"coreText\" || data.subRole == \"themeText\"){\r\n        return;\r\n      }\r\n      var p = go.Point.parse(data.loc)\r\n      if(node.__yunPointsX && node.__yunPointsY ){\r\n        if(p.x >= node.__yunPointsX[0] && p.x <= node.__yunPointsX[node.__yunPointsX.length-1] \r\n          && p.y >= node.__yunPointsY[node.__yunPointsY.length-1] && p.y <= node.__yunPointsY[0] ){\r\n            // 在画布格子范围内的位置才对齐网格\r\n            var minX=20000,minY=20000,tmp,orderX,orderY;\r\n            for(var i=0;i<node.__yunPointsX.length;i++){\r\n              tmp = Math.abs(p.x - node.__yunPointsX[i])\r\n              if(tmp< minX){\r\n                minX = tmp;\r\n                orderX = i+1;\r\n              }\r\n            }\r\n            for(var i=0;i<node.__yunPointsY.length;i++){\r\n              tmp = Math.abs(p.y - node.__yunPointsY[i])\r\n              if(tmp< minY){\r\n                minY = tmp;\r\n                orderY = i+1;\r\n              }\r\n            }\r\n\r\n            if(orderX!=null && orderY!=null){\r\n              // var x = node.__yunPointsX[orderX-1]\r\n              // var y = node.__yunPointsX[orderY-1]\r\n              // x = -1300\r\n              // y = -1300\r\n              // data.loc = \"-1688.105387366997 -121.19730986224602\"\r\n              data.orderX = orderX\r\n              data.orderY = orderY\r\n            }\r\n          }else{\r\n            delete data.orderX\r\n            delete data.orderY\r\n          }\r\n     }\r\n    }\r\n\r\n    addFreeText(e, node){\r\n      console.log(\"addFreeTextaddFreeText begin\",e)\r\n      var gridWidth = node.data.gridWidth\r\n      var p = e.documentPoint\r\n      var that = this;\r\n      var data = {\"text\":\"节点\",\r\n      \"deletable\":true, \r\n      \"role\":\"freeText\",\r\n      \"fill\":\"black\", \r\n      \"iconVisible\":false, \r\n      \"locationSpot\":\"0.5 0.5 0 0\", \r\n      \"minSize\":`30 30`,\r\n      \"subRole\":\"yunpanText\",\r\n\r\n      // \"width\":`${gridWidth-10}`,\r\n      font: that.defaultTextFont,\r\n      \"textAlign\":\"center\", \r\n      \"category\":\"autoText\", \r\n      \"loc\": go.Point.stringify(p), \r\n      \"movable\":true, \"group\":node.data.key\r\n     }\r\n    //  console.log()\r\n     \r\n\r\n      this.snapToGrid(data, node)\r\n     this.diagram.startTransaction(\"addFreeText\")\r\n     this.diagram.model.addNodeData(data);\r\n     this.diagram.commitTransaction(\"addFreeText\")\r\n     node.layout.isValidLayout = false\r\n     console.log(\"addFreeTextaddFreeText end\",e)\r\n    }\r\n    addFreeShapeText(e, node){\r\n      console.log(\"addFreeTextaddFreeText begin\",e)\r\n      var gridWidth = node.data.gridWidth\r\n      var p = e.documentPoint\r\n      var that = this;\r\n      var data = {\"text\":\"节点\",\r\n      \"deletable\":true, \r\n      \"role\":\"freeText\",\r\n      \"fill\":\"#F2F2F2\", \r\n      \"iconVisible\":false, \r\n      \"locationSpot\":\"0.5 0.5 0 0\", \r\n      \"minSize\":`30 30`,\r\n      \"subRole\":\"yunpanText\",\r\n      desiredSize: go.Size.stringify(new go.Size(gridWidth-10,gridWidth-10)),\r\n      // \"width\":`${gridWidth-10}`,\r\n      font: that.defaultTextFont,\r\n      \"textAlign\":\"center\", \r\n      \"category\":\"shapeText\", \r\n      \"loc\": go.Point.stringify(p), \r\n      \"movable\":true, \"group\":node.data.key\r\n     }\r\n    //  console.log()\r\n     \r\n\r\n      this.snapToGrid(data, node)\r\n     this.diagram.startTransaction(\"addFreeText\")\r\n     this.diagram.model.addNodeData(data);\r\n     this.diagram.commitTransaction(\"addFreeText\")\r\n     node.layout.isValidLayout = false\r\n     console.log(\"addFreeTextaddFreeText end\",e)\r\n    }\r\n\r\n    getNodeTemplate(){\r\n      var that = this\r\n      return $(go.Group, \"Auto\",\r\n      { selectionObjectName: \"PH\",\r\n      __trtdNode: that,\r\n      layerName: \"default\",\r\n      padding: 0,\r\n      margin: 0,\r\n      copyable: false,\r\n      zOrder: 15,\r\n        locationObjectName: \"PH\",\r\n        locationSpot: new go.Spot(0,1,0,-0),\r\n        // rotationSpot: go.Spot.LeftCenter,\r\n        rotatable: false,\r\n        alignment: go.Spot.Left,\r\n        alignmentFocus: go.Spot.Left,\r\n        // rotateObject:\"PH\",\r\n        click: (e, node)=>{\r\n          console.log(node.data)\r\n          var it = node.findSubGraphParts().iterator;\r\n          while (it.next()) {\r\n              var n = it.value;\r\n              if(n.data.category == \"autoText\"){\r\n                  n.findObject(\"textBorder\").visible = false;\r\n              }\r\n          }\r\n          node.layout.isValidLayout = false\r\n          return;\r\n          if(node.isSelected) return;\r\n          var it = node.findSubGraphParts().iterator;\r\n          var n;\r\n          while (it.next()) {\r\n              n = it.value;\r\n              if(n.data.role == \"labelGroup\"){\r\n                  n.__trtdNode.switchBorder(n, true)\r\n                  break;\r\n              }\r\n          }\r\n          if(n){\r\n            setTimeout(function(){\r\n              n.__trtdNode.switchBorder(n, false)\r\n            },3000)\r\n          }\r\n        },\r\n        doubleClick: function (e, node){\r\n          that.addFreeShapeText(e, node)\r\n        },\r\n        mouseOver: function(e, node) {\r\n          // if(node.data.hyperlink){\r\n          //   var textObj = node.findObject('TEXT');\r\n          //   textObj.isUnderline = true;\r\n          // }\r\n          // if(!node.containingGroup) return;\r\n          return;\r\n          // diagram.__trtd.showNodeRemarkTips(e, node);\r\n      },\r\n      contextMenu: $(go.Adornment),\r\n      mouseLeave: function(e, node) {\r\n        // if(!node.containingGroup) return;\r\n        var it = node.findSubGraphParts().iterator;\r\n        while (it.next()) {\r\n            var n = it.value;\r\n            if(n.data.role == \"labelGroup\"){\r\n                // n.__trtdNode.switchBorder(n, false)\r\n                break;\r\n            }\r\n        }\r\n        // if(n){\r\n        //   setTimeout(function(){\r\n        //     n.__trtdNode.switchBorder(n, false)\r\n        //   },3000)\r\n        // }\r\n      },\r\n        // rotatable: true,\r\n        // resizable: true,\r\n        // layoutConditions: go.Part.LayoutStandard,\r\n        layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n        layout: new yunGroupLayout()\r\n        // layout: $(go.GridLayout,{\r\n        //   spacing: new go.Size(0,0),\r\n        //   cellSize: go.Size.parse(300,150),\r\n        //   arrangement:go.GridLayout.LeftToRight,\r\n        //   alignment: go.GridLayout.Location,\r\n        //   comparer:function(pa, pb) {\r\n        //     var da = pa.data;\r\n        //     var db = pb.data;\r\n        //     if (da.order < db.order) return -1;\r\n        //     if (da.order > db.order) return 1;\r\n        //     return 0;\r\n        //   }\r\n        // }) \r\n      },\r\n      new go.Binding(\"deletable\", \"deletable\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n      new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"zOrder\", \"zOrder\").makeTwoWay(function(v,data){\r\n        return v;\r\n      }),\r\n      new go.Binding(\"locationSpot\", \"\", function(data){\r\n        // console.log(\"data:\",data)\r\n        return new go.Spot(0,1,data.gridWidth,-data.gridHeight)\r\n      }),\r\n        \r\n        $(go.Shape,  // using a Shape instead of a Placeholder\r\n          { name: \"PH\",\r\n          figure:\"Rectangle\",\r\n          // rotationSpot: go.Spot.LeftCenter,\r\n          // spot1: new go.Spot(0.01, 0.01),\r\n          // spot2: new go.Spot(0.99, 0.99),\r\n            // width: 600,\r\n            // height:300,\r\n            stroke:\"yellow\" ,\r\n            strokeWidth:0,\r\n            fill: \"rgba(0,0,255,0.0)\" },\r\n          // new go.Binding(\"desiredSize\", \"desiredSize\", function(v,data){\r\n          //   return go.Size.parse(v)\r\n          //   console.log('1111111111111111111111')\r\n          //   // for(var i=0;i<)\r\n          //   var model = data.part.diagram.model;\r\n          //   var group = data.part.data;\r\n          //   var maxWidth = 0;\r\n          //   var maxHeight = 0;\r\n          //   for(var i = 0;i<model.nodeDataArray.length;i++){\r\n          //     if(group.key != model.nodeDataArray[i].group){\r\n          //       continue;\r\n          //     }\r\n          //     if(model.nodeDataArray[i].desiredSize){\r\n          //       console.log(model.nodeDataArray[i].desiredSize)\r\n          //       var size = go.Size.parse(model.nodeDataArray[i].desiredSize)\r\n          //       if(size.width > maxWidth){\r\n          //         maxWidth = size.width;\r\n          //       }\r\n          //       if(size.height > maxHeight){\r\n          //         maxHeight = size.height;\r\n          //       }\r\n          //     }\r\n          //   }\r\n          //   // var group = that.diagram.findNodeForKey(data.part.data.key)\r\n          //   // var git = group.memberParts;\r\n          //   // var maxWidth = 0;\r\n          //   // var maxHeight = 0;\r\n          //   // while (git.next()) {\r\n          //   //   var item = git.value;\r\n          //   //   console.log(\"item:\",item)\r\n          //   //   if(item.naturalBounds.width > maxWidth){\r\n          //   //     maxWidth = item.naturalBounds.width;\r\n          //   //   }\r\n          //   //   if(item.naturalBounds.height > maxHeight){\r\n          //   //     maxHeight = item.naturalBounds.height;\r\n          //   //   }\r\n          //   //   console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n      \r\n          //   // }           \r\n          //   return go.Size.parse(`${maxWidth+100} ${maxHeight}`)         \r\n          //   // group.diagram.model.setDataProperty(group.data, \"desiredSize\", `${maxWidth+100} ${maxHeight}`) \r\n          // }).makeTwoWay(go.Size.stringify)\r\n        ),\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        // $(go.Placeholder,    // represents the area of all member parts,\r\n        //   { padding: 0}\r\n        // ),  // with some extra padding around them\r\n\r\n        // $(go.TextBlock,  // group title\r\n        //   { font: \"Bold 12pt Sans-Serif\" },\r\n        //   new go.Binding(\"text\", \"key\")\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = YunNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/yunpanGroupNodeTemplate.js","    // define a custom grid layout that makes sure the length of each lane is the same\r\n    // and that each lane is broad enough to hold its subgraph\r\n    function YunGroupLayout() {\r\n        go.Layout.call(this);\r\n        // go.GridLayout.call(this);\r\n        // this.cellSize = new go.Size(1, 1);\r\n        // this.wrappingColumn = Infinity;\r\n        // this.wrappingWidth = Infinity;\r\n        // this.spacing = new go.Size(0, 0);\r\n        // this.alignment = go.GridLayout.Position;\r\n      }\r\n      go.Diagram.inherit(YunGroupLayout, go.Layout);\r\n  \r\n      function computeNewRotateLoc(rotateCenter,currentLoc, angle){\r\n          if(rotateCenter.equals(currentLoc)) return currentLoc\r\n        // 计算选择中心点到（0,0）点的偏移\r\n        var offset = new go.Point(0,0).subtract(rotateCenter.copy())\r\n        // 将原来的点偏移到相对0,0点的位置\r\n        var nodeOrigin = currentLoc.copy().offset(offset.x, offset.y)\r\n        var newNodeOrigin = nodeOrigin.rotate(angle)\r\n        var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y)\r\n        return newNodeLoc\r\n        // console.log(\"newNodeLoc\", newNodeLoc)\r\n      }\r\n      YunGroupLayout.prototype.doLayout = function(coll) {\r\n          console.log(\"YunGroupLayout.doLayout\")\r\n        var diagram = this.diagram;\r\n        diagram.startTransaction(\"YunGroupLayout\")\r\n          // COLL might be a Diagram or a Group or some Iterable<Part>\r\n         \r\n        var it = this.collectParts(coll).iterator;\r\n        var collection = []\r\n        var dataCollection =[]\r\n        var group = this.group\r\n        var gridWidth = group.data.gridWidth\r\n        var gridHeight = group.data.gridHeight\r\n        // group.location = new go.Point(0,0)\r\n        var maxWidth = 0;\r\n        var maxHeight = 0;\r\n        var centerLine, axisX, axisY,axisXText, axisYText, themeText, labelText1,labelText2,labelText3,labelGroup,waveGroup\r\n        var shiTextColl = []\r\n        var xuTextColl = []\r\n        var verticalLines = []\r\n        var horizontalLines = []\r\n        var freelLines = []\r\n        var allLines = []\r\n        var freeTexts = []\r\n        var shapeNodes = []\r\n        var horizontalDim = []\r\n        var verticalDim = []\r\n        var snapType = group.data.snapType || \"grid\"\r\n        var showShape = group.data.showShape; // 是否显示矩形\r\n        var beginSpark = group.data.beginSpark; // 是否开始火花\r\n        var shapeStrokes = group.data.shapeStrokes; // 是否开始火花\r\n        var oliveWidth\r\n        var oliveHeight\r\n        while (it.next()) {\r\n            var node = it.value;\r\n                // var item = git.value;\r\n            //   console.log(\"item:\",item)\r\n\r\n            dataCollection.push(node.data)\r\n            if(node.data.category == \"wave\"){\r\n                collection.push(node)\r\n            }\r\n            if(!(node instanceof go.Node)){\r\n              continue;\r\n            }\r\n            \r\n            if(node.data.dimX == 0 && node.data.subRole == \"dimText\"){\r\n              verticalDim.push(node)\r\n            }\r\n            if(node.data.dimY == 0 && node.data.subRole == \"dimText\"){\r\n              horizontalDim.push(node)\r\n            }\r\n            if(node.data.role == \"background\"){\r\n              shapeNodes.push(node)\r\n            }\r\n            // 处理文本节点的位置和定位位置\r\n            // if(node.data.category == \"text\"){\r\n              if(node.data.role == \"axisYText\"){\r\n                axisYText = node;\r\n              }\r\n              if(node.data.role == \"axisXText\"){\r\n                axisXText = node;\r\n              }\r\n              if(node.data.role == \"themeText\"){\r\n                themeText = node;\r\n              }\r\n              if(node.data.role == \"shiText\"){\r\n                shiTextColl.push(node)\r\n              }\r\n              if(node.data.role == \"xuText\"){\r\n                xuTextColl.push(node)\r\n              }\r\n            // }\r\n            // 处理label文本节点的位置和定位位置\r\n            // if(node.data.category == \"iconText\"){\r\n              if(node.data.role == \"labelText1\"){\r\n                labelText1 = node;\r\n              }\r\n              if(node.data.role == \"labelText2\"){\r\n                labelText2 = node;\r\n              }\r\n              if(node.data.role == \"labelText3\"){\r\n                labelText3 = node;\r\n              }\r\n              if(node.data.role == \"labelGroup\"){\r\n                labelGroup = node;\r\n              }\r\n            // }\r\n\r\n              if(node.naturalBounds.width > maxWidth){\r\n                maxWidth = node.naturalBounds.width;\r\n              }\r\n              if(node.naturalBounds.height > maxHeight){\r\n                maxHeight = node.naturalBounds.height;\r\n              }\r\n            \r\n            \r\n              if(node.data.role == \"freeText\"){\r\n                freeTexts.push(node);\r\n              }\r\n            if (node.data.category == \"line\") {\r\n\r\n                allLines.push(node)\r\n                if(node.data.role == \"verticalLine\"){\r\n                  verticalLines.push(node);\r\n                }\r\n                if(node.data.role == \"horizontalLine\"){\r\n                  horizontalLines.push(node);\r\n                }\r\n                if(node.data.role == \"freelLine\"){\r\n                  freelLines.push(node);\r\n                }\r\n            }\r\n            if (node.data.group == group.key) {\r\n            // position the node . . .\r\n                if(node.data.category == \"line\"){\r\n                    if(node.data.role == \"axisX\") {\r\n                      node.angle = 0;\r\n                      axisX = node\r\n                      node.location = group.location.copy().offset(0,0)\r\n                    };\r\n                    if(node.data.role == \"axisY\") {\r\n                      axisY = node\r\n                      node.angle = 270;\r\n                      node.location = group.location.copy().offset(0,0)\r\n                    }\r\n                    // node.angle = 270\r\n                }\r\n                // if(node.data.category == \"waveGroup\"){\r\n                //     waveGroup = node;\r\n                //     // node.angle = group.angle\r\n                //     oliveWidth = node.data.oliveWidth\r\n                //     oliveHeight = node.data.oliveHeight\r\n                //     node.location = group.location.copy().offset(0,0)\r\n                //     // node.layout.isOngoing = true;\r\n                //     // node.layout.isValidLayout = false;\r\n                //     // collection.push(node)\r\n                // }\r\n\r\n            }\r\n        }\r\n        console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n\r\n\r\n\r\n        verticalLines.sort(function(a,b){\r\n            return a.data.order - b.data.order\r\n        })\r\n        horizontalLines.sort(function(a,b){\r\n            return a.data.order - b.data.order\r\n        })\r\n        freelLines.sort(function(a,b){\r\n          return a.data.order - b.data.order\r\n        })\r\n        // verticalDim.sort(function(a,b){\r\n        //     return a.data.dimY - b.data.dimY\r\n        // })\r\n        // horizontalDim.sort(function(a,b){\r\n        //     return a.data.dimX - b.data.dimX\r\n        // })\r\n        // horizontalLines.forEach(function(obj,index){\r\n        //   var newOrder = index+1;\r\n        //   obj.diagram.model.setDataProperty(obj.data,\"dimX\", newOrder)\r\n        // })\r\n        // verticalDim.forEach(function(obj,index){\r\n        //   var newOrder = index+1;\r\n        //   obj.diagram.model.setDataProperty(obj.data,\"dimY\", newOrder)\r\n        // })\r\n        if(snapType == \"between\"){\r\n          var x1 = verticalLines.length*gridWidth+gridWidth\r\n          var x2 = horizontalLines.length*gridHeight+gridHeight\r\n        }else{\r\n          var x1 = verticalLines.length*gridWidth\r\n          var x2 = horizontalLines.length*gridHeight\r\n        }\r\n\r\n        var allPointsX = [];\r\n        var allPointsY = [];\r\n        var centerOrderX = (horizontalLines.length+1)/2\r\n        var centerOrderY = (verticalLines.length+1)/2\r\n        allLines.forEach(function(obj, index){\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n          \r\n          // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n          if( obj.data.role == \"axisX\" ||  obj.data.role == \"axisY\") return;\r\n          // if(obj.data.subRole == \"dim\"){\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[0, 0]\")\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",3)\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"RGBA(164, 177, 198, 1)\")\r\n          // }else{\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[15, 10]\")\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n          // }\r\n        })\r\n\r\n        verticalLines.forEach(function(obj,index){\r\n          var newOrder = index+1;\r\n          obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n          obj.location = group.location.copy().offset(gridWidth*(newOrder),0)\r\n          obj.angle = 270;\r\n          obj.diagram.model.setDataProperty(obj.data, \"deletable\", true)\r\n          obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${x2+20} 10`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n          if(snapType == \"between\"){\r\n            if(newOrder < centerOrderX){\r\n              allPointsX.push(obj.location.x-gridWidth/2)\r\n            }\r\n            if(newOrder == centerOrderX){\r\n              allPointsX.push(obj.location.x)\r\n            }\r\n            if(newOrder > centerOrderX){\r\n              allPointsX.push(obj.location.x+gridWidth/2)\r\n            }\r\n          }else{\r\n            allPointsX.push(obj.location.x)\r\n          }\r\n\r\n\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n        })\r\n        horizontalLines.forEach(function(obj,index){\r\n          var newOrder = index+1;\r\n          obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n          obj.diagram.model.setDataProperty(obj.data, \"deletable\", true)\r\n          obj.location = group.location.copy().offset(0,-gridHeight*(newOrder))\r\n          obj.angle = 0;\r\n          obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${x1+20} 10`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n          if(snapType == \"between\"){\r\n            if(newOrder < centerOrderY){\r\n              allPointsY.push(obj.location.y+gridHeight/2)\r\n            }\r\n            if(newOrder == centerOrderY){\r\n              allPointsY.push(obj.location.y)\r\n            }\r\n            if(newOrder > centerOrderY){\r\n              allPointsY.push(obj.location.y-gridHeight/2)\r\n            }\r\n          }else{\r\n              allPointsY.push(obj.location.y)\r\n          }\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n        })\r\n        // allPointsX.unshift(allPointsX[0]-gridWidth)\r\n        // allPointsX.push(allPointsX[allPointsX.length-1]+gridWidth)\r\n        // allPointsY.unshift(allPointsY[0]-gridLength)\r\n        // allPointsY.push(allPointsY[allPointsY.length-1]+gridLength)\r\n        this.group.__yunPointsX = allPointsX\r\n        this.group.__yunPointsY = allPointsY\r\n        freelLines.forEach(function(obj,index){\r\n          // var newOrder = index+1;\r\n          // obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n          // obj.location = new go.Point(allPointsX[9], allPointsY[9])\r\n          // obj.angle = 315;\r\n          // obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${gridWidth*20-5} 10`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",false)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"selectable\",true)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\",1)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"zOrder\",10)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showArrow\",true)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showBeginArrow\",true)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"showEndArrow\",true)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"locationSpot\",`0.5 0.5 0 0`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"stroke\",\"rgba(0,0,0,0.3)\")\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[5, 5]\")\r\n          // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n        })\r\n\r\n\r\n\r\n        // shapeNodes.forEach(function(obj,index){\r\n        //   obj.diagram.model.setDataProperty(obj.data, \"visible\",true)\r\n        //   if(!showShape){\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"stroke\", \"rgba(255,0,0,0)\")\r\n        //   }else{\r\n        //     try{\r\n        //       obj.diagram.model.setDataProperty(obj.data, \"stroke\", shapeStrokes[obj.data.gridWidth/2-1])\r\n        //     }catch(e){\r\n        //       console.log(e)\r\n        //     }\r\n        //   }\r\n        //     if(obj.data.desiredSize){\r\n        //       return;\r\n        //     }\r\n        //     obj.data.orderX = centerOrderX\r\n        //     obj.data.orderY = centerOrderY\r\n        //     obj.location = new go.Point(allPointsX[obj.data.orderX-1], allPointsY[obj.data.orderY-1])\r\n        //     var shapeWidth = obj.data.gridWidth||2;\r\n        //     if(snapType == \"between\"){\r\n        //       var desiredSize = new go.Size(gridWidth*(shapeWidth-1), gridHeight*(shapeWidth-1))\r\n        //       obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\", gridWidth)\r\n        //     }else{\r\n        //       var desiredSize = new go.Size(gridWidth*shapeWidth+3, gridHeight*shapeWidth+3)\r\n        //       obj.diagram.model.setDataProperty(obj.data, \"strokeWidth\", 3)\r\n        //     }\r\n        //     // obj.desiredSize = desiredSize;\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",go.Size.stringify(desiredSize))\r\n        //     // obj.diagram.model.setDataProperty(obj.data, \"visible\",true)\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[0,0]\")\r\n            \r\n        // })\r\n\r\n        // var dist = Math.max(gridHeight,gridWidth)\r\n        freeTexts.forEach(function(obj,index){\r\n          // var newOrder = index+1;\r\n          // obj.diagram.model.setDataProperty(obj.data,\"order\", newOrder)\r\n          // obj.location = group.location.copy()\r\n          // obj.angle = 315;\r\n          // obj.diagram.model.setDataProperty(obj.data, \"desiredSize\",`${x1+20} 10`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"minSize\",`60 50`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth-10}`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth*3}`)\r\n          // delete obj.data.width\r\n          // obj.diagram.model.setDataProperty(obj.data, \"textAlign\",`center`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"locationSpot\",`0.5 0.5 0 0`)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"strokeDashArray\",\"[10, 5]\")\r\n          // obj.diagram.model.setDataProperty(obj.data, \"font\", group.__trtdNode.defaultTextFont)\r\n\r\n      // if(node.__yunPointsY && node.__yunPointsX){\r\n      //       for(var i=0;i<allPointsX.length;i++){\r\n      //         if(obj)\r\n      //       }\r\n      //    }\r\n      // if(obj.data.text.indexOf(\"自由文本\") >-1){\r\n      //   console.log(\"ddd\",obj.data.text)\r\n      //   var order = obj.data.text.replace(\"自由文本\",\"\").split(\",\")\r\n      //   if(order.length == 2){\r\n      //     obj.data.orderX = order[0]\r\n      //     obj.data.orderY = order[1]\r\n      //     obj.location = new go.Point(allPointsX[obj.data.orderX-1], allPointsY[obj.data.orderY-1])\r\n      //   }\r\n      // }\r\n\r\n        // if(obj.data.text.length == 1){\r\n        //   if(obj.data.subRole == null){\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"subRole\",\"coreText\")\r\n        //     obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n        //   }\r\n        // }\r\n\r\n        // if(obj.data.text.indexOf(\"维度\") >-1){\r\n        //   console.log(\"ddd\",obj.data.text)\r\n        //   // var order = obj.data.text.replace(\"维度\",\"\").split(\",\")\r\n        //   obj.diagram.model.setDataProperty(obj.data, \"subRole\",\"dimText\")\r\n        //   // obj.diagram.model.setDataProperty(obj.data, \"dimKey\", null)\r\n        //   delete obj.data.dimKey\r\n        //   obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n        //   // obj.diagram.model.setDataProperty(obj.data, \"width\", null)\r\n        //   // obj.diagram.model.setDataProperty(obj.data, \"height\", null)\r\n        // }\r\n          obj.areaBackground = null\r\n          // obj.diagram.model.setDataProperty(obj.data, \"height\", null)\r\n          // obj.diagram.model.setDataProperty(obj.data, \"width\", null)\r\n          // obj.findObject(\"place\").visible = false;\r\n          // console.log(\"verticalLines.length+1)/2verticalLines.length+1)/2\",(verticalLines.length+1)/2)\r\n          if(group.data.autoSnapText){\r\n            // 计算普通文字位置\r\n            if(obj.data.orderX && obj.data.orderY){\r\n              obj.location = new go.Point(allPointsX[obj.data.orderX-1], allPointsY[obj.data.orderY-1])\r\n              \r\n              obj.location = new go.Point(allPointsX[obj.data.orderX-1], allPointsY[obj.data.orderY-1])\r\n            }\r\n            // 计算维度文字位置\r\n            if(obj.data.subRole == \"dimText\" && obj.data.dimX!=null && obj.data.dimY!=null){\r\n              console.log(\"dimText\")\r\n              obj.diagram.model.setDataProperty(obj.data, \"deletable\", true)\r\n              var dimXLoc, dimYLoc;\r\n              dimXLoc = allPointsX[obj.data.dimX-1]\r\n              dimYLoc = allPointsY[obj.data.dimY-1]\r\n\r\n              // if(obj.data.dimX > allPointsX.length+1){\r\n              //   dimXLoc = allPointsX[allPointsX.length-1]+gridWidth\r\n              //   // if(snapType != \"between\"){\r\n              //   //   dimXLoc += gridWidth/3\r\n              //   // }\r\n              // }\r\n              // if(obj.data.dimY > allPointsY.length+1){\r\n              //   dimYLoc = allPointsY[allPointsY.length-1]-gridHeight\r\n              //   // if(snapType != \"between\"){\r\n              //   //   dimYLoc -= gridHeight/3\r\n              //   // }\r\n              // }\r\n              if(obj.data.dimX <= 0){\r\n                dimXLoc = allPointsX[0]-gridWidth/2-10\r\n                if(snapType != \"between\"&& obj.data.dimY <= allPointsY.length){\r\n                  dimXLoc -= gridWidth/2\r\n                }\r\n              }\r\n              if(obj.data.dimY <= 0){\r\n                dimYLoc = allPointsY[0]+gridHeight/2\r\n                if(snapType != \"between\" && obj.data.dimX <= allPointsX.length){\r\n                  dimYLoc += gridHeight/2\r\n                }\r\n              }\r\n              obj.location = new go.Point(dimXLoc, dimYLoc)\r\n            }\r\n          }\r\n          // if(obj.data.orderY == centerOrderY||obj.data.dimY == centerOrderY){\r\n          //   // console.log(\"Ddddddd\")\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth-10}`)\r\n          //   // delete obj.data.height\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"height\", null)\r\n          // }\r\n          // if(obj.data.orderX == centerOrderX || obj.data.dimX == centerOrderX ){\r\n          //   // console.log(\"Ddddddd\")\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n          //   obj.diagram.model.setDataProperty(obj.data, \"width\", null)\r\n          //   // delete obj.data.width\r\n          // }\r\n\r\n          // if(Math.abs(obj.data.orderX-centerOrderX) <= 1 && Math.abs(obj.data.orderY-centerOrderY) <= 1){\r\n          //   // 中心节点\r\n          //   if(snapType != \"between\"){\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth-10}`)\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n          //   }\r\n          // }\r\n\r\n          // if(Math.abs(obj.data.orderX-centerOrderX) == 0 && Math.abs(obj.data.orderY-centerOrderY) == 0){\r\n          //   // 中心节点\r\n          //   // obj.diagram.model.setDataProperty(obj.data, \"textStroke\",`red`)\r\n          //   // obj.diagram.model.setDataProperty(obj.data, \"deletable\", false)\r\n          //   // obj.diagram.model.setDataProperty(obj.data, \"subRole\", \"themeText\")\r\n          //   // obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n          //   if(snapType == \"between\"){\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth+gridWidth-10}`)\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight+gridHeight-10}`)\r\n          //   }else{\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"width\",`${gridWidth-10}`)\r\n          //     obj.diagram.model.setDataProperty(obj.data, \"height\",`${gridHeight-10}`)\r\n          //   }\r\n          // }\r\n          // else{\r\n          //   // var list = verticalLines[0].layer.findObjectsNear(obj.location, dist)\r\n          //   // console.log(\"list\",list)\r\n          //   var x=obj.location.x,y=obj.location.y, xi,yi;\r\n          //     for(var i=0;i<allPointsX.length;i++){\r\n          //       if(x<allPointsX[i]){\r\n          //         x = allPointsX[i]\r\n          //         xi = i\r\n          //         break;\r\n          //       }\r\n          //     }\r\n          //     for(var i=0;i<allPointsY.length;i++){\r\n          //       if(y<=allPointsY[i]){\r\n          //         y = allPointsY[i]\r\n          //         yi = i;\r\n          //         break;\r\n          //       }\r\n          //     }\r\n\r\n          //     if(x != -9000 && y != 9000){\r\n          //       obj.location = new go.Point(x, y)\r\n          //       obj.data.orderX = xi + 1;\r\n          //       obj.data.orderY = yi + 1;\r\n          //     }\r\n          //     console.log(\"sdfdsfsd\")\r\n          // }\r\n\r\n          // obj.diagram.model.setDataProperty(obj.data, \"selectable\",false)\r\n        })\r\n\r\n        if(axisXText){\r\n          axisXText.location = group.location.copy().offset(x1+50, 0)\r\n          axisXText.locationSpot = go.Spot.Left\r\n        }\r\n        if(axisYText){\r\n          axisYText.location = group.location.copy().offset(0, -(x2+50))\r\n          axisYText.locationSpot = go.Spot.Bottom\r\n        }\r\n        if(axisY) {\r\n          axisY.angle = 270;\r\n          this.diagram.model.setDataProperty(axisY.data, \"desiredSize\",`${x2+30} 10`)\r\n        }\r\n        if(axisX) {\r\n          axisX.angle = 0\r\n          this.diagram.model.setDataProperty(axisX.data, \"desiredSize\",`${x1+30} 10`)\r\n        }\r\n        // line.width = 2000\r\n        // line.height = 4\r\n        group.width = x1+gridWidth*2\r\n        group.height = x2+gridHeight*2\r\n        // group.location = group.location.copy().offset(-gridWidth, gridHeight)\r\n        // this.diagram.model.setDataProperty(group.data, \"loc\",go.Point.stringify(group.location.copy().offset(-gridWidth, gridHeight)))\r\n        go.Layout.prototype.doLayout.call(this, coll);\r\n        diagram.commitTransaction(\"YunGroupLayout\");\r\n        // diagram.updateAllTargetBindings()\r\n        return;\r\n        // return;\r\n        // var diagram = this.diagram;\r\n        if (diagram === null) return;\r\n        diagram.startTransaction(\"PoolLayout\");\r\n        // make sure all of the Group Shapes are big enough\r\n        // var minsize = computeMinPoolSize();\r\n        // diagram.findTopLevelGroups().each(function(lane) {\r\n        //   if (!(lane instanceof go.Group)) return;\r\n        //   var shape = lane.selectionObject;\r\n        //   if (shape !== null) {  // change the desiredSize to be big enough in both directions\r\n        //     var sz = computeLaneSize(lane);\r\n        //     shape.width = (!isNaN(shape.width)) ? Math.max(shape.width, sz.width) : sz.width;\r\n        //     shape.height = (isNaN(shape.height) ? minsize.height : Math.max(shape.height, minsize.height));\r\n        //     var cell = lane.resizeCellSize;\r\n        //     if (!isNaN(shape.width) && !isNaN(cell.width) && cell.width > 0) shape.width = Math.ceil(shape.width / cell.width) * cell.width;\r\n        //     if (!isNaN(shape.height) && !isNaN(cell.height) && cell.height > 0) shape.height = Math.ceil(shape.height / cell.height) * cell.height;\r\n        //   }\r\n        // });\r\n        // now do all of the usual stuff, according to whatever properties have been set on this GridLayout\r\n        go.GridLayout.prototype.doLayout.call(this, coll);\r\n        diagram.commitTransaction(\"PoolLayout\");\r\n      };\r\n      // end PoolLayout class\r\n\r\n      module.exports = YunGroupLayout\n\n\n// WEBPACK FOOTER //\n// ./src/layout/yunpanGroupLayout.js","\r\n\r\nvar $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\n  \r\n\r\nclass shapeNodeTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n\r\n  \r\n\r\n    getNodeSelectionAdornmentTemplate(){\r\n      return  $(go.Adornment, \"Spot\",\r\n                $(go.Panel, \"Auto\",\r\n                    $(go.Shape, { fill: null, stroke: \"dodgerblue\", strokeWidth: 1 }),\r\n                    $(go.Placeholder) // this represents the selected Node\r\n\r\n                ),\r\n                //$(\"TreeExpanderButton\",\r\n                $(go.Panel, \"Vertical\", {\r\n                        name: \"ButtonIcon1\",\r\n                        alignment: new go.Spot(0, 1, -20, 20),\r\n                        alignmentFocus: go.Spot.Center,\r\n                        width: 60,\r\n                        height: 60,\r\n                        isActionable: true,\r\n                        // click: interactions.expandCollapse // this function is defined below\r\n                    },\r\n\r\n                    $(go.Shape, \"Circle\", {\r\n                        fill: \"rgba(1,1,1,0)\",\r\n                        strokeWidth: 0,\r\n                        stroke: \"green\",\r\n                        width: 50,\r\n                        height: 50\r\n                    })\r\n\r\n                )\r\n            ); // end Adornment;\r\n    }\r\n\r\n    nodeResizeAdornmentTemplate () {\r\n      return $(go.Adornment, \"Spot\",\r\n          $(go.Placeholder), // takes size and position of adorned object\r\n          $(go.Shape, \"Circle\", // left resize handle\r\n              {\r\n                  alignment: go.Spot.TopLeft,\r\n                  alignmentFocus: go.Spot.BottomRight,\r\n                  cursor: \"col-resize\",\r\n                  desiredSize: new go.Size(30, 30),\r\n                  fill: \"lightblue\",\r\n                  stroke: \"dodgerblue\"\r\n              }),\r\n          $(go.Shape, \"Circle\", // right resize handle\r\n              {\r\n                  alignment: go.Spot.BottomRight,\r\n                  alignmentFocus: go.Spot.TopLeft,\r\n                  cursor: \"col-resize\",\r\n                  desiredSize: new go.Size(30, 30),\r\n                  fill: \"lightblue\",\r\n                  stroke: \"dodgerblue\"\r\n              })\r\n      )\r\n  }\r\n\r\n    getNodeTemplate(){\r\n      var diagram = this.diagram\r\n      var that = this;\r\n      return $(go.Node, \"Spot\", {\r\n        name: \"NODE\",\r\n        \"_controlExpand\": true,\r\n        layerName: \"default\",\r\n        zOrder: 13,\r\n        locationSpot: go.Spot.Center,\r\n        resizeCellSize: new go.Size(10, 10),\r\n        locationObjectName: \"SHAPE\",\r\n        resizable: true,\r\n        resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n        rotatable: true,\r\n        rotateObjectName: \"SHAPE\", // rotate the Shape without rotating the label\r\n        doubleClick: function (e, node) {\r\n            // interactions.selectText(e, node)\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeDoubleClickListener){\r\n                node.diagram.__trtd.nodeDoubleClickListener(node)\r\n            }\r\n            \r\n        },\r\n        click: function(e, node) {\r\n            console.log(node.data)\r\n            if(node.diagram.__trtd.nodeClickListener){\r\n                node.diagram.__trtd.nodeClickListener(node)\r\n            }\r\n            // showNodeToolBar(e,node);\r\n        },\r\n        selectable: true,\r\n        movable: true,\r\n        angle: 0,\r\n        //toMaxLinks: 1,\r\n        layoutConditions: go.Part.LayoutStandard,\r\n        //layoutConditions:~go.Part.LayoutAdded,\r\n        // fromLinkable: true, toLinkable: true,\r\n        alignment: go.Spot.Center,\r\n        alignmentFocus: go.Spot.Center,\r\n        resizeAdornmentTemplate: that.nodeResizeAdornmentTemplate(),\r\n        //rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n        contextMenu: diagram.__trtd.nodeContextMenu,\r\n        selectionAdornmentTemplate: that.getNodeSelectionAdornmentTemplate(),\r\n        contextMenu: $(go.Adornment),\r\n      },\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n        new go.Binding(\"resizable\", \"resizable\").makeTwoWay(),\r\n        new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n        new go.Binding(\"visible\", \"visible\"),\r\n        new go.Binding(\"zOrder\", \"zOrder\"),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        $(go.Shape, {\r\n            strokeDashArray: null,\r\n            // strokeDashOffset:10,\r\n            // padding: -1,\r\n            margin: 0,\r\n            name: \"SHAPE\",\r\n            figure: \"Rectangle\",\r\n            fill: \"rgba(0,0,0,0)\",\r\n            // fromLinkable: true,\r\n            // toLinkable: true,\r\n            // cursor: \"pointer\",\r\n            minSize: new go.Size(50, 50),\r\n            strokeWidth: 3,\r\n            stroke: \"RGBA(255,0,0,0.2)\",\r\n            portId: \"\"\r\n\r\n        },\r\n        new go.Binding(\"fill\", \"fill\").makeTwoWay(),\r\n        new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n        new go.Binding(\"figure\", \"figure\").makeTwoWay(),\r\n        new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n        new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n            var size = new go.Size.parse(v)\r\n            return size;\r\n        }).makeTwoWay(function(v) {\r\n            return go.Size.stringify(v)\r\n        }),\r\n        new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n            return JSON.parse(v)\r\n        }).makeTwoWay(function(v) {\r\n            return JSON.stringify(v)\r\n        }),\r\n        ),\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = shapeNodeTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/shapeNodeTemplate.js","var $ = go.GraphObject.make;\r\nvar Base = require('./base')\r\nvar helpers = require('../helpers/helpers.gojs')\r\n  \r\nclass AutoTextTemplate extends Base {\r\n    constructor(options){\r\n        super(options)\r\n        // this.nodeProperties = {}\r\n        \r\n    }\r\n\r\n    clearBorder(node){\r\n        if(node.data.showBorder){\r\n            // if(node.data.text == \"\"){\r\n                node.findObject(\"textBorder\").visible = false;\r\n            // }\r\n        }\r\n    }\r\n\r\n    makeGeo(data, shape, options) {\r\n      // this is much more efficient than calling go.GraphObject.make:\r\n      var {radiusX=150,radiusY=100} = data\r\n      var geo =  new go.Geometry()\r\n        .add(new go.PathFigure(0, 0)  // start point\r\n          .add(new go.PathSegment(go.PathSegment.SvgArc,\r\n          radiusX*2,0,radiusX, radiusY,0,1,options.clockwiseFlag?1:0\r\n              )\r\n            )\r\n          )\r\n          geo.defaultStretch = go.GraphObject.Fill;\r\n          return geo;\r\n    }\r\n    getNodeTemplate(){\r\n       var properties = {\r\n          figure: \"Rectangle\",\r\n          fill: \"rgba(0,0,0,0)\",\r\n          strokeWidth: 1,\r\n          stroke: \"rgba(0,0,0,0)\",\r\n          fontSize: 15,\r\n          font: \"sans-serif\"\r\n      };\r\n      var that = this\r\n      var diagram = this.diagram\r\n      return $(go.Node, \"Spot\", {\r\n              \"_controlExpand\": true,\r\n              __trtdNode: that,\r\n              layerName: \"Foreground\",\r\n              zOrder: 15,\r\n              movable: true,\r\n              isShadowed :true,\r\n     \r\n            //   shadowBlur : null,\r\n              shadowColor :\"#57617a\",\r\n              shadowOffset:new go.Point(0,0),\r\n            //   copyable: false,\r\n              visible: true,\r\n              locationSpot: go.Spot.Center,\r\n              resizeCellSize: new go.Size(10, 10),\r\n            //   locationObjectName: \"textBorder\",\r\n              selectionObjectName: \"SHAPE\",\r\n              resizable: true,\r\n            //   selectable: false,\r\n            //   clickable: false,\r\n              resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n              rotatable: false,\r\n              location: new go.Point(0, 0),\r\n              //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n              // doubleClick: selectText,\r\n              toMaxLinks: 1,\r\n              mouseDrop: function(e, obj) {\r\n                var node = obj.part;\r\n                var selnode = e.diagram.selection.first();\r\n\r\n                   // 常变\r\n                   if(selnode.data.category == \"picGroup\" && selnode.data.role == \"cbian\" && node.data.role == \"centerText\"){\r\n                       var oliveNode = e.diagram.findNodeForKey(node.data.olive)\r\n                       if(!oliveNode) return;\r\n                    var it = selnode.findSubGraphParts().iterator;\r\n                    var deleteObjs = []\r\n                    var cbian = {}\r\n                    while (it.next()) {\r\n                        var n = it.value;\r\n                        if(n.data.category == \"autoText\"){\r\n                        if(n.data.locationSpot == \"0 0 0 0\"){\r\n                            cbian.shiText = n.data.text;\r\n                        }\r\n                        if(n.data.locationSpot == \"0 0.5 0 0\"){\r\n                            cbian.centerText = n.data.text;\r\n                        }\r\n                        if(n.data.locationSpot == \"0 1 0 0\"){\r\n                            cbian.xuText = n.data.text;\r\n                        }\r\n                        }\r\n                        deleteObjs.push(n.data)\r\n                    }\r\n                    e.diagram.startTransaction(\"mouseDrop\")\r\n                    // 删除总结图\r\n                    e.diagram.model.removeNodeDataCollection(deleteObjs)\r\n                    var backupSelnode = JSON.parse(JSON.stringify(selnode.data))\r\n                    e.diagram.model.removeNodeData(selnode.data)\r\n        \r\n                    // 添加新橄榄\r\n                    e.diagram.__trtd.addOlive(oliveNode, cbian)\r\n                    e.diagram.commitTransaction(\"mouseDrop\")\r\n                    return;\r\n                }\r\n\r\n            \r\n\r\n                // 互换要点文字,只有云盘里的文字可以互换\r\n                if(selnode.data.subRole == \"coreText\" && node.data.subRole == \"coreText\" || \r\n                    selnode.data.subRole == \"yunpanText\" && node.data.subRole == \"yunpanText\"){\r\n                    e.diagram.model.startTransaction(\"coreTextExchange\")\r\n                    var selOrderX = selnode.data.orderX\r\n                    var selOrderY = selnode.data.orderY\r\n                    var selDimKey = selnode.data.dimKey\r\n                    e.diagram.model.setDataProperty(selnode.data, \"orderX\", node.data.orderX)\r\n                    e.diagram.model.setDataProperty(selnode.data, \"orderY\", node.data.orderY)\r\n                    e.diagram.model.setDataProperty(selnode.data, \"dimKey\", node.data.dimKey)\r\n                    e.diagram.model.setDataProperty(node.data, \"orderX\", selOrderX)\r\n                    e.diagram.model.setDataProperty(node.data, \"orderY\", selOrderY)\r\n                    e.diagram.model.setDataProperty(node.data, \"dimKey\", selDimKey)\r\n                    e.diagram.model.commitTransaction(\"coreTextExchange\")\r\n                }\r\n\r\n                // 云盘互换维度\r\n                if(selnode.data.subRole == \"dimText\" && node.data.subRole == \"dimText\" && \r\n                    selnode.data.category == node.data.category){\r\n                        if(selnode.data.group!= node.data.group) return;\r\n                        if(!selnode.containingGroup) return;\r\n                        if(selnode.containingGroup.data.category != \"yunpanGroup\") return;\r\n                        if(!(selnode.data.dimX == node.data.dimX  || selnode.data.dimY == node.data.dimY )){\r\n                            return;\r\n                        }\r\n\r\n                        e.diagram.model.startTransaction(\"dimTextExchange\")\r\n                        var selOrderX = selnode.data.dimX\r\n                        var selOrderY = selnode.data.dimY\r\n                        var it = node.containingGroup.findSubGraphParts().iterator;\r\n                        var nodeCoreTexts = []\r\n                        var selnodeCoreTexts = []\r\n                        var yunnodeCoreTexts = []\r\n                        var yunselnodeCoreTexts = []\r\n                        var normDim = \"X\"\r\n                        if(selnode.data.dimX == 0){\r\n                            normDim  = \"Y\"\r\n                        }\r\n                        var selOrder = selnode.data[\"dim\"+normDim]\r\n                        var nodeOrder = node.data[\"dim\"+normDim]\r\n                        while (it.next()) {\r\n                            var n = it.value;\r\n                            if(n.data.subRole == \"yunpanText\"){\r\n                                if(n.data[\"order\"+normDim] == nodeOrder){\r\n                                    yunnodeCoreTexts.push(n)\r\n                                }\r\n                                if(n.data[\"order\"+normDim] == selOrder){\r\n                                    yunselnodeCoreTexts.push(n)\r\n                                }\r\n                            }\r\n                        }\r\n                        var tmpX,tmpY;\r\n                        for(var i=0;i<yunnodeCoreTexts.length;i++){\r\n                            e.diagram.model.setDataProperty(yunnodeCoreTexts[i].data, \"order\"+normDim, selOrder)\r\n                        }\r\n                        for(var i=0;i<yunselnodeCoreTexts.length;i++){\r\n                            e.diagram.model.setDataProperty(yunselnodeCoreTexts[i].data, \"order\"+normDim, nodeOrder)\r\n                        }\r\n                        e.diagram.model.setDataProperty(selnode.data, \"dim\"+normDim, nodeOrder)\r\n                        e.diagram.model.setDataProperty(node.data, \"dim\"+normDim, selOrder)\r\n                        e.diagram.model.commitTransaction(\"dimTextExchange\")\r\n                    return;\r\n                    }\r\n\r\n                // 互换维度\r\n                if(selnode.data.subRole == \"dimText\" && node.data.subRole == \"dimText\"){\r\n                    e.diagram.model.startTransaction(\"dimTextExchange\")\r\n                    var selOrderX = selnode.data.dimX\r\n                    var selOrderY = selnode.data.dimY\r\n                    var it = node.containingGroup.findSubGraphParts().iterator;\r\n                    var nodeCoreTexts = []\r\n                    var selnodeCoreTexts = []\r\n                    var yunnodeCoreTexts = []\r\n                    var yunselnodeCoreTexts = []\r\n                    var normDim = \"X\"\r\n                    if(selnode.data.dimX == 0){\r\n                        normDim  = \"Y\"\r\n                    }\r\n                    while (it.next()) {\r\n                        var n = it.value;\r\n                        if(n.data.dimKey == node.data.key){\r\n                            nodeCoreTexts.push(n)\r\n                        }\r\n                        if(n.data.dimKey == selnode.data.key){\r\n                            selnodeCoreTexts.push(n)\r\n                        }\r\n                        if(n.data.subRole == \"yunpanText\"){\r\n                            if(n.data[\"order\"+normDim] == node.data[\"order\"+normDim]){\r\n                                yunnodeCoreTexts.push(n)\r\n                            }\r\n                            if(n.data[\"order\"+normDim] == selnode.data[\"order\"+normDim]){\r\n                                yunselnodeCoreTexts.push(n)\r\n                            }\r\n                        }\r\n                    }\r\n                    console.log(\"selnodeCoreTextsselnodeCoreTextsselnodeCoreTexts\",selnodeCoreTexts.length)\r\n                    var centerOrderX = (node.containingGroup.__yunPointsX.length+1)/2\r\n                    var centerOrderY = (node.containingGroup.__yunPointsY.length+1)/2\r\n\r\n                    if(selnode.data.dimX > centerOrderX){\r\n                        selnodeCoreTexts.sort(function(a,b){\r\n                            return a.data.orderX - b.data.orderX\r\n                        })\r\n                    }\r\n                    if(selnode.data.dimX == centerOrderX){\r\n                        if(selnode.data.dimY > centerOrderY){\r\n                            selnodeCoreTexts.sort(function(a,b){\r\n                                return a.data.orderY - b.data.orderY\r\n                            })\r\n                        }else{\r\n                            selnodeCoreTexts.sort(function(a,b){\r\n                                return b.data.orderY -a.data.orderY\r\n                            })\r\n                        }\r\n                    }\r\n                    if(selnode.data.dimX < centerOrderX){\r\n                        selnodeCoreTexts.sort(function(a,b){\r\n                            return  b.data.orderX - a.data.orderX\r\n                        })\r\n                    }\r\n\r\n                    if(node.data.dimX > centerOrderX){\r\n                        nodeCoreTexts.sort(function(a,b){\r\n                            return a.data.orderX - b.data.orderX\r\n                        })\r\n                    }\r\n                    if(node.data.dimX == centerOrderX){\r\n                        if(node.data.dimY > centerOrderY){\r\n                            nodeCoreTexts.sort(function(a,b){\r\n                                return a.data.orderY - b.data.orderY\r\n                            })\r\n                        }else{\r\n                            nodeCoreTexts.sort(function(a,b){\r\n                                return b.data.orderY -a.data.orderY\r\n                            })\r\n                        }\r\n                    }\r\n                    if(node.data.dimX < centerOrderX){\r\n                        nodeCoreTexts.sort(function(a,b){\r\n                            return  b.data.orderX - a.data.orderX\r\n                        })\r\n                    }\r\n\r\n                    var tmpX,tmpY;\r\n                    for(var i=0;i<selnodeCoreTexts.length;i++){\r\n                        tmpX = selnodeCoreTexts[i].data.orderX;\r\n                        tmpY = selnodeCoreTexts[i].data.orderY;\r\n                        e.diagram.model.setDataProperty(selnodeCoreTexts[i].data, \"orderX\", nodeCoreTexts[i].data.orderX)\r\n                        e.diagram.model.setDataProperty(selnodeCoreTexts[i].data, \"orderY\", nodeCoreTexts[i].data.orderY)\r\n                        e.diagram.model.setDataProperty(nodeCoreTexts[i].data, \"orderX\", tmpX)\r\n                        e.diagram.model.setDataProperty(nodeCoreTexts[i].data, \"orderY\", tmpY)\r\n                    }\r\n                    e.diagram.model.setDataProperty(selnode.data, \"dimX\", node.data.dimX)\r\n                    e.diagram.model.setDataProperty(selnode.data, \"dimY\", node.data.dimY)\r\n                    e.diagram.model.setDataProperty(node.data, \"dimX\", selOrderX)\r\n                    e.diagram.model.setDataProperty(node.data, \"dimY\", selOrderY)\r\n                    e.diagram.model.commitTransaction(\"dimTextExchange\")\r\n                }\r\n\r\n\r\n                \r\n\r\n                if (selnode.data.category != \"wave\") {\r\n                    return;\r\n                }\r\n                if(node.data.role != \"centerText\"){\r\n                    return;\r\n                }\r\n                if(!node){\r\n                  // node.containingGroup.layout.isValidLayout = false\r\n                  return;\r\n                }\r\n                if(selnode.data.group != obj.data.group){\r\n                  return;\r\n                }\r\n                e.diagram.startTransaction(\"mouseDrop\")\r\n                selnode.__oldOrder = selnode.data.order\r\n                e.diagram.model.setDataProperty(selnode.data, \"order\",node.data.order+0.5)\r\n                var xuText = e.diagram.model.findNodeDataForKey(selnode.data.xuText)\r\n                var shiText = e.diagram.model.findNodeDataForKey(selnode.data.shiText)\r\n                e.diagram.model.setDataProperty(shiText, \"order\",node.data.order+0.5)\r\n                e.diagram.model.setDataProperty(xuText, \"order\",node.data.order+0.5)\r\n                // node.containingGroup.layout.isValidLayout = false\r\n                e.diagram.commitTransaction(\"mouseDrop\")\r\n              },\r\n              mouseDragEnter: function(e, obj) {\r\n                var node = obj.part;\r\n                var selnode = e.diagram.selection.first();\r\n                if(!selnode) return;\r\n                if(selnode.data.subRole == \"coreText\" && node.data.subRole == \"coreText\" || \r\n                selnode.data.subRole == \"yunpanText\" && node.data.subRole == \"yunpanText\"){\r\n                    selnode.areaBackground = null\r\n                    node.areaBackground = \"RGB(107,208,137)\"\r\n                }\r\n                if(selnode.data.subRole == \"dimText\" && node.data.subRole == \"dimText\"){\r\n                    selnode.areaBackground = null\r\n                    node.areaBackground = \"RGB(107,208,137)\"\r\n                }\r\n\r\n                if(node.data.role == \"centerText\"){\r\n                    node.layerName = \"Background\"\r\n                }\r\n                // if (!(selnode instanceof go.Node)  || selnode.data.role != \"freeText\"  || selnode.category != \"autoText\" ||selnode.data.subRole != \"coreText\") {\r\n                //     return;\r\n                // }\r\n\r\n\r\n\r\n                // //var sat = node.selectionAdornmentTemplate;\r\n                // //var adorn = sat.copy();\r\n                // //adorn.adornedObject = node;\r\n                // //node.addAdornment(\"dragEnter\", adorn);\r\n    \r\n                // //if (!mayWorkFor(selnode, node)) return;\r\n                // var shape = node.findObject(\"SHAPE\");\r\n                // if (shape) {\r\n                //     shape._prevFill = shape.fill; // remember the original brush\r\n                //     shape.fill = \"darkred\";\r\n                // }\r\n    \r\n            },\r\n            mouseDragLeave: function(e, obj) {\r\n                var node = obj.part;\r\n                var selnode = e.diagram.selection.first();\r\n                // var shape = node.findObject(\"SHAPE\");\r\n                if(selnode.data.subRole == \"coreText\" && node.data.subRole == \"coreText\"|| \r\n                selnode.data.subRole == \"yunpanText\" && node.data.subRole == \"yunpanText\"){\r\n                    node.areaBackground = null\r\n                }\r\n                if(selnode.data.subRole == \"dimText\" && node.data.subRole == \"dimText\"){\r\n                    node.areaBackground = null\r\n                }\r\n                if(node.data.role == \"centerText\"){\r\n                    node.layerName = \"Foreground\"\r\n                }\r\n                //node.removeAdornment(\"dragEnter\");\r\n            },\r\n              selectionChanged: (node)=>{\r\n                console.log(\"selectionChanged\",node)\r\n\r\n                if(node.data.category != \"autoText\" || node.data.orderX ==null \r\n                || node.data.orderY ==null || node.data.role != \"freeText\" || node.data.subRole !=\"coreText\"|| node.data.subRole !=\"yunpanText\"){\r\n                    return;\r\n                }\r\n\r\n                if( !node.containingGroup || node.containingGroup.data.category != \"yunGroup\" || node.containingGroup.data.category != \"yunpanGroup\"){\r\n                    return;\r\n                }\r\n\r\n                if(node.containingGroup.data.beginSpark != \"line\"){\r\n                    return;\r\n                }\r\n                if(node.containingGroup.__yunPointsX && node.containingGroup.__yunPointsY){\r\n                    var centerOrderX = (node.containingGroup.__yunPointsX.length+1)/2\r\n                    var centerOrderY = (node.containingGroup.__yunPointsY.length+1)/2\r\n                    if(node.data.orderX == centerOrderX && node.data.orderY == centerOrderY){\r\n                        // 中心文字不参与变色\r\n                        return;\r\n                    }\r\n                    var orderX = node.data.orderX, orderY=node.data.orderY\r\n                    if(orderX == centerOrderX){\r\n                        orderX = orderY\r\n                    }\r\n                    if(orderY == centerOrderY){\r\n                        orderY = orderX\r\n                    }\r\n                    var shapeStrokes = node.containingGroup.data.shapeStrokes\r\n                    var showShape = node.containingGroup.data.showShape; // 是否显示矩形\r\n                    if(node.isSelected){\r\n                        if(node.containingGroup.data.snapType == \"between\"){\r\n                            var diff = Math.max(Math.abs(node.data.orderX - centerOrderX), Math.abs(node.data.orderY - centerOrderY))+1\r\n                        }else{\r\n                            var diff = Math.max(Math.abs(node.data.orderX - centerOrderX), Math.abs(node.data.orderY - centerOrderY))\r\n                        }\r\n                        console.log(\"diff:\",diff,node.data.orderX,node.data.orderY)\r\n                        var it = node.containingGroup.findSubGraphParts().iterator;\r\n\r\n                        console.log(\"showShape\",showShape)\r\n                        // var beginSpark = node.containingGroup.data.beginSpark; // 是否显示矩形\r\n                        var shape = null;\r\n                        while (it.next()) {\r\n                            var n = it.value;\r\n                            if(n.data.category == \"autoText\" && n.data.orderX !=null \r\n                            && n.data.orderY !=null && n.data.role == \"freeText\" ){\r\n                                n.findObject(\"textBorder\").visible = false;\r\n                                // if((Math.abs(n.data.orderX-centerOrderX) == Math.abs(orderX-centerOrderX) \r\n                                //     || Math.abs(n.data.orderX-centerOrderY) == Math.abs(orderY-centerOrderY)) \r\n                                // && !(Math.abs(n.data.orderX-centerOrderY) < Math.abs(orderY-centerOrderY) \r\n                                //     && Math.abs(n.data.orderX-centerOrderX) < Math.abs(orderX-centerOrderX))){\r\n                                //     n.areaBackground = \"red\"\r\n                                // }\r\n\r\n                                if(Math.abs(n.data.orderX-centerOrderX) == Math.abs(orderX-centerOrderX)\r\n                                && Math.abs(n.data.orderY-centerOrderY) <= Math.abs(orderY-centerOrderY)\r\n                                ||Math.abs(n.data.orderX-centerOrderX) <= Math.abs(orderX-centerOrderX)\r\n                                && Math.abs(n.data.orderY-centerOrderY) == Math.abs(orderY-centerOrderY)){\r\n                                    // n.findObject(\"place\").visible = true;\r\n                                    n.areaBackground = \"white\"\r\n                                    n.zOrder = 999\r\n                                }\r\n\r\n                            }\r\n                            if(n.data.category == \"shape\" && n.data.role == \"background\"){\r\n                                var obj = n.findObject(\"SHAPE\")\r\n                                // console.log(\"dfsdfsdfsdf\", obj)\r\n                                if(n.data.gridWidth == diff*2){\r\n                                    shape = obj;\r\n                                    // if(showShape){\r\n                                        // n.visible = true\r\n                                    // }\r\n                                    if(!obj.__prestroke){\r\n                                        obj.__prestroke = obj.stroke\r\n                                        obj.stroke = \"rgba(255,0,0,0.5)\"\r\n                                    }\r\n                                }else{\r\n                                    if(obj.__prestroke){\r\n                                        obj.stroke = obj.__prestroke\r\n                                        delete obj.__prestroke\r\n                                    }\r\n                                }\r\n                            }\r\n\r\n                        }\r\n                        if(!shape){\r\n                            if(node.containingGroup.data.snapType == \"between\"){\r\n                                var gridWidth = diff*2;\r\n                            }else{\r\n                                var gridWidth = diff*2\r\n                            }\r\n                            console.log(\"addShape\")\r\n                            node.diagram.model.startTransaction(\"addShape\");\r\n                            var shapeData = {\"deletable\":true, \r\n                            \"role\":\"background\", \r\n                            \"category\":\"shape\", \r\n                            // \"loc\":\"-1532.0268216255727 9.121091688849674\", \r\n                            \"loc\":go.Point.stringify(new go.Point(node.containingGroup.__yunPointsX[centerOrderX-1],node.containingGroup.__yunPointsY[centerOrderY-1])), \r\n                            \"movable\":true, \r\n                            \"group\":-19, \r\n                            \"key\": helpers.guid(), \r\n                            \"orderX\":10, \r\n                            \"orderY\":10, \r\n                            \"gridWidth\":gridWidth, \r\n                            \"stroke\":shapeStrokes[diff-1],\r\n                             \"visible\":true, \"strokeDashArray\":\"[0,0]\", \"strokeWidth\":3,\r\n                            //   \"desiredSize\":\"1263 1263\"\r\n                            };\r\n                             node.diagram.model.addNodeData(shapeData)\r\n                            node.diagram.model.commitTransaction(\"addShape\");\r\n                            setTimeout(()=>{\r\n                                var nod = node.diagram.findNodeForKey(shapeData.key)\r\n                                console.log(\"add shape add shape\")\r\n                                if(nod){\r\n                                    // nod.visible = true\r\n                                    var obj = nod.findObject(\"SHAPE\")\r\n                                    if(!obj.__prestroke){\r\n                                        obj.__prestroke = obj.stroke\r\n                                        obj.stroke = \"rgba(255,0,0,0.5)\"\r\n                                    }\r\n                                }\r\n                            },100)\r\n                        }\r\n                    }else{\r\n                        var it = node.containingGroup.findSubGraphParts().iterator;\r\n                        while (it.next()) {\r\n                            var n = it.value;\r\n                            if(n.data.category == \"autoText\" && n.data.orderX !=null \r\n                            && n.data.orderY !=null && n.data.role == \"freeText\" ){\r\n                                // n.findObject(\"textBorder\").visible = false;\r\n                                // if((n.data.orderX == orderX || n.data.orderY == orderY) \r\n                                // && !(n.data.orderX < orderX && n.data.orderY <orderY )){\r\n                                //     n.areaBackground = \"red\"\r\n                                // }\r\n\r\n                                if(Math.abs(n.data.orderX-centerOrderX) == Math.abs(orderX-centerOrderX)\r\n                                && Math.abs(n.data.orderY-centerOrderY) <= Math.abs(orderY-centerOrderY)\r\n                                ||Math.abs(n.data.orderX-centerOrderX) <= Math.abs(orderX-centerOrderX)\r\n                                && Math.abs(n.data.orderY-centerOrderY) == Math.abs(orderY-centerOrderY)){\r\n                                    // n.findObject(\"textBorder\").visible = true;\r\n                                    // n.findObject(\"place\").visible = false;\r\n                                    n.areaBackground = null\r\n                                    n.zOrder = NaN\r\n                                }\r\n\r\n                            }\r\n                            if(n.data.category == \"shape\" && n.data.role == \"background\"){\r\n                                var obj = n.findObject(\"SHAPE\")\r\n                                // console.log(\"dfsdfsdfsdf\", obj)\r\n                                if(!showShape){\r\n                                    // n.visible = false\r\n                                    obj.stroke = \"rgba(255,0,0,0)\"\r\n                                }\r\n                                if(n.data.gridWidth == diff*2){\r\n                                    if(!obj.__prestroke){\r\n                                        obj.__prestroke = obj.stroke\r\n                                        obj.stroke = \"rgba(255,0,0,0.7)\"\r\n\r\n                                    }\r\n                                }else{\r\n                                    \r\n                                    if(obj.__prestroke){\r\n                                        obj.stroke = obj.__prestroke\r\n                                        delete obj.__prestroke\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n              },\r\n              click: (e, node)=>{\r\n                console.log(node.data)\r\n\r\n                // if(node.data.role == \"centerText\"){\r\n                //     var waveNode = node.diagram.findNodeForKey(node.data.olive)\r\n                //     node.layerName = \"Background\"\r\n                //     if(waveNode){\r\n                //         node.diagram.select(waveNode)\r\n                //     }\r\n                // }\r\n                // e.diagram.model.startTransaction(\"click\")\r\n                // e.diagram.model.setDataProperty(node.data, \"dimKey\", -124)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -73)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -141)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -74)\r\n\r\n\r\n\r\n\r\n                // e.diagram.model.setDataProperty(node.data, \"dimKey\", -124)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -141)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -158)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -176)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -73)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -74)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -175)\r\n                // e.diagram.model.setDataProperty(node.data,\"dimKey\", -177)\r\n                // node.data.dimKey = -124\r\n                // node.data.dimKey = -141\r\n                // node.data.dimKey = -158\r\n                // node.data.dimKey = -176\r\n                // node.data.dimKey = -73\r\n                // node.data.dimKey = -74\r\n                // node.data.dimKey = -175\r\n                // node.data.dimKey = -177\r\n                \r\n                // e.diagram.model.commitTransaction(\"click\")\r\n\r\n              },\r\n            //   rotateAdornmentTemplate:  // specify appearance of rotation handle\r\n            //   $(go.Adornment,\r\n            //     { locationSpot: go.Spot.Center },\r\n            //     $(go.Shape, \"BpmnActivityLoop\",\r\n            //       { width: 12, height: 12, cursor: \"pointer\",\r\n            //         background: \"transparent\", stroke: \"dodgerblue\", strokeWidth: 2 })\r\n            //     ),\r\n              mouseOver: function(e, node) {\r\n                // if(node.data.hyperlink){\r\n                //   var textObj = node.findObject('TEXT');\r\n                //   textObj.isUnderline = true;\r\n                // }\r\n                // console.log(\"mouseOvermouseOvermouseOver\")\r\n                if(node.data.showBorder){\r\n                    if(node.data.text == \"\" && (node.data.role == \"xuText\" || node.data.role == \"shiText\" )){\r\n                        node.findObject(\"textBorder\").visible = true;\r\n                    }\r\n                }\r\n                if(node.data.role == \"centerText\"){\r\n                    node.layerName = \"Background\"\r\n                    // node.diagram.model.startTransaction(\"centerText\")\r\n                    // node.diagram.model.setDataProperty(node.data,\"layerName\", \"Background\")\r\n                    // node.diagram.model.commitTransaction(\"centerText\")\r\n                }\r\n                //   node.areaBackground = \"mediumslateblue\"\r\n                // }\r\n\r\n                // if(!node.containingGroup) return;\r\n                // var it = node.containingGroup.findSubGraphParts().iterator;\r\n                // while (it.next()) {\r\n                //     var n = it.value;\r\n                //     if(n.data.category == \"autoText\"){\r\n                //         if(n.data.order == node.data.order){\r\n                //             // locateNode = n;\r\n                //             n.areaBackground = \"mediumslateblue\"\r\n                //         }\r\n                //     }\r\n                // }\r\n                // diagram.__trtd.showNodeRemarkTips(e, node);\r\n                },\r\n            mouseLeave: function(e, node) {\r\n            //   if(node.data.text == \"\"){\r\n                if(node.data.showBorder){\r\n                    // if(node.data.text == \"\"){\r\n                        node.findObject(\"textBorder\").visible = false;\r\n                    // }\r\n                }\r\n                if(node.data.role == \"centerText\"){\r\n                    node.layerName = \"Foreground\"\r\n                    // node.diagram.model.startTransaction(\"centerText\")\r\n                    // node.diagram.model.setDataProperty(node.data,\"layerName\", \"Foreground\")\r\n                    // node.diagram.model.commitTransaction(\"centerText\")\r\n                }\r\n                // node.areaBackground = null\r\n            //   }\r\n            },\r\n            //   layoutConditions: go.Part.LayoutStandard,\r\n              layoutConditions: go.Part.LayoutStandard & go.Part.LayoutRemoved & go.Part.LayoutAdded & ~go.Part.LayoutNodeSized,\r\n              //layoutConditions:~go.Part.LayoutAdded,\r\n              // fromLinkable: true, toLinkable: true,\r\n              alignment: go.Spot.Center,\r\n              alignmentFocus: go.Spot.Center,\r\n              contextMenu: $(go.Adornment),\r\n              resizeAdornmentTemplate:  // specify what resize handles there are and how they look\r\n              $(go.Adornment, \"Spot\",\r\n                $(go.Placeholder),  // takes size and position of adorned object\r\n            //     $(go.Shape, \"Circle\",  // left resize handle\r\n            //       { alignment: go.Spot.Left, cursor: \"col-resize\",\r\n            //         desiredSize: new go.Size(9, 9), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n            //     $(go.Shape, \"Circle\",  // right resize handle\r\n            //       { alignment: go.Spot.Right, cursor: \"col-resize\",\r\n            //         desiredSize: new go.Size(9, 9), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n            //   $(go.Shape, \"Circle\",  // right resize handle\r\n            //   { alignment: go.Spot.Top, cursor: \"col-resize\",\r\n            //   desiredSize: new go.Size(9, 9), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n              $(go.Shape, \"Circle\",  // right resize handle\r\n              { alignment: go.Spot.BottomRight, cursor: \"col-resize\",\r\n              desiredSize: new go.Size(15, 15), fill: \"lightblue\", stroke: \"dodgerblue\" }),\r\n                // $(go.TextBlock, // show the width as text\r\n                //   { alignment: go.Spot.Top, alignmentFocus: new go.Spot(0.5, 1, 0, -2),\r\n                //     stroke: \"dodgerblue\" },\r\n                //   new go.Binding(\"text\", \"adornedObject\",\r\n                //                  function(shp) { return shp.naturalBounds.width.toFixed(0); })\r\n                //       .ofObject())\r\n              ),\r\n              doubleClick: function (e, node){\r\n                  e.diagram.__trtd.selectText(e, node)\r\n              }\r\n\r\n              // selectionAdornmentTemplate: nodeSelectionAdornmentTemplate,\r\n          },\r\n          new go.Binding(\"locationSpot\", \"locationSpot\", function(v){\r\n              return go.Spot.parse(v)\r\n          }).makeTwoWay(function(v){\r\n              return go.Spot.stringify(v)\r\n          }),\r\n          new go.Binding(\"type\", \"type\", function(v){\r\n              return go.Panel[v]\r\n          }),\r\n          new go.Binding(\"visible\", \"visible\").makeTwoWay(),\r\n          new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n          new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n          new go.Binding(\"rotatable\", \"rotatable\").makeTwoWay(),\r\n          new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n          new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n          new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n          new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n          new go.Binding(\"copyable\", \"copyable\").makeTwoWay(),\r\n          new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n              return v ? v : \"\";\r\n          }),\r\n          $(go.Shape, {\r\n            strokeDashArray: null,\r\n            opacity:0.7,\r\n            stretch: go.GraphObject.UniformToFill,\r\n            // locationSpot: go.Spot.Center,  // the location is the center of the Shape\r\n            // strokeDashOffset:10,\r\n            name: \"SHAPE\",\r\n            figure: \"Circle\",\r\n            fill: \"rgba(0,255,0,1)\",\r\n            fromLinkable: false,\r\n            toLinkable: false,\r\n            width:100,\r\n            height:100,\r\n            cursor: \"pointer\",\r\n            minSize: new go.Size(50, 50),\r\n            // maxSize: new go.Size(100, 100),\r\n            strokeWidth: 1,\r\n            stroke: \"black\",\r\n            portId: \"\"\r\n\r\n        },\r\n        new go.Binding(\"strokeDashArray\", \"shiStrokeDashArray\", function(v) {\r\n            return JSON.parse(v)\r\n        }).makeTwoWay(function(v) {\r\n            return JSON.stringify(v)\r\n        }),\r\n        new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n            return v instanceof go.Brush ? v.color : v;\r\n        }).makeTwoWay(),\r\n        // new go.Binding(\"fill\", \"isSelected\", function(s, obj) { return s ? \"red\" : obj.part.data.color; }).ofObject()),\r\n        new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n            // console.log(\"vd m\", v, d )\r\n            // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n            return go.Size.parse(v)\r\n        }).makeTwoWay(function(v) {\r\n            console.log(\"sizesizesizesize\")\r\n            // var size = new go.Size(v.width, v.height)\r\n            return go.Size.stringify(v)\r\n        }),\r\n        new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n            return v instanceof go.Brush ? v.stroke : v;\r\n        }).makeTwoWay(),\r\n\r\n        new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n            return d;\r\n        }).makeTwoWay(function(d) {\r\n            return d;\r\n        }),\r\n        new go.Binding(\"figure\", \"figure\").makeTwoWay(), \r\n        new go.Binding(\"opacity\", \"opacity\").makeTwoWay(), \r\n        // {\r\n        //     figure: properties.figure,\r\n        //     fill: properties.fill,\r\n        //     strokeWidth: properties.strokeWidth,\r\n        //     stroke: properties.stroke\r\n        // }\r\n    ),\r\n    $(\r\n        go.Shape,\r\n        {\r\n          geometryString: \"M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z\",\r\n            // \"M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM16 29c-7.18 0-13-5.82-13-13s5.82-13 13-13 13 5.82 13 13-5.82 13-13 13zM12 8c-1.105 0-2 0.895-2 2s0.895 2 2 2h5.172l-8.586 8.586c-0.781 0.781-0.781 2.047 0 2.829 0.39 0.39 0.902 0.586 1.414 0.586s1.024-0.195 1.414-0.586l8.586-8.586v5.172c0 1.105 0.895 2 2 2s2-0.895 2-2v-12h-12z\",\r\n          visible: false,\r\n          name: \"figure\",\r\n          cursor: \"pointer\",\r\n          alignment: go.Spot.TopRight,\r\n          alignmentFocus: go.Spot.TopRight,\r\n          width: 14,\r\n          height: 14,\r\n          fill: \"green\",\r\n          toolTip: $(\r\n            \"ToolTip\",\r\n            $(\r\n              go.Panel,\r\n              \"Vertical\",\r\n              $(\r\n                go.Picture,\r\n                new go.Binding(\"source\", \"src\", function(s) {\r\n                  return \"images/\" + s + \".png\";\r\n                })\r\n              ),\r\n              $(go.TextBlock, {text:\"进入子盘\", margin: 3 })\r\n            )\r\n          ),\r\n          click: function(e) {\r\n            console.log(\"click figure\", e);\r\n            var node = e.targetObject.part;\r\n            e.diagram.__trtd.openFigure({\r\n              figure: node.data.figure,\r\n              title: node.data.text,\r\n              key: node.data.key,\r\n              node: node\r\n            });\r\n          }\r\n        },\r\n        // new go.Binding(\"geometry\", \"geo\", function(){\r\n\r\n        // })),\r\n        new go.Binding(\"visible\", \"figure\", function(v) {\r\n          console.log(\"----------------------\");\r\n          if (v) {\r\n            return true;\r\n          } else {\r\n            return false;\r\n          }\r\n        })\r\n      ),\r\n    // $(go.Shape, {\r\n    //         name: \"SHAPE_Back\",\r\n    //         figure: \"Rectangle\",\r\n    //         fill: \"rgba(128,128,128,0)\",\r\n    //         fromLinkable: true,\r\n    //         toLinkable: true,\r\n    //         strokeWidth: 0\r\n    //     },\r\n    //     new go.Binding(\"desiredSize\", \"width\", function(v) {\r\n    //         var va = (v / 2) * Math.sqrt(2);\r\n    //         return new go.Size(va - 3, va - 3);\r\n    //     }).ofObject(\"SHAPE\")\r\n    // ),\r\n          $(go.TextBlock, {\r\n                  name: \"TEXT\",\r\n                  alignment: new go.Spot(0.5, 0.5),\r\n                  font: \"18px 'Microsoft YaHei'\",\r\n                  editable: false,\r\n                //   areaBackground:\"gray\",\r\n                  //margin: 3, editable: true,\r\n                //   background:\"yellow\",\r\n                  stroke: \"black\",\r\n                  isMultiline: true,\r\n                  overflow: go.TextBlock.OverflowClip,\r\n                  wrap: go.TextBlock.WrapDesiredSize,\r\n                  textAlign: \"center\",\r\n                  verticalAlignment: go.Spot.Center,\r\n                  spacingAbove: 4,\r\n                  spacingBelow: 4,\r\n                  portId: \"TEXT\",\r\n                  margin:0,\r\n                  maxSize:new go.Size(600,NaN),\r\n                  minSize: new go.Size(10,10),\r\n                  stretch: go.GraphObject.UniformToFill,\r\n                  textEdited: function(textBlock,oldv,newv){\r\n\r\n                    // // if(textBlock.part.containingGroup.data.textAngle == \"horizontal\"){\r\n                    //   var centerText = textBlock.part.diagram.model.findNodeDataForKey(textBlock.part.data.centerText)\r\n                    //   if(centerText){\r\n                    //     console.log(\"centerTextcenterTextcenterTextcenterText\")\r\n                    var part = textBlock.part\r\n                    if(newv.trim() == \"\" &&(part.data.role == \"shiText\" || part.data.role == \"xuText\")){\r\n                        textBlock.part.diagram.model.startTransaction(\"text\")\r\n                        textBlock.part.diagram.model.setDataProperty(textBlock.part.data,\"nloc\", null)\r\n                        textBlock.part.diagram.model.commitTransaction(\"text\")\r\n                    }\r\n                    //   }\r\n                    // //   return;\r\n                    // // }\r\n                    // setTimeout(function(){\r\n                    //   console.log(\"textEditedtextEditedtextEdited\",textBlock.lineCount)\r\n                    //   if(!textBlock.text) return;\r\n                    //   if(textBlock.text && textBlock.text.trim() == \"\") return;\r\n                    //   if(textBlock.lineCount %2 != 0){\r\n                    //     if(newv[newv.length-1] == \"\\n\"){\r\n                    //       textBlock.text = newv.substring(0, newv.length-1)\r\n                    //       return;\r\n                    //     }\r\n                    //     textBlock.text = newv+\"\\n\"\r\n                    //   }\r\n                    // },100)\r\n                    \r\n                    // var enterCount = 0;\r\n                    if(textBlock.part.data.role && textBlock.part.data.role.indexOf(\"labelText\") > -1 ){\r\n                        textBlock.part.containingGroup.layout.isValidLayout = false\r\n                    }\r\n                    // for(var i=0;i<newv.length;i++){\r\n                      \r\n                    // }\r\n                    // textBlock.part.updateTargetBindings()\r\n    \r\n                    // if(textBlock.lineCount %2 != 0){\r\n                    //   if(newv[newv.length-1] == \"\\n\"){\r\n                    //     textBlock.text = newv.substring(0, newv.length-1)\r\n                    //     return;\r\n                    //   }\r\n                    //   textBlock.text = newv+\"\\n\"\r\n                    // }\r\n                  },\r\n              },\r\n              new go.Binding(\"background\", \"background\", function(v) {\r\n                  return v;\r\n              }).makeTwoWay(),\r\n              new go.Binding(\"areaBackground\", \"areaBackground\", function(v) {\r\n                  return v;\r\n              }).makeTwoWay(),\r\n              new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                  return v;\r\n              }).makeTwoWay(),\r\n              new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                  return helpers.tdTransToNum(v, 4);\r\n              }).makeTwoWay(),\r\n              new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                  return helpers.tdTransToNum(v, 4);\r\n              }).makeTwoWay(),\r\n              new go.Binding(\"maxSize\",\"\",function(data,d,m){\r\n                  // console.log(\"maxSize\",v,m,d)\r\n                  var width = NaN\r\n                  var height = NaN\r\n                  if(data.width){\r\n                      width = data.width\r\n                  }\r\n                  if(data.height){\r\n                      height = data.height\r\n                  }\r\n\r\n                  return new go.Size(width,height)\r\n              }),\r\n              new go.Binding(\"minSize\",\"minSize\",function(v){\r\n                  // console.log(\"maxSize\",v,m,d)\r\n\r\n                  return go.Size.parse(v)\r\n              }),\r\n              // new go.Binding(\"width\", \"width\", function(v) {\r\n              //     return v;\r\n              // }).makeTwoWay(),\r\n              // new go.Binding(\"height\", \"height\", function(v) {\r\n              //     return v;\r\n              // }).makeTwoWay(),\r\n              // new go.Binding(\"height\", \"height\", function (v) {\r\n              //   return v;\r\n              // }).ofObject(\"SHAPE\"),\r\n              new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n              new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n              new go.Binding(\"font\", \"font\").makeTwoWay()\r\n          ),\r\n        //   $(go.Panel,\"Vertical\",\r\n        //     {alignment: go.Spot.Left,\r\n        //     alignmentFocus: go.Spot.Right,\r\n        //     },\r\n        //     $(go.Shape,{\r\n        //         name:\"ICON\",\r\n        //         width:16,\r\n        //         height:16,\r\n        //         visible: false,\r\n        //         click: function(e){\r\n        //             console.log(\"icon click\")\r\n        //         },\r\n        //         figure:\"Circle\",\r\n        //         fill:\"red\",\r\n        //         strokeWidth:0,\r\n        //         margin: 3\r\n        //     },\r\n    \r\n        //     // new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        //     new go.Binding(\"figure\", \"figure\").makeTwoWay(),\r\n        //     new go.Binding(\"visible\", \"iconVisible\").makeTwoWay(),\r\n        //     new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n        //         return v\r\n        //     }).makeTwoWay()\r\n        //     )\r\n        // ),\r\n    //     $(go.Shape,\"Rectangle\",{\r\n    //         name: \"textBorder\",\r\n    //         stroke: \"green\",\r\n    //         strokeWidth: 3,\r\n    //         strokeDashArray: [10, 5],\r\n    //         visible:false,\r\n    //         fill:\"transparent\",\r\n    //         alignment: go.Spot.Center,\r\n    //         // alignmentFocus: go.Spot.Right,\r\n    //         width:100,\r\n    //         height:270, \r\n    //     },\r\n    //     new go.Binding(\"stroke\",\"textStroke\"),\r\n    //     new go.Binding(\"desiredSize\",\"\", function(v,d){\r\n    //         // console.log(\"vvvvvvvvvvvvv,\",v,d)\r\n    //         if(!helpers.checkPhone()){\r\n    //             // return new go.Size(Math.max(d.part.naturalBounds.width,100)-3, Math.max(d.part.naturalBounds.height,100)-3);\r\n    //             return new go.Size(d.part.naturalBounds.width-3, d.part.naturalBounds.height-3);\r\n    //         }\r\n    //         var olive = d.part.diagram.findNodeForKey(d.part.data.olive)\r\n    //         return new go.Size(olive.naturalBounds.width-3, olive.naturalBounds.height);\r\n    //         // return new go.Size(d.part.actualBounds.width-3, d.part.actualBounds.height-3);\r\n    //     })\r\n    // ),\r\n        // $(go.Shape,\"Circle\",{\r\n        //     name: \"place\",\r\n        //     stroke: \"red\",\r\n        //     strokeWidth: 1,\r\n        //     strokeDashArray: null,\r\n        //     visible:false,\r\n        //     fill:\"transparent\",\r\n        //     alignment: go.Spot.Center,\r\n        //     // alignmentFocus: go.Spot.Right,\r\n        //     width:50,\r\n        //     height:50, \r\n        // },\r\n        // new go.Binding(\"stroke\",\"placeStroke\"),\r\n        // )\r\n      )\r\n    }\r\n}\r\n\r\nmodule.exports = AutoTextTemplate\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/shapeTextNodeTemplate.js","/**\r\n * 天盘连接线的布局\r\n */\r\n'use strict';\r\n\r\n// import * as go from 'gojs';\r\n\r\n// let menus = require('../templates/menu');\r\nvar $ = go.GraphObject.make;\r\n\r\nfunction SmoothLink() {\r\n    go.Link.call(this);\r\n}\r\n\r\nfunction computeOffset(newR, newStartAngle) {\r\n    //console.log(\"newStartAngle:\"+newStartAngle);\r\n    var ctl2, dy, dx; //需要调整\r\n    if (newStartAngle >= 0 && newStartAngle <= 90) {\r\n        dy = newR * Math.sin(newStartAngle * Math.PI / 180);\r\n        dx = newR * Math.cos(newStartAngle * Math.PI / 180);\r\n        return [dx, dy];\r\n    } else if (newStartAngle > 90 && newStartAngle <= 180) {\r\n        dy = newR * Math.sin((180 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((180 - newStartAngle) * Math.PI / 180);\r\n        return [-dx, dy];\r\n    } else if (newStartAngle > 180 && newStartAngle <= 270) {\r\n        dy = newR * Math.sin((newStartAngle - 180) * Math.PI / 180);\r\n        dx = newR * Math.cos((newStartAngle - 180) * Math.PI / 180);\r\n        return [-dx, -dy];\r\n    } else if (newStartAngle > 270 && newStartAngle <= 360) {\r\n        dy = newR * Math.sin((360 - newStartAngle) * Math.PI / 180);\r\n        dx = newR * Math.cos((360 - newStartAngle) * Math.PI / 180);\r\n        return [dx, -dy];\r\n    }\r\n}\r\n\r\n// var tdCurrentTheme = menus.tdCurrentTheme;\r\n// 根据根节点与两个节点的位置计算出圆心在AB中垂线与 过根节点且平行于AB的射线的交点 D\r\nfunction computeNewCenter(O, A, B) {\r\n    var C = new go.Point((A.x + B.x) / 2, (A.y + B.y) / 2); //AB的中点\r\n    if (O.equals(A)) {\r\n        var locD = C.copy();\r\n        var r = Math.sqrt(C.distanceSquaredPoint(A));\r\n        var direction = (A.directionPoint(B) + 90) % 360;\r\n        var distance = r * 0.15;\r\n        var offset = computeOffset(distance, direction);\r\n        locD.offset(offset[0], offset[1]); //圆心坐标\r\n        r = Math.sqrt(locD.distanceSquaredPoint(A));\r\n        return [r, locD.x, locD.y];\r\n    }\r\n    var OC = Math.sqrt(O.distanceSquaredPoint(C));\r\n    var directionOC = O.directionPoint(C);\r\n    var directionFlagOD = O.distanceSquaredPoint(B) < O.distanceSquaredPoint(A);\r\n    if (directionFlagOD) {\r\n        var directionOD = B.directionPoint(A); //OD平行于AB\r\n    } else {\r\n        var directionOD = A.directionPoint(B); //OD平行于AB\r\n    }\r\n\r\n    var angleDOC = Math.abs(directionOC - directionOD);\r\n    if (angleDOC > 90 && angleDOC < 180) {\r\n        angleDOC = 180 - angleDOC;\r\n    } else if (angleDOC >= 180) {\r\n        angleDOC = 360 - angleDOC; //角doc是润角\r\n    }\r\n    // if(O.distanceSquaredPoint(B) > O.distanceSquaredPoint(A)){\r\n    //   directionOD = B.directionPoint(A);\r\n    // }\r\n    var OD = OC * Math.cos(angleDOC * Math.PI / 180);\r\n    var offset = computeOffset(OD, directionOD);\r\n    var locD = O.copy();\r\n    locD.offset(offset[0], offset[1]); //圆心坐标\r\n    var r = Math.sqrt(locD.distanceSquaredPoint(A));\r\n    return [r, locD.x, locD.y];\r\n    // return locD;\r\n}\r\n\r\ngo.Diagram.inherit(SmoothLink, go.Link);\r\n\r\nSmoothLink.prototype.makeGeometry = function() {\r\n    // get the Geometry created by the standard behavior\r\n    var geo = go.Link.prototype.makeGeometry.call(this);\r\n    if (geo.type !== go.Geometry.Path || geo.figures.length === 0) return geo;\r\n    return geo;\r\n};\r\n\r\n/** @override */\r\nSmoothLink.prototype.computePoints = function() {\r\n\r\n    var myDiagram = this.diagram;\r\n\r\n    var nodes = [];\r\n    if (this.fromNode == null || this.toNode == null) return true;\r\n    if (this.fromNode.location.equals(this.toNode.location)) {\r\n        return false;\r\n    }\r\n    var start = this.fromNode.location.copy();\r\n    var end = this.toNode.location.copy();\r\n\r\n    if (!start.isReal() || !end.isReal()) {\r\n        return true;\r\n    }\r\n    var A = start;\r\n    var B = end;\r\n    var O = myDiagram.findNodeForKey(this.toNode.data.parent);\r\n    if (!O) return true;\r\n    O = O.location;\r\n    var cent = computeNewCenter(O, A, B);\r\n\r\n\r\n\r\n    var centInfo = cent;\r\n    var centorPoint = new go.Point(centInfo[1], centInfo[2]);\r\n\r\n    this.micenter = centorPoint;\r\n    var rcenter = centInfo[0];\r\n    var rstart = this.fromNode.actualBounds.width / 2;\r\n    var rend = this.toNode.actualBounds.width / 2;\r\n    var center2mid = (2 * rcenter * rcenter - rstart * rstart) / (2 * rcenter); //大圆到大圆与开始节点交点中点的距离，然后求出夹角\r\n    var af = Math.acos(center2mid / rcenter) * 180 / Math.PI;\r\n\r\n    var geo = new go.Geometry(go.Geometry.Line);\r\n    geo.startX = centorPoint.x;\r\n    geo.startY = centorPoint.y;\r\n    geo.endX = this.fromNode.location.x;\r\n    geo.endY = this.fromNode.location.y;\r\n    if(!af){\r\n        af = 0;\r\n    }\r\n    geo.rotate(af, centorPoint.x, centorPoint.y); //相对圆心旋转，顺时针\r\n    var start2 = new go.Point(geo.endX, geo.endY);\r\n    // var start2 = new go.Point(this.fromNode.location.x, this.fromNode.location.y);\r\n\r\n    center2mid = (2 * rcenter * rcenter - rend * rend) / (2 * rcenter); //大圆到大圆与开始节点交点中点的距离，然后求出夹角\r\n    af = Math.acos(center2mid / rcenter) * 180 / Math.PI;\r\n    geo.endX = this.toNode.location.x;\r\n    geo.endY = this.toNode.location.y;\r\n    if(!af){\r\n        af = 0;\r\n    }\r\n    geo.rotate(-af, centorPoint.x, centorPoint.y); //相对圆心旋转,逆时针\r\n    var end2 = new go.Point(geo.endX, geo.endY);\r\n\r\n    //console.log(Math.abs(centorPoint.directionPoint(start2) - centorPoint.directionPoint(end2)));\r\n    //var result = computeControlPoint(start,midPoint,end,centInfo);\r\n    var result = computeControlPoint(start2, null, end2, centInfo);\r\n\r\n    var ctl1 = result[0];\r\n    var ctl2 = result[1];\r\n\r\n    this.clearPoints();\r\n    if (isNaN(start2.x) || isNaN(start2.y)) {\r\n        start2 = this.fromNode.location.copy();\r\n    }\r\n    if (isNaN(end2.x) || isNaN(end2.y)) {\r\n        end2 = this.toNode.location.copy();\r\n    }\r\n    //start1.rotate();\r\n    this.points.add(start2);\r\n    this.points.add(result[0]);\r\n    this.points.add(result[1]);\r\n    this.points.add(end2);\r\n\r\n    var oust = \"\";\r\n    return true;\r\n};\r\n\r\n\r\nfunction computeControlPoint(p1, p2, p3) {\r\n\r\n    var result;\r\n    result = arguments[3] ? arguments[3] : triangleCircle(p1, p2, p3);\r\n    var radius = result[0];\r\n    var cent = new go.Point(result[1], result[2]);\r\n\r\n    //起始节点的弧度\r\n    var sweep = Math.abs(cent.directionPoint(p1) - cent.directionPoint(p3));\r\n    sweep = sweep > 180 ? 360 - sweep : sweep;\r\n    //console.log(\"sweep:\"+sweep);\r\n    var newR = radius / Math.cos(sweep / 3 * Math.PI / 180);\r\n    var geo = new go.Geometry(go.Geometry.Line);\r\n    geo.startX = cent.x;\r\n    geo.startY = cent.y;\r\n    geo.endX = p1.x;\r\n    geo.endY = p1.y;\r\n    geo.rotate(sweep / 3, cent.x, cent.y); //相对圆心旋转3分之1弧度\r\n    var newStartAngle = cent.direction(geo.endX, geo.endY);\r\n    var ctl1;\r\n    result = computeOffset(newR, newStartAngle);\r\n    ctl1 = cent.copy().offset(result[0], result[1]);\r\n\r\n    geo.rotate(sweep / 3, cent.x, cent.y); //相对圆心旋转3分之1弧度\r\n    newStartAngle = cent.direction(geo.endX, geo.endY);\r\n\r\n    var ctl2; //需要调整\r\n    result = computeOffset(newR, newStartAngle);\r\n    ctl2 = cent.copy().offset(result[0], result[1]);\r\n\r\n    return [ctl1, ctl2];\r\n}\r\n\r\n\r\nfunction createTianpanLink(diagram) {\r\n    return $(SmoothLink, {\r\n            curve: go.Link.Bezier,\r\n            layerName: \"\",\r\n            isTreeLink: true,\r\n            //curve: go.Link.Bezier,\r\n            curviness: 30,\r\n            //smoothness:1,\r\n            adjusting: go.Link.Stretch,\r\n            relinkableFrom: true,\r\n            relinkableTo: true,\r\n            reshapable: true,\r\n            layoutConditions: go.Part.LayoutStandard & ~go.Part.LayoutNodeSized,\r\n            mouseDragEnter: function(e, obj) {\r\n                var link = obj.part;\r\n                var shape = link.findObject(\"SHAPE\");\r\n                shape._preStoke = shape.stroke;\r\n                shape.stroke = \"darkred\";\r\n                shape._preStrokeWidth = shape.strokeWidth;\r\n                shape.strokeWidth = 5;\r\n            },\r\n            mouseDragLeave: function(e, obj) {\r\n                var link = obj.part;\r\n                var shape = link.findObject(\"SHAPE\");\r\n                shape.stroke = shape._preStoke;\r\n                shape.strokeWidth = shape._preStrokeWidth;\r\n            },\r\n            mouseDrop: function(e, obj) {\r\n                var link = obj.part;\r\n                var draggedNode = e.diagram.selection.first();\r\n                if (!draggedNode instanceof go.Node) {\r\n                    return;\r\n                }\r\n                if (!draggedNode instanceof go.Group) {\r\n                    return;\r\n                }\r\n                if (draggedNode.data.key == 1) {\r\n                    return;\r\n                }\r\n                var fromNode = link.fromNode,\r\n                    toNode = link.toNode;\r\n                //disconnectFromTreeStructure(draggedNode);\r\n                if (toNode.data.parent == fromNode.data.key) {\r\n                    e.diagram.__trtd.setNodeAsChildren(draggedNode, fromNode);\r\n                } else {\r\n                    e.diagram.__trtd.setNodeAsSibling(draggedNode, fromNode);\r\n                }\r\n            }\r\n        }, // negate curviness if not clockwise\r\n        $(go.Shape, {\r\n                name: \"SHAPE\",\r\n                stroke: \"#767678\",\r\n                strokeWidth: 3\r\n            },\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"color\").makeTwoWay(),\r\n            new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n                try {\r\n                    var val = [parseInt(v.split(\" \")[0]), parseInt(v.split(\" \")[1])];\r\n                } catch (e) {\r\n                    var val = null;\r\n                }\r\n                return val;\r\n            }).makeTwoWay(function(v) {\r\n                return v[0] + \" \" + v[1];\r\n            }) //保留，设置边线样式\r\n\r\n        ),\r\n        $(go.Shape, {\r\n                name: \"Arrow\",\r\n                toArrow: \"Triangle\",\r\n                stroke: \"#767678\",\r\n                strokeWidth: 3\r\n            },\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\"),\r\n            new go.Binding(\"fill\", \"color\"),\r\n            new go.Binding(\"stroke\", \"color\"),\r\n            new go.Binding(\"toArrow\", \"toArrow\")\r\n        ),\r\n        new go.Binding(\"curviness\", \"curviness\").makeTwoWay(),\r\n        new go.Binding(\"points\").makeTwoWay()\r\n\r\n    );\r\n}\r\n\r\n\r\nmodule.exports = createTianpanLink\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/linkTemplate/createTianpanLink.js","// require('./core/core.controller')(Trtd);\r\n// import * as go from 'gojs';\r\nvar helpers = require('../helpers/helpers.gojs')\r\nlet lang = require('../assets/localization');\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\n// var createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar TRTD_BASE = require('./trtd').Trtd\r\n\r\nvar $ = go.GraphObject.make;\r\n\r\nclass Trtd extends TRTD_BASE {\r\n\tconstructor(div, config){\r\n       \r\n        super(div, config)\r\n\t\tthis.config = config;\r\n\t\tthis.modelChangedListener = config.modelChangedListener;\r\n\t\tthis.type = config.type;\r\n\t\tthis.diagram = {};\r\n        this.model = config.model;\r\n        // this.tpid = config.tpid;\r\n        this.readOnly = false;// 控制是否只读\r\n        if(config.readOnly != null){\r\n            this.readOnly = config.readOnly\r\n        }\r\n        this.initDiagramBase(div, config); // 基类初始化diagram\r\n\t\t// 初始化diagram\r\n        this.diagram = this.initDiagram(div, config);\r\n        // this.diagram.__trtd = this;\r\n\t\tthis.initListener();\r\n\t\t// Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        if(this.model){\r\n            this.initModel();\r\n        }\r\n\t}\r\n/**\r\n * method 初始化diagram\r\n * @param {*} div \r\n * @param {*} config \r\n */\r\n\tinitDiagram(div, config){\r\n        var myDiagram = this.diagram;\r\n        \r\n        var defaultConfig = {\r\n            // initialAutoScale: go.Diagram.Uniform,\r\n            // initialContentAlignment: go.Spot.Center,\r\n            // initialDocumentSpot: go.Spot.Center,\r\n            // initialViewportSpot: go.Spot.Center,\r\n            \"undoManager.isEnabled\": true,\r\n            // \"toolManager.hoverDelay\": 100,\r\n            // \"toolManager.mouseWheelBehavior\": go.ToolManager.WheelZoom,\r\n            // maxScale: 5.0,\r\n            // minScale: 0.05,\r\n            allowMove: true,\r\n            // allowDrop: true,\r\n            // hasVerticalScrollbar: false,\r\n            // hasHorizontalScrollbar: false,\r\n            // \"draggingTool.isCopyEnabled\": false,\r\n            // BackgroundSingleClicked: function(e) {\r\n            // \tcloseToolbarWindow();\r\n            // },\r\n            \"animationManager.isEnabled\": false,\r\n            // scrollMode: go.Diagram.InfiniteScroll,\r\n            // validCycle: go.Diagram.CycleDestinationTree,\r\n            // scrollMargin: 50,\r\n            // \"ModelChanged\": function(e){\r\n            //     that.saveModel(e)\r\n            // },\r\n            // \"TextEdited\": onTextChanged,\r\n        };\r\n        var diagramConfig = Object.assign(defaultConfig, config.diagramConfig);\r\n        this.diagram.setProperties(diagramConfig);\r\n       \r\n        \r\n        this.addNodeTemplate();\r\n        // this.customMenu();\r\n        // this.addDiagramContextMenu();\r\n        // this.addLinkTemplate();\r\n        // this.addGroupTemplate();\r\n        return myDiagram\r\n    }\r\n    getTdData(){\r\n        return this.diagram.model.toJson()\r\n    }\r\n    // 以下两个方法控制菜单显示\r\n    getDefaultCustomMenuDivStr(){\r\n        return `\r\n        <ul>\r\n            <li trtd_action=\"addFollowerGround\"><a class=\"i18n\" data-lang=\"insertsl\">增加同级节点</a></li>\r\n            <li trtd_action=\"addNewCircle\"><a class=\"i18n\" data-lang=\"icn\">增加子节点</a></li>\r\n            <li trtd_action=\"apiDeleteSelection\"><a class=\"i18n\" data-lang=\"remove\">删除</a></li>\r\n        </ul>\r\n        `\r\n    }\r\n    getShowContextMenus(node){\r\n        if(node){\r\n            return \"addFollowerGround,\" + \"addNewCircle,\"+\"apiDeleteSelection\";\r\n        }else{\r\n            return \"none\"\r\n        }\r\n    }\r\n\r\n    addTextNode(message){\r\n        console.log('eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee:');\r\n        var myDiagram = this.diagram;\r\n        myDiagram.startTransaction();\r\n        var text = { text: message||lang.trans('blankText'), category: 'text' };\r\n        text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n        myDiagram.model.addNodeData(text);\r\n        myDiagram.commitTransaction()\r\n    }\r\n\r\n\r\n    /**\r\n     * method 初始化model\r\n     */\r\n\tinitModel(model){\r\n        if(model){\r\n            this.model = model;\r\n        }\r\n        console.log('initModel')\r\n        var tmpModel = go.Model.fromJson(this.model);\r\n        if(tmpModel.modelData.currentType == 'dipan'){\r\n            tmpModel.nodeDataArray = tmpModel.nodeDataArray.filter((d)=>{\r\n                if(!d.isGroup){\r\n                    delete d.group\r\n                    return true;\r\n                }\r\n            })\r\n            // tmpModel.nodeDataArray = \r\n            tmpModel.linkDataArray=[]\r\n        }\r\n\r\n        this.diagram.layout.isInitial = false;\r\n        //randomUrl(tmpModel);\r\n        tmpModel.modelData.type = this.type\r\n        // tmpModel.modelData.version = Trtd.version\r\n        this.diagram.model = tmpModel;\r\n        // configModel(myDiagram.model);\r\n        this.groundLayout(this.diagram);\r\n        this.diagram.updateAllTargetBindings();\r\n    }\r\n    loadModel(model){\r\n       \r\n        this.initModel(model)\r\n    }\r\n    /**\r\n     * method: 初始化监听方法\r\n     */\r\n\tinitListener(){\r\n\t\tconsole.log('initListener')\r\n    }\r\n    /**\r\n     * 添加节点模板\r\n     */\r\n\r\n   \r\n    addNodeTemplate(){\r\n\r\n        var that = this;\r\n        var myDiagram = this.diagram\r\n      \r\n        var globalProperties = this.tdGetModelData(null, myDiagram.model,myDiagram); //获取所有全局属性到一个对象中,从localstorage中\r\n        //var layerThickness = myDiagram.model.modelData.layerThickness;\r\n        var layerThickness = parseInt(globalProperties['layerThickness']);\r\n        console.log(layerThickness)\r\n        \r\n        var tdDipanTextAngle = globalProperties['tdDipanTextAngle'];\r\n        console.log(tdDipanTextAngle)\r\n        myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\r\n        myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        // myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", this.createTextNodeTemplate());\r\n        \r\n    }\r\n\r\n    \r\n    createTextNodeTemplate () {\r\n    var properties = {\r\n        figure: \"Rectangle\",\r\n        fill: \"rgba(0,0,0,0)\",\r\n        strokeWidth: 1,\r\n        stroke: \"rgba(0,0,0,0)\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Spot\", {\r\n            \"_controlExpand\": true,\r\n            layerName: \"Foreground\",\r\n            locationSpot: go.Spot.Center,\r\n            resizeCellSize: new go.Size(10, 10),\r\n            locationObjectName: \"SHAPE\",\r\n            resizable: true,\r\n            resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n            rotatable: true,\r\n            location: new go.Point(0, 0),\r\n            //rotateObjectName: \"SHAPE\",  // rotate the Shape without rotating the label\r\n            // doubleClick: selectText,\r\n            toMaxLinks: 1,\r\n            layoutConditions: go.Part.LayoutStandard,\r\n            //layoutConditions:~go.Part.LayoutAdded,\r\n            // fromLinkable: true, toLinkable: true,\r\n            alignment: go.Spot.Center,\r\n            alignmentFocus: go.Spot.Center,\r\n            contextMenu: this.getNodeContextMenu\r\n            // selectionAdornmentTemplate: nodeSelectionAdornmentTemplate,\r\n        },\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        $(go.Shape, {\r\n                strokeDashArray: null,\r\n                // strokeDashOffset:10,\r\n                name: \"SHAPE\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                fromLinkable: true,\r\n                toLinkable: true,\r\n                cursor: \"pointer\",\r\n                minSize: new go.Size(50, 50),\r\n                strokeWidth: 2,\r\n                stroke: \"rgba(0,0,0,0)\",\r\n                portId: \"\",\r\n                width:150\r\n            },\r\n            new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n                return [v.split()[0], v.split()[1]];\r\n            }).makeTwoWay(function(v) {\r\n                return v[0] + \" \" + v[1];\r\n            }), //保留，设置边线样式\r\n            new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n                return v instanceof go.Brush ? v.color : v;\r\n            }).makeTwoWay(),\r\n            // new go.Binding(\"fill\", \"isSelected\", function(s, obj) { return s ? \"red\" : obj.part.data.color; }).ofObject()),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                return d;\r\n            }).makeTwoWay(function(d) {\r\n                return d;\r\n            }),\r\n            new go.Binding(\"figure\", \"figure\").makeTwoWay(), {\r\n                figure: properties.figure,\r\n                fill: properties.fill,\r\n                strokeWidth: properties.strokeWidth,\r\n                stroke: properties.stroke\r\n            }\r\n        ),\r\n        $(go.Shape, {\r\n                name: \"SHAPE_Back\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                // fromLinkable: true,\r\n                // toLinkable: true,\r\n                strokeWidth: 0\r\n            },\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\")\r\n        ),\r\n        $(go.TextBlock, {\r\n                name: \"TEXT\",\r\n                alignment: new go.Spot(0.5, 0.5),\r\n                font: \"bold \" + 22 + \"px 幼圆\",\r\n                editable: true,\r\n                //margin: 3, editable: true,\r\n                stroke: \"black\",\r\n                isMultiline: true,\r\n                overflow: go.TextBlock.OverflowClip,\r\n                wrap: go.TextBlock.WrapDesiredSize,\r\n                textAlign: \"center\",\r\n                spacingAbove: 4,\r\n                spacingBelow: 4,\r\n                portId: \"TEXT\",\r\n                stretch: go.GraphObject.Fill\r\n            },\r\n            new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            // new go.Binding(\"height\", \"height\", function (v) {\r\n            //   return v;\r\n            // }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n            new go.Binding(\"font\", \"font\").makeTwoWay()\r\n        )\r\n    );\r\n}\r\n\r\n    /**\r\n     * method 地盘模板\r\n     * @param {*} layerThickness \r\n     * @param {*} tdDipanTextAngle \r\n     */\r\n    createDipanTemplate (layerThickness, tdDipanTextAngle) {\r\n        console.log(layerThickness)\r\n        if (layerThickness == null) {\r\n            var layerThickness = 100;\r\n        }\r\n\r\n        if (tdDipanTextAngle == null) {\r\n            var tdDipanTextAngle = \"zhengli\";\r\n        }\r\n        var that = this;\r\n        var $ = go.GraphObject.make;\r\n        return $(go.Node, \"Spot\", {\r\n                locationSpot: go.Spot.Center, // Node.location is the center of the TextBlock\r\n                locationObjectName: \"MAIN\",\r\n                selectionObjectName: \"SHAPE\",\r\n                click: function(e, node) {\r\n                    console.log(node.data)\r\n                    if(that.readOnly){\r\n                        if(node.diagram.__trtd.nodeClickListener){\r\n                            node.diagram.__trtd.nodeClickListener(node);\r\n                        }\r\n                    }\r\n                \r\n                },\r\n                contextMenu: this.getNodeContextMenu,\r\n                movable: false,\r\n                doubleClick: function(e){\r\n                    console.log(\"that.readOnlythat.readOnly\",that.readOnly)\r\n                    if(that.readOnly){\r\n                        return;\r\n                    }\r\n\r\n                    var myDiagram = e.diagram;\r\n                    var node = myDiagram.selection.first();\r\n                    // if(node.data.istemp) return;\r\n                    if (!node) return;\r\n                    // removeNodeRemarkTips();\r\n                    var tb = myDiagram.selection.first().findObject('TEXT');\r\n                    if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n                    helpers.simulateEnterWithAlt(e);\r\n                    changeTemp2normal(myDiagram)\r\n                },\r\n                selectionAdorned:!that.readOnly,\r\n                selectionAdornmentTemplate: \r\n                     $(go.Adornment, \"Spot\",\r\n                        $(go.Panel, \"Auto\",\r\n                            $(go.Shape, { fill: 'rgba(255,232,211,0.1)', stroke: \"blue\", strokeWidth: 2 }),\r\n                            $(go.Placeholder) // this represents the selected Node\r\n                        ),\r\n                        // the button to create a \"next\" node, at the top-right corner\r\n                        $(\"Button\", {\r\n                                alignment: go.Spot.RightCenter,\r\n                                alignmentFocus: go.Spot.Bottom,\r\n                                width: 30,\r\n                                height: 30,\r\n                \r\n                                click: (e) => {\r\n                                    console.log(e.diagram.selection.first().data)\r\n                                    console.log(e.diagram.selection.first().data.parent)\r\n                                    var node = e.diagram.selection.first();\r\n                                    if(node.data.parent){\r\n                                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                                        if(parentNode.data.istemp){\r\n                                            return\r\n                                        }\r\n                                    }\r\n                                    that.addNewCircle(e) // this function is defined below\r\n                                } \r\n                                \r\n                            },\r\n                            $(go.Shape, \"PlusLine\", { desiredSize: new go.Size(15, 15) })\r\n                        ),\r\n                        // end button\r\n                        $(\"Button\", {\r\n                                alignment: go.Spot.BottomCenter,\r\n                                width: 30,\r\n                                height: 30,\r\n                                //visible:function(d){\r\n                                //    return !isUndefined(d.istemp)&&d.istemp?false:true;\r\n                                //},\r\n                                click: function(e) {\r\n                                    console.log(e)\r\n                                    console.log(e.diagram.selection.first().data)\r\n                                    //判断临时节点\r\n                                    if(e.diagram.selection.first().data.istemp){\r\n                                        return\r\n                                    }\r\n                                    \r\n                                    that.addFollowerGround(e);\r\n                                    } // this function is defined below\r\n                                    \r\n                            },\r\n                            $(go.Shape, \"PlusLine\", { desiredSize: new go.Size(15, 15) })\r\n                        ) \r\n                        //备注\r\n                    ),\r\n                mouseOver: function(e, node) {\r\n                },\r\n                mouseLeave: function(e, node) {\r\n                    //removeNodeRemarkTips();\r\n                },\r\n                mouseDragEnter: function(e, node, prev) {\r\n                    return;\r\n                },\r\n                mouseDragLeave: function(e, node, next) {\r\n                    return;\r\n                },\r\n                mouseDrop: function(e, node) {\r\n                    return;\r\n                }\r\n            },\r\n            new go.Binding(\"angle\", \"dangle\"),\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            new go.Binding(\"selectionAdorned\", \"selectionAdorned\", function(v, d) {\r\n                console.log(v)\r\n                return v ? v : \"\";\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            $(go.Shape, {\r\n                    figure: \"Rectangle\",\r\n                    name: \"MAIN\",\r\n                    fill: \"rgba(255,255,0,0)\", // default value, but also data-bound\r\n                    strokeWidth: 0,\r\n                    stroke: \"red\",\r\n                    height: 1\r\n                },\r\n                new go.Binding('width', 'layerThickness', function(data) {\r\n                    return parseInt(data || 100);\r\n                })\r\n            ),\r\n            $(go.Shape, {\r\n                    name: \"SHAPE\",\r\n                    fill: \"lightgray\", // default value, but also data-bound\r\n                    strokeWidth: 2,\r\n                    margin: 5,\r\n                    stroke: \"green\",\r\n                    alignment: go.Spot.Right,\r\n                    alignmentFocus: go.Spot.Right,\r\n                    portId: \"\" // so links will go to the shape, not the whole node\r\n                },\r\n                new go.Binding(\"geometry\", \"\", function(data) {\r\n                return makeAnnularWedge(data);\r\n                }),\r\n                new go.Binding(\"fill\", \"fill\", function(v) {\r\n                    return v instanceof go.Brush ? v.color : v;\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                    return v instanceof go.Brush ? v.stroke : v;\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                    return d;\r\n                }).makeTwoWay(function(d) {\r\n                    return d;\r\n                })\r\n            ),\r\n            $(go.Shape, {\r\n                    figure: \"Rectangle\",\r\n                    name: \"LOCATE\",\r\n                    fill: \"rgba(0,255,0,0)\", // default value, but also data-bound\r\n                    strokeWidth: 0,\r\n                    stroke: \"green\",\r\n                    height: 20,\r\n                    alignment: go.Spot.Right,\r\n                    alignmentFocus: go.Spot.Right\r\n                },\r\n                new go.Binding('width', 'layerThickness', function(data) {\r\n                    return parseInt(data || 100);\r\n                })\r\n            ),\r\n            $(go.TextBlock, {\r\n                    name: \"TEXT\",\r\n                    isMultiline: true,\r\n                    click: function(e, node) {\r\n                \r\n                    },\r\n                    textAlign: \"center\",\r\n                    editable: false,\r\n                    wrap: go.TextBlock.WrapDesiredSize,\r\n                    overflow: go.TextBlock.OverflowClip,\r\n                    spacingAbove: 4,\r\n                    spacingBelow: 4,\r\n                    font: \"bold 15px 幼圆\"\r\n                },\r\n                new go.Binding(\"text\").makeTwoWay(),\r\n                new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                    return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                    return helpers.tdTransToNum(v, 4);\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                    return helpers.tdTransToNum(v, 4);\r\n                }).makeTwoWay(),\r\n                new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n                new go.Binding(\"font\", \"font\").makeTwoWay(),\r\n                new go.Binding(\"width\", \"\", function(data, obj) {\r\n                    var tdDipanTextAngle = data.tdDipanTextAngle || 'xuanzhuan';\r\n                    var layerThickness = parseInt(data.layerThickness || 100);\r\n                    var maxWidth = data.sweep / 180 * data.dradius * Math.PI * 0.7;\r\n                    if (tdDipanTextAngle == 'fangshe') {\r\n                        return maxWidth;\r\n                    }\r\n                    if (tdDipanTextAngle == 'zhengli') {\r\n                        return layerThickness * 0.7;\r\n                    }\r\n                    if (tdDipanTextAngle == 'xuanzhuan') {\r\n                        return layerThickness * 0.7;\r\n                    }\r\n                }),\r\n\r\n                new go.Binding(\"angle\", \"textAngle\").makeTwoWay(),\r\n                new go.Binding('alignment', 'tdDipanTextAngle', function(data) {\r\n                    var tdDipanTextAngle = data || 'xuanzhuan';\r\n                    var alignment = go.Spot.Center;\r\n                    switch (tdDipanTextAngle) {\r\n                        case 'xuanzhuan':\r\n                            alignment = go.Spot.Center;\r\n                            break;\r\n                        case 'fangshe':\r\n                            alignment = go.Spot.Left;\r\n                            break;\r\n                        case 'zhengli':\r\n                            alignment = go.Spot.Center;\r\n                            break;\r\n                    }\r\n                    return alignment;\r\n                }),\r\n                new go.Binding('alignmentFocus', 'tdDipanTextAngle', function(data) {\r\n                    var tdDipanTextAngle = data || 'xuanzhuan';\r\n                    var alignmentFocus = go.Spot.Center;\r\n                    switch (tdDipanTextAngle) {\r\n                        case 'xuanzhuan':\r\n                            alignmentFocus = go.Spot.Center;\r\n                            break;\r\n                        case 'fangshe':\r\n                            alignmentFocus = go.Spot.Left;\r\n                            break;\r\n                        case 'zhengli':\r\n                            alignmentFocus = go.Spot.Center;\r\n                            break;\r\n                    }\r\n                    return alignmentFocus;\r\n                })\r\n            \r\n            )\r\n        );\r\n\r\n\r\n \r\n    }\r\n\r\n    getDipanRootTemplate(layerThickness){\r\n        var that = this;\r\n        return $(go.Node, \"Auto\", {\r\n            locationSpot: go.Spot.Center,\r\n            selectionAdorned: true,\r\n            movable: false,\r\n            \r\n            click: function(e, node) {\r\n                //showNodeToolBar(e, node);\r\n                //showTempToolBar(e, node);\r\n                console.log(node.data)\r\n                if(that.readOnly){\r\n                    if(node.diagram.__trtd.nodeClickListener){\r\n                        node.diagram.__trtd.nodeClickListener(node);\r\n                    }\r\n                }\r\n                \r\n            },\r\n            doubleClick: function(e){\r\n                if(that.readOnly){\r\n                    return;\r\n                }\r\n                var myDiagram = e.diagram;\r\n                var node = myDiagram.selection.first();\r\n                if (!node) return;\r\n                // removeNodeRemarkTips();\r\n                var tb = myDiagram.selection.first().findObject('TEXT');\r\n                if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n                helpers.simulateEnterWithAlt(e);\r\n            },\r\n         \r\n            mouseOver: function(e, node) {\r\n                //showNodeRemarkTips(e, node);\r\n             \r\n            },\r\n            mouseLeave: function(e, node) {\r\n                //removeNodeRemarkTips();\r\n                //removeNodeToolBar();\r\n            },\r\n            selectionAdorned:!that.readOnly,\r\n            selectionAdornmentTemplate: $(go.Adornment, \"Spot\",\r\n                        $(go.Panel, \"Auto\",\r\n                            $(go.Shape, { fill: 'rgba(255,232,211,0.1)', stroke: \"blue\", strokeWidth: 2 }),\r\n                            $(go.Placeholder) // this represents the selected Node\r\n                        ),\r\n                        // the button to create a \"next\" node, at the top-right corner\r\n                        $(\"Button\", {\r\n                                alignment: go.Spot.RightCenter,\r\n                                alignmentFocus: go.Spot.Bottom,\r\n                                width: 30,\r\n                                height: 30,\r\n                \r\n                                click: (e) => {\r\n                                    console.log(e.diagram.selection.first().data)\r\n                                    console.log(e.diagram.selection.first().data.parent)\r\n                                    var node = e.diagram.selection.first();\r\n                                    if(node.data.parent){\r\n                                        var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n                                        if(parentNode.data.istemp){\r\n                                            return\r\n                                        }\r\n                                    }\r\n                                    this.addNewCircle(e) // this function is defined below\r\n                                } \r\n                                \r\n                            },\r\n                            $(go.Shape, \"PlusLine\", { desiredSize: new go.Size(15, 15) })\r\n                        ),\r\n                        //备注\r\n                \r\n                    ),\r\n            // contextMenu: $(go.Adornment, \"Vertical\",\r\n            //     $(\"ContextMenuButton\",\r\n            //         $(go.TextBlock, \"更换地盘背景\"), {\r\n            //             click: function(e, obj) {\r\n            //                 var backImage = tdDipanBackgroundImages[Math.floor(Math.random() * tdDipanBackgroundImages.length)];\r\n            //                 setSourceOfPicture(backImage, 1); //更换主题时，如果是保留颜色，则刷新背景图片\r\n            //             }\r\n            //         }),\r\n            //     $(\"ContextMenuButton\",\r\n            //         $(go.TextBlock, \"移除地盘背景\"), {\r\n            //             click: function(e, obj) {\r\n            //                 var backnodeData = null;\r\n            //                 var rootKey = obj.part.data.key;\r\n            //                 myDiagram.model.nodeDataArray.forEach(function(d) {\r\n            //                     if (d.rootKey == rootKey && d.category == '3') {\r\n            //                         backnodeData = d;\r\n            //                         return;\r\n            //                     }\r\n            //                 })\r\n            //                 if (backnodeData) {\r\n            //                     myDiagram.model.startTransaction();\r\n            //                     myDiagram.model.removeNodeData(backnodeData);\r\n            //                     myDiagram.model.commitTransaction();\r\n            //                 }\r\n            //             }\r\n            //         })\r\n            // ),\r\n            \r\n        \r\n            location: new go.Point(0, 0)\r\n        },\r\n        new go.Binding(\"width\", \"layerThickness\", function(v) {\r\n            return v ? v * 2 : 100 * 2;\r\n        }),\r\n        new go.Binding(\"height\", \"layerThickness\", function(v) {\r\n            return v ? v * 2 : 100 * 2;\r\n        }),\r\n        $(go.Shape, \"Circle\", {\r\n                name: \"SHAPE\",\r\n                fill: \"#FFBFBF\",\r\n                strokeWidth: 0,\r\n                // width: 100,\r\n                // height: 100,\r\n                spot1: go.Spot.TopLeft,\r\n                spot2: go.Spot.BottomRight\r\n            },\r\n            new go.Binding(\"fill\", \"fill\", function(v) {\r\n                return v instanceof go.Brush ? v.color : v;\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay(),\r\n        \r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                return d;\r\n            }).makeTwoWay(function(d) {\r\n                return d;\r\n            })\r\n        ),\r\n        $(go.TextBlock, {\r\n                name: \"TEXT\",\r\n                font: \"bold 23px 幼圆\",\r\n                textAlign: \"center\",\r\n                editable: false,\r\n                spacingAbove: 4,\r\n                isMultiline: true,\r\n                \r\n                spacingBelow: 4\r\n            },\r\n            new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                return helpers.tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"text\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n            new go.Binding(\"width\", \"width\").makeTwoWay(),\r\n            new go.Binding(\"font\", \"font\").makeTwoWay(),\r\n            new go.Binding(\"angle\", \"textAngle\").makeTwoWay()\r\n        )\r\n        );\r\n        }\r\n\r\n    tdGetModelData1(name,model,myDiagram1) { //获取盘的model.modelData中的全局属性 \r\n        var defaultVal = {\r\n            currentType: 'dipan',\r\n            currentThemeID: 0,\r\n            layerThickness: 100,\r\n            splitLayer: 1,\r\n            layout: 'inner',\r\n            tdDipanTextAngle: 'xuanzhuan'\r\n        };\r\n        return Object.assign(defaultVal,model.modelData)\r\n    }\r\n    tdGetModelData(name,model) { //获取盘的model.modelData中的全局属性 \r\n        // if(myDiagram1){\r\n        //     myDiagram = myDiagram1\r\n        // }\r\n        var myDiagram = this.diagram\r\n        var  model = myDiagram.model\r\n        var defaultVal = {\r\n            currentType: 'tianpan',\r\n            currentThemeID: 0,\r\n            layerThickness: 100,\r\n            splitLayer: 1,\r\n            layout: 'inner',\r\n            tdDipanTextAngle: 'xuanzhuan'\r\n        };\r\n        console.log(\"getRootNodeData1111111111111111111111\")\r\n        var root = getRootNodeData(model);\r\n        if (typeof(name) != 'undefined' && name != null) { //返回指定的属性值\r\n            if (root) {\r\n                return root[name] || model.modelData[name] || defaultVal[name]\r\n            } else {\r\n                return model.modelData[name] || defaultVal[name];\r\n            }\r\n        }\r\n        //返回所有属性值\r\n        if (root) {\r\n            for (var key in defaultVal) {\r\n                if (root[key]) {\r\n                    defaultVal[key] = root[key];\r\n                } else {\r\n                    if (model.modelData && model.modelData[key]) {\r\n                        defaultVal[key] = model.modelData[key];\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (var key in defaultVal) {\r\n                if (model.modelData && model.modelData[key]) {\r\n                    defaultVal[key] = model.modelData[key];\r\n                }\r\n            }\r\n        }\r\n        return defaultVal;\r\n    }\r\n    deleteSelection () {\r\n        // console.log(\"====================deleteSelection 优化\")\r\n        var myDiagram = this.diagram;\r\n        var node = myDiagram.selection.first();\r\n        console.log(`删除节点 ${JSON.stringify(node.data)}`)\r\n        console.log(node.data)\r\n        var cmd = myDiagram.commandHandler;\r\n        // if (node instanceof go.Group) {\r\n        //     return;\r\n        // }\r\n        var locateNode = null;\r\n    \r\n        if (!node || node.data.istemp) {\r\n            return;\r\n        }\r\n        if (node.data.key == 1 || node.data.key == 'g_1' || node.data.key == 'Root') {\r\n            //删除根节点触发清空节点\r\n            //clearAllNodesGround();\r\n             \r\n            return;\r\n        }\r\n    \r\n        myDiagram.model.startTransaction('all');\r\n        myDiagram.model.startTransaction('level1');\r\n    \r\n        // myDiagram.model.startTransaction(\"sub\");\r\n        myDiagram.model.setDataProperty(node.data, \"istemp\", true); //防止节点呗删除访问属性失败\r\n        // console.log(myDiagram.model.nodeDataArray)\r\n        this.deleteNode(node,myDiagram);\r\n        //removeOneNode(node); //zyy\r\n        \r\n        // console.log(myDiagram.model.nodeDataArray)\r\n        // myDiagram.model.commitTransaction(\"sub\");\r\n    \r\n        //统一删除节点\r\n        var maxCircle = this.getMaxCircle(myDiagram);\r\n        //找到所有要删除的节点\r\n        var nodes = [];\r\n        myDiagram.model.nodeDataArray.forEach(function(n) {\r\n            if (n.level > maxCircle) {//zyy 增加n.group!==\"g_1\"\r\n                nodes.push(n);\r\n            }\r\n        });\r\n        // myDiagram.model.startTransaction(\"deleteTempNode\");\r\n        //删除所有只有临时节点的层级\r\n        myDiagram.model.removeNodeDataCollection(nodes);\r\n        //删除最外圈节点的isparent属性\r\n        myDiagram.model.nodeDataArray.forEach(function(n) {\r\n            if (n.level == maxCircle && n.isparent != null) {\r\n                // delete n.isparent;\r\n                myDiagram.model.setDataProperty(n, 'isparent', null);\r\n            }\r\n        });\r\n        myDiagram.model.removeNodeData(node.data);\r\n        // go.CommandHandler.prototype.deleteSelection.call(cmd);\r\n        myDiagram.model.commitTransaction('level1');\r\n        this.groundLayout(myDiagram);\r\n        //changeTheme(myDiagram.model.modelData.currentThemeID, true);zyy\r\n      \r\n        myDiagram.model.commitTransaction('all');\r\n        var locateNode = null;\r\n        var tempArray = [\"next\",\"prev\",\"parent\"]\r\n        for(var i=0;i<tempArray.length;i++){\r\n            if(node.data[tempArray[i]]){\r\n                locateNode = myDiagram.findNodeForKey(node.data[tempArray[i]])\r\n                break;\r\n            }\r\n        }\r\n        // if(node.data.category === 'dipan'){\r\n            if (locateNode) {\r\n                // console.log('5612 locateNode................' +  locateNode)\r\n                // console.dir(locateNode)\r\n                //选中单个节点 bug问题：外圈都是临时节点的时候，无法选中 \r\n                myDiagram.select(locateNode);\r\n            } \r\n            \r\n        // }\r\n    }\r\n\r\n    deleteNode(node) {\r\n        console.log('删除节点 deleteNode')\r\n        console.log(node.data.key)\r\n        console.log(node.data)\r\n        var myDiagram  = this.diagram\r\n        var mainNode = null;\r\n            var preNode = node.data.prev ? myDiagram.findNodeForKey(node.data.prev) : null;\r\n            var nextNode = node.data.next ? myDiagram.findNodeForKey(node.data.next) : null;\r\n            var parentNode = node.data.parent ? myDiagram.findNodeForKey(node.data.parent) : null;\r\n    \r\n            // try {\r\n                // 如果有子节点，则删除所有子节点\r\n                if (node.data.isparent) {\r\n                    var firstNode = myDiagram.findNodeForKey(node.data.isparent)\r\n                    var nodes = []\r\n                    helpers.tdTravelTdpData(firstNode.data, myDiagram.model, nodes, function(data){\r\n                        return data\r\n                    })\r\n                    myDiagram.model.removeNodeDataCollection(nodes);\r\n    \r\n                    var maxCircles = this.getMaxCircle(myDiagram)\r\n                }\r\n                // 父节点存在的情况下\r\n                if (parentNode != null) {\r\n                    //当前节点为第一个子节点\r\n                    if (parentNode.data.isparent == node.data.key) {\r\n                        //如果当前节点是最后一个子节点\r\n                        if (nextNode == null) {\r\n                            myDiagram.model.setDataProperty(parentNode.data, \"isparent\", undefined);\r\n                        } else {\r\n                            myDiagram.model.setDataProperty(parentNode.data, \"isparent\", nextNode.data.key);\r\n                            myDiagram.model.setDataProperty(nextNode.data, \"prev\", undefined);\r\n                        }\r\n                    } else {\r\n                        myDiagram.model.setDataProperty(preNode.data, \"next\", nextNode == null ? null : nextNode.data.key);\r\n                        if (nextNode != null) {\r\n                            myDiagram.model.setDataProperty(nextNode.data, \"prev\", preNode.data.key);\r\n                        }\r\n                    }\r\n                }\r\n    \r\n                if(myDiagram.model.modelData.currentType == 'dipan'){\r\n                    // 删除的只剩下root节点时对root节点做处理\r\n                    var totalCount = 0;\r\n                    for(var i=0;i<myDiagram.model.nodeDataArray.length;i++){\r\n                        if(!myDiagram.model.nodeDataArray[i].istemp && !myDiagram.model.nodeDataArray[i].isGroup){\r\n                            totalCount++;\r\n                        }\r\n                        if(totalCount>1) break;\r\n                    }\r\n                    if(totalCount <= 1){  \r\n                        console.log(\"删除的只剩下root节点时对root节点做处理\")\r\n                        var dipanRoot = myDiagram.model.findNodeDataForKey(1);\r\n                        delete dipanRoot.group\r\n                    }\r\n                }\r\n            // } catch (ex) {\r\n            //     console.log(ex.message);\r\n            // }\r\n    \r\n        // }\r\n        myDiagram.isModified = true;\r\n    \r\n    \r\n    }\r\n\r\n    getMaxCircle() {\r\n        var myDiagram = this.diagram\r\n        var maxCircle = 0;\r\n        let nodeArr = [];\r\n        let nodeLevelArr = [];\r\n        let maxNodeArr = [];\r\n        let arr = [];\r\n        myDiagram.model.nodeDataArray.forEach(function(d) {\r\n            if(!d.istemp&&!d.isGroup){\r\n                nodeArr.push(d)\r\n                if(d.level){\r\n                    nodeLevelArr.push(d.level)\r\n                }\r\n            }else{\r\n                arr.push(d)\r\n            }\r\n        });\r\n        let max = Math.max.apply(null, nodeLevelArr);\r\n        // console.log(max)\r\n        nodeArr.forEach(function(node){\r\n            if(node.level === max){\r\n                maxNodeArr.push(node)\r\n            }\r\n        })\r\n        if(max ===-Infinity&&maxNodeArr.length === 0){\r\n            console.log(\"11111111111111\")\r\n            maxCircle = 0\r\n        }else if(max !== -Infinity&&maxNodeArr.length === 0){\r\n           maxCircle = max -1;\r\n        }else if(maxNodeArr.length > 0){\r\n           maxCircle = max;\r\n        }\r\n        // console.log(\"maxCircle\")\r\n        // console.log(maxCircle)\r\n        return maxCircle\r\n    }\r\n\r\n    addNewCircle(e) {\r\n        let myDiagram = this.diagram\r\n        var maxCircles = this.getMaxCircle()\r\n        var node = myDiagram.selection.first();\r\n        console.log(node.data)\r\n        if (!node) return;\r\n        if (node.data.isparent && myDiagram.findNodeForKey(node.data.isparent) && !myDiagram.findNodeForKey(node.data.isparent).visible) {\r\n            return;\r\n        }\r\n        myDiagram.model.startTransaction(\"addNewCircle\");\r\n        if (\"istemp\" in node.data && node.data.istemp) {\r\n            changeTemp2normal(myDiagram);\r\n            if (node.data.text == \"\") {\r\n               myDiagram.model.setDataProperty(node.data, \"text\", lang.trans('dce'));\r\n               //myDiagram.model.setDataProperty(node.data, \"text\", node.data.key)\r\n            }\r\n        }\r\n    \r\n        var firstnodeData = null;\r\n        if (node.data.isparent) {\r\n            firstnodeData = myDiagram.model.findNodeDataForKey(node.data.isparent);\r\n        }\r\n        if (firstnodeData != null && firstnodeData.istemp) {\r\n            myDiagram.model.setDataProperty(firstnodeData, \"istemp\", false);\r\n            myDiagram.model.setDataProperty(firstnodeData, \"text\", lang.trans('dce'));\r\n            //myDiagram.model.setDataProperty(node.data, \"text\", node.data.key)\r\n        } else {\r\n            var follower = this.addChildNodeData(node);\r\n            if (follower.level > maxCircles) {\r\n                maxCircles = follower.level;\r\n            }\r\n    \r\n            this.groundLayout(myDiagram);\r\n        }\r\n        myDiagram.model.commitTransaction(\"addNewCircle\");\r\n    }\r\n    \r\n     //modify nodeDataArray\r\n     addChildNodeData(node) {\r\n        // 去掉连线和group\r\n        console.log(\"===================================addChildNodeData:去掉连线和group、主题\")\r\n        var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        var myDiagram = node.diagram;\r\n        var result = arguments[1] ? arguments[1] : null;\r\n        var currentType = 'dipan'\r\n        //myDiagram.startTransaction();\r\n        var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n        //var follower = {key: nextkey, text: nextkey};\r\n        var follower = { key: nextkey, text: lang.trans('dce') };\r\n        //if (result != null) {\r\n        myDiagram.model.makeNodeDataKeyUnique(follower);\r\n        nextkey = follower.key;\r\n        var firstNode = null;\r\n        follower.level = node.data.level + 1;\r\n        follower.parent = node.data.key;\r\n        follower.prev = undefined;\r\n    \r\n        //如果已经有子节点\r\n        if (node.data.isparent) {\r\n            firstNode = myDiagram.model.findNodeDataForKey(node.data.isparent)\r\n            if(firstNode){\r\n                follower.next = firstNode.key;\r\n                myDiagram.model.setDataProperty(firstNode, \"prev\", follower.key);\r\n            }\r\n        }\r\n    \r\n        if (result != null) {\r\n            //只是用来填充的节点\r\n            follower.istemp = true;\r\n            follower.text = \"\";\r\n        }\r\n    \r\n        var sectotLayerThickNess  = myDiagram.model.modelData.layerThickness\r\n        console.log(\" myDiagram.model\", myDiagram.model);\r\n        // follower.fill = colorMap[follower.level % 5];\r\n        follower.dangle = node.data.dangle;\r\n        follower.dradius = node.data.dradius;\r\n        follower.sweep = node.data.sweep;\r\n        // zyy follower.loc = node.data.loc;\r\n        follower.layerThickness = sectotLayerThickNess || 100;\r\n        follower.tdDipanTextAngle = node.data.tdDipanTextAngle || 'xuanzhuan';\r\n        if (node.data.level != 0) {\r\n            follower.category = node.data.category;\r\n        }\r\n        if (node.data.category == \"Root\") {\r\n            follower.category = \"dipan\";\r\n        }\r\n    \r\n    \r\n        follower.strokeWidth = node.data.strokeWidth;\r\n        if (node.data.figure) {\r\n            follower.figure = node.data.figure;\r\n        }\r\n    \r\n        if (node.data.picture) {\r\n            follower.picture = node.data.picture;\r\n        }\r\n    \r\n        if (node.data.width) {\r\n            follower.width = node.data.width;\r\n        }\r\n        if (node.data.height) {\r\n            follower.height = node.data.height;\r\n        }\r\n        follower = applyTheme2Node(follower,myDiagram);\r\n        follower.font = node.data.font;\r\n        follower.textStroke = node.findObject(\"TEXT\").stroke;\r\n        myDiagram.model.setDataProperty(node.data, \"isparent\", nextkey);\r\n        follower.newAdd = true;\r\n        myDiagram.model.addNodeData(follower,myDiagram);\r\n        myDiagram.isModified = true;\r\n        return follower;\r\n    }\r\n    \r\n    addFollowerGround(e) {\r\n        let myDiagram = this.diagram;\r\n        if (myDiagram.selection.count == 0) return;\r\n        var node = myDiagram.selection.first();\r\n        if (node.data.key == 1) {\r\n            return;\r\n        }\r\n        if (!node) return;\r\n        var diagram = node.diagram;\r\n        // var isautolayout = window.localStorage.getItem('isautolayout') == null?true:window.localStorage.getItem('isautolayout') == 'true';\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        if (node === null || !(node instanceof go.Node) || node instanceof go.Group) return;\r\n        // root node is not allowed to add follower\r\n        // if (node.findLinksInto().count == 0) return;\r\n        myDiagram.model.startTransaction('all');\r\n        if (\"istemp\" in node.data && node.data.istemp) {\r\n            changeTemp2normal(myDiagram);\r\n            if (node.data.text == \"\") {\r\n                myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n            }\r\n        }\r\n        // if(!isautolayout){\r\n        //   ControlAutoLayout(false);\r\n        // }else{\r\n        //   ControlAutoLayout(true);\r\n        // }\r\n        //myDiagram.model.startTransaction('addnode');\r\n        myDiagram.startTransaction('sub1');\r\n        var follower = this.addLevelNodeData(node);\r\n        myDiagram.commitTransaction('sub1');\r\n        this.groundLayout(myDiagram);\r\n        //changeTheme(myDiagram.model.modelData.currentThemeID, true);zyy颜色\r\n        myDiagram.model.commitTransaction('all');\r\n        var newnode = diagram.findNodeForData(follower);\r\n        if (newnode) {\r\n            // myDiagram.centerRect(newnode.actualBounds);\r\n            diagram.select(newnode);\r\n        }\r\n    \r\n    \r\n    }\r\n    \r\n    addLevelNodeData(node) {\r\n        console.log(\"======================去掉天盘\")\r\n        var isautolayout = window.localStorage.getItem('isautolayout') == null ? true : window.localStorage.getItem('isautolayout') == 'true';\r\n        // var isautoselect =  window.localStorage.getItem('isautoselect') == null?true:window.localStorage.getItem('isautoselect') == 'true';\r\n        var myDiagram = this.diagram;\r\n        var currentType = 'dipan';\r\n        var toKey = node.data.next;\r\n        //delete the next link\r\n    \r\n        var nextkey = (myDiagram.model.nodeDataArray.length + 1).toString();\r\n        //var follower = {key: nextkey, text: nextkey, color: \"yellow\"};\r\n    \r\n        var follower = { key: nextkey, text: lang.trans(\"dce\"), color: \"yellow\" };\r\n        myDiagram.model.makeNodeDataKeyUnique(follower);\r\n        nextkey = follower.key;\r\n        var nextnode = null;\r\n        if(toKey){\r\n            var nextnode = myDiagram.model.findNodeDataForKey(toKey);\r\n        }\r\n        myDiagram.model.startTransaction();\r\n    \r\n        follower = applyTheme2Node(follower, myDiagram);\r\n        //delete the next link\r\n        var deleteLink = null;\r\n    \r\n        //if has next node\r\n        if (nextnode != null) {\r\n            follower.next = nextnode.key;\r\n            myDiagram.model.setDataProperty(nextnode, \"prev\", follower.key);\r\n        }\r\n        follower.level = node.data.level;\r\n        follower.radius = node.data.radius;\r\n        follower.fill = node.data.fill;\r\n        //follower.fill =go.Brush.randomColor(128, 240);\r\n        follower.dangle = node.data.dangle;\r\n        follower.dradius = node.data.dradius;\r\n        // zyy follower.loc = node.data.loc;\r\n        follower.sweep = node.data.sweep;\r\n        follower.layerThickness = node.data.layerThickness || 100;\r\n        follower.tdDipanTextAngle = node.data.tdDipanTextAngle || 'xuanzhuan';\r\n    \r\n        follower.parent = node.data.parent;\r\n        follower.prev = node.data.key;\r\n        follower.strokeWidth = node.data.strokeWidth;\r\n        follower.stroke = node.data.stroke;\r\n        follower.font = node.data.font;\r\n        //follower.font = node.data.font;\r\n        follower.textStroke = node.findObject(\"TEXT\").stroke;\r\n        if (node.data.figure) {\r\n            follower.figure = node.data.figure;\r\n        }\r\n        follower.loc = node.data.loc;\r\n        if (node.data.width) {\r\n            follower.width = node.data.width;\r\n        }\r\n        if (node.data.height) {\r\n            follower.height = node.data.height;\r\n        }\r\n        follower.category = node.data.category;\r\n        follower.newAdd = true;\r\n        // add a new node\r\n        myDiagram.model.addNodeData(follower);\r\n        myDiagram.model.setDataProperty(node.data, \"next\", nextkey);\r\n    \r\n        myDiagram.model.commitTransaction();\r\n        myDiagram.isModified = true;\r\n        return follower;\r\n    }\r\n\r\n    moveWithinNodes(direction) {\r\n        var myDiagram = this.diagram;\r\n        var node = myDiagram.selection.first();\r\n        if(!node){\r\n            return;\r\n        }\r\n        if (!node) {\r\n            myDiagram.select(myDiagram.findNodeForKey(1));\r\n            return;\r\n        }\r\n        switch (direction) {\r\n            case 'left':\r\n                if (node.data.prev) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.prev);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'up':\r\n                if (node.data.parent) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.parent);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'right':\r\n                if (node.data.next) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.next);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n            case 'down':\r\n                if (node.data.isparent) {\r\n                    var prevNode = myDiagram.findNodeForKey(node.data.isparent);\r\n                    if (prevNode) {\r\n                        myDiagram.select(prevNode);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    selectText(e) {\r\n        var myDiagram = this.diagram\r\n        var node = myDiagram.selection.first();\r\n        if (!node) return;\r\n        // removeNodeRemarkTips();\r\n        var tb = myDiagram.selection.first().findObject('TEXT');\r\n        if (tb) myDiagram.commandHandler.editTextBlock(tb);\r\n        helpers.simulateEnterWithAlt(e);\r\n    }\r\n\r\n    // 地盘布局\r\n    groundLayout(myDiagram) {\r\n        // var dipaninteractions = require('./dipan');\r\n        // var addChildNodeData = this.addChildNodeData\r\n        var myDiagram = this.diagram\r\n        var root = myDiagram.findNodeForKey(1);\r\n        var that = this;\r\n        if (!root) {\r\n            return;\r\n        }\r\n        root.location = new go.Point(0, 0);\r\n        var diagram = root.diagram;\r\n        if (diagram === null) return;\r\n        // make this Node the root\r\n        root.data.category = \"Root\";\r\n        // determine new distances from this new root node\r\n        //    var results = findDistances(somenode);\r\n        //    radialLayout(root);\r\n        var layout = getTdLayout(myDiagram);\r\n        if (layout == 'out') {\r\n            var maxCircles = this.getMaxCircle(myDiagram);\r\n    \r\n            var model = myDiagram.model;\r\n            helpers.tdTravelTdpData(root.data, model, [], function(d) {\r\n                if (d.level < maxCircles && typeof(d.isparent) == 'undefined') {\r\n                    var followerNode = myDiagram.findNodeForKey(d.key);\r\n                    that.addChildNodeData(followerNode, \"temp\");\r\n                }\r\n            });\r\n            changeLayout();\r\n        } else if (layout == 'inner') {\r\n            radialLayout(root,myDiagram);\r\n            // myDiagram.model.modelData.splitLayer = 1\r\n            // splitLayer = 1\r\n            // splitRadlayout(null, myDiagram.model, splitLayer);\r\n        } else {\r\n            splitLayer = myDiagram.model.modelData.splitLayer ? myDiagram.model.modelData.splitLayer : splitLayer;\r\n            splitRadlayout(null, myDiagram.model, splitLayer);\r\n        }\r\n        // setSourceOfPicture(null, 1); //重新计算背景图片宽高\r\n\r\n        function radialLayout(root,myDiagram) {\r\n            root.diagram.startTransaction(\"radial layout\");\r\n            // sort all results into Arrays of Nodes with the same distance\r\n            var nodes = {};\r\n            var maxlayer = 0;\r\n            // var globalProperties = tdGetModelData(null, myDiagram.model); //获取所有全局属性到一个对象中\r\n            // var layerThickness = parseInt(root.data.layerThickness || 100);\r\n            var layerThickness = myDiagram.model.modelData.layerThickness || 100;\r\n            var tdDipanTextAngle = root.data.tdDipanTextAngle || \"xuanzhuan\";\r\n        \r\n            root.diagram.model.setDataProperty(root.data, \"dangle\", 0);\r\n            root.diagram.model.setDataProperty(root.data, \"sweep\", 360);\r\n            root.diagram.model.setDataProperty(root.data, \"dradius\", 0);\r\n        \r\n        \r\n            myDiagram.nodes.each(function(n) {\r\n                n.data._laid = false;\r\n            });\r\n        \r\n            // now recursively position nodes, starting with the root\r\n            root.location = new go.Point(0, 0);\r\n            maxCircles = that.getMaxCircle(myDiagram);\r\n            radlay1(root, 1, 90, 360, layerThickness, tdDipanTextAngle,myDiagram);\r\n            root.diagram.commitTransaction(\"radial layout\");\r\n        }\r\n\r\n        function radlay1(node, layer, angle, sweep, layerThickness, tdDipanTextAngle,myDiagram) {\r\n            // var dipaninteractions = require('./dipan');\r\n            var addChildNodeData = that.addChildNodeData\r\n            try {\r\n                var nodes = getAllChilds(node);\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n            var parentKey = node.data.key;\r\n        \r\n            if (node.data.category >= 3) {\r\n                return;\r\n            }\r\n            // var globalProperties = tdGetModelData(null, myDiagram.model);   //获取所有全局属性到一个对象中\r\n            // var layerThickness = parseInt(globalProperties['layerThickness']);\r\n            // var tdDipanTextAngle = globalProperties['tdDipanTextAngle'];\r\n        \r\n            var found = nodes.length;\r\n            //if (found === 0) return;\r\n            if (found === 0 && node.data.level >= maxCircles) return;\r\n            if (found === 0) {\r\n                var newdata = that.addChildNodeData(node, \"temp\");\r\n        \r\n                var newnode = myDiagram.findNodeForData(newdata);\r\n                nodes.push(newnode);\r\n                //node.diagram.model.setDataProperty(newdata, \"istemp\", true);\r\n                found++;\r\n            }\r\n            var rootNode = myDiagram.model.findNodeDataForKey(1);\r\n            var rootRadius = parseInt(rootNode.layerThickness);\r\n            var radius = rootRadius + (layer - 1) * layerThickness;\r\n            var separator = sweep / found;\r\n            var start = angle - sweep / 2 + separator / 2;\r\n            for (var i = 0; i < found; i++) {\r\n                var n = nodes[i];\r\n                var a = start + i * separator;\r\n                var p = new go.Point(radius + layerThickness / 2, 0);\r\n                if (n.data._laid) {\r\n                    radlay1(n, layer + 1, n.data.dangle, n.data.sweep, layerThickness, tdDipanTextAngle,myDiagram);\r\n                    continue;\r\n                }\r\n                p.rotate(a);\r\n                // n.location = p;\r\n                n.diagram.model.setDataProperty(n.data, \"loc\", go.Point.stringify(p));\r\n                n.data._laid = true;\r\n                n.diagram.model.setDataProperty(n.data, \"dangle\", a);\r\n                n.diagram.model.setDataProperty(n.data, \"sweep\", separator);\r\n                n.diagram.model.setDataProperty(n.data, \"dradius\", radius);\r\n                n.diagram.model.setDataProperty(n.data, \"layerThickness\", layerThickness);\r\n                \r\n                // make sure text is never upside down\r\n                var label = n.findObject(\"TEXT\");\r\n                if (label !== null) {\r\n                    label.angle = ((a > 90 && a < 270 || a < -90) ? 180 : 0);\r\n                    //n.diagram.model.setDataProperty(n.data, \"textAngle\", label.angle);\r\n                    if (tdDipanTextAngle == 'xuanzhuan') { //文字方向旋转\r\n                        n.diagram.model.setDataProperty(n.data, \"textAngle\", label.angle);\r\n                    }\r\n                    if (tdDipanTextAngle == 'fangshe') { //文字方向旋转\r\n                        n.diagram.model.setDataProperty(n.data, \"textAngle\", 90);\r\n                    }\r\n                    if (tdDipanTextAngle == 'zhengli') { //文字方向正向\r\n                        n.diagram.model.setDataProperty(n.data, \"textAngle\", -a);\r\n                    }\r\n                    // console.log(\"text:\"+n.data.text+\",textangle:\"+n.data.textAngle+\";nodeAngle=\"+a  );\r\n                }\r\n                if (n.data.key == \"1\") {\r\n                    n.diagram.model.setDataProperty(n.data, \"textAngle\", 0);\r\n                }\r\n                radlay1(n, layer + 1, a, sweep / found, layerThickness, tdDipanTextAngle,myDiagram);\r\n            }\r\n        }\r\n\r\n        function getTdLayout(myDiagram) {\r\n            return myDiagram.model.modelData.layout ? myDiagram.model.modelData.layout : 'inner';\r\n        }\r\n\r\n        function getAllChilds(parentNode) {\r\n            try {\r\n                if (!parentNode.data.isparent) {\r\n                    return [];\r\n                }\r\n                var nodes = [],\r\n                    tmpDataObj;\r\n                if (!parentNode.data.isparent) return [];\r\n                var firstNode = parentNode.diagram.findNodeForKey(parentNode.data.isparent);\r\n                tmpDataObj = firstNode;\r\n                if (tmpDataObj) {\r\n                    nodes.push(firstNode);\r\n                    while (tmpDataObj.data.next) {\r\n                        tmpDataObj = parentNode.diagram.findNodeForKey(tmpDataObj.data.next);\r\n                        if (!tmpDataObj) break;\r\n                        nodes.push(tmpDataObj);\r\n                    }\r\n                }\r\n                return nodes;\r\n            } catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n        \r\n       // 外圈均分布局\r\n        function splitRadlayout(nodeData, model) {\r\n            if (nodeData == null) {\r\n                nodeData = model.findNodeDataForKey(1);\r\n            }\r\n            var rootNode = model.findNodeDataForKey(1);\r\n            var rootRadius = parseInt(rootNode.layerThickness);\r\n            console.log(\"rootRadius\", rootRadius);\r\n            model.nodeDataArray.forEach(function(d) {\r\n                d._laid = false;\r\n            });\r\n            // var globalProperties = tdGetModelData(null, myDiagram.model); //获取所有全局属性到一个对象中\r\n            // var root = getSubGraphRoot(nodeData, myDiagram);\r\n            // var layerThickness = parseInt(nodeData.layerThickness || 100);\r\n            var layerThickness = myDiagram.model.modelData.layerThickness;\r\n\r\n            var tdDipanTextAngle = nodeData.tdDipanTextAngle || \"xuanzhuan\";\r\n            var maxCircle = arguments[2] ? arguments[2] : getMaxCircle(myDiagram);\r\n            var result = getNumOfLevelChild(nodeData, model, maxCircle);\r\n            var childNum = result.count;\r\n            if (childNum <= 0) return;\r\n            var sweepUnit = 360.0 / childNum;\r\n            //setLevelSectionIndex(nodeData, model);\r\n\r\n            var length = model.nodeDataArray.length;\r\n\r\n            var collector = [];\r\n            if (nodeData.isparent) {\r\n                var firstChild = model.findNodeDataForKey(nodeData.isparent);\r\n            } else {\r\n                return;\r\n            }\r\n\r\n            helpers.tdTravelTdpData(firstChild, model, collector, function(d) {\r\n                return d;\r\n            });\r\n            var tmpArray;\r\n\r\n            for (var level = 1; level <= maxCircle; level++) {\r\n                tmpArray = _.filter(collector, function(item) {\r\n                    return (!item.isGroup && item.level == level);\r\n                });\r\n                var angle = 0;\r\n                var start = 0;\r\n                var radius = rootRadius + (level - 1) * layerThickness;\r\n                for (var index = 0; index < tmpArray.length; index++) {\r\n                    var data = tmpArray[index];\r\n                    data._laid = true;\r\n                    if (data.key == \"1\") {\r\n                        model.setDataProperty(n.data, \"textAngle\", 0);\r\n                        continue;\r\n                    }\r\n                    result = getNumOfLevelChild(data, model, maxCircle);\r\n                    childNum = result.count;\r\n                    if (childNum < 0) {\r\n                        continue;\r\n                    }\r\n                    if (childNum == 0) {\r\n                        var separator = sweepUnit;\r\n                    } else {\r\n                        var separator = childNum * sweepUnit;\r\n                    }\r\n                    if (index == 0) {\r\n                        start = -90;\r\n                    }\r\n\r\n                    angle = start + separator / 2;\r\n                    start += separator;\r\n                    var a = angle;\r\n                    var p = new go.Point(radius + layerThickness / 2, 0);\r\n                    // console.log('layerThickness', layerThickness, 'radius:', radius)\r\n                    p.rotate(a);\r\n                    // n.location = p;\r\n                    model.setDataProperty(data, \"loc\", go.Point.stringify(p));\r\n                    model.setDataProperty(data, \"dangle\", a);\r\n                    model.setDataProperty(data, \"sweep\", separator);\r\n                    model.setDataProperty(data, \"dradius\", radius);\r\n                    model.setDataProperty(data, \"layerThickness\", layerThickness);\r\n                    \r\n                    // make sure text is never upside down\r\n                    // var label = myDiagram.findNodeForKey(nodeData.key).findObject(\"TEXT\");\r\n                    //if (label !== null) {\r\n                    //label.angle = ((a > 90 && a < 270 || a < -90) ? 180 : 0);\r\n                    var tmpAngle = ((a > 90 && a < 270 || a < -90) ? 180 : 0);\r\n                    //if(a>80 && a < 100){\r\n                    //    label.angle = -a;\r\n                    //}\r\n                    if (tdDipanTextAngle == 'xuanzhuan') { //文字方向旋转\r\n                        model.setDataProperty(data, \"textAngle\", tmpAngle);\r\n                    }\r\n                    if (tdDipanTextAngle == 'fangshe') { //文字方向旋转\r\n                        var tmpAngle = (a > 0 && a < 180 || a < -180) ? 180 : 0;\r\n                        model.setDataProperty(data, \"textAngle\", 90);\r\n\r\n                        // label.width = 100;\r\n                    }\r\n                    //}\r\n                    if (tdDipanTextAngle == 'zhengli') { //文字方向正向\r\n                        model.setDataProperty(data, \"textAngle\", -a);\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n            // 指定层均分会调用内圈均分的函数\r\n            console.log()\r\n            if (maxCircle < this.getMaxCircle(myDiagram)) {\r\n                radlay1(myDiagram.findNodeForKey(1), 1, 90, 360, layerThickness, tdDipanTextAngle);\r\n            }\r\n        }\r\n \r\n        //获取node指定层子节点的个数,isAll是否是所有子孙\r\n        function getNumOfLevelChild(nodeData, model, level, isAll) {\r\n            var result = { count: 0, list: [] },\r\n                flag = false;\r\n            try {\r\n                if (nodeData.key == 1) {\r\n                    model.nodeDataArray.forEach(function(d) {\r\n                        if (isAll) {\r\n                            flag = d.level >= level\r\n                        } else {\r\n                            flag = d.level == level\r\n                        }\r\n                        if (!_.has(d, 'isGroup') && flag) {\r\n                            result.count += 1;\r\n                            result.list.push(d);\r\n                        }\r\n                    })\r\n                } else {\r\n                    //var result = 0;\r\n                    if (nodeData.isparent) {\r\n                        var firstChild = model.findNodeDataForKey(nodeData.isparent);\r\n                    } else {\r\n                        return result;\r\n                    }\r\n                    helpers.tdTravelTdpData(firstChild, model, [], function(d) {\r\n                        if (isAll) {\r\n                            flag = d.level >= level\r\n                        } else {\r\n                            flag = d.level == level\r\n                        }\r\n                        if (!_.has(d, 'isGroup') && flag) {\r\n                            result.count += 1;\r\n                            result.list.push(d);\r\n                        }\r\n                    });\r\n                }\r\n            } catch (e) {\r\n\r\n\r\n                console.log(e);\r\n                return { count: 0, list: [] };\r\n            }\r\n\r\n            return result;\r\n        }\r\n\r\n    }\r\n\r\n    //快捷键\r\n    dokeyDownFnq (diagram) {\r\n        var myDiagram = this.diagram;\r\n        var e = myDiagram.lastInput;\r\n        var cmd = myDiagram.commandHandler;\r\n        var node = myDiagram.selection.first();\r\n\r\n        // if (e.event.altKey) {\r\n        //     if (e.key == \"Q\") {\r\n        //         autoLayoutAll();\r\n        //         return;\r\n        //     } else if (e.key == \"R\") {\r\n        //         centerNode();\r\n        //         return;\r\n        //     } else if (e.key == \"C\") {\r\n        //         centerCurrentNode();\r\n        //         return;\r\n        //     } else if (e.key == \"A\") {\r\n        //         zoomToFit();\r\n        //         return;\r\n        //     }\r\n        // }\r\n        if (e.event.keyCode >= 65 && e.event.keyCode <= 90 && !e.event.altKey && !e.event.ctrlKey && !e.event.shiftKey) {\r\n            // e.bubbles = true;\r\n            e.bubbles = false;\r\n            this.selectText(e, diagram);\r\n            return true;\r\n        }\r\n\r\n        if (e.event.keyCode === 13) { // could also check for e.control or e.shift\r\n            if (node && node.data.category == 'Root' ) {\r\n                this.addFollowerGround();\r\n            } else if(node && node.data.category == 'dipan'){\r\n                this.addFollowerGround();\r\n            }\r\n\r\n        } else if (e.event.keyCode === 9) { // could also check for e.control or e.shift\r\n            if (node && node.data.category == 'Root') {\r\n\r\n                this.addNewCircle();\r\n            } else if(node && node.data.category == 'dipan'){\r\n                this.addNewCircle();\r\n            }\r\n        } else if (e.key === \"t\") { // could also check for e.control or e.shift\r\n            if (cmd.canCollapseSubGraph()) {\r\n                cmd.collapseSubGraph();\r\n            } else if (cmd.canExpandSubGraph()) {\r\n                cmd.expandSubGraph();\r\n            }\r\n        } else if (e.key == \"Del\") {\r\n            if (myDiagram.selection.count == 0) {\r\n                return;\r\n            }\r\n            e.diagram.commandHandler.deleteSelection();\r\n        } else if (e.event.keyCode == 113) { //F2,覆盖地盘默认行为\r\n            this.selectText();\r\n        } else if (e.event.keyCode == 37) { //左\r\n            this.moveWithinNodes('left');\r\n        } else if (e.event.keyCode == 38) { //上\r\n            this.moveWithinNodes('up');\r\n        } else if (e.event.keyCode == 39) { //右\r\n            this.moveWithinNodes('right');\r\n        } else if (e.event.keyCode == 40) { //下\r\n            this.moveWithinNodes('down');\r\n        } else {\r\n            // call base method with no arguments\r\n            go.CommandHandler.prototype.doKeyDown.call(cmd);\r\n        }\r\n        e.bubbles = false; //阻止事件冒泡到dom\r\n    }\r\n    \r\n    // 生成base64图片\r\n    downloadImage() {\r\n        var myDiagram = this.diagram;\r\n        var imgdata = myDiagram.makeImageData({\r\n            scale: 1.0,\r\n            background: \"#ffffff\",\r\n            type: \"image/png\",\r\n            maxSize: new go.Size(9000, 9000)\r\n        });\r\n\r\n        return imgdata;\r\n    }\r\n}\r\n\r\n//临时扇区转换为正式扇区\r\nfunction changeTemp2normal(myDiagram) {\r\n\r\n    var node = myDiagram.selection.first();\r\n    if (node.data.istemp) {\r\n        myDiagram.model.startTransaction();\r\n        var tmpNode = myDiagram.findNodeForKey(node.data.parent);\r\n        myDiagram.model.setDataProperty(node.data, \"istemp\", undefined);\r\n        var lastNode = null; //记录这一级扇区\r\n        while (tmpNode) {\r\n            if (tmpNode.data.istemp) {\r\n                myDiagram.model.setDataProperty(tmpNode.data, \"istemp\", undefined);\r\n                myDiagram.model.setDataProperty(tmpNode.data, \"text\", \"双击编辑内容\");\r\n                lastNode = tmpNode;\r\n            } else {\r\n                if (lastNode) {\r\n                    myDiagram.model.setDataProperty(tmpNode.data, \"isparent\", lastNode.data.key);\r\n                }\r\n                break;\r\n            }\r\n            tmpNode = myDiagram.findNodeForKey(tmpNode.data.parent);\r\n        }\r\n        myDiagram.model.commitTransaction();\r\n        myDiagram.isModified = true;\r\n    }\r\n}\r\n\r\n\r\nfunction computeEffectiveCollection(parts) {\r\n    var coll = new go.Set();\r\n    var node = parts.first();\r\n    if (node) {\r\n        helpers.travelParts(node, function(p) {\r\n            coll.add(p);\r\n        })\r\n    } else {\r\n        coll.addAll(parts);\r\n    }\r\n    var tool = this;\r\n\r\n    return go.DraggingTool.prototype.computeEffectiveCollection.call(this, coll);\r\n};\r\n\r\nfunction applyTheme2Node(follower, myDiagram) {\r\n    var tdCurrentTheme = myDiagram.__trtd.tdCurrentTheme\r\n    // follower.strokeWidth = tdCurrentTheme.borderWidth;\r\n    // follower.stroke = tdCurrentTheme.borderColor;\r\n    myDiagram.model.setDataProperty(follower, 'strokeWidth', tdCurrentTheme.borderWidth);\r\n    myDiagram.model.setDataProperty(follower, 'stroke', tdCurrentTheme.borderColor);\r\n    if (tdCurrentTheme.colorRange == null) {\r\n        // follower.fill = randomColor({luminosity: 'light', count: 1})[0];\r\n        myDiagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n    } else if (tdCurrentTheme.colorRange instanceof Array) {\r\n        var tmpColor = \"white\";\r\n        if (follower.level >= tdCurrentTheme.colorRange.length) {\r\n            tmpColor = tdCurrentTheme.colorRange[follower.level % tdCurrentTheme.colorRange.length];\r\n        } else {\r\n            tmpColor = tdCurrentTheme.colorRange[follower.level];\r\n        }\r\n        // follower.fill = tmpColor;\r\n        myDiagram.model.setDataProperty(follower, 'fill', tmpColor);\r\n    } else if (tdCurrentTheme.colorRange == \"random\") {\r\n        //层级颜色一样的随机色\r\n        if (follower.prev) {\r\n            var preNode = myDiagram.findNodeForKey(follower.prev);\r\n            if (preNode) {\r\n                // follower.fill = preNode.data.fill;\r\n                myDiagram.model.setDataProperty(follower, 'fill', preNode.data.fill);\r\n            } else {\r\n                // follower.fill = randomColor({luminosity: 'light', count: 1})[0];\r\n                myDiagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n            }\r\n\r\n        } else {\r\n            // follower.fill = randomColor({luminosity: 'light', count: 1})[0];\r\n            myDiagram.model.setDataProperty(follower, 'fill', randomColor({ luminosity: 'light', count: 1 })[0]);\r\n        }\r\n    } else {\r\n        // follower.fill = \"rgba(0,0,0,0)\";\r\n        if (tdCurrentTheme.colorRange == \"white\") {\r\n            myDiagram.model.setDataProperty(follower, 'fill', \"white\");\r\n        } else {\r\n            myDiagram.model.setDataProperty(follower, 'fill', \"rgba(0,0,0,0)\");\r\n        }\r\n\r\n    }\r\n    return follower;\r\n}\r\n\r\n//生成地盘的figure形状\r\nfunction makeAnnularWedge(data, layerThickness) {\r\n    var sweep = data.sweep ? data.sweep : 360;\r\n    var layerThickness = data.layerThickness || 100;\r\n    var radius = data.dradius ? data.dradius : 100;\r\n    var p = new go.Point(radius + layerThickness, 0).rotate(-sweep / 2);\r\n    var q = new go.Point(radius, 0).rotate(sweep / 2);\r\n    var geo = new go.Geometry()\r\n        .add(new go.PathFigure(p.x, p.y)\r\n            .add(new go.PathSegment(go.PathSegment.Arc, -sweep / 2, sweep, 0, 0, radius + layerThickness, radius + layerThickness))\r\n            .add(new go.PathSegment(go.PathSegment.Line, q.x, q.y))\r\n            .add(new go.PathSegment(go.PathSegment.Arc, sweep / 2, -sweep, 0, 0, radius, radius).close()));\r\n    geo.normalize();\r\n    return geo;\r\n}\r\n\r\nfunction getRootNodeData(model) {\r\n    var root = null;\r\n    root = model.nodeDataArray.find((o)=>{\r\n        if(!o.isGroup && o.category == \"Root\" && o.level == 0){\r\n            return true;\r\n        }\r\n    })\r\n\r\n    return root;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n// function cxcommand (obj, val) {\r\n//     var diagram = obj.diagram;\r\n//     var myDiagram = obj.diagram;\r\n//     if (!(diagram.currentTool instanceof go.ContextMenuTool)) return;\r\n//     switch (val) {\r\n//         // case \"Paste\": diagram.commandHandler.pasteSelection(diagram.lastInput.documentPoint); break;\r\n//         case \"addChildNodeMenu\":\r\n//             tdAddChildNode(obj);\r\n//             break;\r\n//         case \"addLevelNodeMenu\":\r\n//             tdAddLevelNode(obj);\r\n//             break;\r\n//         case \"changeDipanBgMenu\":\r\n//             changeDipanBackgroundImg();\r\n//             break;\r\n//         case \"removeDipanBgMenu\":\r\n//             removeDipanBackgroundImg(obj);\r\n//             break;\r\n//         case \"deleteNodeMenu\":\r\n//             myDiagram.toolManager.textEditingTool.doCancel();\r\n//             myDiagram.commandHandler.deleteSelection();\r\n//             break;\r\n//         case \"addNodePictureMenu\":\r\n//             // jQuery(\"#insertimage\").modal('show');\r\n//             // document.getElementById('insertimage').modal('show');\r\n//             break; //特殊处理\r\n//         case \"removeNodePictureMenu\":\r\n//             removeNodePicture(obj);\r\n//             break;\r\n//         case \"clearNodeTextMenu\":\r\n//             var node = myDiagram.selection.first();\r\n//             if (node) {\r\n//                 myDiagram.startTransaction();\r\n//                 myDiagram.model.setDataProperty(node.data, \"text\", \"\");\r\n//                 myDiagram.commitTransaction();\r\n//             };\r\n//             break;\r\n//         case \"locateRootNodeMenu\":\r\n//             centerNode(obj);\r\n//             break;\r\n//         case \"showAllNodesMenu\":\r\n//             zoomToFit(obj);\r\n//             break;\r\n//         case \"removeOutCycleMenu\":\r\n//             removeOutCycle(obj);\r\n//             break;\r\n//         case \"centerPictureMenu\":\r\n//             centerPicture(obj);\r\n//             break;\r\n//         case \"equalWidthHeightPictureMenu\":\r\n//             equalWidthHeightPicture(obj);\r\n//             break;\r\n//         case \"bringToTopMenu\":\r\n//             bringToLayer(\"Foreground\", obj);\r\n//             break;\r\n//         case \"bringToBackgroundMenu\":\r\n//             bringToLayer(\"Background\", obj);\r\n//             break;\r\n//         case \"bringUpMenu\":\r\n//             bringToLayer(null, obj);\r\n//             break;\r\n//         case \"layoutGroupMenu\":\r\n//             autoLayoutAll(true, obj);\r\n//             break;\r\n\r\n//         case \"insertTextMenu\":\r\n//             insertTextNode(obj);\r\n//             break;\r\n//         case \"duplicateNode\":\r\n//             duplicateNode(obj);\r\n//             break; // 复制节点\r\n//         case \"insertTianpanMenu\":\r\n//             myDiagram.toolManager.clickCreatingTool.insertPart(myDiagram.lastInput.documentPoint);\r\n//             break;\r\n//         //固定节点\r\n//         case \"fixPictureMenu\":   \r\n//         case \"activePictureMenu\":\r\n//             //var node = myDiagram.findPartAt(myDiagram.lastInput.documentPoint, false);\r\n//             var node = myDiagram.selection.first();\r\n//             myDiagram.startTransaction();\r\n//             myDiagram.model.setDataProperty(node.data, \"selectable\", node.data.selectable != undefined ? (!node.data.selectable) : false);\r\n//             myDiagram.commitTransaction();\r\n//             break;\r\n//         case \"orderChildNode\":\r\n//             orderChildNode(obj);\r\n//             break;\r\n//         case \"clearOrderChildNode\":\r\n//             clearOrderChildNode(obj);\r\n//             break;\r\n//         case \"delYunpanAxis\":\r\n//             yunpan.yunpandel(obj);\r\n//             break;\r\n//         case \"addYunpanAxis\":\r\n//             var node = myDiagram.selection.first();\r\n//             if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n//                 yunpan.addy(obj)\r\n//             }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n//                 yunpan.addx(obj)\r\n//             }; \r\n//             break;\r\n//         case \"addLevelDipanNode\":\r\n//             if(myDiagram.selection.first().data.istemp){\r\n//                 return\r\n//             }\r\n//             obj.addFollowerGround();\r\n//             break;\r\n//         case \"addChildDipanNode\":\r\n//             var node = myDiagram.selection.first();\r\n//                 if(node.data.parent){\r\n//                     var parentNode = node.diagram.findNodeForKey(node.data.parent);\r\n//                     if(parentNode.data.istemp){\r\n//                         return\r\n//                     }\r\n//                 }\r\n//             obj.addNewCircle(obj);\r\n//             break;\r\n//         case \"deleteDipanNode\":\r\n//         // myDiagram.commandHandler.deleteSelection();\r\n//         obj.deleteSelection();\r\n//         break;\r\n//     }\r\n//     diagram.currentTool.stopTool();\r\n// }\r\n\r\n\r\n// 清除节点的关系属性，比如父节点索引，子节点索引等\r\nfunction clearRelProperty(data) {\r\n    data.level = 0;\r\n    delete data.prev;\r\n    delete data.isparent;\r\n    delete data.next;\r\n    delete data.group;\r\n    delete data.parent;\r\n    return data;\r\n}\r\n\r\n// 复制单个节点\r\nfunction duplicateNode(obj) {\r\n    var myDiagram = obj.diagram;\r\n    var node = myDiagram.selection.first();\r\n    if (!node) return;\r\n    myDiagram.startTransaction();\r\n    var newData = myDiagram.model.copyNodeData(node.data);\r\n    var location = node.location.copy();\r\n    location.offset(50, -50);\r\n    newData.loc = go.Point.stringify(location);\r\n    newData.level = 0;\r\n    newData = clearRelProperty(newData);\r\n    myDiagram.model.addNodeData(newData);\r\n    myDiagram.commitTransaction();\r\n}\r\n\r\nTrtd.go = go;\r\n\r\n// if (typeof window !== 'undefined') {\r\n// \tif(window.Trtd){\r\n//         window.Trtd.dipan = Trtd;\r\n//     } else{\r\n//         window.Trtd = {\r\n//             dipan: Trtd\r\n//         }\r\n//     }\r\n// }\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/dipan.js","\r\nvar Trtd_tianpan = require('./tianpan')\r\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\n\r\nclass Trtd extends Trtd_tianpan {\r\n    constructor(div, config){\r\n        super(div, config)\r\n\t\t// this.config = config;\r\n\t\t// this.modelChangedListener = config.modelChangedListener;\r\n\t\t// this.type = config.type;\r\n\t\t// this.diagram = {};\r\n        // this.model = config.model;\r\n        // this.tpid = config.tpid||Date.now();\r\n        // this.InitialFontSize = 18\r\n        // this.tdCurrentTheme = {\r\n        //     id: 6,\r\n        //     borderWidth: 2,\r\n        //     borderColor: \"black\",\r\n        //     groupColor: \"rgba(0,0,0,0)\",\r\n        //     groupStroke: \"rgba(0,0,0,0)\",\r\n        //     groupStrokeWidth: 0,\r\n        //     themeName: \"黑白\",\r\n        //     linkColor: \"black\",\r\n        //     colorRange: \"white\"\r\n        // }\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n\r\n     /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n\r\n\r\n        // myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\r\n        // myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", );\r\n        var myDiagram = this.diagram\r\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\r\n\r\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\r\n\r\n        \r\n    }\r\n}\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/jin.js","\r\nvar Trtd_tianpan = require('./tianpan')\r\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\n\r\nclass Trtd extends Trtd_tianpan {\r\n    constructor(div, config){\r\n        super(div, config)\r\n\t\t// this.config = config;\r\n\t\t// this.modelChangedListener = config.modelChangedListener;\r\n\t\t// this.type = config.type;\r\n\t\t// this.diagram = {};\r\n        // this.model = config.model;\r\n        // this.tpid = config.tpid||Date.now();\r\n        // this.InitialFontSize = 18\r\n        // this.tdCurrentTheme = {\r\n        //     id: 6,\r\n        //     borderWidth: 2,\r\n        //     borderColor: \"black\",\r\n        //     groupColor: \"rgba(0,0,0,0)\",\r\n        //     groupStroke: \"rgba(0,0,0,0)\",\r\n        //     groupStrokeWidth: 0,\r\n        //     themeName: \"黑白\",\r\n        //     linkColor: \"black\",\r\n        //     colorRange: \"white\"\r\n        // }\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n\r\n     /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n\r\n        // myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\r\n        // myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", );\r\n        var myDiagram = this.diagram\r\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\r\n\r\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\r\n\r\n        \r\n    }\r\n}\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/huo.js","\r\nvar Trtd_tianpan = require('./tianpan')\r\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\n\r\nclass Trtd extends Trtd_tianpan {\r\n    constructor(div, config){\r\n        super(div, config)\r\n\t\t// this.config = config;\r\n\t\t// this.modelChangedListener = config.modelChangedListener;\r\n\t\t// this.type = config.type;\r\n\t\t// this.diagram = {};\r\n        // this.model = config.model;\r\n        // this.tpid = config.tpid||Date.now();\r\n        // this.InitialFontSize = 18\r\n        // this.tdCurrentTheme = {\r\n        //     id: 6,\r\n        //     borderWidth: 2,\r\n        //     borderColor: \"black\",\r\n        //     groupColor: \"rgba(0,0,0,0)\",\r\n        //     groupStroke: \"rgba(0,0,0,0)\",\r\n        //     groupStrokeWidth: 0,\r\n        //     themeName: \"黑白\",\r\n        //     linkColor: \"black\",\r\n        //     colorRange: \"white\"\r\n        // }\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n\r\n     /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n        var myDiagram = this.diagram\r\n\r\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\r\n\r\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\r\n\r\n        \r\n    }\r\n}\r\n\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/shui.js","\r\nvar Trtd_tianpan = require('./tianpan')\r\nvar $ = go.GraphObject.make;\r\n\r\n// var createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\n\r\nclass Trtd extends Trtd_tianpan {\r\n    constructor(div, config){\r\n        super(div, config)\r\n        this.initDiagramYun(div, config)\r\n\t\t// this.config = config;\r\n\t\t// this.modelChangedListener = config.modelChangedListener;\r\n\t\t// this.type = config.type;\r\n\t\t// this.diagram = {};\r\n        // this.model = config.model;\r\n        // this.tpid = config.tpid||Date.now();\r\n        // this.InitialFontSize = 18\r\n        // this.tdCurrentTheme = {\r\n        //     id: 6,\r\n        //     borderWidth: 2,\r\n        //     borderColor: \"black\",\r\n        //     groupColor: \"rgba(0,0,0,0)\",\r\n        //     groupStroke: \"rgba(0,0,0,0)\",\r\n        //     groupStrokeWidth: 0,\r\n        //     themeName: \"黑白\",\r\n        //     linkColor: \"black\",\r\n        //     colorRange: \"white\"\r\n        // }\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n\r\n    initDiagramYun(div, config){\r\n        // this.diagram.contextMenu = ()=>{\r\n        //     var that = this\r\n        //     return getYunpanNodeContextMenu;\r\n        // },\r\n        var myDiagram = this.diagram;\r\n        var defaultConfig = {\r\n            contextMenu:this.getYunpanNodeContextMenu,\r\n            \"animationManager.isEnabled\": false,\r\n        }\r\n        this.diagram.commandHandler.doKeyDown = ()=>{\r\n            var that = this\r\n            return yunpanDokeyDownFn(that);\r\n        }\r\n        var diagramConfig = Object.assign(defaultConfig, config.diagramConfig);\r\n        this.diagram.setProperties(diagramConfig);\r\n        this.addNodeTemplate();\r\n        return myDiagram\r\n    }\r\n     /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n\r\n        var that = this;\r\n        var myDiagram = this.diagram\r\n        myDiagram.nodeTemplateMap.add(\"yunpanx\",createNodeTemplatex(that));\r\n        myDiagram.nodeTemplateMap.add(\"yunpany\",createNodeTemplatey(that));\r\n        myDiagram.nodeTemplateMap.add(\"y\",yTemplate(that));\r\n        myDiagram.nodeTemplateMap.add(\"x\",yTemplate(that));\r\n        myDiagram.nodeTemplateMap.add(\"ytext\",tTemplate());\r\n        myDiagram.nodeTemplateMap.add(\"xtext\",tTemplate());\r\n        myDiagram.nodeTemplateMap.add(\"LogicXor\",LogicXor(that));\r\n        myDiagram.nodeTemplateMap.add(\"addtextTemplate\",addtextTemplate());\r\n\r\n        \r\n    }\r\n}\r\n\r\n// 返回云盘(轴)\r\nfunction createNodeTemplatex (that) {\r\n    return $(go.Node, \"Vertical\",\r\n        {\r\n            movable:false,\r\n            //allowMove:false,\r\n            //selectable:false,\r\n            locationSpot: go.Spot.Bottom,\r\n            location: new go.Point(0,0),\r\n            //locationObjectName: \"LINE\",\r\n            angle: 90,\r\n            click: function(e, node) {\r\n                console.log(node.data)\r\n            \r\n                //  yunpanmune(e, node)\r\n                \r\n            },\r\n            //selectionAdorned:false,//取消选择的默认边框\r\n            selectionAdornmentTemplate: function() {\r\n                var $ = go.GraphObject.make;\r\n              \r\n                    return $(go.Adornment, \"Spot\",\r\n                        $(go.Panel, \"Auto\",\r\n                            \r\n                            $(go.Shape, {\r\n                                figure: \"Linev\", \r\n                                // fill: 'rgba(255,0,120,0.2)', \r\n                                fill:\"blue\",\r\n                                stroke: \"blue\", \r\n                                strokeWidth: 2,\r\n                                \r\n                            },\r\n                            ),\r\n                            $(go.Shape,\r\n                            { \r\n                                // geometry: go.Geometry.parse(\"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z\", false).rotate(90),\r\n                                geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n                                fill: \"blue\",\r\n                                stroke: \"blue\",\r\n                                strokeWidth: 0,\r\n                                alignment: new go.Spot(0.5, 0, 0, 0)\r\n                            }\r\n                            ),\r\n                            \r\n                            $(go.Placeholder) // this represents the selected Node\r\n\r\n                        ),\r\n\r\n                    );\r\n              \r\n                \r\n        \r\n            }(),\r\n        \r\n            //  contextMenu: function(e,node){\r\n            //     var diagram = node.diagram;\r\n            //     console.log(\"node.data\",node)\r\n            //     console.log(\"node.datanode.datanode.datanode.data\")\r\n            //     interactions.nodeContextMenu\r\n            //     //diagram.model.setDataProperty(node.data, \"stroke\",\"blue\");  \r\n            // },\r\n            contextMenu:getYunpanNodeContextMenu,\r\n\r\n            \r\n            mouseEnter:function(e,node){\r\n                var diagram = node.diagram\r\n                //diagram.model.setDataProperty(node.data, \"stroke\",\"blue\");  \r\n            },\r\n            mouseLeave:function(e,node){\r\n                //console.log(node.data)\r\n                var diagram = e.diagram\r\n                //diagram.model.setDataProperty(node.data, \"stroke\",\"#8799c4\");\r\n            },\r\n        },\r\n        new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n        new go.Binding(\"location\", \"loc\",go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        // 箭头  \r\n        $(go.Shape, \r\n        { \r\n            // shape: \"BackwardV\",\r\n            // \"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z\"\r\n            // figure: \"Backward\",\r\n            geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n            fill: \"rgb(135,153,196)\",\r\n            stroke: \"#8799c4\",\r\n            strokeWidth: 0,\r\n            strokeDashArray: [0, 0],\r\n        },\r\n        new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n        new go.Binding(\"fill\", \"stroke\").makeTwoWay(),\r\n        ),\r\n        // 坐标 \r\n        $(go.Shape,{ \r\n            name: 'LINE',\r\n            figure: \"Linev\",\r\n            //geometryString:geometryString,\r\n            //geometry: Y_geometry,\r\n            //fill: \"#8799c4\",\r\n            stroke: \"#8799c4\",\r\n            strokeWidth:2,\r\n        \r\n            strokeDashArray: [4, 2],\r\n            // position: new go.Point(0, 0)\r\n            // desiredSize: new go.Size(10, 100)\r\n        },\r\n        //new go.Binding(\"fill\", \"fill\").makeTwoWay(),\r\n        new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n        new go.Binding(\"strokeDashArray\", \"strokeDashArray\").makeTwoWay(),\r\n        new go.Binding(\"geometryString\", \"geometryString\").makeTwoWay(),\r\n        new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n        // new go.Binding(\"stroke\", \"isSelected\", function(sel,node) {\r\n        //     console.log(\"2333\")\r\n        //     if (sel) return \"red\"; else return \"stroke\";\r\n            \r\n        // }).ofObject(\"\")\r\n        new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay()\r\n        ),\r\n        \r\n    )\r\n\r\n    \r\n}\r\nfunction createNodeTemplatey (that) {\r\n    return $(go.Node, \"Vertical\",\r\n        {\r\n            movable:false,\r\n            //allowMove:false,\r\n            //selectable:false,\r\n            locationSpot: go.Spot.Bottom,\r\n            location: new go.Point(0,0),\r\n            //locationObjectName: \"LINE\",\r\n            // angle: 0,\r\n            click: function(e, node) {\r\n                console.log(node.data)\r\n            \r\n                //  yunpanmune(e, node)\r\n                \r\n            },\r\n            //selectionAdorned:false,//取消选择的默认边框\r\n            selectionAdornmentTemplate: function() {\r\n                var $ = go.GraphObject.make;\r\n              \r\n                    return $(go.Adornment, \"Spot\",\r\n                        $(go.Panel, \"Auto\",\r\n                            \r\n                            $(go.Shape, {\r\n                                figure: \"Linev\", \r\n                                fill: 'rgba(255,0,120,0.2)', \r\n                                stroke: \"blue\", \r\n                                strokeWidth: 2, \r\n                            },\r\n                            ),\r\n                            $(go.Shape,\r\n                            { \r\n                                // geometry: go.Geometry.parse(\"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z\", false).rotate(90),\r\n                                geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n                                fill: \"blue\",\r\n                                stroke: \"blue\",\r\n                                strokeWidth: 0,\r\n                                alignment: new go.Spot(0.5, 0, 0, 0)\r\n                            }\r\n                            ),\r\n                            $(go.Placeholder) // this represents the selected Node\r\n                        ),\r\n                    );\r\n            }(),\r\n        \r\n            //  contextMenu: function(e,node){\r\n            //     var diagram = node.diagram;\r\n            //     console.log(\"node.data\",node)\r\n            //     console.log(\"node.datanode.datanode.datanode.data\")\r\n            //     interactions.nodeContextMenu\r\n            //     //diagram.model.setDataProperty(node.data, \"stroke\",\"blue\");  \r\n            // },\r\n            contextMenu:getYunpanNodeContextMenu,\r\n            mouseEnter:function(e,node){\r\n                var diagram = node.diagram\r\n                //diagram.model.setDataProperty(node.data, \"stroke\",\"blue\");  \r\n            },\r\n            mouseLeave:function(e,node){\r\n                //console.log(node.data)\r\n                var diagram = e.diagram\r\n                //diagram.model.setDataProperty(node.data, \"stroke\",\"#8799c4\");\r\n            },\r\n        },\r\n        new go.Binding(\"location\", \"loc\",go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        // 箭头  \r\n        $(go.Shape, \r\n        {\r\n            geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n            fill: \"rgb(135,153,196)\",\r\n            stroke: \"#8799c4\",\r\n            strokeWidth: 0,\r\n            strokeDashArray: [0, 0],\r\n        },\r\n        new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n        new go.Binding(\"fill\", \"stroke\").makeTwoWay(),\r\n        ),\r\n        // 坐标 \r\n        $(go.Shape,{ \r\n            name: 'LINE',\r\n            figure: \"Linev\",\r\n            stroke: \"#8799c4\",\r\n            strokeWidth:2,\r\n            strokeDashArray: [4, 2],\r\n        },\r\n        new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n        new go.Binding(\"strokeDashArray\", \"strokeDashArray\").makeTwoWay(),\r\n        new go.Binding(\"geometryString\", \"geometryString\").makeTwoWay(),\r\n        new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n        new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay()\r\n        ),\r\n        \r\n    )\r\n\r\n    \r\n}\r\n\r\n\r\n\r\n\r\n// 返回云盘(xy坐标轴)\r\nfunction yTemplate(that){\r\n    var $ = go.GraphObject.make;\r\n    return $(go.Node, \"Vertical\",\r\n    {\r\n        movable:false,\r\n        locationSpot: go.Spot.Bottom,\r\n        location: new go.Point(0,0),\r\n        //locationObjectName: \"LINE\",\r\n        angle: 0,\r\n        //selectionAdorned:false,//取消选择的默认边框\r\n        //desiredSize: new go.Size(400, 800),\r\n        click: function(e, node) {\r\n            console.log(node.data) \r\n        },\r\n        //点击\r\n        selectionAdornmentTemplate: function() {\r\n            var $ = go.GraphObject.make;\r\n                return $(go.Adornment, \"Spot\",\r\n                    $(go.Panel, \"Auto\",\r\n                        $(go.Shape, {\r\n                            figure: \"Linev\", \r\n                            // fill: 'rgba(255,0,120,0.2)', \r\n                            fill: \"blue\",\r\n                            stroke: \"blue\", \r\n                            strokeWidth: 2,\r\n                        },\r\n                        ),\r\n                        $(go.Shape,\r\n                        { \r\n                            geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n                            // fill: 'rgba(255,0,120,0.2)', \r\n                            fill: \"blue\",\r\n                            stroke: \"blue\",\r\n                            strokeWidth: 2,\r\n                            alignment: new go.Spot(0.5, 0, 0, 0)\r\n                        }\r\n                        ),\r\n                        \r\n                        $(go.Placeholder) // this represents the selected Node\r\n\r\n                    ),\r\n\r\n                );\r\n        }(),\r\n        // contextClick:function(e, node) {\r\n        //     addaxis(e, node)\r\n        // },\r\n        mouseHover:function(e,node){   \r\n            // that.showNodeRemarkTips(e, node);\r\n        },\r\n        mouseEnter:function(e,node){\r\n            var diagram = node.diagram\r\n            diagram.model.setDataProperty(node.data, \"stroke\",\"blue\");\r\n            diagram.model.setDataProperty(node.data, \"fill\",\"blue\")   \r\n  \r\n        },\r\n        mouseLeave:function(e,node){\r\n            //console.log(node.data)\r\n            var diagram = node.diagram\r\n         \r\n                that.removeNodeRemarkTips(); \r\n            \r\n                diagram.model.setDataProperty(node.data, \"stroke\",\"#8799c4\");\r\n                diagram.model.setDataProperty(node.data, \"fill\",\"#8799c4\");\r\n            //removeNodeRemarkTips()   \r\n        }, \r\n    },\r\n    new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n    new go.Binding(\"location\", \"loc\",go.Point.parse).makeTwoWay(go.Point.stringify),\r\n    // 箭头  \r\n    $(go.Shape, \r\n    { \r\n        // shape: \"BackwardV\",\r\n        // \"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z\"\r\n        //figure: \"BackwardV\",\r\n        geometry: go.Geometry.parse(\"M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z\", true).rotate(180).scale(0.0117,0.0117),\r\n        fill: \"#8799c4\",\r\n        stroke: \"#8799c4\",\r\n        // strokeWidth: 0,\r\n        // strokeDashArray: [0, 0],\r\n        // position: new go.Point(-6, -1)\r\n    },\r\n    new go.Binding(\"fill\", \"fill\").makeTwoWay(),\r\n    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n    ),\r\n    // 坐标 \r\n    $(go.Shape,{ \r\n        name: 'LINE',\r\n        //geometry: Y_geometry,\r\n        width:0,\r\n        height:1000,\r\n        fill: \"#8799c4\",\r\n        stroke: \"#8799c4\",\r\n        strokeWidth: 2,\r\n       \r\n        //strokeDashArray: [4, 2],\r\n        // position: new go.Point(0, 0)\r\n        // desiredSize: new go.Size(10, 100)\r\n    },\r\n    new go.Binding(\"height\", \"height\").makeTwoWay(),\r\n    new go.Binding(\"fill\", \"fill\").makeTwoWay(),\r\n    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(),\r\n    new go.Binding(\"strokeDashArray\", \"strokeDashArray\").makeTwoWay(),\r\n    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(),\r\n    ),\r\n    \r\n   \r\n    )\r\n}\r\n\r\n\r\n//返回云盘文本\r\nfunction tTemplate(){\r\n    var $ = go.GraphObject.make;\r\n    return $(go.Node, \"Vertical\",\r\n    {\r\n        movable:false,\r\n        //locationSpot:locationSpot,\r\n        //locationSpot: go.Spot.Right,\r\n        selectionAdorned:false,//取消选择的默认边框\r\n        click: function(e, node) {\r\n            // showNodeToolBar(e,node);\r\n            console.log(node.data)\r\n        },\r\n       \r\n    },\r\n    //(\"locationSpot\", \"locationSpot\",node.data.group > 0 ? \"go.Spot.Right\":\"go.Spot.Top\").makeTwoWay(),\r\n    //new go.Binding(\"locationSpot\", \"locationSpot\",function(v,node)),\r\n    new go.Binding(\"location\", \"loc\",go.Point.parse).makeTwoWay(go.Point.stringify),\r\n    new go.Binding(\"locationSpot\", \"dir\", function(d) { return spotConverter(d, false); }),\r\n    $(go.Panel, \"Vertical\",\r\n    //{ width: 100, defaultStretch: go.GraphObject.None },\r\n    $(go.TextBlock, {\r\n            name: \"TEXT\",\r\n            alignment: new go.Spot(0, 1),\r\n            // font: \"bold 14px arial,\",\r\n            font: \"14px 微软雅黑\",\r\n            width:70,\r\n            // height:40,\r\n            //maxLines:7,\r\n            // spacingAbove: 4,\r\n            // spacingBelow: 4,\r\n            // editable :false,//禁止编辑\r\n            wrap: go.TextBlock.WrapDesiredSize,\r\n            // margin:5,\r\n            textAlign: \"center\",\r\n            // verticalAlignment :\"left\",\r\n            editable: true,\r\n            isMultiline: false,//单行\r\n            // margin: 10, \r\n            margin: 0, \r\n            stroke: \"black\",\r\n            isMultiline: true,\r\n            //overflow: go.TextBlock.OverflowClip,\r\n            //wrap: go.TextBlock.WrapDesiredSize,\r\n            alignment: go.Spot.Right,\r\n            portId: \"TEXT\",\r\n            stretch: go.GraphObject.Fill,\r\n            //background:\"green\"\r\n            // DoubleClick : false\r\n            \r\n        },\r\n        new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n        new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n        new go.Binding(\"font\", \"font\").makeTwoWay(),\r\n        new go.Binding(\"margin\", \"margin\").makeTwoWay()\r\n        )\r\n    )\r\n    )}\r\n \r\n\r\nfunction spotConverter(dir, from) {\r\n    if (dir === \"right\") {\r\n    return  go.Spot.Right;\r\n    } else if(dir === \"top\") {\r\n    return (go.Spot.Top);\r\n    }\r\n}\r\n\r\n//返回云盘增加文本\r\nfunction addtextTemplate() {\r\n    var $ = go.GraphObject.make;\r\n    var properties = {\r\n        figure: \"Rectangle\",\r\n        fill: \"rgba(0,0,0,0)\",\r\n        strokeWidth: 1,\r\n        stroke: \"rgba(0,0,0,0)\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n\r\n    return $(go.Node, \"Spot\", {\r\n            \"_controlExpand\": true,\r\n            layerName: \"Foreground\",\r\n            locationSpot: go.Spot.Center,\r\n            resizeCellSize: new go.Size(10, 10),\r\n            locationObjectName: \"SHAPE\",\r\n            resizable: true,\r\n            resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n            rotatable: true,\r\n            location: new go.Point(0, 0),\r\n            toMaxLinks: 1,\r\n            click: function(e, node) {\r\n                console.log(node.data)\r\n                // showNodeToolBar(e,node);\r\n            },\r\n            layoutConditions: go.Part.LayoutStandard,\r\n            alignment: go.Spot.Center,\r\n            alignmentFocus: go.Spot.Center\r\n        },\r\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        new go.Binding(\"isShadowed\", \"isShadowed\").makeTwoWay(),\r\n        new go.Binding(\"angle\", \"angle\").makeTwoWay(),\r\n        new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n        new go.Binding(\"layerName\", \"layerName\", function(v, d) {\r\n            return v ? v : \"\";\r\n        }).makeTwoWay(function(v) {\r\n            return v;\r\n        }),\r\n        $(go.Shape, {\r\n                strokeDashArray: null,\r\n                // strokeDashOffset:10,\r\n                name: \"SHAPE\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                fromLinkable: true,\r\n                toLinkable: true,\r\n                cursor: \"pointer\",\r\n                minSize: new go.Size(50, 50),\r\n                strokeWidth: 2,\r\n                stroke: \"rgba(0,0,0,0)\",\r\n                portId: \"\"\r\n            },\r\n            new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v) {\r\n                return [v.split()[0], v.split()[1]];\r\n            }).makeTwoWay(function(v) {\r\n                return v[0] + \" \" + v[1];\r\n            }), //保留，设置边线样式\r\n            new go.Binding(\"fill\", \"fill\", function(v, obj) {\r\n                return v instanceof go.Brush ? v.color : v;\r\n            }).makeTwoWay(),\r\n            // new go.Binding(\"fill\", \"isSelected\", function(s, obj) { return s ? \"red\" : obj.part.data.color; }).ofObject()),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                //alert(v);\r\n                return v;\r\n            }).makeTwoWay(function(v) {\r\n                return v;\r\n            }),\r\n            new go.Binding(\"stroke\", \"stroke\", function(v) {\r\n                return v instanceof go.Brush ? v.stroke : v;\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"strokeWidth\", \"strokeWidth\", function(d) {\r\n                return d;\r\n            }).makeTwoWay(function(d) {\r\n                return d;\r\n            }),\r\n            new go.Binding(\"figure\", \"figure\").makeTwoWay(), {\r\n                figure: properties.figure,\r\n                fill: properties.fill,\r\n                strokeWidth: properties.strokeWidth,\r\n                stroke: properties.stroke\r\n            }\r\n        ),\r\n        $(go.Shape, {\r\n                name: \"SHAPE_Back\",\r\n                figure: \"Rectangle\",\r\n                fill: \"rgba(0,0,0,0)\",\r\n                // fromLinkable: true,\r\n                // toLinkable: true,\r\n                strokeWidth: 0\r\n            },\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"height\", \"height\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\")\r\n        ),\r\n        $(go.TextBlock, {\r\n                name: \"TEXT\",\r\n                alignment: new go.Spot(0.5, 0.5),\r\n                font: \"bold \" + 18 + \"px 幼圆\",\r\n                editable: true,\r\n                //margin: 3, editable: true,\r\n                stroke: \"black\",\r\n                isMultiline: true,\r\n                overflow: go.TextBlock.OverflowClip,\r\n                wrap: go.TextBlock.WrapDesiredSize,\r\n                textAlign: \"center\",\r\n                spacingAbove: 4,\r\n                spacingBelow: 4,\r\n                portId: \"TEXT\",\r\n                stretch: go.GraphObject.Fill\r\n            },\r\n            new go.Binding(\"textAlign\", \"textAlign\", function(v) {\r\n                return _.contains(['start', 'center', 'end'], v) ? v : \"center\";\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingAbove\", \"spacingline\", function(v) {\r\n                return tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"spacingBelow\", \"spacingline\", function(v) {\r\n                return tdTransToNum(v, 4);\r\n            }).makeTwoWay(),\r\n            new go.Binding(\"width\", \"width\", function(v) {\r\n                return v;\r\n            }).ofObject(\"SHAPE\"),\r\n            // new go.Binding(\"height\", \"height\", function (v) {\r\n            //   return v;\r\n            // }).ofObject(\"SHAPE\"),\r\n            new go.Binding(\"text\", \"text\").makeTwoWay(),\r\n            new go.Binding(\"stroke\", \"textStroke\").makeTwoWay(),\r\n            new go.Binding(\"font\", \"font\").makeTwoWay()\r\n        )\r\n    );\r\n}\r\n\r\n\r\n\r\n//提示框\r\n  var shapeShowblur = null;\r\n  var circleStroke = null;\r\n\r\n  function showToolTip(obj, diagram) {\r\n    var box = document.getElementById(\"infoBoxHolder\");\r\n    var contextMenu= document.getElementsByClassName(\"context-menu\")[0];\r\n    //  console.log(contextMenu)  \r\n    \r\n    if (obj !== null) {\r\n      var node = obj.part;\r\n      var e = diagram.lastInput;\r\n      var circle = node.findObject(\"CIRCLE\");\r\n      var shape= node.findObject(\"SHAPE\"); \r\n    //   console.log(circle)\r\n    if(circle !== null) circle.stroke = \"#57617a\";\r\n    if(shape !== null)  shape.shadowBlur = 10;\r\n\r\n    if (shapeShowblur !== null && shapeShowblur !== shape) {\r\n        \r\n        shapeShowblur.shadowBlur = 0;\r\n        shapeShowblur = shape;\r\n  \r\n        if(box&&(contextMenu.style.display === \"\"||contextMenu.style.display === \"none\")){\r\n            box.style.display = \"block\";\r\n        }\r\n    } else{\r\n        \r\n        shapeShowblur = shape;\r\n    }\r\n\r\n      \r\n      \r\n      if (circleStroke !== null && circleStroke !== circle) \r\n      circleStroke.stroke = null;\r\n      circleStroke = circle;\r\n        if(box&&(contextMenu.style.display === \"\"||contextMenu.style.display === \"none\")){\r\n            box.style.display = \"block\";\r\n        }\r\n    } else {\r\n      if (circleStroke !== null) \r\n      circleStroke.stroke = null;\r\n      circleStroke = null;\r\n    //   document.getElementById(\"infoBox\").innerHTML = \"\";\r\n     \r\n      \r\n    }\r\n\r\n    \r\n  }\r\n    \r\n\r\n  \r\n\r\n\r\n\r\n\r\n\r\n// myDiagram.nodeTemplate =\r\n// $(go.Node,\r\n//   $(go.Shape, \"Circle\",\r\n//     {\r\n//       desiredSize: new go.Size(28, 28),\r\n//       fill: radBrush, strokeWidth: 0, stroke: null\r\n//     }), // no outline\r\n//   {\r\n//     locationSpot: go.Spot.Center,\r\n//     click: showArrowInfo,  // defined below\r\n//     toolTip:  // define a tooltip for each link that displays its information\r\n//         $(\"ToolTip\",\r\n//           $(go.TextBlock, { margin: 4 },\r\n//             new go.Binding(\"text\", \"\", infoString).ofObject())\r\n//         )\r\n//   }\r\n// );\r\n\r\n//返回云盘图标\r\nfunction LogicXor(that){\r\n    var $ = go.GraphObject.make;\r\n    return $(go.Node, \"Vertical\",\r\n        {\r\n            movable:false,\r\n            locationSpot: go.Spot.Top,\r\n            location: new go.Point(860,5),\r\n            mouseHover:function(e,node){\r\n                that.showNodeRemarkTips(e, node);\r\n            },\r\n            mouseLeave:function(e,node){\r\n                that.removeNodeRemarkTips();    \r\n            },\r\n            click:function(e,node){\r\n             \r\n                console.log(node.data)\r\n                console.log(Number(node.data.loc.split(' ')[1])>0)\r\n                if(Number(node.data.loc.split(' ')[1])>0){\r\n                    addy(e)\r\n                }else{\r\n                    addx(e)\r\n                }\r\n            }\r\n        },     \r\n        new go.Binding(\"location\", \"loc\",go.Point.parse).makeTwoWay(go.Point.stringify),\r\n        $(go.Shape, {\r\n            figure: \"LogicXor\", \r\n            stroke: \"#8799c4\", \r\n            width:30,\r\n            strokeWidth: 2,\r\n            \r\n        },\r\n        )\r\n\r\n    )\r\n}\r\n\r\nfunction yunpanDokeyDownFn (that) {\r\n    // console.log('myDiagram:', diagram);\r\n    // var myDiagram = diagram.diagram;\r\n    // var e = myDiagram.lastInput;\r\n    // var cmd = myDiagram.commandHandler;\r\n    // var node = myDiagram.selection.first();\r\n    var diagram = that.diagram\r\n    // var that = this;\r\n    var myDiagram = that.diagram;\r\n    var e = myDiagram.lastInput;\r\n    var node = myDiagram.selection.first();\r\n    var cmd = myDiagram.commandHandler;\r\n    if (e.key === \"Del\"|| e.event.keyCode === 8) { \r\n        // console.log(myDiagram.model.nodeDataArray)\r\n        console.log(\"0\",myDiagram.model.nodeDataArray)\r\n        del(e)    \r\n    }\r\n\r\n    if(e.event.ctrlKey){\r\n        //增加y轴\r\n        if (e.event.keyCode === 89) {\r\n            if((node&&node.data.category!== \"addtextTemplate\")||(!node)){\r\n                addy(e);\r\n            }\r\n        }\r\n        //增加x轴\r\n        if (e.event.keyCode === 88) {\r\n            \r\n            if((node&&node.data.category!== \"addtextTemplate\")||(!node)){\r\n                addx(e);\r\n            }\r\n        }\r\n        e.bubbles = false; \r\n        }\r\n\r\n    }\r\n\r\n\r\nfunction getYunpanNodeContextMenu() {\r\n\r\n    return $(go.Adornment, \"Vertical\",\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"删除 DEl\"), {\r\n                click: function(e,node) {\r\n                    del(e);\r\n                }\r\n            }),\r\n        $(\"ContextMenuButton\",\r\n            $(go.TextBlock, \"增加 CTRL+X/Y\"), {\r\n                click: function(e, node) {\r\n                    if(node.data.loc.split(\" \")[1] === \"0\"&&node.data.category!==\"x\"){\r\n                        addy(e)\r\n                    }else if(node.data.loc.split(\" \")[0] === \"0\"&&node.data.category!==\"y\"){\r\n                        addx(e)\r\n                    }; \r\n                }\r\n            })\r\n        \r\n    );\r\n}\r\n//云盘增加y轴节点\r\nfunction addy(e){\r\n    let myDiagram = e.diagram;\r\n    let node = myDiagram.selection.first();\r\n    let nodeDataArray = myDiagram.model.nodeDataArray;\r\n    console.log(nodeDataArray)\r\n    let yl = 0;\r\n    let stroke =\"#8799c4\";\r\n    let strokeDashArray=[4, 2];\r\n    let loc = 0;\r\n    let locy = '';\r\n    let height = 260 ;\r\n    nodeDataArray.forEach(function(data){\r\n        \r\n        if(data.category === \"y\"){\r\n            yl = data.height - 10  \r\n        }\r\n        \r\n        if(data.category===\"x\"){\r\n        //console.log(data)\r\n        height = data.height +200\r\n        myDiagram.model.startTransaction(\"addheight\");\r\n        myDiagram.model.setDataProperty(data, \"height\",height);\r\n        myDiagram.model.commitTransaction(\"addheight\");\r\n        }\r\n        if(data.category === 'LogicXor'){\r\n            let locL = +data.loc.split(' ')[0]\r\n            if(locL>0){\r\n                let loclc = (locL + 200) + \" 5\" \r\n                myDiagram.model.startTransaction();\r\n                myDiagram.model.setDataProperty(data, \"loc\",loclc);\r\n                myDiagram.model.commitTransaction();\r\n            }\r\n            \r\n        }\r\n    })\r\n    nodeDataArray.forEach(function(data){\r\n        if(data.loc.split(' ')[0] === '0'&&data.category!== \"addtextTemplate\"){\r\n            let l = height - 10;\r\n            let geometryStringx = \"M 0 0 L 0 \"+ l;\r\n            myDiagram.model.startTransaction(\"changel\");\r\n            myDiagram.model.setDataProperty(data, \"geometryString\",geometryStringx);\r\n            myDiagram.model.commitTransaction(\"changel\");\r\n        }\r\n    })\r\n    let geometryString= \"M 0 0 L 0 \"+yl\r\n    \r\n    if(node && (node.data.category === 'y'||node.data.loc.split(' ')[0] !== '0')&&node.data.category !== 'x'&&node.data.category !== 'LogicXor'&&node.data.category!== \"addtextTemplate\"){\r\n        //if()\r\n        console.log(node.data)\r\n        loc = +node.data.loc.split(' ')[0] + 200;\r\n        locy = loc + \" 0\"\r\n\r\n        //移动位置\r\n        nodeDataArray.forEach(function(data){\r\n            console.log(loc)\r\n            if(data.category !== 'LogicXor'&&data.category!== \"addtextTemplate\"){\r\n                let loco = +data.loc.split(' ')[0]\r\n                if(loco >= loc){\r\n                    loco = loco+200;\r\n                    var locy = loco + \" 0\"\r\n                    myDiagram.model.startTransaction(\"changeloc\");\r\n                    myDiagram.model.setDataProperty(data, \"loc\",locy);\r\n                    myDiagram.model.commitTransaction(\"changeloc\");\r\n                }\r\n            }\r\n            \r\n    })\r\n        \r\n    }else {\r\n        let arr =[]\r\n        nodeDataArray.forEach(function(data){\r\n            if(data.loc.split(' ')[0] !== '0'&&data.category !== 'LogicXor'&&data.category!== \"addtextTemplate\"){\r\n                arr.push(+data.loc.split(' ')[0])\r\n            }\r\n        })\r\n        if(arr.length === 0){\r\n            // geometryString = \"M 0 0 L 0 200\";\r\n            locy = \"200 0\"\r\n        }else{\r\n            var max= Math.max.apply(null,arr)+200 ;\r\n            locy = max + \" 0\" \r\n        }\r\n    }\r\n    \r\n    \r\n\r\n    let newy = {key:guid(),category: \"yunpany\",stroke:stroke,geometryString:geometryString,strokeDashArray:strokeDashArray,loc: locy };\r\n    let newytext = {key:guid(),category: \"xtext\",margin:10,\"textStroke\":\"#666666\",text:\"维度\"+locy.split(' ')[0]/200,loc: locy,dir: \"top\" };\r\n    myDiagram.model.startTransaction(\"addy\");\r\n    myDiagram.model.addNodeData(newy);\r\n    myDiagram.model.addNodeData(newytext);\r\n    myDiagram.model.commitTransaction(\"addy\");\r\n\r\n        \r\n}\r\n\r\n//云盘增加x轴节点\r\nfunction addx(e){\r\n    let myDiagram = e.diagram;\r\n    let node = myDiagram.selection.first();\r\n    let nodeDataArray = myDiagram.model.nodeDataArray;\r\n    let xl = 0;\r\n    let stroke =\"#8799c4\";\r\n    let strokeDashArray=[4, 2];\r\n    let loc = 0;\r\n    let locy = '';\r\n    let height = 260 ;\r\n    nodeDataArray.forEach(function(data){\r\n        \r\n        if(data.category === \"x\"){\r\n            xl = data.height - 10  \r\n        }\r\n        if(data.category===\"y\"){\r\n        //console.log(data)\r\n        height = data.height +200\r\n        myDiagram.model.startTransaction(\"addheight\");\r\n        myDiagram.model.setDataProperty(data, \"height\",height);\r\n        myDiagram.model.commitTransaction(\"addheight\");\r\n        }\r\n        if(data.category === 'LogicXor'){\r\n            let locL = +data.loc.split(' ')[1]\r\n            if(locL < 0){\r\n                let loclc =\"-20 \"+(locL - 200)\r\n                myDiagram.model.startTransaction();\r\n                myDiagram.model.setDataProperty(data, \"loc\",loclc);\r\n                myDiagram.model.commitTransaction();\r\n            }\r\n            \r\n        }\r\n    })\r\n    nodeDataArray.forEach(function(data){\r\n        if(data.loc.split(' ')[1] === '0'&&data.category!== \"addtextTemplate\"){\r\n            let l = height - 10;\r\n            let geometryStringx = \"M 0 0 L 0 \"+ l;\r\n            myDiagram.model.startTransaction(\"changel\");\r\n            myDiagram.model.setDataProperty(data, \"geometryString\",geometryStringx);\r\n            myDiagram.model.commitTransaction(\"changel\");\r\n        }\r\n    })\r\n    let geometryString= \"M 0 0 L 0 \"+xl\r\n    \r\n    if(node && (node.data.category === 'x'||node.data.loc.split(' ')[1] !== '0')&&node.data.category !== 'y'&&node.data.category !== 'LogicXor'&&node.data.category!== \"addtextTemplate\"){\r\n        //if()\r\n        console.log(node.data)\r\n        loc = +node.data.loc.split(' ')[1] - 200;\r\n        locy = \"0 \"+loc;\r\n\r\n        //移动位置\r\n        nodeDataArray.forEach(function(data){\r\n            console.log(loc)\r\n            if(data.category !== 'LogicXor'&&data.category!== \"addtextTemplate\"){\r\n                let loco = +data.loc.split(' ')[1]\r\n                if(loco <= loc){\r\n                    loco = loco-200;\r\n                    var locy = \"0 \"+loco\r\n                    myDiagram.model.startTransaction(\"changeloc\");\r\n                    myDiagram.model.setDataProperty(data, \"loc\",locy);\r\n                    myDiagram.model.commitTransaction(\"changeloc\");\r\n                }\r\n            }else{\r\n\r\n            }\r\n            \r\n    })\r\n        \r\n    }else {\r\n        let arr =[]\r\n        nodeDataArray.forEach(function(data){\r\n            if(data.loc.split(' ')[1] !== '0'&&data.category !== 'LogicXor'&&data.category!== \"addtextTemplate\"){\r\n                arr.push(+data.loc.split(' ')[1])\r\n            }\r\n        })\r\n        if(arr.length === 0){\r\n            // geometryString = \"M 0 0 L 0 200\";\r\n            locy = \"0 -200\"\r\n        }else{\r\n            var min= Math.min.apply(null,arr)-200 ;\r\n            locy = \"0 \"+min; \r\n        }\r\n    }\r\n    \r\n\r\n    let newx = {key:guid(),category: \"yunpanx\",stroke:stroke,geometryString:geometryString,strokeDashArray:strokeDashArray,loc: locy };\r\n    let newxtext = {key:guid(),category: \"ytext\",text:\"维度\"+Math.abs(+locy.split(' ')[1]/200),\"textStroke\":\"#666666\",loc: locy,dir: \"right\" };\r\n    myDiagram.model.startTransaction(\"addx\");\r\n    myDiagram.model.addNodeData(newx);\r\n    myDiagram.model.addNodeData(newxtext);\r\n    myDiagram.model.commitTransaction(\"addx\");\r\n\r\n\r\n}\r\n\r\n\r\n//云盘删除节点\r\nfunction del(e){\r\n    let myDiagram = e.diagram;\r\n    let node = myDiagram.selection.first();\r\n    console.log(\"1\",myDiagram.model.nodeDataArray)\r\n    //text和轴\r\n    if (node) {\r\n        console.log(\"11111111111111111111111\")\r\n        //非xy的坐标轴\r\n        console.log(node.data)\r\n        //判断点击y子轴\r\n        if(node.data.category === \"yunpany\"){\r\n           \r\n            let loc = node.data.loc\r\n            let locx = +node.data.loc.split(' ')[0]\r\n            console.log(locx)\r\n            myDiagram.model.nodeDataArray.forEach(function(data){\r\n\r\n                //如果不加判断，点击轴删除，只会删除轴，不会删除坐标\r\n                // debugger\r\n                // if(data.category===\"yunpany\"&&data.loc === loc){\r\n                //     myDiagram.model.startTransaction(\"deletAxis\");\r\n                //     //删除轴\r\n                //     myDiagram.model.removeNodeData(node.data);\r\n                //     myDiagram.model.removeNodeData(data);\r\n                //     myDiagram.model.commitTransaction(\"deletAxis\");\r\n                // }else\r\n                 if(data.category===\"xtext\"&&data.loc === loc){\r\n                    console.log(\"data\",data)\r\n                    myDiagram.model.startTransaction(\"delettext\");\r\n                    //删除轴\r\n                    myDiagram.model.removeNodeData(node.data);\r\n                    //删除text\r\n                    myDiagram.model.removeNodeData(data);\r\n                    \r\n                    myDiagram.model.commitTransaction(\"delettext\");\r\n                }\r\n        \r\n            })\r\n            //改变其他轴长度及坐标\r\n            console.log(\"2\",myDiagram.model.nodeDataArray)\r\n            changelen(locx,myDiagram)\r\n            \r\n        //x\r\n        }else if(node.data.category === \"yunpanx\"){\r\n            console.log(\"x\")\r\n            let loc = node.data.loc\r\n            let locx = +node.data.loc.split(' ')[1]\r\n            myDiagram.model.nodeDataArray.forEach(function(data){\r\n                // if(data.category===\"ytext\"&&data.loc === loc){\r\n                //     myDiagram.model.startTransaction(\"delettext\");\r\n                //     myDiagram.model.removeNodeData(data);\r\n                //     myDiagram.model.removeNodeData(node.data);\r\n                //     myDiagram.model.commitTransaction(\"delettext\");\r\n                // }else \r\n                if(data.category===\"ytext\"&&data.loc === loc){\r\n                    myDiagram.model.startTransaction(\"delettext\");\r\n                    myDiagram.model.removeNodeData(data);\r\n                    myDiagram.model.removeNodeData(node.data);\r\n                    myDiagram.model.commitTransaction(\"delettext\");\r\n                }\r\n                \r\n            \r\n            })\r\n            \r\n            changelenx(locx,myDiagram)\r\n            \r\n        }else if(node.data.category!==\"ytext\"&&node.data.category!==\"xtext\"&&node.data.category!==\"LogicXor\"&&node.data.category!==\"x\"&&node.data.category!==\"y\" ){\r\n            myDiagram.model.startTransaction();\r\n            myDiagram.model.removeNodeData(node.data);\r\n            myDiagram.model.commitTransaction();\r\n        }      \r\n        \r\n    }\r\n\r\n}\r\n\r\n//改变x轴长度\r\n\r\nfunction changelen(locx,myDiagram){\r\n    console.log(\"3\",myDiagram.model.nodeDataArray)\r\n    myDiagram.model.nodeDataArray.forEach(function(data){\r\n                                \r\n        //Math.abs(key)\r\n        let datalocx = +data.loc.split(' ')[0]\r\n        console.log(data.loc)\r\n        console.log(datalocx)\r\n        //改变位置\r\n        if(datalocx > locx){\r\n            if(data.category===\"yunpany\"||data.category===\"xtext\"){\r\n                let l = datalocx-200\r\n                let loc = l+\" 0\"\r\n                console.log(loc)\r\n                myDiagram.model.startTransaction(\"changea\");\r\n                myDiagram.model.setDataProperty(data, \"loc\",loc);\r\n                myDiagram.model.commitTransaction(\"changea\");\r\n            }\r\n            \r\n        }\r\n        //改变长度\r\n     \r\n            console.log(data)\r\n            if(data.category===\"x\"){\r\n                let height = data.height -200\r\n                myDiagram.model.startTransaction(\"cheight\");\r\n                myDiagram.model.setDataProperty(data, \"height\",height);\r\n                myDiagram.model.commitTransaction(\"cheight\");\r\n            }else if(data.category===\"yunpanx\"){\r\n                let gs = NaN\r\n                let l = (data.geometryString||\"\").split(' ')\r\n                console.log(l)\r\n                if(l[5]){\r\n                    gs = +l[5] - 200;\r\n                }else{\r\n                    gs = +l[3] - 200;\r\n                }\r\n                console.log(gs)\r\n                let gs2 = gs + \"\";\r\n                let gs3 = \"M 0 0  L 0 \"+gs2;\r\n                myDiagram.model.startTransaction(\"changea\");\r\n                myDiagram.model.setDataProperty(data, \"geometryString\",gs3);\r\n                myDiagram.model.commitTransaction(\"changea\");\r\n            }\r\n        \r\n        if(data.category === 'LogicXor'){\r\n            let locL = +data.loc.split(' ')[0]\r\n            if(locL > 0){\r\n                let loclc =(locL - 200) +\" 5\"\r\n                myDiagram.model.startTransaction();\r\n                myDiagram.model.setDataProperty(data, \"loc\",loclc);\r\n                myDiagram.model.commitTransaction();\r\n            }\r\n        }\r\n    })\r\n}\r\n\r\nfunction changelenx(locx,myDiagram){\r\n    console.log(myDiagram.model.nodeDataArray)\r\n    myDiagram.model.nodeDataArray.forEach(function(data){\r\n\r\n    let datalocx = +data.loc.split(' ')[1]\r\n    // console.log(data.loc)\r\n    // console.log(datalocx)\r\n    //改变位置\r\n    if(datalocx < locx){\r\n        if(data.category===\"yunpanx\"||data.category===\"ytext\"){\r\n            let l = datalocx+200\r\n            let loc = \"0 \"+l\r\n            console.log(\"节点\",data)\r\n            console.log(\"改变位置\",loc)\r\n            myDiagram.model.startTransaction(\"changea\");\r\n            myDiagram.model.setDataProperty(data, \"loc\",loc);\r\n            myDiagram.model.commitTransaction(\"changea\");\r\n        }\r\n        \r\n        \r\n    }\r\n    //改变长度\r\n    if(data.category===\"y\"){\r\n        let height = data.height -200\r\n        console.log(\"节点\",data)\r\n        console.log(\"改变坐标轴长度没有angle\",height)\r\n        myDiagram.model.startTransaction(\"cheight\");\r\n        myDiagram.model.setDataProperty(data, \"height\",height);\r\n        myDiagram.model.commitTransaction(\"cheight\");\r\n    }else if(data.category===\"yunpany\"){\r\n        let gs = NaN\r\n        let l = (data.geometryString||\"\").split(' ')\r\n        if(l[5]){\r\n            gs = +l[5] - 200;\r\n        }else{\r\n            gs = +l[3] - 200;\r\n        }\r\n        // console.log(gs)\r\n        let gs2 = gs + \"\";\r\n        let gs3 = \"M 0 0  L 0 \"+gs2;\r\n        console.log(\"节点\",data)\r\n        console.log(\"改变y轴长度没有angle\",gs3)\r\n        myDiagram.model.startTransaction(\"changea\");\r\n        myDiagram.model.setDataProperty(data, \"geometryString\",gs3);\r\n        myDiagram.model.commitTransaction(\"changea\");\r\n    }   \r\n\r\n    if(data.category === 'LogicXor'){\r\n            let locL = +data.loc.split(' ')[1]\r\n            if(locL < 0){\r\n                let loclc =\"-20 \"+(locL + 200) \r\n                myDiagram.model.startTransaction();\r\n                myDiagram.model.setDataProperty(data, \"loc\",loclc);\r\n                myDiagram.model.commitTransaction();\r\n            }\r\n        }\r\n    })\r\n}\r\nfunction guid() {\r\n    function S4() {\r\n        return (((1+Math.random())*0x10000)|0).toString(16).substring(1);\r\n    }\r\nreturn (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\r\n}\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/yunpan.js","\r\nvar Trtd_tianpan = require('./tianpan')\r\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\r\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\r\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\r\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\r\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\r\n\r\n\r\nclass Trtd extends Trtd_tianpan {\r\n    constructor(div, config){\r\n        super(div, config)\r\n\t\t// this.config = config;\r\n\t\t// this.modelChangedListener = config.modelChangedListener;\r\n\t\t// this.type = config.type;\r\n\t\t// this.diagram = {};\r\n        // this.model = config.model;\r\n        // this.tpid = config.tpid||Date.now();\r\n        // this.InitialFontSize = 18\r\n        // this.tdCurrentTheme = {\r\n        //     id: 6,\r\n        //     borderWidth: 2,\r\n        //     borderColor: \"black\",\r\n        //     groupColor: \"rgba(0,0,0,0)\",\r\n        //     groupStroke: \"rgba(0,0,0,0)\",\r\n        //     groupStrokeWidth: 0,\r\n        //     themeName: \"黑白\",\r\n        //     linkColor: \"black\",\r\n        //     colorRange: \"white\"\r\n        // }\r\n\t\t// // 初始化diagram\r\n\t\t// this.initDiagram(div, config);\r\n\t\t// this.initListener();\r\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\r\n        // if(this.model){\r\n        //     this.initModel();\r\n        // }\r\n    }\r\n\r\n     /**\r\n     * 添加节点模板\r\n     */\r\n    addNodeTemplate(){\r\n\r\n        var that = this;\r\n        var myDiagram = this.diagram\r\n\r\n        // myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\r\n        // myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\r\n        // myDiagram.nodeTemplateMap.add(\"text\", );\r\n\r\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\r\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\r\n\r\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\r\n\r\n        \r\n    }\r\n}\r\n\r\n// export default Trtd;\r\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/wheel.js","\nvar Trtd_tianpan = require('./tianpan')\nvar createNodeTemplate = require('../nodeTemplate/createNodeTemplate')\nvar createPictureSingleNodeTemplate = require('../nodeTemplate/createPictureSingleNodeTemplate')\nvar createPictureNodeTemplate = require('../nodeTemplate/createPictureNodeTemplate')\nvar createTextNodeTemplate = require('../nodeTemplate/createTextNodeTemplate')\nvar createNodeSvgTemplate = require('../nodeTemplate/createNodeSvgTemplate')\nvar createArcNodeTemplate = require('../nodeTemplate/createArcNodeTemplate')\nvar createLineNodeTemplate = require('../nodeTemplate/createLineNodeTemplate')\nvar createWaveNodeTemplate = require('../nodeTemplate/createWaveNodeTemplate')\nvar nodeTemplateFactory = require('../nodeTemplate/factory')\nvar $ = go.GraphObject.make;\nvar GroupRotatingTool = require('../tools/GroupRotatingTool')\nvar helpers = require('../helpers/helpers.gojs')\nvar layoutWaveGroup = require(\"../layout/waveGroupLayout\").layoutWaveGroup;\nvar adjustTextAngle = require(\"../layout/waveGroupLayout\").adjustTextAngle;\n\n\nfunction computeNewRotateLoc(rotateCenter,currentLoc, angle){\n    if(rotateCenter.equals(currentLoc)) return currentLoc\n  // 计算选择中心点到（0,0）点的偏移\n  var offset = new go.Point(0,0).subtract(rotateCenter.copy())\n  // 将原来的点偏移到相对0,0点的位置\n  var nodeOrigin = currentLoc.copy().offset(offset.x, offset.y)\n  var newNodeOrigin = nodeOrigin.rotate(angle)\n  var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y)\n  return newNodeLoc\n  // console.log(\"newNodeLoc\", newNodeLoc)\n}\n\nrequire(\"../tools/textEditor\")\nclass Trtd extends Trtd_tianpan {\n    constructor(div, config){\n        super(div, config)\n        var that = this;\n        var diagramConfig = {\n            layout: $(go.Layout),\n            initialContentAlignment: go.Spot.Center,\n            initialAutoScale: go.Diagram.Uniform,\n            initialDocumentSpot: go.Spot.Center,\n            initialViewportSpot: go.Spot.Center,\n            rotatingTool: new GroupRotatingTool(),\n            PartResized: (e) =>{\n                console.log(\"PartResizedPartResizedPartResizedPartResized\")\n                var node = e.subject.part\n                if(!node) return;\n                // return;\n                if(node.data.category == \"waveGroup\"){\n                    console.log(\"PartResizedPartResized\")\n                    // wave 的宽高限制\n                    var maxWidth = 400;\n                    var maxHeight = 400;\n                    var oliveWidth, oliveHeight;\n                    var it = node.findSubGraphParts().iterator;\n                    var waveCount = 0\n                    var lastWave;\n                    while(it.next()){\n                        var n = it.value;\n                        if(n.data.category == \"wave\"){\n                            waveCount+=1;\n                            lastWave = n;\n                        }\n                    }\n                    console.log(\"actualBoundsactualBoundsactualBoundsactualBounds\")\n                    var nodeSize = node.resizeObject.actualBounds;\n                    var waveSize = lastWave.resizeObject.naturalBounds\n                    // oliveWidth = (nodeSize.width-100)/waveCount\n                    oliveWidth = (nodeSize.width-0)*5/3/waveCount\n                    oliveWidth = (nodeSize.width-0)*3/(waveCount*3+2)\n                    if(oliveWidth<100){\n                        oliveWidth=100\n                    }\n                    // oliveWidth = waveSize.width*waveCount + waveSize.width*2/3\n                    // oliveWidth = waveSize.width\n                    if( oliveWidth > maxWidth){\n                        oliveWidth = maxWidth;\n                        // nodeSize.width = maxWidth*waveCount+100;\n                    }\n                    oliveHeight = nodeSize.height;\n                    if( oliveHeight > maxHeight){\n                        oliveHeight = maxHeight;\n                        // nodeSize.height  = maxWidth;\n                    }\n                    if( oliveHeight > oliveWidth){\n                        oliveHeight = oliveWidth;\n                        // nodeSize.height  = maxWidth;\n                    }\n                    node.diagram.startTransaction()\n                    // node.diagram.model.setDataProperty(node.data, \"desiredSize\",`${nodeSize.width} ${nodeSize.height}`)\n                    node.diagram.model.setDataProperty(node.data, \"oliveHeight\", oliveHeight)\n                    node.diagram.model.setDataProperty(node.data, \"oliveWidth\", oliveWidth)\n                                 //     e.subject.part.layout.isOngoing = true;\n                    //     e.subject.part.layout.isValidLayout = false;\n                    var it = e.subject.part.findSubGraphParts().iterator;\n                    layoutWaveGroup(it,node.diagram,e.subject.part)\n                    // node.diagram.updateAllTargetBindings()\n                    it.reset()\n                    while(it.next()){\n                        it.value.updateTargetBindings()\n                    }\n                    \n                    node.diagram.commitTransaction()\n                    setTimeout(()=>{\n                        e.subject.part.layout.isOngoing = true;\n                        e.subject.part.layout.isValidLayout = false;\n                    },100)\n                }else if(node.data.category === \"autoText\"){\n                    console.log(\"e.subject.width resize\")\n                    if(e.subject.width <= 50){\n                        e.subject.width = 50\n                    }\n                    if(e.subject.height <= 50){\n                        e.subject.height =50\n                    }\n                    e.diagram.startTransaction(\"resize\");\n                    e.diagram.model.setDataProperty(node.data, \"width\", e.subject.width);\n                    e.diagram.model.setDataProperty(node.data, \"nwidth\", true);\n                    e.diagram.model.setDataProperty(node.data, \"height\", e.subject.height);\n                    e.diagram.model.setDataProperty(node.data, \"nheight\", true);\n                    e.diagram.commitTransaction(\"resize\");\n                }\n            },\n            SelectionMoved: (e)=>{\n                // console.log(\"SelectionMovedSelectionMoved\",e.subject)\n                // if (!e.isTransactionFinished) {\n                //     return;\n                // }\n                try{\n                    var selnode = e.subject.first()\n                    if(!selnode) return;\n                    if(selnode.data.category == \"wave\"){\n                        if(selnode.containingGroup){\n                            selnode.containingGroup.layout.isValidLayout = false;\n                        }\n                    }\n                    if(selnode.data.category == \"autoText\"){\n                        if((selnode.data.role == \"shiText\" || selnode.data.role == \"xuText\")){\n                            selnode.diagram.startTransaction()\n                            console.log(\"SelectionMovedSelectionMovedSelectionMoved\")\n                            if(!selnode.__location){\n                                var obj = selnode.diagram.findNodeForKey(selnode.data.olive)\n                                var group = selnode.containingGroup\n                                if(obj){\n                                    var loc = group.location.copy().offset(group.data.oliveWidth*(obj.data.order-1),0)\n                                    selnode.__location = loc.copy().offset(obj.naturalBounds.width/2, 0)\n                                    selnode.__location = computeNewRotateLoc(group.location, selnode.__location, obj.angle)\n                                }\n                            }\n                            if(selnode.__location){\n                                console.log(\"selnode.__locationselnode.__locationselnode.__location\")\n                                if(selnode.data.order %2 == 0){\n                                    selnode.__offset = selnode.__location.copy().subtract(selnode.location)\n                                }else{\n                                    selnode.__offset = selnode.__location.copy().subtract(selnode.location)\n                                }\n                                delete selnode.__oldOrder\n                            }\n                            delete selnode.__oldLocation\n                            if(selnode.data.text.trim() != \"\"){\n                                selnode.data.nloc = true;\n                                selnode.diagram.model.setDataProperty(selnode.data, \"nloc\", true)\n                            }\n                            selnode.diagram.commitTransaction()\n                        }\n                        if(selnode.containingGroup && (selnode.containingGroup.data.category == \"yunGroup\"||selnode.containingGroup.data.category == \"yunpanGroup\")){\n                            selnode.containingGroup.__trtdNode.snapToGrid(selnode.data, selnode.containingGroup)\n                            // selnode.containingGroup.layout.isOngoing = true;\n                            selnode.containingGroup.layout.isValidLayout = false;\n                        }\n                    }\n                    if(selnode.data.category == \"shapeText\"){\n                        if(selnode.containingGroup && (selnode.containingGroup.data.category == \"yunpanGroup\")){\n                            selnode.containingGroup.__trtdNode.snapToGrid(selnode.data, selnode.containingGroup)\n                            // selnode.containingGroup.layout.isOngoing = true;\n                            selnode.containingGroup.layout.isValidLayout = false;\n                        }\n                    }\n                }catch(err){\n                    console.log(err)\n                }\n                // if(e.subject)\n            },\n            // \"toolManager.hoverDelay\": 600,\n            // \"toolManager.toolTipDuration\": 3000,\n            click: function(e) {\n                // closeToolbarWindow();\n                // removeNodeToolBar();\n                console.log(\"eeeeeeee:\",e)\n                that.clearAllTextBorder()\n                localStorage.setItem(\"TRTD_documentPoint\",go.Point.stringify(e.documentPoint))\n            },\n        }\n        this.diagram.setProperties(diagramConfig);\n        \n        this.diagram.commandHandler.doKeyDown = (e)=>{\n            this.dokeyDownFn(e)\n            // var cmd = this.diagram.commandHandler;\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        }\n        this.diagram.commandHandler.canCopySelection = function(){\n            // this.dokeyDownFn(e)\n            console.log(\"canCopySelectioncanCopySelection\")\n            var node = that.diagram.selection.first()\n            if(node){\n                if(node.data.category == \"axisGroup\" || node.data.category == \"yunGroup\"){\n                    return true;\n                }else{\n                    return false;\n                }\n            }\n            var cmd = this.diagram.commandHandler;\n            return go.CommandHandler.prototype.canCopySelection.call(cmd);\n        }\n        this.diagram.commandHandler.pasteFromClipboard = function(e, obj){\n            var coll = go.CommandHandler.prototype.pasteFromClipboard.call(this);\n            \n            // this.diagram.moveParts(coll, this._lastPasteOffset);\n            // this._lastPasteOffset.add(this.pasteOffset);\n            var it = coll.iterator;\n            var shiTextColl = []\n            var xuTextColl = []\n            var waveColl = []\n            var centerTextColl = []\n            var waveGroup = null\n            var yunGroup = null;\n            while(it.next()){\n                var n = it.value;\n                if(n.data.role == \"shiText\"){\n                    shiTextColl.push(n)\n                    continue;\n                }\n                if(n.data.role == \"xuText\"){\n                    xuTextColl.push(n)\n                    continue;\n                }\n                if(n.data.role == \"centerText\"){\n                    centerTextColl.push(n)\n                    continue;\n                }\n                if(n.data.category == \"wave\" && n.data.role != \"waveTail\"){\n                    waveColl.push(n)\n                    continue;\n                }\n                if(n.data.category == \"waveGroup\"){\n                    waveGroup = n;\n                }\n            }\n            if(!waveGroup){\n                // coll.clear()\n                // coll.removeAll()\n                coll = new go.Set(go.Part)\n                return coll;\n            }\n\n            waveColl = waveColl.sort(function(a,b){\n                // console.log(`Number(a.data.order)${Number(a.data.order)} > Number(b.data.order) ${Number(b.data.order)}`,Number(a.data.order) > Number(b.data.order))\n                return Number(a.data.order) - Number(b.data.order)\n            })\n            shiTextColl.sort(function(a,b){\n                return Number(a.data.order) - Number(b.data.order)\n            })\n            xuTextColl.sort(function(a,b){\n                return Number(a.data.order) - Number(b.data.order)\n            })\n            centerTextColl.sort(function(a,b){\n                return Number(a.data.order) - Number(b.data.order)\n            })\n\n            waveColl.forEach(function(obj,index){\n                obj.data.shiText = shiTextColl[index].data.key\n                obj.data.xuText = xuTextColl[index].data.key\n                obj.data.centerText = centerTextColl[index].data.key\n                shiTextColl[index].data.olive = obj.data.key\n                xuTextColl[index].data.olive = obj.data.key\n            })\n            console.log(\"pasteFromClipboardpasteFromClipboard\")\n            return coll;\n            // var cmd = this.diagram.commandHandler;\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        }\n        this.diagram.commandHandler.deleteSelection = ()=>{\n         \n            return this.deleteSelection();\n        }\n        this.diagram.toolManager.resizingTool.computeReshape = function() { \n            if(this.adornedObject.part.data.category == \"shapeText\"){\n                return false\n            }\n            go.TextEditingTool.prototype.doCancel.call(this);\n\n        }\n        this.diagram.toolManager.textEditingTool.doCancel = function(){\n            // var textEditor = this.diagram.currentTextEditor;\n            // console.log(\"textEditor。。。。\")\n            var tool = this;\n            try{\n                if(this.textBlock){\n                    var node = this.textBlock.part;\n                }\n            }catch(e){\n                console.log(e)\n            }\n            setTimeout(()=>{\n                try{\n                    if(node && node.data.category == \"wave\"){\n                        if(node.containingGroup && node.containingGroup.data.textAngle == \"horizontal\" && node.containingGroup.data.centerTextAngle == \"independent\"){\n                            // 如果文字方向为正向，且中线文字为正向\n                            node.findObject(\"TEXT\").visible = false;\n                            var centerText = node.diagram.findNodeForKey(node.data.centerText)\n                            if(centerText){\n                              centerText.visible = true;\n                            }\n                          }\n                    }\n                }catch(e){\n                    console.info(e)\n                }\n            },100)\n            // var cmd = this.diagram.commandHandler;\n            // this.doCancel()\n            // go.CommandHandler.prototype.deleteSelection.call(cmd);\n            go.TextEditingTool.prototype.doCancel.call(tool);\n        }\n\n        this.diagram.toolManager.resizingTool.computeReshape = function() { \n            // 保持图片宽高比\n            if(this.adornedObject.part.data.category == \"pic\"){\n                return false; \n            }    \n            return true\n        }\n\n        if( window.TextEditor){\n            console.log(\"TextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditor\")\n            this.diagram.toolManager.textEditingTool.defaultTextEditor = window.TextEditor;\n        }\n        this.diagram.toolManager.clickCreatingTool.archetypeNodeData = {\n            category: \"autoText\",\n            \"font\":\"18px 'Microsoft YaHei'\",\n            text: \"空白文本\",\n            level: 0\n        };\n\n        this.diagram.groupTemplateMap.add(\"waveGroup1\",     $(go.Group, \"Spot\",\n        { selectionObjectName: \"SHAPE\" },\n        { locationObjectName: \"SHAPE\", locationSpot: go.Spot.Center },\n        new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\n        { rotatable: true },\n        new go.Binding(\"angle\",\"angle\",function(v,m,a){\n            console.log(\"vvvvvvvvvvvvvvvvvvv:\",v,\" m:\",m,\" a:\",a)\n            // m.diagram.startTransaction()\n            // for(var i=0;i<m.diagram.model.nodeDataArray.length-1;i++){\n            //     if(m.diagram.model.nodeDataArray[i].group == m.key){\n            //         m.diagram.model.setDataProperty(m.diagram.model.nodeDataArray[i], \"angle\", v)\n            //     }\n            // }\n            // // var group = a.findNodeDataForKey(m.group)\n            // // a.setDataProperty(group, \"angle\", v)\n            // m.diagram.commitTransaction()\n            return v;\n        }).makeTwoWay(function(v,m,a){\n            console.log(\"v:\",v,\" m:\",m,\" a:\",a)\n            // a.startTransaction()\n            // for(var i=0;i<a.nodeDataArray.length-1;i++){\n            //     if(a.nodeDataArray[i].group == m.key){\n            //         a.setDataProperty(a.nodeDataArray[i], \"angle\", v)\n            //     }\n            // }\n            // // var group = a.findNodeDataForKey(m.group)\n            // // a.setDataProperty(group, \"angle\", v)\n            // a.commitTransaction()\n            return v;\n        }),\n        { resizable: true, resizeObjectName: \"SHAPE\" },\n        $(go.Panel, \"Vertical\",\n          $(go.TextBlock, { font: \"bold 12pt sans-serif\" },\n            new go.Binding(\"text\", \"key\")),\n          $(go.Shape, { name: \"SHAPE\", fill: \"transparent\" },\n            new go.Binding(\"desiredSize\", \"desiredSize\", go.Size.parse).makeTwoWay(go.Size.stringify))\n        )\n      ))\n\t\t// this.config = config;\n\t\t// this.modelChangedListener = config.modelChangedListener;\n\t\t// this.type = config.type;\n\t\t// this.diagram = {};\n        // this.model = config.model;\n        // this.tpid = config.tpid||Date.now();\n        // this.InitialFontSize = 18\n        // this.tdCurrentTheme = {\n        //     id: 6,\n        //     borderWidth: 2,\n        //     borderColor: \"black\",\n        //     groupColor: \"rgba(0,0,0,0)\",\n        //     groupStroke: \"rgba(0,0,0,0)\",\n        //     groupStrokeWidth: 0,\n        //     themeName: \"黑白\",\n        //     linkColor: \"black\",\n        //     colorRange: \"white\"\n        // }\n\t\t// // 初始化diagram\n\t\t// this.initDiagram(div, config);\n\t\t// this.initListener();\n\t\t// // Then you will need to construct a Model (usually a GraphLinksModel) for the Diagram, initialize its data by setting its Model.nodeDataArray and other properties, and then set the diagram's model.\n        // if(this.model){\n        //     this.initModel();\n        // }\n    }\n\n     /**\n     * 添加节点模板\n     */\n    addNodeTemplate(){\n\n        // myDiagram.nodeTemplateMap.add(\"dipan\", this.createDipanTemplate(layerThickness,tdDipanTextAngle));\n        // myDiagram.nodeTemplateMap.add(\"Root\", this.getDipanRootTemplate(layerThickness));\n        // myDiagram.nodeTemplateMap.add(\"text\", );\n        var myDiagram = this.diagram\n        myDiagram.nodeTemplateMap.add(\"0\", createNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"1\", createNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"2\", createNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"3\", createPictureSingleNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"4\", createPictureNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"text\", createTextNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"\", createNodeTemplate(this.diagram));\n\n        myDiagram.nodeTemplateMap.add(\"8\",createNodeSvgTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"9\", createArcNodeTemplate(this.diagram));\n        myDiagram.nodeTemplateMap.add(\"line\", createLineNodeTemplate(this.diagram));\n        // myDiagram.nodeTemplateMap.add(\"wave\", createWaveNodeTemplate(this.diagram));\n        // var sampleNode = nodeTemplateFactory(\"sample\")\n        myDiagram.nodeTemplateMap.add(\"wave\", nodeTemplateFactory(\"wave\",{diagram:myDiagram}).getNodeTemplate());\n        // myDiagram.nodeTemplateMap.add(\"waveTail\", nodeTemplateFactory(\"waveTail\",{diagram:myDiagram}).getNodeTemplate());\n        myDiagram.nodeTemplateMap.add(\"iconText\", nodeTemplateFactory(\"iconText\",{diagram:myDiagram}).getNodeTemplate());\n        // myDiagram.nodeTemplateMap.add(\"cbian\",  nodeTemplateFactory(\"cbian\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.nodeTemplateMap.add(\"pic\",  nodeTemplateFactory(\"pic\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.nodeTemplateMap.add(\"shape\",  nodeTemplateFactory(\"shape\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.nodeTemplateMap.add(\"autoText\", nodeTemplateFactory(\"autoText\",{diagram:myDiagram}).getNodeTemplate());\n        myDiagram.nodeTemplateMap.add(\"shapeText\", nodeTemplateFactory(\"shapeText\",{diagram:myDiagram}).getNodeTemplate());\n        myDiagram.groupTemplateMap.add(\"labelGroup\", nodeTemplateFactory(\"labelGroup\",{diagram:myDiagram}).getNodeTemplate());\n        myDiagram.groupTemplateMap.add(\"picGroup\", nodeTemplateFactory(\"picGroup\",{diagram:myDiagram}).getNodeTemplate());\n        myDiagram.groupTemplateMap.add(\"waveGroup\",  nodeTemplateFactory(\"waveGroup\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.groupTemplateMap.add(\"axisGroup\",  nodeTemplateFactory(\"axisGroup\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.groupTemplateMap.add(\"yunGroup\",  nodeTemplateFactory(\"yunGroup\",{diagram:this.diagram}).getNodeTemplate())\n        myDiagram.groupTemplateMap.add(\"yunpanGroup\",  nodeTemplateFactory(\"yunpanGroup\",{diagram:this.diagram}).getNodeTemplate())\n        \n    }\n\n    deleteSelection(node){\n        var cmd = this.diagram.commandHandler;\n        if(!node){\n            node = this.diagram.selection.first()\n        }\n        var locateNode = null;\n        var shiText,xuText,centerText;\n        if(!node) return;\n        if(!node.canDelete()) return;\n        if(node.data.category == \"yunGroup\" && !node.data.deletable){   \n            return\n        }\n        this.diagram.startTransaction(\"deleteSelection1\");\n        var count = 0;\n        if(node){\n            if(node.data.category == \"axisGroup\"){\n                var it = node.findSubGraphParts().iterator;\n                while (it.next()) {\n                    var n = it.value;\n                    this.diagram.model.removeNodeData(n.data)\n                }\n                this.diagram.model.removeNodeData(node.data)\n            }\n            if(node.data.category == \"wave\" && node.containingGroup){\n                var it = node.containingGroup.findSubGraphParts().iterator;\n                while (it.next()) {\n                    var n = it.value;\n                    if(n.data.category == \"wave\" && n.data.role != \"waveTail\"){\n                        if(n.data.order == node.data.order+1){\n                            locateNode = n;\n                        }\n                        count++;\n                    }\n                    if(n.data.role == \"shiText\" && n.data.order == node.data.order){\n                        shiText = n;\n                    }\n                    if(n.data.role == \"xuText\" && n.data.order == node.data.order){\n                        xuText = n;\n                    }\n                    if(n.data.role == \"centerText\" && n.data.order == node.data.order){\n                        centerText = n;\n                    }\n\n                }\n                if(count<=1){\n                    this.diagram.commitTransaction(\"deleteSelection1\");\n                    return;\n                }\n                node.containingGroup.layout.isOngoing = true;\n                node.containingGroup.layout.isValidLayout = false;\n                if(node.containingGroup.containingGroup){\n                    node.containingGroup.containingGroup.layout.isOngoing = true;\n                    node.containingGroup.containingGroup.layout.isValidLayout = false; \n                }\n            }\n            // 云盘 维度删除\n            if(node.data.category == \"autoText\" &&  node.data.subRole == \"dimText\" && node.containingGroup && node.containingGroup.data.category == \"yunpanGroup\"){\n                var it = node.containingGroup.findSubGraphParts().iterator;\n                var deleteNodes = []\n                var deleteLines = []\n                var normDim = \"X\",unnormDim = \"Y\", lineRole = \"verticalLine\"\n                if(node.data.dimX == 0){\n                    normDim = \"Y\"\n                    unnormDim = \"X\"\n                    lineRole = \"horizontalLine\"\n                }\n                while (it.next()) {\n                    var n = it.value;\n                    if(n.data.subRole == \"dimText\" && n.data[\"dim\"+unnormDim] == 0){\n                        // if(n.data.order == node.data.order+1){\n                        //     locateNode = n;\n                        // }\n                        count++;\n                    }\n                    if(n.data.subRole == \"yunpanText\" && n.data[\"order\"+normDim] == node.data[\"dim\"+normDim]){\n                        deleteNodes.push(n.data)\n                    }\n                    if(n.data.category == \"line\"  && n.data.role == lineRole\n                    && n.data[\"order\"]  == node.data[\"dim\"+normDim]\n                    ){\n                        deleteLines.push(n.data)\n                    }\n                    // if(n.data.role == \"xuText\" && n.data.order == node.data.order){\n                    //     xuText = n;\n                    // }\n                    // if(n.data.role == \"centerText\" && n.data.order == node.data.order){\n                    //     centerText = n;\n                    // }\n\n                }\n                \n                if(count<=1){\n                    this.diagram.commitTransaction(\"deleteSelection1\");\n                    return;\n                }\n\n                it.reset()\n                while (it.next()) {\n                    var n = it.value;\n                    if(n.data.subRole == \"dimText\" && n.data[\"dim\"+unnormDim] == 0 && n.data[\"dim\"+normDim] > node.data[\"dim\"+normDim]){\n                        // if(n.data.order == node.data.order+1){\n                        //     locateNode = n;\n                        // }\n                        n.diagram.model.setDataProperty(n.data, \"dim\"+normDim, n.data[\"dim\"+normDim] - 1)\n                        // count++;\n                    }\n                    if(n.data.subRole == \"yunpanText\" && n.data[\"order\"+normDim] > node.data[\"dim\"+normDim]){\n                        n.diagram.model.setDataProperty(n.data, \"order\"+normDim, n.data[\"order\"+normDim] - 1)\n                    }\n                    if(n.data.category == \"line\"  && n.data.role == lineRole\n                    && n.data[\"order\"]  > node.data[\"dim\"+normDim]\n                    ){\n                        n.diagram.model.setDataProperty(n.data, \"order\", n.data[\"order\"] - 1)\n                    }\n                    // if(n.data.role == \"xuText\" && n.data.order == node.data.order){\n                    //     xuText = n;\n                    // }\n                    // if(n.data.role == \"centerText\" && n.data.order == node.data.order){\n                    //     centerText = n;\n                    // }\n\n                }\n\n                node.diagram.model.removeNodeDataCollection(deleteLines)\n                node.diagram.model.removeNodeDataCollection(deleteNodes)\n                node.containingGroup.layout.isOngoing = true;\n                node.containingGroup.layout.isValidLayout = false;\n                // if(node.containingGroup.containingGroup){\n                //     node.containingGroup.containingGroup.layout.isOngoing = true;\n                //     node.containingGroup.containingGroup.layout.isValidLayout = false; \n                // }\n            }\n\n\n        }\n        //myDiagram.currentTool.doCancel();\n        //go.CommandHandler.prototype.redo.call(cmd);\n        // myDiagram.clearSelection();\n        if(xuText){\n            this.diagram.model.removeNodeData(xuText.data)\n        }\n        if(shiText){\n            this.diagram.model.removeNodeData(shiText.data)\n        }\n        if(centerText){\n            this.diagram.model.removeNodeData(centerText.data)\n        }\n        go.CommandHandler.prototype.deleteSelection.call(cmd);\n\n        \n\n        this.diagram.commitTransaction(\"deleteSelection1\");\n        // this.layoutAllGroup()\n        // setTimeout(()=>{\n        //     // this.diagram.updateAllTargetBindings()\n        //     this.diagram.layoutDiagram(true)\n        // },500)\n        if (locateNode) {\n            this.diagram.select(locateNode);\n        }\n    }\n\n\n    layoutLabelGroup(){\n        console.log(\"layoutLabelGroup\")\n        setTimeout(()=>{\n            var it = this.diagram.nodes.iterator;\n            while (it.next()) {\n                var n = it.value;\n                if(n.data.category == \"labelGroup\"){\n                    n.layout.isOngoing = true;\n                    n.layout.isValidLayout = false;\n                }\n            }\n        },200)\n    }\n    // 复制拓扑\n    copyWaveGroup(){\n        var diagram = this.diagram\n        var cmd = this.diagram.commandHandler;\n        cmd.copySelection()\n        cmd.pasteSelection()\n        return;\n    }\n\n    layoutAllGroup(){\n        console.log(\"layoutAllGroup\")\n        var it = this.diagram.nodes.iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.isGroup == true){\n                n.layout.isOngoing = true;\n                n.layout.isValidLayout = false;\n            }\n        }\n    }\n    exportAsSubFigure(){\n        var diagram = this.diagram\n        var node = diagram.selection.first()\n        if(!node) return;\n        if(!node.data.isGroup) return;\n        var it = node.findSubGraphParts().iterator;\n        var groupData = [node.data]\n        var theme = null;\n        while(it.next()){\n            var n = it.value;\n            groupData.push(n.data)\n            if(n.data.role == \"themeText\"){\n                theme = n\n            }\n        }\n        var model = JSON.parse(diagram.model.toJson())\n        model.nodeDataArray = groupData;\n        if(this.exportAsSubFigureCallback){\n            this.exportAsSubFigureCallback({\n                node: node,\n                model: model,\n                theme: theme\n            })\n        }\n    }\n\n    // 拆分橄榄\n    splitOlive2Half(){\n        var diagram = this.diagram\n        var node = diagram.selection.first()\n        if(!node) return;\n        if(node.data.category != \"wave\"){\n            return;\n        }\n        if(node.data.order ==1) return;\n        if(!node.containingGroup){\n            return;\n        }\n        this.diagram.startTransaction(\"splitOlive2Half\")\n        node.containingGroup.layout.isOngoing = true;\n        node.containingGroup.layout.isValidLayout = false;\n        var axisData = this.addAxisGroup({emptyAxis: true})\n        if(!axisData) {\n            this.diagram.commitTransaction(\"splitOlive2Half\")\n            return;\n        }\n        var waveGroup;\n        for(var i=0;i<axisData.length;i++){\n            if(axisData[i].category == \"waveGroup\"){\n                waveGroup = axisData[i]\n                break;\n            }\n        }\n        if(!waveGroup) {\n            this.diagram.commitTransaction(\"splitOlive2Half\")\n            return;\n        };\n        var curOrder = node.data.order\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        var splitOlive = []\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.category == \"wave\" && n.data.order >= curOrder && n.data.role != \"waveTail\"){\n                splitOlive.push(n)\n            }\n        }\n        for(var i=0;i<splitOlive.length;i++){\n            this.diagram.model.setDataProperty(splitOlive[i].data, \"group\", waveGroup.key)\n            var shiText = this.diagram.model.findNodeDataForKey(splitOlive[i].data.shiText)\n            var centerText = this.diagram.model.findNodeDataForKey(splitOlive[i].data.centerText)\n            var xuText = this.diagram.model.findNodeDataForKey(splitOlive[i].data.xuText)\n            if(shiText){\n                this.diagram.model.setDataProperty(shiText, \"group\", waveGroup.key)\n            }\n            if(centerText){\n                this.diagram.model.setDataProperty(centerText, \"group\", waveGroup.key)\n            }\n            if(xuText){\n                this.diagram.model.setDataProperty(xuText, \"group\", waveGroup.key)\n            }\n        }\n \n        this.diagram.commitTransaction(\"splitOlive2Half\")\n    }\n\n    // 分离常变\n    splitOlive2Cbian(){\n        var diagram = this.diagram\n        var node = diagram.selection.first()\n        if(!node) return;\n        if(node.data.category != \"wave\"){\n           return;\n        }\n\n        this.diagram.startTransaction(\"splitOlive2Cbian\")\n        // 删除橄榄\n        var shiText = this.diagram.model.findNodeDataForKey(node.data.shiText)\n        var centerText = this.diagram.model.findNodeDataForKey(node.data.centerText)\n        var xuText = this.diagram.model.findNodeDataForKey(node.data.xuText)\n        var cbian = {\n            shiText: shiText.text,\n            centerText: centerText.text,\n            xuText: xuText.text,\n            basePoint:node.location.copy().offset(0,-300),\n            group: node.data.group\n        }\n        this.deleteSelection(node)\n        // 添加常变\n        this.addCbian(cbian)\n        this.diagram.commitTransaction(\"splitOlive2Cbian\")\n    }\n\n    // 增加常变\n    addCbian(cbian){\n        console.log(\"addCbian\")\n        var diagram = this.diagram\n        var node = diagram.selection.first();\n        var group = null\n        if(node && node.data.category == \"axisGroup\"){\n            group=node.data.key;\n        }\n        var e = diagram.lastInput\n        diagram.startTransaction(\"addCbian\")\n        var groupKey = helpers.guid()\n        \n        if(cbian && cbian.basePoint){\n            var basePoint = cbian.basePoint\n        }else{\n            var basePoint = e.documentPoint\n        }\n        var groupData = {\"category\":\"picGroup\", \n         \"role\":\"cbian\", \"isGroup\":true, \"level\":0, \n        \"key\":groupKey, \"loc\":go.Point.stringify(basePoint), \"deletable\":true}\n        if(group){\n            groupData.group = group\n        }\n        if(cbian && cbian.group){\n            groupData.group = cbian.group\n        }\n        var picData = { \"group\":groupKey, \"text\":\"\", cbianName:\"cbian1\",\n        \"resizable\":false, \"category\":\"pic\", \n        \"loc\":go.Point.stringify(basePoint),\n        \"picture\":\"https://static.365trtd.com/system/cbian/cbian.png\", \"width\":150, \"height\":150}\n        // \"picture\":\"https://static.365trtd.com/system/cbian/cbian.png\", \"width\":150, \"height\":150}\n       \n        var themeData = {\"text\":\"总结\",\"role\":\"theme\", \"deletable\":false,  \"fill\":\"black\", \"iconVisible\":false, \n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(3,-3)), \n        \"movable\":true, \"group\":groupKey}\n        var timeData = {\"text\":\"时间\",\"role\":\"axisXText\", \"deletable\":false,  \"fill\":\"black\", \"iconVisible\":false, \n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(150, 0)), \n        \"movable\":true, \"group\":groupKey}\n        var energeData = {\"text\":\"能量\",\"role\":\"axisYText\", \"deletable\":false, \"fill\":\"black\", \"iconVisible\":false, \n        \"locationSpot\":\"1 0 0 0\", \"textAlign\":\"center\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(0, -150)), \n        \"movable\":true, \"group\":groupKey}\n        var text1Data = {\"text\":\"总结1\",\"role\":\"cbianText1\", \"deletable\":false,\"font\":\"normal bold 18px 'Microsoft YaHei'\", \"textStroke\":\"#0e399d\", \"iconVisible\":false, \n        \"locationSpot\":\"0 0 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(155*Math.cos(30*Math.PI/180), -150*Math.sin(30*Math.PI/180))), \n        \"movable\":true, \"group\":groupKey}\n        var text2Data = {\"text\":\"总结3\", \"role\":\"cbianText3\",\"deletable\":false, \"font\":\"normal bold 18px 'Microsoft YaHei'\", \"textStroke\":\"rgba(252, 172, 0, 1)\", \"iconVisible\":false, \n        \"locationSpot\":\"0 0.5 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(145*Math.cos(45*Math.PI/180), -150*Math.sin(45*Math.PI/180))), \n        \"movable\":true, \"group\":groupKey}\n        var text3Data = {\"text\":\"总结2\",\"role\":\"cbianText2\",\"font\":\"normal bold 18px 'Microsoft YaHei'\", \"deletable\":false, \"textStroke\":\"#cb1c27\", \"iconVisible\":false, \n        \"locationSpot\":\"0 1 0 0\", \"textAlign\":\"left\", \"category\":\"autoText\", \n        \"loc\":go.Point.stringify(basePoint.copy().offset(145*Math.cos(70*Math.PI/180), -140*Math.sin(70*Math.PI/180))), \n        \"movable\":true, \"group\":groupKey}\n\n        var cbianName = localStorage.getItem(\"cbianName\");\n        if(cbianName){\n            try{\n                var theme = JSON.parse(cbianName);\n                picData.picture = theme[\"picture\"]\n                picData.width = theme['size'][0]\n                picData.height = theme['size'][1]\n                picData.cbianName = theme['name']\n                text1Data.textStroke = theme[\"textStrokes\"][0]\n                text3Data.textStroke = theme[\"textStrokes\"][1]\n                text2Data.textStroke = theme[\"textStrokes\"][2]\n            }catch(e){\n                console.error(e)\n            }\n        }\n        if(cbian){\n            text1Data.text = cbian.shiText;\n            text2Data.text = cbian.centerText;\n            text3Data.text = cbian.xuText;\n        }\n        diagram.model.addNodeData(text1Data)\n        diagram.model.addNodeData(text2Data)\n        diagram.model.addNodeData(text3Data)\n        diagram.model.addNodeData(themeData)\n        diagram.model.addNodeData(timeData)\n        diagram.model.addNodeData(energeData)\n        diagram.model.addNodeData(picData)\n        diagram.model.addNodeData(groupData)\n        \n    //     {\"text\":\"自由文本\",\n    //     \"deletable\":true, \n    //     \"role\":\"freeText\",\n    //     \"fill\":\"black\", \n    //     \"iconVisible\":false, \n    //     \"locationSpot\":\"0.5 0.5 0 0\", \n    //     \"textAlign\":\"center\", \n    //     \"category\":\"autoText\", \n    //     \"loc\": go.Point.stringify(e.documentPoint), \n    //     \"movable\":true, \"group\":node.data.key\n    //    }\n\n        diagram.commitTransaction(\"addCbian\")\n    }\n    adjustTextAngle(...obj){\n        adjustTextAngle(obj)\n    }\n    // 增加橄榄\n    addOlive(node, cbian){\n        console.log(\"addOliveaddOlive\")\n        var diagram = this.diagram\n        if(!node){\n            node = diagram.selection.first();\n        }\n        if(!node) return;\n        var count = 0\n        var labelGroup;\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        var oliveWidth = node.containingGroup.data.oliveWidth;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.category == \"wave\"){\n                count++;\n            }\n        }\n        var maxOlive = 50;\n        if(node.containingGroup.data.maxOlive != null){\n            maxOlive = node.containingGroup.data.maxOlive\n        }\n        if(count>maxOlive){\n            return;\n        }\n        var curShiText = this.diagram.findNodeForKey(node.data.shiText)\n        var curXuText = this.diagram.findNodeForKey(node.data.xuText)\n        diagram.startTransaction(\"dspiral\")\n        var order = 1000;\n        if(node.data.order != null){\n            order = Number(node.data.order)+0.5;\n        }\n\n        var data = JSON.parse(JSON.stringify(node.data))\n        Object.assign(data, {\n            \"key\": helpers.guid(), \n            \"order\": order,\n            \"text\":\"\",\n        })\n        if(cbian){\n            data.text = cbian.centerText\n        }\n        delete data.centerText\n        delete data.__gohashid\n        delete data.hyperlink\n        delete data.figure\n        delete data.remark\n        // var data =  {\"category\":\"wave\", \n        //     \"text\":\"\", \n        //     \"level\":0, \"key\": helpers.guid(), \n        //     \"group\":node.data.group, \n        //     \"loc\":node.data.loc,\n        //     \"desiredSize\":node.data.desiredSize, \n        //     \"order\": order,\n        //     \"font\": node.data.font,\n        //     \"textStroke\": node.data.textStroke,\n        //     \"textAlign\": node.data.textAlign,\n        //     \"spacingline\": node.data.spacingline,\n        // }\n        var shiText = JSON.parse(JSON.stringify(curShiText.data))\n        delete shiText.__gohashid\n        // delete shiText.textAlign\n        delete shiText.hyperlink\n        delete shiText.figure\n        delete shiText.remark\n        delete shiText.nloc\n        Object.assign(shiText, {\n            \"key\": helpers.guid(), \n            \"order\": order,\n            \"olive\": data.key,\n            \"text\":\"\",\n        })\n        if(cbian){\n            shiText.text = cbian.shiText\n        }\n        // var shiText = {\n        // \"text\":\"\",\n        // \"minSize\":`${oliveWidth-30} 30`,\n        // \"deletable\":false,\n        //  \"font\":curShiText.data.font || \"18px 'Microsoft YaHei'\", \n        // //  \"textStroke\": curShiText.textStroke,\n        //  \"textAlign\": curShiText.data.textAlign,\n        //  \"spacingline\": curShiText.data.spacingline,\n        //  \"category\":\"autoText\", \n        //  \"key\": helpers.guid(), \"width\":300, \n        //  \"role\":\"shiText\", \"level\":0, \"group\": node.data.group, \n        //  \"order\": order,\n        //  \"olive\": data.key,\n        // }\n        var xuText = JSON.parse(JSON.stringify(curXuText.data))\n        delete xuText.__gohashid\n        // delete xuText.textAlign\n        delete xuText.hyperlink\n        delete xuText.figure\n        delete xuText.remark\n        delete xuText.nloc\n        Object.assign(xuText, {\n            \"key\": helpers.guid(), \n            \"order\": order,\n            \"olive\": data.key,\n            \"text\":\"\",\n        })\n        if(cbian){\n            xuText.text = cbian.xuText\n        }\n        // var xuText = {\n        // \"text\":\"\",\n        // \"minSize\":`${oliveWidth-30} 30`,\n        // \"deletable\":false,\n        //  \"font\": curXuText.data.font || \"18px 'Microsoft YaHei'\", \n        //  \"textAlign\": curXuText.data.textAlign,\n        //  \"spacingline\": curXuText.data.spacingline,\n        //  \"category\":\"autoText\", \n        //  \"key\": helpers.guid(), \"width\":300, \n        //  \"role\":\"xuText\", \"level\":0, \"group\": node.data.group, \n        //  \"order\": order,\n        //  \"olive\": data.key\n        // }\n        data.shiText = shiText.key\n        data.xuText = xuText.key\n\n\n        console.log(\"orderorderorderorder:\",order)\n        if(node.containingGroup){\n            node.containingGroup.layout.isOngoing = true;\n            // node.containingGroup.layout.isInit = true;\n            node.containingGroup.layout.isValidLayout = false;\n            if(node.containingGroup.containingGroup){\n                node.containingGroup.containingGroup.layout.isOngoing = true;\n                node.containingGroup.containingGroup.layout.isValidLayout = false; \n            }\n        }\n        data.isNew = true\n        diagram.model.addNodeData(data);\n        diagram.model.addNodeData(shiText);\n        diagram.model.addNodeData(xuText);\n        //diagram.model.setDataProperty(node.containingGroup,\"width\",300)\n        // diagram.model.setDataProperty(node.containingGroup,\"width\",300)\n        diagram.commitTransaction(\"dspiral\")\n        // this.diagram.updateAllTargetBindings()\n        // setTimeout(()=>{\n        //     // this.diagram.updateAllTargetBindings()\n        //     // this.diagram.layoutDiagram(true)\n        //     node.containingGroup.layout.isOngoing = true;\n        //     // node.containingGroup.layout.isInit = true;\n        //     node.containingGroup.layout.isValidLayout = false;\n        //     if(node.containingGroup.containingGroup){\n        //         node.containingGroup.containingGroup.layout.isOngoing = true;\n        //         node.containingGroup.containingGroup.layout.isValidLayout = false; \n        //     }\n        // },500)\n        // this.layoutAllGroup()\n    }\n\n\n    getAxisGroupData(options){\n        var e = this.diagram.lastInput\n        // diagram.startTransaction(\"addCbian\")\n        // var groupKey = helpers.guid()\n        \n        var basePoint = e.documentPoint\n        var baseLoc = go.Point.stringify(basePoint)\n  var axisGroupKey = helpers.guid()\n  var labelGroupKey = helpers.guid()\n  var waveGroupKey = helpers.guid()\n  var olive1Key = helpers.guid()\n  var olive2Key = helpers.guid()\n  var olive3Key = helpers.guid()\n  var olive4Key = helpers.guid()\n  var olive1ShiTextKey = helpers.guid()\n  var olive1XuTextKey = helpers.guid()\n  var olive2ShiTextKey = helpers.guid()\n  var olive2XuTextKey = helpers.guid()\n  var olive3ShiTextKey = helpers.guid()\n  var olive3XuTextKey = helpers.guid()\n  var olive4ShiTextKey = helpers.guid()\n  var olive4XuTextKey = helpers.guid()\n  var olive1CenterTextKey = helpers.guid()\n  var olive2CenterTextKey = helpers.guid()\n  var olive3CenterTextKey = helpers.guid()\n  var olive4CenterTextKey = helpers.guid()\n\n  var temp = [\n  {\"category\":\"labelGroup\", \"group\":axisGroupKey, \"role\":\"labelGroup\", \"isGroup\":true, \"level\":0, \"key\":labelGroupKey, \"loc\":go.Point.stringify(basePoint.copy().offset(30,700)), \"deletable\":false, \"selectable\":false},\n{\"category\":\"waveGroup\",\"maxOlive\":15, \"deletable\":false, \"haveTail\":true, \"oliveType\":\"Wave\", \"shiStroke\":\"#0e399d\", \"xuStroke\":\"#cb1c27\", \"centerStroke\":\"rgba(9, 166, 9, 1)\", \"oliveWidth\":150, \"oliveHeight\":120, \"isGroup\":true, \"level\":0, \"key\":waveGroupKey, \"loc\":baseLoc, \"angle\":330.08938180947, \"group\":axisGroupKey, \"movable\":false, \"desiredSize\":\"700 120\", \"textAngle\":\"horizontal\", \"centerTextAngle\":\"independent\", \"centerTextMode\":\"independent\"},\n{\"category\":\"axisGroup\", \"isGroup\":true, \"level\":0, \"key\":axisGroupKey, \"loc\":baseLoc, \"angle\":0, \"desiredSize\":\"300 150\"},\n{\"category\":\"line\", \"level\":0, \"key\":-11, \"loc\":baseLoc, \"desiredSize\":\"700 1\", \"width\":1400, \"height\":1, \"group\":waveGroupKey, \"angle\":330.08938180947, \"role\":\"centerLine\", \"selectable\":false, \"stroke\":\"rgba(9, 166, 9, 1)\"},\n{\"category\":\"line\", \"level\":0, \"key\":-8, \"loc\":\"-91.91674008334496 -140.02427812707117\", \"desiredSize\":\"606.7630471788291 10\", \"width\":1400, \"height\":1, \"angle\":0, \"group\":axisGroupKey, \"role\":\"axisX\", \"selectable\":false, \"stroke\":\"#0e399d\"},\n{\"category\":\"line\", \"level\":0, \"key\":-7, \"loc\":\"-91.91674008334496 -140.02427812707117\", \"desiredSize\":\"349.05387059630493 10\", \"width\":1400, \"height\":1, \"angle\":270, \"group\":axisGroupKey, \"role\":\"axisY\", \"selectable\":false, \"stroke\":\"#cb1c27\"},\n{\"text\":\"能量\", \"deletable\":false, \"font\":\"24px 'Microsoft YaHei'\", \"category\":\"autoText\", \"loc\":\"-101.91674008334496 -489.0781487233761\", \"key\":-12, \"role\":\"axisYText\", \"locationSpot\":\"1 0.5 0 0\", \"group\":axisGroupKey, \"movable\":true},\n{\"text\":\"主题\", \"role\":\"themeText\", \"deletable\":false, \"font\":\"24px 'Microsoft YaHei'\", \"category\":\"autoText\", \"loc\":go.Point.stringify(basePoint.copy().offset(-30,0)), \"key\":-13, \"level\":0, \"group\":axisGroupKey, \"locationSpot\":\"0.5 0 0 0\", \"movable\":true, \"width\":300},\n{\"text\":\"时间\", \"deletable\":false, \"font\":\"24px 'Microsoft YaHei'\", \"category\":\"autoText\", \"loc\":\"514.8463070954841 -140.02427812707117\", \"key\":-14, \"role\":\"axisXText\", \"group\":axisGroupKey, \"locationSpot\":\"0.5 0 0 0\"},\n{\"text\":\"实线：\", \"deletable\":false, \"fill\":\"#cb1c27\", \"iconVisible\":true, \"locationSpot\":\"0 0 0 0\", \"textAlign\":\"start\", \"category\":\"autoText\", \"loc\":go.Point.stringify(basePoint.copy().offset(30,-350)), \"role\":\"labelText1\", \"movable\":true, \"group\":labelGroupKey, \"visible\":true, \"minSize\":\"120 30\"},\n{\"text\":\"虚线：\", \"deletable\":false, \"fill\":\"#0e399d\", \"iconVisible\":true, \"locationSpot\":\"0 0 0 0\", \"textAlign\":\"start\", \"category\":\"autoText\", \"loc\":go.Point.stringify(basePoint.copy().offset(30,-310)), \"role\":\"labelText2\", \"movable\":true, \"group\":labelGroupKey, \"visible\":true, \"minSize\":\"120 30\"},\n{\"text\":\"中线：\", \"deletable\":false, \"fill\":\"#3f5369\", \"iconVisible\":true, \"locationSpot\":\"0 0 0 0\", \"textAlign\":\"start\", \"category\":\"autoText\", \"loc\":go.Point.stringify(basePoint.copy().offset(30,-270)), \"role\":\"labelText3\", \"movable\":true, \"group\":labelGroupKey, \"visible\":true, \"minSize\":\"120 30\"},\n\n{\"category\":\"wave\", \"text\":\"\", \"role\":\"waveTail\", \"deletable\":false, \"selectable\":false, \"level\":0, \"key\":\"2d6ff2f1-0966-36bf-4e85-f5775ca0652b\", \"group\":waveGroupKey, \"loc\":\"710.0826118675676 -829.1890319396903\", \"desiredSize\":\"75 120\", \"order\":999, \"oliveType\":\"Wave\", \"angle\":330.08938180947, \"textAlign\":\"center\", \"shiStroke\":\"#0e399d\", \"xuStroke\":\"#cb1c27\", \"centerText\":\"df53d882-fe51-d78e-d8e3-8d9681578cb8\", \"textVisible\":false, \"isNew\":null},\n    ]\n    if(!options){\n        temp = temp.concat([\n            {\"category\":\"wave\", \"text\":\"1\\n\", \"level\":0, \"key\":olive1Key, \"group\":waveGroupKey, \"desiredSize\":\"150 120\", \"order\":1, \"shiText\":olive1ShiTextKey, \"xuText\":olive1XuTextKey, \"angle\":330.08938180947, \"loc\":\"-91.91674008334496 -140.02427812707123\", \"oliveType\":\"Ellipse\", \"textAlign\":\"center\", \"shiStroke\":\"#cb1c27\", \"xuStroke\":\"#0e399d\", \"centerText\":olive1CenterTextKey, \"textVisible\":false},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive1ShiTextKey, \"width\":150, \"role\":\"shiText\", \"level\":0, \"group\":waveGroupKey, \"order\":1, \"olive\":olive1Key, \"loc\":\"4.128618140465704 -125.47989214278559\", \"locationSpot\":\"0 0 0 0\", \"textStroke\":\"#cb1c27\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive1XuTextKey, \"width\":150, \"role\":\"xuText\", \"level\":0, \"group\":waveGroupKey, \"order\":1, \"olive\":olive1Key, \"loc\":\"-56.2078366340385 -230.36321886941172\", \"locationSpot\":\"1 1 0 0\", \"textStroke\":\"#0e399d\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"category\":\"wave\", \"text\":\"3\\n\", \"level\":0, \"key\":olive2Key, \"group\":waveGroupKey, \"desiredSize\":\"150 120\", \"order\":3, \"shiText\":olive2ShiTextKey, \"xuText\":olive2XuTextKey, \"angle\":330.08938180947, \"loc\":\"168.12456585043884 -289.61879409691636\", \"oliveType\":\"Ellipse\", \"textAlign\":\"center\", \"shiStroke\":\"#cb1c27\", \"xuStroke\":\"#0e399d\", \"centerText\":olive2CenterTextKey, \"textVisible\":false},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive2ShiTextKey, \"width\":150, \"role\":\"shiText\", \"level\":0, \"group\":waveGroupKey, \"order\":3, \"olive\":olive2Key, \"loc\":\"264.16992407424954 -275.07440811263075\", \"locationSpot\":\"0 0 0 0\", \"textStroke\":\"#cb1c27\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive2XuTextKey, \"width\":150, \"role\":\"xuText\", \"level\":0, \"group\":waveGroupKey, \"order\":3, \"olive\":olive2Key, \"loc\":\"203.83346929974533 -379.9577348392569\", \"locationSpot\":\"1 1 0 0\", \"textStroke\":\"#0e399d\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"category\":\"wave\", \"text\":\"2\\n\", \"level\":0, \"key\":olive3Key, \"group\":waveGroupKey, \"desiredSize\":\"150 120\", \"order\":2, \"shiText\":olive3ShiTextKey, \"xuText\":olive3XuTextKey, \"angle\":330.08938180947, \"loc\":\"38.10391288354694 -214.8215361119938\", \"oliveType\":\"Ellipse\", \"textAlign\":\"center\", \"shiStroke\":\"#cb1c27\", \"xuStroke\":\"#0e399d\", \"centerText\":olive3CenterTextKey, \"textVisible\":false},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive3ShiTextKey, \"width\":150, \"role\":\"shiText\", \"level\":0, \"group\":waveGroupKey, \"order\":2, \"olive\":olive3Key, \"loc\":\"73.8128163328534 -305.1604768543343\", \"locationSpot\":\"1 1 0 0\", \"textStroke\":\"#cb1c27\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive3XuTextKey, \"width\":150, \"role\":\"xuText\", \"level\":0, \"group\":waveGroupKey, \"order\":2, \"olive\":olive3Key, \"loc\":\"134.1492711073576 -200.27715012770815\", \"locationSpot\":\"0 0 0 0\", \"textStroke\":\"#0e399d\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"category\":\"wave\", \"text\":\"4\\n\", \"level\":0, \"key\":olive4Key, \"group\":waveGroupKey, \"desiredSize\":\"150 120\", \"order\":4, \"shiText\":olive4ShiTextKey, \"xuText\":olive4XuTextKey, \"angle\":330.08938180947, \"loc\":\"298.1452188173308 -364.41605208183887\", \"oliveType\":\"Ellipse\", \"textAlign\":\"center\", \"shiStroke\":\"#cb1c27\", \"xuStroke\":\"#0e399d\", \"centerText\":olive4CenterTextKey, \"textVisible\":false},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive4ShiTextKey, \"width\":150, \"role\":\"shiText\", \"level\":0, \"group\":waveGroupKey, \"order\":4, \"olive\":olive4Key, \"loc\":\"333.8541222666372 -454.7549928241794\", \"locationSpot\":\"1 1 0 0\", \"textStroke\":\"#cb1c27\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"deletable\":false, \"text\":\"\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive4XuTextKey, \"width\":150, \"role\":\"xuText\", \"level\":0, \"group\":waveGroupKey, \"order\":4, \"olive\":olive4Key, \"loc\":\"394.1905770411414 -349.87166609755326\", \"locationSpot\":\"0 0 0 0\", \"textStroke\":\"#0e399d\", \"showBorder\":true, \"angle\":0, \"minSize\":\"120 30\", \"textAlign\":\"start\"},\n            {\"text\":\"1\\n\", \"minSize\":\"120 30\", \"deletable\":false, \"textAlign\":\"center\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive1CenterTextKey, \"width\":120, \"role\":\"centerText\", \"level\":0, \"group\":waveGroupKey, \"order\":1, \"visible\":true, \"layerName\":\"Foreground\", \"locationSpot\":\"0.5 0.5 0 0\", \"selectable\":false, \"olive\":olive1Key, \"loc\":\"-26.039609246786398 -177.92155550609866\", \"angle\":0},\n            {\"text\":\"2\\n\", \"minSize\":\"120 30\", \"deletable\":false, \"textAlign\":\"center\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive3CenterTextKey, \"width\":120, \"role\":\"centerText\", \"level\":0, \"group\":waveGroupKey, \"order\":2, \"visible\":true, \"layerName\":\"Foreground\", \"locationSpot\":\"0.5 0.5 0 0\", \"selectable\":false, \"olive\":olive3Key, \"loc\":\"103.9810437201055 -252.71881349102122\", \"angle\":0},\n            {\"text\":\"3\\n\", \"minSize\":\"120 30\", \"deletable\":false, \"textAlign\":\"center\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive2CenterTextKey, \"width\":120, \"role\":\"centerText\", \"level\":0, \"group\":waveGroupKey, \"order\":3, \"visible\":true, \"layerName\":\"Foreground\", \"locationSpot\":\"0.5 0.5 0 0\", \"selectable\":false, \"olive\":olive2Key, \"loc\":\"234.00169668699743 -327.5160714759438\", \"angle\":0},\n            {\"text\":\"4\\n\", \"minSize\":\"120 30\", \"deletable\":false, \"textAlign\":\"center\", \"font\":\"18px 'Microsoft YaHei'\", \"category\":\"autoText\", \"key\":olive4CenterTextKey, \"width\":120, \"role\":\"centerText\", \"level\":0, \"group\":waveGroupKey, \"order\":4, \"visible\":true, \"layerName\":\"Foreground\", \"locationSpot\":\"0.5 0.5 0 0\", \"selectable\":false, \"olive\":olive4Key, \"loc\":\"364.0223496538893 -402.3133294608663\", \"angle\":0},\n        ])\n    }\n  return temp\n    }\n    \n\n    // 增加拓扑\n    addAxisGroup(options){\n        console.log(\"addOliveaddOlive\")\n        var diagram = this.diagram\n        var axisGroupCount = 0;\n        for(var i=0;i<diagram.model.nodeDataArray.length;i++){\n            if(diagram.model.nodeDataArray[i].category == \"axisGroup\"){\n                axisGroupCount += 1;\n            }\n        }\n        // 最多插入13个拓扑\n        if(axisGroupCount > 13){\n            return;\n        }\n        var axisData = this.getAxisGroupData(options)\n        if(!axisData) return;\n        diagram.startTransaction(\"dspiral\")\n        for(var i=0;i<axisData.length;i++){\n            diagram.model.addNodeData(axisData[i]);\n        }\n       \n        //diagram.model.setDataProperty(node.containingGroup,\"width\",300)\n        // diagram.model.setDataProperty(node.containingGroup,\"width\",300)\n        diagram.commitTransaction(\"dspiral\")\n        return axisData\n        // this.diagram.updateAllTargetBindings()\n        // setTimeout(()=>{\n        //     // this.diagram.updateAllTargetBindings()\n        //     this.diagram.layoutDiagram(true)\n        // },500)\n        // this.layoutAllGroup()\n    }\n    // 选择文本节点\n    selectText(e) {\n        // console.log(\"selectTextselectTextselectText\")\n        var myDiagram = this.diagram\n        var node = myDiagram.selection.first();\n        if (!node) return;\n        // removeNodeRemarkTips();\n        // console.log(\"selectTExt\")\n\n        var tb = myDiagram.selection.first().findObject('TEXT');\n        if (tb) myDiagram.commandHandler.editTextBlock(tb);\n        // try{\n        //     var tmp;\n        //     if(node.containingGroup && node.containingGroup.data.category == \"waveGroup\"){\n        //         if(node.data.role == \"shiText\"){\n        //             if(node.containingGroup.labelText1 && node.data.text.trim() == \"\"){\n        //                 // node.data.text = node.containingGroup.labelText1.data.text\n        //                 tmp = node.containingGroup.labelText1.data.text.replace(\"实线：\",\"\")\n        //                 if(tmp != \"\"){\n        //                     myDiagram.currentTool.currentTextEditor.mainElement.value = tmp+\"：\"\n        //                 }\n        //             }\n        //         }\n        //         if(node.data.role == \"xuText\"){\n        //             if(node.containingGroup.labelText2 && node.data.text.trim() == \"\"){\n        //                 // node.data.text = node.containingGroup.labelText1.data.text\n        //                 tmp = node.containingGroup.labelText2.data.text.replace(\"虚线：\",\"\")\n        //                 if(tmp != \"\"){\n        //                     myDiagram.currentTool.currentTextEditor.mainElement.value = tmp+\"：\"\n        //                 }\n        //             }\n        //         }\n        //         if(node.data.category == \"wave\" || node.data.role == \"centerText\"){\n        //             if(node.containingGroup.labelText3 && node.data.text.trim() == \"\"){\n        //                 // node.data.text = node.containingGroup.labelText1.data.text\n        //                 tmp = node.containingGroup.labelText3.data.text.replace(\"中线：\",\"\")\n        //                 if(tmp != \"\"){\n        //                     myDiagram.currentTool.currentTextEditor.mainElement.value = tmp+\"：\"\n        //                 }\n        //             }\n        //         }\n        //     }\n        // }catch(e){\n        //     console.log(\"selectText:error:\",e)\n        // }\n        // 手机上支持换行，电脑上需要ctl+Enter键换行\n        if(!helpers.checkPhone()){\n            helpers.simulateEnterWithAlt(e);\n        }else{\n            var val = myDiagram.currentTool.currentTextEditor.mainElement.value\n            myDiagram.currentTool.currentTextEditor.mainElement.selectionStart = val.length; \n            myDiagram.currentTool.currentTextEditor.mainElement.selectionEnd = val.length; \n        }\n    }\n\n    clearAllTextBorder(){\n        var it = this.diagram.nodes.iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.category == \"autoText\"){\n                  n.findObject(\"textBorder\").visible = false;\n            }\n        }\n    }\n\n    triggerShowFireText(){\n        var e = this.diagram.lastInput;\n        var node = this.diagram.selection.first()\n        if(!node) return;\n        node.__trtdNode.dealFireText(e)\n    }\n    \n    // 获取火花矩阵某一圈的文字\n    apiGetFireText(theta){\n        var fireTexts = {}\n        var node = this.diagram.selection.first()\n        // var group = node.containingGroup;\n       \n        if(!node) return fireTexts\n        if(node.containingGroup && node.containingGroup.data.category == \"yunGroup\"){\n            var group = node.containingGroup;\n            var it;\n            if(theta){\n                 it = group.findSubGraphParts().iterator;\n                while(it.next()){\n                    if(it.value.data.theta == theta){\n                        node = it.value;\n                        break;\n                    }\n                }\n                it.reset();\n            }\n            var x = Math.max(Math.abs(node.data.orderX - 10), Math.abs(node.data.orderY -10))\n             it = group.findSubGraphParts().iterator;\n            while(it.next()){\n                var n = it.value;\n                if(n.data.dimX == (0) && n.data.dimY == (19)){\n                    fireTexts.dimText1 = n;\n                }\n                if(n.data.dimX == (10) && n.data.dimY == (19)){\n                    fireTexts.dimText2 = n;\n                }\n                if(n.data.dimX == (19) && n.data.dimY == (19)){\n                    fireTexts.dimText3 = n;\n                }\n                if(n.data.dimX == (19) && n.data.dimY == (10)){\n                    fireTexts.dimText4 = n;\n                }\n                if(n.data.dimX == (19) && n.data.dimY == (19)){\n                    fireTexts.dimText5 = n;\n                }\n                if(n.data.dimX == (10) && n.data.dimY == (0)){\n                    fireTexts.dimText6 = n;\n                }\n                if(n.data.dimX == (0) && n.data.dimY == (0)){\n                    fireTexts.dimText7 = n;\n                }\n                if(n.data.dimX == (0) && n.data.dimY == (10)){\n                    fireTexts.dimText8 = n;\n                }\n                if(n.data.orderX == (10-x) && n.data.orderY == (10+x)){\n                    fireTexts.text1 = n;\n                }\n \n                if(n.data.orderX == (10) && n.data.orderY == (10+x)){\n                    fireTexts.text2 = n;\n                }\n                if(n.data.orderX == (10+x) && n.data.orderY == (10+x)){\n                    fireTexts.text3 = n;\n                }\n                if(n.data.orderX == (10+x) && n.data.orderY == (10)){\n                    fireTexts.text4 = n;\n                }\n                if(n.data.orderX == (10+x) && n.data.orderY == (10-x)){\n                    fireTexts.text5 = n;\n                }\n                if(n.data.orderX == (10) && n.data.orderY == (10-x)){\n                    fireTexts.text6 = n;\n                }\n                if(n.data.orderX == (10-x) && n.data.orderY == (10-x)){\n                    fireTexts.text7 = n;\n                }\n                if(n.data.orderX == (10-x) && n.data.orderY == (10)){\n                    fireTexts.text8 = n;\n                }\n                if(n.data.subRole == \"themeText\"){\n                    fireTexts.themeText = n;\n                }\n\n            }\n            fireTexts.radius = x;\n            return fireTexts\n        }\n        return fireTexts\n    }\n\n    apiSwitchWaveTail(){\n        console.log(\"apiSwitchWaveTailapiSwitchWaveTail\")\n        var node = this.diagram.selection.first()\n        if(!node) return\n        this.diagram.startTransaction()\n        // this.diagram.model.setDataProperty(node.data, \"oliveType\", \"Ellipse\")\n        // this.diagram.model.setDataProperty(node.data, \"haveTail\", false)\n        var it = node.findSubGraphParts().iterator;\n        var waveTail= null; // 查找是否存在尾巴\n        var lastNode = null;\n        var loc;\n        while(it.next()){\n            var n = it.value;\n            lastNode = n;\n            if(n.data.role == \"waveTail\"){\n                waveTail = n;\n                break;\n            }\n        }\n        if(lastNode){\n            loc = lastNode.data.loc\n        }else{\n            loc = node.data.loc\n        }\n        if(waveTail){\n            this.diagram.model.removeNodeData(waveTail.data);\n            this.diagram.model.setDataProperty(node.data, \"haveTail\", false)\n        }else{\n            this.diagram.model.setDataProperty(node.data, \"haveTail\", true)\n            var tailOlive = {\"category\":\"wave\", \n                \"text\":\"\", \n                \"role\":\"waveTail\",\n                deletable:false,\n                \"selectable\": false,\n                \"deletable\": false,\n                \"level\":0, \"key\": helpers.guid(), \n                \"group\":node.data.key, \n                \"loc\": loc,\n                \"desiredSize\": `${node.data.oliveWidth} ${node.data.oliveHeight}`, \n                \"order\": 2000,\n            }\n            this.diagram.model.addNodeData(tailOlive)\n        }\n        node.layout.isOngoing = true;\n        node.layout.isValidLayout = false;\n        this.diagram.commitTransaction()\n    }\n\n    //切换为橄榄形状\n    apiSwitchToEllipse(){\n        console.log(\"apiSwitchToEllipse\")\n        var node = this.diagram.selection.first()\n        if(!node) return\n        this.diagram.startTransaction()\n        this.diagram.model.setDataProperty(node.data, \"oliveType\", \"Ellipse\")\n        // this.diagram.model.setDataProperty(node.data, \"haveTail\", false)\n        var it = node.findSubGraphParts().iterator;\n        var waveTail= null; // 查找是否存在尾巴\n\n        while(it.next()){\n            var n = it.value;\n            if(n.data.role == \"waveTail\"){\n                waveTail = n;\n                break;\n            }\n        }\n\n        if(waveTail){\n            this.diagram.model.removeNodeData(waveTail.data);\n        }\n        node.layout.isOngoing = true;\n        node.layout.isValidLayout = false;\n        if(node.containingGroup){\n            node.containingGroup.layout.isOngoing = true;\n            node.containingGroup.layout.isValidLayout = false;\n        }\n        this.diagram.commitTransaction()\n    }\n\n\n    \n    // 切换为螺旋形状\n    apiSwitchToWave(){\n        var node = this.diagram.selection.first()\n        if(!node) return\n        this.diagram.startTransaction(\"apiSwitchToWave\")\n        this.diagram.model.setDataProperty(node.data, \"oliveType\", \"Wave\")\n        // this.diagram.model.setDataProperty(node.data, \"haveTail\", true)\n        var it = node.findSubGraphParts().iterator;\n        var waveTail= null; // 查找是否存在尾巴\n        var lastNode = null;\n        var haveTail = node.data.haveTail\n        var loc;\n        while(it.next()){\n            var n = it.value;\n            lastNode = n;\n            if(n.data.role == \"waveTail\"){\n                waveTail = n;\n                break;\n            }\n        }\n        if(lastNode){\n            loc = lastNode.data.loc\n        }else{\n            loc = node.data.loc\n        }\n        if(!waveTail && haveTail == true){\n            var tailOlive = {\"category\":\"wave\", \n                \"text\":\"\", \n                \"role\":\"waveTail\",\n                deletable:false,\n                \"selectable\": false,\n                \"deletable\": false,\n                \"level\":0, \"key\": helpers.guid(), \n                \"group\":node.data.key, \n                \"loc\": loc,\n                \"desiredSize\": `${node.data.oliveWidth} ${node.data.oliveHeight}`, \n                \"order\": 2000,\n            }\n            this.diagram.model.addNodeData(tailOlive)\n        }\n        node.layout.isOngoing = true;\n        node.layout.isValidLayout = false;\n        if(node.containingGroup){\n            node.containingGroup.layout.isOngoing = true;\n            node.containingGroup.layout.isValidLayout = false;\n        }\n        this.diagram.commitTransaction(\"apiSwitchToWave\")\n    }\n\n    // 切换文字方向\n    apiSwitchTextAngle(textAngle){\n        var node = this.diagram.selection.first()\n        if(!node) return\n        var mapObj = {\n            \"horizontal\":\"vertical\",\n            \"vertical\":\"horizontal\",\n        }\n        console.log(\"apiSwitchTextAngle\")\n        \n        node.diagram.startTransaction(\"apiSwitchTextAngle\")\n        if(textAngle && [\"horizontal\",\"vertical\"].indexOf(textAngle) > -1){\n            node.diagram.model.setDataProperty(node.data, \"textAngle\", textAngle)\n            node.data.textAngle = textAngle\n        }else{\n           textAngle = mapObj[node.data.textAngle] || \"horizontal\"\n           node.diagram.model.setDataProperty(node.data, \"textAngle\", textAngle)\n            node.data.textAngle = textAngle\n            // }\n        }\n        // var angle = node.angle\n        // this.diagram.model.setDataProperty(node.data, \"angle\", angle+1)\n        // this.diagram.model.setDataProperty(node.data, \"angle\", angle)\n        // node.layout.isInit = true;\n        // setTimeout(()=>{\n            node.layout.isOngoing = true;\n            node.layout.isValidLayout = false;\n        // })\n        node.diagram.commitTransaction(\"apiSwitchTextAngle\")\n        // this.diagram.startTransaction(\"layout\")\n        // node.layout.isOngoing = true;\n        // node.layout.isValidLayout = false;\n        // this.diagram.commitTransaction(\"layout\")\n        // this.diagram.updateAllTargetBindings()\n        // this.diagram.layoutDiagram(true)\n    }\n\n    // 以下两个方法控制菜单显示\n    getDefaultCustomMenuDivStr(){\n        return `\n        <ul>\n            <li trtd_action=\"exportAsSubFigure\"><a class=\"i18n\" data-lang=\"cancelfix\">创建为子盘</a></li>\n            <li trtd_action=\"drillAnalyze\"><a class=\"i18n\" data-lang=\"cancelfix\">插入子盘</a></li>\n            <li trtd_action=\"addFollower\"><a class=\"i18n\" data-lang=\"insertsl\">插入同级节点</a></li>\n            <li trtd_action=\"startNewSpiral\"><a class=\"i18n\" data-lang=\"icn\">插入子节点</a></li>\n            <li trtd_action=\"apiDuplicateNode\"><a class=\"i18n\" data-lang=\"duplicateNode\">复制节点</a></li>\n            <li trtd_action=\"apiDeleteSelection\"><a class=\"i18n\" data-lang=\"remove\">删除</a></li>\n            <li trtd_action=\"clearDim\"><a class=\"i18n\" data-lang=\"clearDim\">清空维度</a></li>\n            <li trtd_action=\"splitOlive2Cbian\"><a class=\"i18n\" data-lang=\"remove\">分离</a></li>\n            <li trtd_action=\"splitOlive2Half\"><a class=\"i18n\" data-lang=\"remove\">拆分</a></li>\n            <li trtd_action=\"orderChildNode\"><a class=\"i18n\" data-lang=\"ordernode\">子节点编号</a></li>\n            <li trtd_action=\"clearOrderChildNode\"><a class=\"i18n\" data-lang=\"clearordernode\">取消子节点编号</a></li>\n            <li trtd_action=\"clearNodeTextMenu\"><a class=\"i18n\" data-lang=\"emptynodetext\">清空节点文本</a></li>\n            <li trtd_action=\"apiInsertTianpanNode\"><a class=\"i18n\" data-lang=\"insertnodetianpan\">插入天盘节点</a></li>\n            <li trtd_action=\"addTextNode\"><a class=\"i18n\" data-lang=\"inserttext\">插入文本</a></li>\n            <li trtd_action=\"locateRootNodeMenu\"><a class=\"i18n\" data-lang=\"locaterootnode\">定位根节点</a></li>\n            <li trtd_action=\"showAllNodesMenu\"><a class=\"i18n\" data-lang=\"displayallnodes\">显示所有节点</a></li>\n            <li trtd_action=\"fixPictureMenu\"><a class=\"i18n\" data-lang=\"fixnode\">固定节点</a></li>\n            <li trtd_action=\"activePictureMenu\"><a class=\"i18n\" data-lang=\"cancelfix\">取消固定</a></li>\n            <li trtd_action=\"apiSwitchToEllipse\"><a class=\"i18n\" data-lang=\"cancelfix\">切换为橄榄形状</a></li>\n            <li trtd_action=\"apiSwitchToWave\"><a class=\"i18n\" data-lang=\"cancelfix\">切换为螺旋形状</a></li>\n            <li trtd_action=\"apiSwitchWaveTail\"><a class=\"i18n\" data-lang=\"cancelfix\">添加/删除尾巴</a></li>\n            <li trtd_action=\"apiSwitchTextAngle\"><a class=\"i18n\" data-lang=\"cancelfix\">切换文字方向</a></li>\n            <li trtd_action=\"addCbian\"><a class=\"i18n\" data-lang=\"cancelfix\">添加总结图</a></li>\n            <li trtd_action=\"addAxisGroup\"><a class=\"i18n\" data-lang=\"cancelfix\">插入拓扑</a></li>\n            <li trtd_action=\"addYunText\"><a class=\"i18n\" data-lang=\"cancelfix\">添加文字</a></li>\n            <li trtd_action=\"showRect\"><a class=\"i18n\" data-lang=\"cancelfix\">显示矩形线</a></li>\n            <li trtd_action=\"hideRect\"><a class=\"i18n\" data-lang=\"cancelfix\">隐藏矩形线</a></li>\n            <li trtd_action=\"offShowRedLine\"><a class=\"i18n\" data-lang=\"cancelfix\">关闭自动显示红线</a></li>\n            <li trtd_action=\"autoShowRedline\"><a class=\"i18n\" data-lang=\"cancelfix\">自动显示自旋红线</a></li>\n            <li trtd_action=\"bringupLayer\"><a class=\"i18n\" data-lang=\"cancelfix\">上移一层</a></li>\n            <li trtd_action=\"bringdownLayer\"><a class=\"i18n\" data-lang=\"cancelfix\">下移一层</a></li>\n            <li trtd_action=\"bringToBackground\"><a class=\"i18n\" data-lang=\"cancelfix\">置于底层</a></li>\n            <li trtd_action=\"bringToForeground\"><a class=\"i18n\" data-lang=\"cancelfix\">置于顶层</a></li>\n            <li trtd_action=\"addDimTtext\"><a class=\"i18n\" data-lang=\"cancelfix\">增加维度</a></li>\n            <li trtd_action=\"switchCbianSize\"><a class=\"i18n\" data-lang=\"cancelfix\">切换大小</a></li>\n            <li trtd_action=\"copyWaveGroup\"><a class=\"i18n\" data-lang=\"cancelfix\">复制</a></li>\n        </ul>\n        `\n    }\n    getShowContextMenus(node){\n        var showIds = null\n        console.log(\"getShowContextMenus\")\n        if(node){\n            // 双螺旋可以添加常变\n            if([\"axisGroup\"].indexOf(node.data.category) > -1){\n                showIds = \"addCbian,apiDeleteSelection,exportAsSubFigure,copyWaveGroup\"\n            }\n            if([\"picGroup\"].indexOf(node.data.category) > -1){\n                showIds = \"apiDeleteSelection,switchCbianSize\"\n            }\n\n            if([\"3\"].indexOf(node.data.category) > -1){\n                showIds = \"bringupLayer,apiDeleteSelection,bringdownLayer,bringToBackground,bringToForeground\"\n            }\n\n            if( [\"wave\"].indexOf(node.data.category) > -1){\n                if(node.data.deletable != null){\n                    if(node.data.deletable){\n                        showIds = \"apiDeleteSelection,splitOlive2Cbian,splitOlive2Half\";\n                    }\n                }else{\n                    if(node.deletable){\n                        showIds = \"apiDeleteSelection,splitOlive2Cbian,splitOlive2Half\";\n                    }\n                }\n            }\n            console.log(\"waveGroupwaveGroup\")\n            if( [\"waveGroup\"].indexOf(node.data.category) > -1){\n                showIds = \"apiSwitchTextAngle,\";\n                if(node.data.oliveType == \"Ellipse\"){\n                    showIds += \"apiSwitchToWave\"\n                }else{\n                    showIds += \"apiSwitchToEllipse,apiSwitchWaveTail\"\n                }\n                \n            }\n            if( [\"yunGroup\"].indexOf(node.data.category) > -1){\n                showIds = \"addYunText,\";\n                if(node.data.showShape){\n                    showIds += \"hideRect\"\n                }else{\n                    showIds += \"showRect\"\n                }\n                if(node.data.beginSpark != \"line\"){\n                    showIds += \",autoShowRedline\"\n                }else{\n                    showIds += \",offShowRedLine\"\n                }\n            }\n            if( [\"autoText\"].indexOf(node.data.category) > -1 && [\"shiText\",\"xuText\"].indexOf(node.data.role) < 0){\n                showIds = \"apiDeleteSelection\";\n            }\n            if(node.data.subRole == \"dimText\" && node.containingGroup.data.category == \"yunpanGroup\"){\n                showIds = \"apiDeleteSelection,addDimTtext\"\n            }\n            if(node.data.category == \"shapeText\"&& node.containingGroup.data.category == \"yunpanGroup\"){\n                showIds = \"apiDeleteSelection\"\n            }\n\n            // 橄榄/文字节点可以拓扑钻取分析\n            if([\"wave\",\"autoText\",\"shapeText\"].indexOf(node.data.category)>-1){\n                if(node.data.text){\n                    showIds += \",drillAnalyze\"\n                }\n            }\n            if([\"autoText\"].indexOf(node.data.category)>-1){\n                // if(node.data.text){\n                    showIds += \",apiDuplicateNode\"\n\n                    if(node.data.subRole == \"dimText\"){\n                        showIds+=\",clearDim\"\n                    }\n                // }\n            }\n            \n            // apiDuplicateNode\n            // return \"addFollowerGround,\" + \"addNewCircle,\"+\"apiDeleteSelection\";\n        }else{\n            // return \"addFollowerGround\"\n            console.log(\"show menu ...............\", this.canAddAxisGroup)\n            if(this.canAddAxisGroup){\n                showIds = \"addCbian,addAxisGroup\"\n            }else{\n                showIds = \"addCbian\"\n\n            }\n            \n        }\n\n        return showIds;\n    }\n    \n    addYunText(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        if(!node) return;\n        var e = myDiagram.lastInput;\n        node.__trtdNode.addFreeText(e, node)\n    }\n    // 清空维度\n    clearDim(){\n        var node = this.diagram.selection.first();\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        this.diagram.startTransaction(\"clearDim\");\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.subRole == \"coreText\" && n.data.dimKey == node.data.key){\n                // if(n.data.order == node.data.order+1){\n                //     locateNode = n;\n                // }\n                this.diagram.model.setDataProperty(n.data, 'text', (n.data.theta?n.data.theta:\"\")+'')\n            }\n        }\n        this.diagram.model.setDataProperty(node.data, 'text', \"维度\")\n        this.diagram.model.setDataProperty(node.data, 'dimid', null)\n        this.diagram.commitTransaction(\"clearDim\");\n    }\n    // 云盘增加维度\n    addDimTtext(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        if(!node) return;\n        if(node.data.subRole != \"dimText\") return;\n        var count = 0\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        var deleteNodes = []\n        var deleteLines = []\n        var curLine = null;\n        var normDim = \"X\",unnormDim = \"Y\", lineRole = \"verticalLine\"\n        if(node.data.dimX == 0){\n            normDim = \"Y\"\n            unnormDim = \"X\"\n            lineRole = \"horizontalLine\"\n        }\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.subRole == \"dimText\" && n.data[\"dim\"+unnormDim] == 0){\n                // if(n.data.order == node.data.order+1){\n                //     locateNode = n;\n                // }\n                count++;\n            }\n            if(n.data.subRole == \"yunpanText\" && n.data[\"order\"+normDim] == node.data[\"dim\"+normDim]){\n                deleteNodes.push(n.data)\n            }\n            if(n.data.category == \"line\"  && n.data.role == lineRole\n            && n.data[\"order\"]  == node.data[\"dim\"+normDim]\n            ){\n                curLine = n\n            }\n            // if(n.data.role == \"xuText\" && n.data.order == node.data.order){\n            //     xuText = n;\n            // }\n            // if(n.data.role == \"centerText\" && n.data.order == node.data.order){\n            //     centerText = n;\n            // }\n\n        }\n        \n        if(count>=30){\n           \n            return;\n        }\n        this.diagram.startTransaction(\"addDimTtext\");\n        it.reset()\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.subRole == \"dimText\" && n.data[\"dim\"+unnormDim] == 0 && n.data[\"dim\"+normDim] > node.data[\"dim\"+normDim]){\n                // if(n.data.order == node.data.order+1){\n                //     locateNode = n;\n                // }\n                n.diagram.model.setDataProperty(n.data, \"dim\"+normDim, n.data[\"dim\"+normDim] + 1)\n                // count++;\n            }\n            if(n.data.subRole == \"yunpanText\" && n.data[\"order\"+normDim] > node.data[\"dim\"+normDim]){\n                n.diagram.model.setDataProperty(n.data, \"order\"+normDim, n.data[\"order\"+normDim] + 1)\n            }\n            if(n.data.category == \"line\"  && n.data.role == lineRole\n            && n.data[\"order\"]  > node.data[\"dim\"+normDim]\n            ){\n                n.diagram.model.setDataProperty(n.data, \"order\", n.data[\"order\"] + 1)\n            }\n            // if(n.data.role == \"xuText\" && n.data.order == node.data.order){\n            //     xuText = n;\n            // }\n            // if(n.data.role == \"centerText\" && n.data.order == node.data.order){\n            //     centerText = n;\n            // }\n\n        }\n        var dimTextData = JSON.parse(JSON.stringify(node.data))\n        delete dimTextData.key;\n        delete dimTextData.__gohashid;\n        if(curLine){\n            var lineData = JSON.parse(JSON.stringify(curLine.data))\n            delete lineData.key;\n            delete lineData.__gohashid;\n            lineData[\"order\"] = lineData[\"order\"]+1;\n            node.diagram.model.addNodeData(lineData)\n        }\n        // Object.assign(dimTextData, {\n\n        // })\n        dimTextData[\"dim\"+normDim] = node.data[\"dim\"+normDim]+1;\n        dimTextData.text = \"维度\" + dimTextData[\"dim\"+normDim]\n        node.diagram.model.addNodeData(dimTextData)\n        // node.diagram.model.removeNodeDataCollection(deleteNodes)\n        node.containingGroup.layout.isOngoing = true;\n        node.containingGroup.layout.isValidLayout = false;\n        this.diagram.commitTransaction(\"addDimTtext\");\n    }\n\n    switchCbianSize(){\n        console.log(\"switchCbianSizeswitchCbianSize\")\n        var node = this.diagram.selection.first();\n        if(!node) return;\n        if(node.data.cbianType == \"big\"){\n            node.__trtdNode.changeCbianSize(node,\"small\")\n        }else{\n            node.__trtdNode.changeCbianSize(node,\"big\")\n        }\n    }\n    bringToBackground(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        myDiagram.model.startTransaction();\n        myDiagram.model.setDataProperty(node.data, \"layerName\", \"Background\");\n        myDiagram.model.setDataProperty(node.data, \"zOrder\", 1);\n        myDiagram.model.commitTransaction();\n    }\n    bringToForeground(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        myDiagram.model.startTransaction();\n        myDiagram.model.setDataProperty(node.data, \"layerName\", \"Foreground\");\n        myDiagram.model.setDataProperty(node.data, \"zOrder\", 999);\n        myDiagram.model.commitTransaction();\n    }\n\n    bringdownLayer(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        if(!node) return;\n        var layerName = node.layerName;\n        var toLayerName = layerName\n        var zOrder = node.zOrder;\n        var toZOrder = 1;\n        if(layerName == \"Foreground\"){\n            toLayerName = \"default\"\n        }\n        if(layerName == \"default\"){\n            toLayerName = \"Background\"\n        }\n        if(layerName == \"Background\"){\n            toLayerName = \"Background\"\n        }\n        myDiagram.model.startTransaction();\n        myDiagram.model.setDataProperty(node.data, \"layerName\", toLayerName);\n        myDiagram.model.setDataProperty(node.data, \"zOrder\", toZOrder);\n        myDiagram.model.commitTransaction();\n    }\n    bringupLayer(){\n        var node = this.diagram.selection.first();\n        var myDiagram = this.diagram;\n        if(!node) return;\n        var layerName = node.layerName;\n        var toLayerName = layerName\n        var zOrder = node.zOrder;\n        var toZOrder = 999;\n        if(layerName == \"Background\"){\n            toLayerName = \"default\"\n        }\n        if(layerName == \"default\"){\n            toLayerName = \"Foreground\"\n        }\n        if(layerName == \"Foreground\"){\n            toLayerName = \"Foreground\"\n        }\n        myDiagram.model.startTransaction();\n        myDiagram.model.setDataProperty(node.data, \"layerName\", toLayerName);\n        myDiagram.model.setDataProperty(node.data, \"zOrder\", toZOrder);\n        myDiagram.model.commitTransaction();\n    }\n\n    bringToLayer(layerName, zOrder) {\n\n            var node = myDiagram.selection.first();\n            myDiagram.model.startTransaction();\n            if (node) {\n                if (layerName == null) {\n                    layerName = node.data.layerName ? node.data.layerName : \"\";\n                    var tempData = myDiagram.model.copyNodeData(node.data);\n                    myDiagram.model.removeNodeData(node.data);\n                    myDiagram.model.addNodeData(tempData);\n\n                } else {\n                    myDiagram.model.setDataProperty(node.data, \"layerName\", layerName);\n                }\n            }\n            myDiagram.model.commitTransaction();\n        }\n\n    showRect(){\n        var node = this.diagram.selection.first()\n        console.log(\"show shape\")\n        if(!node) return;\n        if(node.data.category != \"yunGroup\") return;\n        node.diagram.startTransaction(\"showRect\")\n        node.diagram.model.setDataProperty(node.data, \"showShape\", true)\n        var it = node.findSubGraphParts().iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.role == \"background\"){\n                node.diagram.model.setDataProperty(n.data, \"visible\", true)\n            }\n        }\n        node.layout.isValidLayout = false\n        node.diagram.commitTransaction(\"showRect\")\n    }\n    hideRect(){\n        var node = this.diagram.selection.first()\n        if(!node) return;\n        if(node.data.category != \"yunGroup\") return;\n        node.diagram.startTransaction(\"hideRect\")\n        node.diagram.model.setDataProperty(node.data, \"showShape\", false)\n        var it = node.findSubGraphParts().iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.role == \"background\"){\n                node.diagram.model.setDataProperty(n.data, \"visible\", true)\n                node.diagram.model.setDataProperty(n.data, \"stroke\", \"rgba(255,0,0,0)\")\n            }\n        }\n        node.diagram.commitTransaction(\"hideRect\")\n    }\n    autoShowRedline(){\n        var node = this.diagram.selection.first()\n        if(!node) return;\n        if(node.data.category != \"yunGroup\") return;\n        node.diagram.startTransaction(\"beginSpark\")\n        node.diagram.model.setDataProperty(node.data, \"beginSpark\", \"line\")\n        node.diagram.commitTransaction(\"beginSpark\")\n    }\n    offShowRedLine(){\n        var node = this.diagram.selection.first()\n        if(!node) return;\n        if(node.data.category != \"yunGroup\") return;\n        node.diagram.startTransaction(\"offShowRedLine\")\n        node.diagram.model.setDataProperty(node.data, \"beginSpark\", undefined)\n        node.diagram.commitTransaction(\"offShowRedLine\")\n    }\n    //快捷键\n    dokeyDownFn (e) {\n        console.log('dspirallllllllllllllllllllllllll:');\n        var diagram = this.diagram\n        var that = this;\n        var myDiagram = this.diagram;\n        var e = myDiagram.lastInput;\n        var cmd = myDiagram.commandHandler;\n        if (e.event.altKey) {\n            if (e.key == \"Q\") {\n                autoLayoutAll();\n                return;\n            } else if (e.key == \"R\") {\n                centerNode();\n                return;\n            } else if (e.key == \"C\") {\n                centerCurrentNode();\n                return;\n            } else if (e.key == \"A\") {\n                zoomToFit();\n                return;\n            }\n        }\n        if (e.event.keyCode >= 65 && e.event.keyCode <= 90 && !e.event.altKey && !e.event.ctrlKey && !e.event.shiftKey) {\n            e.bubbles = false;\n            var node = myDiagram.selection.first()\n            if(!node) return;\n            if(node.data.category == \"wave\" && node.containingGroup && node.containingGroup.data.textAngle == \"horizontal\" && node.containingGroup.data.centerTextAngle == \"independent\"){\n                node.findObject(\"TEXT\").visible = true;\n                var centerText = node.diagram.findNodeForKey(node.data.centerText)\n                if(centerText){\n                  centerText.visible = false;\n                }\n            }\n            setTimeout(()=>{\n                if(this.textDoubleClick){\n                    return this.textDoubleClick(e, node)\n                }\n                this.selectText(e, diagram);\n            },100)\n            return true;\n    \n        }\n        // console.log('catched in dokeydown ' + e.event.keyCode);\n        // console.log('catched in dokeydown ' + e.key);\n        if (e.event.keyCode === 13) { // could also check for e.control or e.shift\n            console.log(\"dspiral add Follower\")\n            var node = myDiagram.selection.first();\n            if (node && node.category == \"wave\") {\n                // this.addFollower(e, true);\n                this.addOlive()\n            }\n        } else if (e.event.keyCode === 9) { // could also check for e.control or e.shift\n            this.addFollower(true);\n        } else if (e.key === \"t\") { // could also check for e.control or e.shift\n            if (cmd.canCollapseSubGraph()) {\n                cmd.collapseSubGraph();\n            } else if (cmd.canExpandSubGraph()) {\n                cmd.expandSubGraph();\n            }\n        } else if (e.key == \"Del\") {\n            e.diagram.commandHandler.deleteSelection();\n        } else if (e.event.keyCode == 113) { //F2,不知道为什么失效了，重新赋予功能\n            // selectText();\n            this.selectText(e, diagram);\n        } else if (e.event.keyCode == 37) { //左\n            this.moveWithinNodes('left', diagram);\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        } else if (e.event.keyCode == 38) { //上\n            this.moveWithinNodes('up', diagram);\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        } else if (e.event.keyCode == 39) { //右\n            this.moveWithinNodes('right', diagram);\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        } else if (e.event.keyCode == 40) { //下\n            this.moveWithinNodes('down', diagram);\n            // go.CommandHandler.prototype.doKeyDown.call(cmd);\n        } else {\n            // call base method with no arguments\n            go.CommandHandler.prototype.doKeyDown.call(cmd);\n        }\n        e.bubbles = false; //阻止事件冒泡到dom\n    }\n\n    findPrevOlive(node){\n        if(node.data.order <= 1){\n            return null;\n        }\n        var prenode = null;\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.category == \"wave\"){\n                if(n.data.order == node.data.order-1){\n                    prenode = n;\n                    break;\n                }\n            }\n        }\n        return prenode;\n    }\n    findNextOlive(node){\n        var nextnode = null;\n        var it = node.containingGroup.findSubGraphParts().iterator;\n        while (it.next()) {\n            var n = it.value;\n            if(n.data.role == \"waveTail\"){\n                continue;\n            }\n            if(node.data.category == \"autoText\"){\n                if(n.data.role == \"shiText\"){\n                    if(n.data.order == node.data.order+1){\n                        nextnode = n;\n                        break;\n                    }\n                }\n            }else{\n                if(n.data.category == \"wave\"){\n                    if(n.data.order == node.data.order+1){\n                        nextnode = n;\n                        break;\n                    }\n                }\n            }\n\n        }\n        return nextnode;\n    }\n\n    findUpOlive(node){\n        var upnode = null;\n        if(node.data.category == \"wave\"){\n            if(node.data.order % 2 != 0){\n                upnode = this.diagram.findNodeForKey(node.data.xuText)\n            }else{\n                upnode = this.diagram.findNodeForKey(node.data.shiText)\n            }\n        }\n        if(node.data.role == \"xuText\"){\n            if(node.data.order % 2 != 0){\n                // upnode = this.diagram.findNodeForKey(node.data.xuText)\n            }else{\n                upnode = this.diagram.findNodeForKey(node.data.olive)\n            }\n        }\n        if(node.data.role == \"shiText\"){\n            if(node.data.order % 2 != 0){\n                upnode = this.diagram.findNodeForKey(node.data.olive)\n            }else{\n                // upnode = this.diagram.findNodeForKey(node.data.olive)\n            }\n        }\n        return upnode;        \n    }\n\n    findDownOlive(node){\n        var downnode = null;\n        if(node.data.category == \"wave\"){\n            if(node.data.order % 2 != 0){\n                downnode = this.diagram.findNodeForKey(node.data.shiText)\n            }else{\n                downnode = this.diagram.findNodeForKey(node.data.xuText)\n            }\n        }\n        if(node.data.role == \"xuText\"){\n            if(node.data.order % 2 != 0){\n                downnode = this.diagram.findNodeForKey(node.data.olive)\n            }else{\n                // downnode = this.diagram.findNodeForKey(node.data.olive)\n            }\n        }\n        if(node.data.role == \"shiText\"){\n            if(node.data.order % 2 != 0){\n                // downnode = this.diagram.findNodeForKey(node.data.olive)\n            }else{\n                downnode = this.diagram.findNodeForKey(node.data.olive)\n            }\n        }\n        return downnode;\n    }\n\n    moveWithinNodes(direction) {\n        var myDiagram = this.diagram;\n        var node = myDiagram.selection.first();\n        if(!node){\n            return;\n        }\n        // 火花矩阵文字\n        if(node.data.category == \"autoText\" && node.data.subRole == \"coreText\"){\n            if(!(node.containingGroup && node.containingGroup.data.category == \"yunGroup\")){\n                return;\n            }\n            var nextNode;\n            var centerOrderX = 30000\n            var centerOrderY = 30000\n            if(node.containingGroup.__yunPointsX && node.containingGroup.__yunPointsY){\n                centerOrderX = (node.containingGroup.__yunPointsX.length+1)/2\n                centerOrderY = (node.containingGroup.__yunPointsY.length+1)/2\n\n            }\n            switch (direction) {\n                case 'left':\n                    if(node.data.orderX == centerOrderX){\n                        return;\n                    } \n                    var it = node.containingGroup.findSubGraphParts().iterator;\n                    while (it.next()) {\n                        var n = it.value;\n                        if(n.data.subRole == \"coreText\" && n.data.dimKey == node.data.dimKey){\n                            if(Number(n.data.orderX) == Number(node.data.orderX)-1){\n                                nextNode = n;\n                                break;\n                            }\n                        }\n                    }\n                    break;\n                case 'up':\n                    if(node.data.orderY == centerOrderY){\n                        return;\n                    } \n                    var it = node.containingGroup.findSubGraphParts().iterator;\n                    while (it.next()) {\n                        var n = it.value;\n                        if(n.data.subRole == \"coreText\" && n.data.dimKey == node.data.dimKey){\n                            if(Number(n.data.orderY) == Number(node.data.orderY)+1){\n                                nextNode = n;\n                                break;\n                            }\n                        }\n                    }\n                    break;\n                case 'right':\n                    if(node.data.orderX == centerOrderX){\n                        return;\n                    } \n                    var it = node.containingGroup.findSubGraphParts().iterator;\n                    while (it.next()) {\n                        var n = it.value;\n                        if(n.data.subRole == \"coreText\" && n.data.dimKey == node.data.dimKey){\n                            if(Number(n.data.orderX) == Number(node.data.orderX)+1){\n                                nextNode = n;\n                                break;\n                            }\n                        }\n                    }\n                    break;\n                case 'down':\n                    if(node.data.orderY == centerOrderY){\n                        return;\n                    } \n                    var it = node.containingGroup.findSubGraphParts().iterator;\n                    while (it.next()) {\n                        var n = it.value;\n                        if(n.data.subRole == \"coreText\" && n.data.dimKey == node.data.dimKey){\n                            if(Number(n.data.orderY) == Number(node.data.orderY)-1){\n                                nextNode = n;\n                                break;\n                            }\n                        }\n                    }\n                    break;\n            }\n            if (nextNode) {\n                myDiagram.select(nextNode);\n            }\n        }\n\n        if(node.data.category == \"wave\" || node.data.role == \"shiText\" || node.data.role == \"xuText\"){\n            switch (direction) {\n                case 'left':\n                    var prevNode = this.findPrevOlive(node)\n                    if (prevNode) {\n                        myDiagram.select(prevNode);\n                    }\n                    break;\n                case 'up':\n                    var upNode = this.findUpOlive(node)\n                    if (upNode) {\n                        myDiagram.select(upNode);\n                    }\n                    break;\n                case 'right':\n                    var nextNode = this.findNextOlive(node)\n                    if (nextNode) {\n                        myDiagram.select(nextNode);\n                    }\n                    break;\n                case 'down':\n                    var downNode = this.findDownOlive(node)\n                    if (downNode) {\n                        myDiagram.select(downNode);\n                    }\n                    break;\n            }\n        }\n    }\n    // 拓扑分析\n    drillAnalyze(){\n        console.log(\"拓扑分析\")\n        var node = this.diagram.selection.first();\n        if(!node) return;\n        // 如果当前节点包含有figure属性\n        if(node.data.figure != null){\n            if(this.openFigure){\n                this.openFigure({\n                    figure: node.data.figure,\n                    title: node.data.text,\n                    key: node.data.key,\n                    node: node\n                })\n            }\n        }else{\n            if(this.createFigure){\n                var figure = this.createFigure({\n                    title: node.data.text||\"未命名拓扑\",\n                    key: node.data.key,\n                    node: node\n                })\n                // if(figure){\n                //     node.data.figure = figure;\n                // }\n            }\n        }\n\n    }\n}\n\n// export default Trtd;\nmodule.exports = Trtd;\n\n\n// WEBPACK FOOTER //\n// ./src/diagram/dspiral.js","var $ = go.GraphObject.make\r\nvar svg = require('../datas/svg.template');\r\n\r\n// 返回svg节点\r\nmodule.exports = function createArcNodeTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 2,\r\n        stroke: \"black\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Spot\",{\r\n                name: \"NODE\",\r\n                \"_controlExpand\": true,\r\n                layerName: \"Background\",\r\n                locationSpot: go.Spot.Center,\r\n                resizeCellSize: new go.Size(10, 10),\r\n                locationObjectName: \"SHAPE\",\r\n                resizable: true,\r\n                resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n                rotatable: true,\r\n                rotateObjectName: \"SHAPE\", // rotate the Shape without rotating the label\r\n                click: function(e, node){\r\n                    // console.log(node.data);\r\n                },\r\n                doubleClick: function (e, node) {\r\n                    doubleClickCreateNodeType(e);\r\n                },\r\n                selectable: true,\r\n                selectionObjectName:\"SHAPE\",\r\n                movable: true,\r\n                angle: 0,\r\n                //toMaxLinks: 1,\r\n                layoutConditions: go.Part.LayoutStandard,\r\n                //layoutConditions:~go.Part.LayoutAdded,\r\n                // fromLinkable: true, toLinkable: true,\r\n                alignment: go.Spot.Center,\r\n                alignmentFocus: go.Spot.Center,\r\n                resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n                // rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n                contextMenu: $(go.Adornment),\r\n                // contextMenu: $(go.Adornment),\r\n            },\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            $(go.Shape, {\r\n                name: \"SHAPE\",\r\n                // geometryString: \"M 0,0 a50,50 0 1,1 100,0\",\r\n                // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n                fill: \"white\",\r\n                strokeWidth: 3, \r\n                stroke: \"black\",\r\n                minSize: new go.Size(50, 50),\r\n                },\r\n                new go.Binding(\"fill\", \"fill\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                    return v;\r\n                }),\r\n                new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                    // var va = (v / 2) * Math.sqrt(2);\r\n                    // console.log(\"desiredSize\",v)\r\n                    return v\r\n                }).ofObject(\"BACKGROUND\"),\r\n                new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    // var va = (v / 2) * Math.sqrt(2);\r\n                    // console.log(\"desiredSize\",v)\r\n                    return v\r\n                }).ofObject(\"BACKGROUND\"),\r\n                new go.Binding(\"geometryString\", \"geometryString\", function(v) {\r\n                    return v;\r\n                }),\r\n            ),\r\n            $(go.Shape, \"Rectangle\",{\r\n                name: 'BACKGROUND',\r\n                fill: \"rgba(1,1,1,0)\",\r\n                // width: 450,\r\n                // height: 450,\r\n                angle: 0,\r\n                stroke: \"rgba(1,1,1,0)\",\r\n                // minSize: new go.Size(50, 50),\r\n                },\r\n                new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                    // console.log(\"vd m\", v, d )\r\n                    if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                    return go.Size.parse(v)\r\n                }).makeTwoWay(function(v) {\r\n                    return go.Size.stringify(v)\r\n                }),\r\n                // new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v){\r\n                //     return v;\r\n                // }),\r\n                // new go.Binding(\"desiredSize\", \"height\", function(v) {\r\n                //     var radius = parseInt(v ? v : 100);\r\n                //     var size = new go.Size(radius, radius);\r\n                //     return size;\r\n                // }).makeTwoWay(function(v) {\r\n                //     return v.height;\r\n                // }),\r\n                // background: \"#555\",\r\n                // stroke: \"red\"}\r\n            ),\r\n    );\r\n}\r\n\r\nfunction doubleClickCreateNodeType(e){\r\n    // console.log('eeeeeeeeeeeeeee:', e);\r\n    var myDiagram = e.diagram;\r\n    myDiagram.startTransaction();\r\n    var text = { text: \"双击编辑文本\", category: 'text' };\r\n    text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n    myDiagram.model.addNodeData(text);\r\n    myDiagram.commitTransaction()\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createArcNodeTemplate.js","var $ = go.GraphObject.make\r\nvar svg = require('../datas/svg.template');\r\n\r\n// 返回svg节点\r\nmodule.exports = function createArcNodeTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 2,\r\n        stroke: \"black\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    return $(go.Node, \"Spot\",{\r\n                name: \"NODE\",\r\n                zOrder: 10,\r\n                layerName: \"default\",\r\n                // isLayoutPositioned: false,\r\n                // defaultStretch: go.GraphObject.Horizontal,\r\n                padding: 0,\r\n                \"_controlExpand\": true,\r\n                // layerName: \"Foreground\",\r\n                locationSpot: go.Spot.LeftCenter,\r\n                resizeCellSize: new go.Size(1, 1),\r\n                locationObjectName: \"SHAPE\",\r\n                resizable: true,\r\n                resizeObjectName: \"SHAPE\", // user can resize the Shape\r\n                rotatable: true,\r\n                mouseDragEnter: function(e, obj) {\r\n                    console.log(\"mouseDragEnter line\")\r\n                },\r\n                mouseDrop: function(e, obj) {\r\n                    var node = obj.part;\r\n                    console.log(\"mouseDropmouseDropmouseDropmouseDrop line\")\r\n                },\r\n                // rotateObjectName: \"SHAPE\", // rotate the Shape without rotating the label\r\n                click: (e, node)=>{\r\n                    console.log(node.data)\r\n                },\r\n                deletable: false,\r\n                doubleClick: function (e, node) {\r\n                    // doubleClickCreateNodeType(e);\r\n                    if(!node.selectable){\r\n                        var part = e.diagram.findObjectAt(e.documentPoint,\r\n                          // Navigation function\r\n                            function(x) { return x.part; },\r\n                            // Because of the navigation function, x will always be a Part.\r\n                            function(x) { return x.canSelect() && x.data.category==\"wave\"; }\r\n                        )\r\n                        if(part){\r\n                            e.diagram.select(part)\r\n                            part.doubleClick(e, part)\r\n                        }\r\n                        // var it = parts.iterator;\r\n                        // while (it.next()) {\r\n                        //   console.log(\"#\" + it.key + \" is \" + it.value);\r\n                        // }\r\n                        \r\n                        console.log(\"partpart...........\",part)\r\n                    }\r\n                },\r\n                selectable: true,\r\n                selectionObjectName:\"SHAPE\",\r\n                movable: true,\r\n                angle: 0,\r\n                //toMaxLinks: 1,\r\n                layoutConditions: go.Part.LayoutStandard,\r\n                //layoutConditions:~go.Part.LayoutAdded,\r\n                // fromLinkable: true, toLinkable: true,\r\n                alignment: go.Spot.Center,\r\n                alignmentFocus: go.Spot.Center,\r\n                resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n                // rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n                contextMenu: $(go.Adornment),\r\n                // contextMenu: $(go.Adornment),\r\n            },\r\n            new go.Binding(\"zOrder\", \"zOrder\").makeTwoWay(),\r\n            new go.Binding(\"selectable\", \"selectable\").makeTwoWay(),\r\n            new go.Binding(\"locationSpot\", \"locationSpot\", function(v){\r\n                return go.Spot.parse(v)\r\n            }).makeTwoWay(function(v){\r\n                return go.Spot.stringify(v)\r\n            }),\r\n            new go.Binding(\"movable\", \"movable\").makeTwoWay(),\r\n            new go.Binding(\"visible\", \"visible\").makeTwoWay(),\r\n            new go.Binding(\"deletable\", \"deletable\").makeTwoWay(),\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v,m,a){\r\n                // console.log(\"wwwwwwwwwwwwwwwww:\",v,\" m:\",m.angle,\" a:\",a)\r\n                return v\r\n                a.startTransaction()\r\n                var group = a.findNodeDataForKey(m.group)\r\n                // a.setDataProperty(group, \"angle\", v)\r\n                for(var i=0;i<a.nodeDataArray.length-1;i++){\r\n                    if(a.nodeDataArray[i].group == group.key && a.nodeDataArray[i].category!=\"line\"){\r\n                        var nodeData = a.nodeDataArray[i]\r\n                        var lineLoc = go.Point.parse(m.loc)\r\n                        var nodeLoc = go.Point.parse(nodeData.loc)\r\n                        console.log('111111111')\r\n                        // distanceSquaredPoint\r\n                        var cp = lineLoc,_rotatePoint = lineLoc // 旋转中心\r\n                        \r\n                        var relativeLocation = nodeLoc.copy().subtract(lineLoc) // 原来的相对位置\r\n                        var newangle = v;\r\n                        var originalAngle = m.angle||0\r\n                        var ang = newangle - originalAngle;  // 直线旋转的角度\r\n                        // var cp = _rotatePoint; \r\n                        var angle = (nodeData.angle||0) + ang; // 橄榄旋转的角度\r\n                        var loc = cp.copy().add(relativeLocation);\r\n                        var dir = cp.directionPoint(loc);\r\n                        var newrad = (ang + dir) * (Math.PI / 180);\r\n                        var centerLocationOffset = lineLoc.copy().subtract(nodeLoc);\r\n                        // var locoffset = centerLocationOffset.copy();\r\n                        // locoffset.rotate(ang);\r\n                        var dist = Math.sqrt(cp.distanceSquaredPoint(loc));\r\n                        var offset = new go.Point(0,0).subtract(cp.copy())\r\n                        var cpOrigin = new go.Point(0,0)\r\n                        var nodeOrigin = nodeLoc.copy().offset(offset.x, offset.y)\r\n                        var newNodeOrigin = nodeOrigin.rotate(ang)\r\n                        var newNodeLoc = newNodeOrigin.copy().offset(-offset.x, -offset.y)\r\n                        console.log(\"newNodeLoc\", newNodeLoc)\r\n                        // var location = new go.Point(cp.x + dist * Math.cos(newrad),\r\n                        //     cp.y + dist * Math.sin(newrad)).subtract(locoffset); \r\n                        a.setDataProperty(nodeData, \"loc\", go.Point.stringify(newNodeLoc))                                   \r\n                        a.setDataProperty(nodeData, \"angle\", v)\r\n                    }\r\n                }\r\n                // var group = a.findNodeDataForKey(m.group)\r\n                a.setDataProperty(group, \"angle\", v)\r\n                a.commitTransaction()\r\n                return v;\r\n            }),\r\n\r\n                $(go.Shape, 'LineH', {\r\n                    name: \"SHAPE\",\r\n                    alignment: go.Spot.Left,alignmentFocus: go.Spot.Left,\r\n                    stretch: go.GraphObject.Horizontal,\r\n                    strokeCap: \"round\",\r\n                    // geometryString: \"M 0,0 a50,50 0 1,1 100,0\",\r\n                    // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n                    // margin: 10,\r\n                    strokeDashArray: [0, 0],\r\n                    width: 300,\r\n                    height:20,\r\n                    margin:0,\r\n                    fill: \"white\",\r\n                    strokeWidth: 3, \r\n                    stroke: \"black\",\r\n                    minSize: new go.Size(NaN, 10),\r\n                    maxSize: new go.Size(NaN, 20)\r\n                    },\r\n                    // $(go.TextBlock, \"alignment: Left\", { row: 0, column: 0 }),\r\n                    new go.Binding(\"fill\", \"fill\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeDashArray\", \"strokeDashArray\", function(v){\r\n                        return JSON.parse(v)\r\n                    }).makeTwoWay(function(v){\r\n                        return  JSON.stringify(v);\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    // new go.Binding(\"width\", \"width\").makeTwoWay(),\r\n                    // new go.Binding(\"height\", \"height\").makeTwoWay(),\r\n                    new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                        // console.log(\"vd m\", v, d )\r\n                        if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                        return go.Size.parse(v)\r\n                    }).makeTwoWay(function(v) {\r\n                        return go.Size.stringify(v)\r\n                    }),\r\n\r\n                    // new go.Binding(\"geometryString\", \"geometryString\", function(v) {\r\n                    //     return v;\r\n                    // }),\r\n                ),\r\n                $(go.Shape, {\r\n                    name: \"BeginArrow\",\r\n                    visible: false,\r\n                    margin:0,\r\n                    alignment: new go.Spot(0,0.5,10,0),\r\n                     alignmentFocus: go.Spot.Right,\r\n                    geometryString: \"M 0,-4 l -8,4 8,4\",\r\n                    strokeCap: \"round\",\r\n                    // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n                    fill: \"black\",\r\n                    width:10,\r\n                    height:15,\r\n\r\n                    strokeWidth: 3, \r\n                    stroke: \"black\",\r\n                    // minSize: new go.Size(50, 50),\r\n                    },\r\n                    new go.Binding(\"fill\", \"stroke\",function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"visible\", \"showBeginArrow\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"SHAPE\"),\r\n                    // new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"geometryString\", \"geometryStringArrow\", function(v) {\r\n                    //     return v;\r\n                    // }),\r\n                ),\r\n                $(go.Shape, {\r\n                    name: \"EndArrow\",\r\n                    visible: false,\r\n                    margin:0,\r\n                    alignment: new go.Spot(1,0.5,0,0),\r\n                     alignmentFocus: go.Spot.Right,\r\n                    geometryString: \"M 0,-4 l 8,4 -8,4\",\r\n                    strokeCap: \"round\",\r\n                    // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n                    fill: \"black\",\r\n                    width:10,\r\n                    height:15,\r\n\r\n                    strokeWidth: 3, \r\n                    stroke: \"black\",\r\n                    // minSize: new go.Size(50, 50),\r\n                    },\r\n                    new go.Binding(\"fill\", \"stroke\",function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"visible\", \"showEndArrow\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"SHAPE\"),\r\n                    // new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"geometryString\", \"geometryStringArrow\", function(v) {\r\n                    //     return v;\r\n                    // }),\r\n                ),\r\n                $(go.Shape, {\r\n                    name: \"Arrow\",\r\n                    visible: true,\r\n                    margin:0,\r\n                    alignment: new go.Spot(1,0.5,5,0),\r\n                     alignmentFocus: go.Spot.Right,\r\n                    geometryString: \"F M 158,-4 l 8,4 -8,4 2,-4 z\",\r\n                    strokeCap: \"round\",\r\n                    // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n                    fill: \"black\",\r\n                    width:20,\r\n                    height:15,\r\n\r\n                    strokeWidth: 3, \r\n                    stroke: \"black\",\r\n                    // minSize: new go.Size(50, 50),\r\n                    },\r\n                    new go.Binding(\"fill\", \"stroke\",function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"visible\", \"showArrow\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"SHAPE\"),\r\n                    // new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"angle\", \"angle\", function(v) {\r\n                    //     // var va = (v / 2) * Math.sqrt(2);\r\n                    //     // console.log(\"desiredSize\",v)\r\n                    //     return v\r\n                    // }).ofObject(\"BACKGROUND\"),\r\n                    // new go.Binding(\"geometryString\", \"geometryStringArrow\", function(v) {\r\n                    //     return v;\r\n                    // }),\r\n                )\r\n    )\r\n\r\n}\r\n\r\nfunction doubleClickCreateNodeType(e){\r\n    // console.log('eeeeeeeeeeeeeee:', e);\r\n    var myDiagram = e.diagram;\r\n    myDiagram.startTransaction();\r\n    var text = { text: \"双击编辑文本\", category: 'text' };\r\n    text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n    myDiagram.model.addNodeData(text);\r\n    myDiagram.commitTransaction()\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createLineNodeTemplate.js","var $ = go.GraphObject.make\r\nvar svg = require('../datas/svg.template');\r\n\r\n\r\nfunction makeWave(tx, ty, curviness, repeat) {\r\n    // if (curviness === 0) {\r\n    //   var geo = new go.Geometry(go.Geometry.Line);\r\n    //   geo.startX = 0;\r\n    //   geo.startY = 0;\r\n    //   geo.endX = tx;\r\n    //   geo.endY = ty;\r\n    //   return geo;\r\n    // }\r\n    if(tx == null) tx = 300;\r\n    if(ty == null) ty = 400;\r\n    if(!repeat) repeat = 1\r\n    var ang = go.Point.direction(0, 0, tx, ty);\r\n    var rad = (ang / 180 * Math.PI) + Math.PI/2;\r\n    var offx = curviness * Math.cos(rad);\r\n    var offy = curviness * Math.sin(rad);\r\n    var geo = new go.Geometry();\r\n    var sx = tx/repeat; var sy = ty/repeat;\r\n    var x = 0; var y = 0;\r\n    var fig = new go.PathFigure(x, y, false);\r\n    for (var i = 0; i < repeat; i++) {\r\n      var odd = (i % 2 === 1);\r\n      fig.add(new go.PathSegment(go.PathSegment.Bezier,\r\n                                  x + sx, y + sy,\r\n                                  x + offx * (odd ? -1 : 1), y + offy * (odd ? -1 : 1),\r\n                                  x + sx + offx * (odd ? -1 : 1), y + sy + offy * (odd ? -1 : 1)));\r\n      x += sx;\r\n      y += sy;\r\n    }\r\n    geo.add(fig);\r\n    return geo;\r\n  }\r\n\r\n  function computeGeo1(data, shape, curviness) {\r\n    // var curviness = 30;\r\n    if(!curviness) curviness = 30;\r\n    // if (shape.stroke === \"red\") curviness = -30;\r\n    // else if (shape.stroke === \"green\") curviness = 0;\r\n    var geo = makeWave(data.x, data.y, curviness, data.repeat);\r\n    var offset = geo.normalize();\r\n    shape.position = new go.Point(-offset.x, -offset.y);\r\n    shape.isGeometryPositioned = true;\r\n    return geo;\r\n  }\r\n\r\n  function computeGeo(data, shape){\r\n    return go.Geometry.parse(\"M 0,80 A100,80 0 1 1 200,80\")\r\n  }\r\n  function computeGeo2(data, shape){\r\n    var geo =  go.Geometry.parse(\"M 0,80 A100,80 0 1 0 200,80\")\r\n    shape.isGeometryPositioned = true\r\n    shape.position = new go.Point(-100, -100)\r\n\r\n    return geo;\r\n  }\r\n\r\n// 返回svg节点\r\nmodule.exports = function createWaveNodeTemplate (diagram) {\r\n    var properties = {\r\n        figure: \"Circle\",\r\n        fill: \"white\",\r\n        strokeWidth: 2,\r\n        stroke: \"black\",\r\n        fontSize: 15,\r\n        font: \"sans-serif\"\r\n    };\r\n    // console.log(\"createWaveNodeTemplatecreateWaveNodeTemplatecreateWaveNodeTemplate\")\r\n    // return $(go.Node,\r\n    //     {\r\n    //         click:()=>{\r\n    //             console.log(\"createWaveNodeTemplate click\")\r\n    //         }            \r\n    //     },\r\n    //     $(go.Shape, { stroke: \"green\" },\r\n    //       new go.Binding(\"geometry\", \"\", computeGeo)),\r\n    //     $(go.Shape, { stroke: \"blue\" },\r\n    //       new go.Binding(\"geometry\", \"\", computeGeo)),\r\n    //     $(go.Shape, { stroke: \"red\", strokeDashArray: [10, 10] },\r\n    //       new go.Binding(\"geometry\", \"\", computeGeo))\r\n    //   );\r\n\r\n    return $(go.Node, \"Spot\",{\r\n                name: \"NODE\",\r\n                \"_controlExpand\": true,\r\n                layerName: \"Background\",\r\n                locationSpot: go.Spot.Center,\r\n                // resizeCellSize: new go.Size(10, 10),\r\n                locationObjectName: \"BACKGROUND\",\r\n                resizable: true,\r\n                resizeObjectName: \"BACKGROUND\", // user can resize the Shape\r\n                rotatable: true,\r\n                rotateObjectName: \"BACKGROUND\", // rotate the Shape without rotating the label\r\n                click: function(e, node){\r\n                    // console.log(node.data);\r\n                },\r\n                doubleClick: function (e, node) {\r\n                    doubleClickCreateNodeType(e);\r\n                },\r\n                selectable: true,\r\n                // selectionObjectName:\"SHAPE\",\r\n                movable: true,\r\n                // width: 200, height: 200,\r\n                angle: 0,\r\n                //toMaxLinks: 1,\r\n                layoutConditions: go.Part.LayoutStandard & go.Part.LayoutNodeSized & go.Part.LayoutAdded & go.Part.LayoutNodeSized,\r\n                //layoutConditions:~go.Part.LayoutAdded,\r\n                // fromLinkable: true, toLinkable: true,\r\n                alignment: go.Spot.Center,\r\n                alignmentFocus: go.Spot.Center,\r\n                resizeAdornmentTemplate: diagram.__trtd.nodeResizeAdornmentTemplate(),\r\n                // rotateAdornmentTemplate: nodeRotateAdornmentTemplate,\r\n                contextMenu: $(go.Adornment),\r\n                // contextMenu: $(go.Adornment),\r\n            },\r\n            new go.Binding(\"location\", \"loc\", go.Point.parse).makeTwoWay(go.Point.stringify),\r\n            $(go.Shape, \"Rectangle\",{\r\n                name: 'BACKGROUND',\r\n                fill: \"rgba(1,1,1,0)\",\r\n                // width: 450,\r\n                // height: 450,\r\n                angle: 0,\r\n                stroke: \"rgba(1,1,1,1)\",\r\n                \r\n                // minSize: new go.Size(50, 50),\r\n                },\r\n                new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                    // console.log(\"vd m\", v, d )\r\n                    // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                    return go.Size.parse(v)\r\n                }).makeTwoWay(function(v) {\r\n                    return go.Size.stringify(v)\r\n                }),\r\n            ),\r\n            // $(go.Shape, { stroke: \"green\" },\r\n            //     new go.Binding(\"geometry\", \"\", computeGeo),\r\n            //     new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n            //         return v;\r\n            //     }),\r\n            //     new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n            //         return v;\r\n            //     }),\r\n            // ),M 0 0 A80,60 0 1 0 160,0\r\n            // $(go.Panel, \"Vertical\",{\r\n            //     alignment: go.Spot.Center,\r\n            //     stretch: go.GraphObject.Fill,\r\n            //     },\r\n            //     new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n            //         return v\r\n            //     }).ofObject(\"BACKGROUND\"),\r\n                $(go.Shape, { \r\n                    name:\"UP\",\r\n                    stroke: \"blue\", \r\n                    // geometryString:\"M 0,80 A100,80 0 1 1 200,80\",\r\n                    position:new go.Point(0, 0),\r\n                    isGeometryPositioned: true,\r\n                    alignment: go.Spot.Center,\r\n                    stretch: go.GraphObject.Fill\r\n                },\r\n                    new go.Binding(\"geometry\", \"\", computeGeo),\r\n                    new go.Binding(\"stroke\", \"stroke1\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    // new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                    //     // console.log(\"vd m\", v, d )\r\n                    //     // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                    //     return go.Size.parse(v)\r\n                    // }).makeTwoWay(function(v) {\r\n                    //     return go.Size.stringify(v)\r\n                    // }),\r\n                ),\r\n                $(go.Shape, { \r\n                    name:\"DOWN\",\r\n                    stroke: \"red\", \r\n                    // geometryString:\"M 0,0 A100,80 0 1 0 200,0\", \r\n                    alignment: go.Spot.Center,\r\n                    strokeDashArray: [10, 10],\r\n                    isGeometryPositioned: true,\r\n                    position:new go.Point(-100, -100),\r\n                    stretch: go.GraphObject.Fill,\r\n                 },\r\n\r\n                    // new go.Binding(\"geometry\", \"\", computeGeo),\r\n                    new go.Binding(\"geometry\", \"\", computeGeo2),\r\n                    new go.Binding(\"stroke\", \"stroke2\").makeTwoWay(function(v){\r\n                        return v;\r\n                    }),\r\n                    new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n                        return v;\r\n                    })\r\n                ),\r\n\r\n                    // new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n                    //     // console.log(\"vd m\", v, d )\r\n                    //     // if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n                    //     return go.Size.parse(v)\r\n                    // }).makeTwoWay(function(v) {\r\n                    //     return go.Size.stringify(v)\r\n                    // }),\r\n                // )\r\n            \r\n            // $(go.Shape, {\r\n            //     name: \"SHAPE\",\r\n            //     // geometryString: \"M 0,0 a50,50 0 1,1 100,0\",\r\n            //     // geometryString: \"M 0 50 L 100 100 L 100 200\",\r\n            //     fill: \"white\",\r\n            //     strokeWidth: 3, \r\n            //     stroke: \"black\",\r\n            //     minSize: new go.Size(50, 50),\r\n            //     },\r\n            //     new go.Binding(\"fill\", \"fill\").makeTwoWay(function(v){\r\n            //         return v;\r\n            //     }),\r\n            //     new go.Binding(\"stroke\", \"stroke\").makeTwoWay(function(v){\r\n            //         return v;\r\n            //     }),\r\n            //     new go.Binding(\"strokeWidth\", \"strokeWidth\").makeTwoWay(function(v){\r\n            //         return v;\r\n            //     }),\r\n            //     new go.Binding(\"desiredSize\", \"desiredSize\", function(v) {\r\n            //         // var va = (v / 2) * Math.sqrt(2);\r\n            //         // console.log(\"desiredSize\",v)\r\n            //         return v\r\n            //     }).ofObject(\"BACKGROUND\"),\r\n            //     new go.Binding(\"angle\", \"angle\", function(v) {\r\n            //         // var va = (v / 2) * Math.sqrt(2);\r\n            //         // console.log(\"desiredSize\",v)\r\n            //         return v\r\n            //     }).ofObject(\"BACKGROUND\"),\r\n            //     new go.Binding(\"geometryString\", \"geometryString\", function(v) {\r\n            //         return v;\r\n            //     }),\r\n            // ),\r\n            // $(go.Shape, \"Rectangle\",{\r\n            //     name: 'BACKGROUND',\r\n            //     fill: \"rgba(1,1,1,0)\",\r\n            //     // width: 450,\r\n            //     // height: 450,\r\n            //     angle: 0,\r\n            //     stroke: \"rgba(1,1,1,0)\",\r\n            //     // minSize: new go.Size(50, 50),\r\n            //     },\r\n            //     new go.Binding(\"desiredSize\", \"desiredSize\", function(v, d) {\r\n            //         // console.log(\"vd m\", v, d )\r\n            //         if(!v) return d.part.findObject(\"SHAPE\").measuredBounds.size;\r\n            //         return go.Size.parse(v)\r\n            //     }).makeTwoWay(function(v) {\r\n            //         return go.Size.stringify(v)\r\n            //     }),\r\n            //     // new go.Binding(\"angle\", \"angle\").makeTwoWay(function(v){\r\n            //     //     return v;\r\n            //     // }),\r\n            //     // new go.Binding(\"desiredSize\", \"height\", function(v) {\r\n            //     //     var radius = parseInt(v ? v : 100);\r\n            //     //     var size = new go.Size(radius, radius);\r\n            //     //     return size;\r\n            //     // }).makeTwoWay(function(v) {\r\n            //     //     return v.height;\r\n            //     // }),\r\n            //     // background: \"#555\",\r\n            //     // stroke: \"red\"}\r\n            // ),\r\n    );\r\n}\r\n\r\nfunction doubleClickCreateNodeType(e){\r\n    // console.log('eeeeeeeeeeeeeee:', e);\r\n    var myDiagram = e.diagram;\r\n    myDiagram.startTransaction();\r\n    var text = { text: \"双击编辑文本\", category: 'text' };\r\n    text.loc = go.Point.stringify(myDiagram.lastInput.documentPoint);\r\n    myDiagram.model.addNodeData(text);\r\n    myDiagram.commitTransaction()\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/nodeTemplate/createWaveNodeTemplate.js","\"use strict\";\r\nvar $ = go.GraphObject.make;\r\n\r\n/*\r\n*  Copyright (C) 1998-2017 by Northwoods Software Corporation. All Rights Reserved.\r\n*/\r\n\r\n/**\r\n* @constructor\r\n* @class\r\n*/\r\nfunction GroupRotatingTool() {\r\n  go.RotatingTool.call(this);\r\n\r\n  // Internal state\r\n  // ._initialInfo holds references to all selected non-Link Parts and\r\n  // their initial relative points and angles\r\n  this._initialInfo = null;\r\n  this._rotatePoint = new go.Point();\r\n  this.handleAngle = 0\r\n  this.handleArchetype =\r\n    $(go.Panel, \"Auto\",\r\n        $(go.Shape, \"BpmnActivityLoop\", { width: 30, height: 30, stroke: \"green\", fill: \"transparent\" }),\r\n        $(go.Shape, \"Rectangle\", {\r\n            width: 30,\r\n            height: 30,\r\n            stroke: \"green\",\r\n            fill: \"transparent\",\r\n            strokeWidth: 0\r\n        })\r\n    );\r\n}\r\ngo.Diagram.inherit(GroupRotatingTool, go.RotatingTool);\r\n\r\nGroupRotatingTool.prototype.doActivate = function() {\r\n \r\n  go.RotatingTool.prototype.doActivate.call(this);\r\n\r\n  // var group = this.adornedObject.part;\r\n  var group = this.adornedObject.part; \r\n  if (group instanceof go.Group && group.data.category == \"waveGroup\") {\r\n    // if (group.placeholder !== null) throw new Error(\"GroupRotatingTool can't handle Placeholder in Group\");\r\n    // assume rotation about the location point\r\n    this._rotatePoint = group.location;\r\n    // remember initial points for each Part\r\n    var infos = new go.Map(go.Part, MultiplePartInfo);\r\n    var textAngle = group.data.textAngle|| \"vertical\" // \"vertical\"\r\n    this.walkTree(group, infos, textAngle);\r\n    this._initialInfo = infos;\r\n  }\r\n}\r\n\r\nGroupRotatingTool.prototype.walkTree = function(part, infos, textAngle) {\r\n  if (part === null || part instanceof go.Link) return;\r\n\r\n  // 文字方向为横向时\r\n  if(textAngle == \"horizontal\"){\r\n    console.log(\"textAngle\")\r\n    if(part.data.category == \"autoText\") return;\r\n  }\r\n  // saves original relative position and original angle\r\n  var loc = part.locationObject.getDocumentPoint(go.Spot.Center);\r\n  var locoffset = loc.copy().subtract(part.location);\r\n  var relloc = loc.subtract(this._rotatePoint);\r\n  infos.add(part, new MultiplePartInfo(relloc, locoffset, part.rotateObject.angle));\r\n  // recurse into Groups\r\n  if (part instanceof go.Group) {\r\n    var it = part.memberParts.iterator;\r\n    while (it.next()) this.walkTree(it.value, infos,textAngle);\r\n  }\r\n};\r\n\r\nfunction MultiplePartInfo(relativeloc, locoffset, rotationAngle) {\r\n  this.relativeLocation = relativeloc;\r\n  this.centerLocationOffset = locoffset;\r\n  this.rotationAngle = rotationAngle;  // in degrees\r\n}\r\n\r\n/**\r\n* Rotate all members of a selected Group about the rotatePoint.\r\n* @this {GroupRotatingTool}\r\n* @param {number} newangle\r\n*/\r\nGroupRotatingTool.prototype.rotate = function(newangle) {\r\n  console.log(\"newangle\",newangle)\r\n  var group = this.adornedObject.part;\r\n\r\n  if (group instanceof go.Group) {\r\n    if((newangle+360)%360<300|| (newangle+360)%360>340){\r\n        if((newangle+360)%360<300) newangle=300\r\n        if((newangle+360)%360>340) newangle=340\r\n\r\n      console.log('dayu.................')\r\n      // setTimeout(()=>{\r\n        // group.diagram.startTransaction()\r\n        // group.layout.isOngoing = true;\r\n        // group.layout.isValidLayout = false;\r\n        // if(group.containingGroup ){\r\n        //   group.containingGroup.layout.isOngoing = true;\r\n        //   group.containingGroup.layout.isValidLayout = false;\r\n        // }\r\n        // group.diagram.commitTransaction() \r\n\r\n      // },100)\r\n \r\n      // return;\r\n    }\r\n  }\r\n  go.RotatingTool.prototype.rotate.call(this, newangle);\r\n  \r\n\r\n\r\n  if (group instanceof go.Group) {\r\n\r\n    var ang = newangle - this.originalAngle;\r\n    var cp = this._rotatePoint;\r\n    group.diagram.startTransaction()\r\n    var it = this._initialInfo.iterator;\r\n    while (it.next()) {\r\n      var part = it.key;\r\n      if (part instanceof go.Link) return; // only Nodes and simple Parts\r\n      var info = it.value;\r\n\r\n      // part.rotateObject.angle = info.rotationAngle + ang;\r\n      var angle = info.rotationAngle + ang;\r\n\r\n      var loc = cp.copy().add(info.relativeLocation);\r\n      var dir = cp.directionPoint(loc);\r\n      var newrad = (ang + dir) * (Math.PI / 180);\r\n      var locoffset = info.centerLocationOffset.copy();\r\n      locoffset.rotate(ang);\r\n      var dist = Math.sqrt(cp.distanceSquaredPoint(loc));\r\n      // part.location = new go.Point(cp.x + dist * Math.cos(newrad),\r\n      //                              cp.y + dist * Math.sin(newrad)).subtract(locoffset);\r\n      var location = new go.Point(cp.x + dist * Math.cos(newrad),\r\n                                   cp.y + dist * Math.sin(newrad)).subtract(locoffset);                                   \r\n      group.diagram.model.setDataProperty(part.data, \"loc\", go.Point.stringify(location))                                   \r\n      group.diagram.model.setDataProperty(part.data, \"angle\", angle) \r\n      // var git = group.memberParts;\r\n      // console.log(\"item:\",git)\r\n      // var maxWidth = 0;\r\n      // var maxHeight = 0;\r\n      // while (git.next()) {\r\n      //   var item = git.value;\r\n      //   console.log(\"item:\",item)\r\n      //   if(item.naturalBounds.width > maxWidth){\r\n      //     maxWidth = item.naturalBounds.width;\r\n      //   }\r\n      //   if(item.naturalBounds.height > maxHeight){\r\n      //     maxHeight = item.naturalBounds.height;\r\n      //   }\r\n      //   console.log(`maxHeight:${maxHeight},maxWidth:${maxWidth}`)\r\n\r\n      // }                    \r\n      // group.diagram.model.setDataProperty(group.data, \"desiredSize\", `${maxWidth+100} ${maxHeight}`)   \r\n      \r\n      // that.diagram.startTransaction();\r\n      console.log(\"isValidLayoutisValidLayout\")\r\n      // var group = that.diagram.findNodeForKey(data.key)\r\n      group.layout.isOngoing = true;\r\n      group.layout.isValidLayout = false;\r\n      if(group.containingGroup ){\r\n        group.containingGroup.layout.isOngoing = true;\r\n        group.containingGroup.layout.isValidLayout = false;\r\n      }\r\n      // that.diagram.commitTransaction();\r\n      group.diagram.commitTransaction()                          \r\n    }\r\n  }\r\n}\r\n\r\n\r\nmodule.exports = GroupRotatingTool\n\n\n// WEBPACK FOOTER //\n// ./src/tools/GroupRotatingTool.js","// \"use strict\";\n/*\n*  Copyright (C) 1998-2019 by Northwoods Software Corporation. All Rights Reserved.\n*/\n\n// HTML + JavaScript text editor menu, made with HTMLInfo\n// This is a re-implementation of the default text editor\n// This file exposes one instance of HTMLInfo, window.TextEditor\n// See also TextEditor.html\n(function(window) {\n  var textarea = document.createElement('textarea');\n  textarea.id = \"myTextArea\";\n    console.log(\"TextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditorTextEditor222222222222\")\n  textarea.addEventListener('input', function(e) {\n    var tool = TextEditor.tool;\n    if (tool.textBlock === null) return;\n    var tempText = tool.measureTemporaryTextBlock(this.value);\n    var scale = this.textScale;\n    this.style.width = 20 + tempText.measuredBounds.width * scale + 'px';\n    this.rows = tempText.lineCount;\n  }, false);\n\n  var observe;\n  if (window.attachEvent) {\n    observe = function (element, handlers) {\n      handlers.forEach(t => {\n        element.attachEvent('on' + t.evt, t.handler);\n      });\n    };\n  } else {\n    observe = function (element, handlers) {\n      handlers.forEach(t => {\n        element.addEventListener(t.evt, t.handler, false);\n      });\n    };\n  }\n\n  function resize() {\n    textarea.style.minHeight = \"40px\";\n    textarea.style.height = 'auto';\n    textarea.style.height = textarea.scrollHeight + 'px';\n  }\n\n  function delayedResize() {\n    setTimeout(resize, 0);\n  }\n\n  observe(textarea, [\n    {\n      evt: \"change\",\n      handler: resize\n    },\n    {\n      evt: \"cut\",\n      handler: delayedResize\n    },\n    {\n      evt: \"paste\",\n      handler: delayedResize\n    },\n    {\n      evt: \"drop\",\n      handler: delayedResize\n    },\n    {\n      evt: \"keydown\",\n      handler: delayedResize\n    }\n  ]);\n\n  textarea.addEventListener('keydown', function(e) {\n    var tool = TextEditor.tool;\n    if (tool.textBlock === null) return;\n    var keynum = e.which;\n    if (keynum === 13) { // Enter\n      if (tool.textBlock.isMultiline === false) e.preventDefault();\n      tool.acceptText(go.TextEditingTool.Enter);\n      return;\n    } else if (keynum === 9) { // Tab\n      tool.acceptText(go.TextEditingTool.Tab);\n      e.preventDefault();\n      return;\n    } else if (keynum === 27) { // Esc\n      tool.doCancel();\n      if (tool.diagram !== null) tool.diagram.doFocus();\n    }\n  }, false);\n\n  // handle focus:\n  textarea.addEventListener('focus', function(e) {\n    var tool = TextEditor.tool;\n    if (!tool || tool.currentTextEditor === null) return;\n\n    if (tool.state === go.TextEditingTool.StateActive) {\n      tool.state = go.TextEditingTool.StateEditing;\n    }\n\n    if (tool.selectsTextOnActivate) {\n      textarea.select();\n      textarea.setSelectionRange(0, 9999);\n    }\n  }, false);\n\n  // Disallow blur.\n  // If the textEditingTool blurs and the text is not valid,\n  // we do not want focus taken off the element just because a user clicked elsewhere.\n  textarea.addEventListener('blur', function(e) {\n    var tool = TextEditor.tool;\n    if (!tool || tool.currentTextEditor === null || tool.state === go.TextEditingTool.StateNone) return;\n\n    textarea.focus();\n\n    if (tool.selectsTextOnActivate) {\n      textarea.select();\n      textarea.setSelectionRange(0, 9999);\n    }\n  }, false);\n\n\n  var TextEditor = new go.HTMLInfo();\n\n  TextEditor.valueFunction = function() { return textarea.value; }\n\n  TextEditor.mainElement = textarea; // to reference it more easily\n\n  // used to be in doActivate\n  TextEditor.show = function(textBlock, diagram, tool) {\n      console.log(\"show.......................\")\n    if (!(textBlock instanceof go.TextBlock)) return;\n\n    TextEditor.tool = tool;  // remember the TextEditingTool for use by listeners\n\n    // This is called during validation, if validation failed:\n    if (tool.state === go.TextEditingTool.StateInvalid) {\n      textarea.style.border = '3px solid red';\n      textarea.focus();\n      return;\n    }\n\n    // This part is called during initalization:\n\n    var loc = textBlock.getDocumentPoint(go.Spot.Center);\n    var pos = diagram.position;\n    var sc = diagram.scale;\n    var textscale = textBlock.getDocumentScale() * sc;\n    if (textscale < tool.minimumEditorScale) textscale = tool.minimumEditorScale;\n    // Add slightly more width/height to stop scrollbars and line wrapping on some browsers\n    // +6 is firefox minimum, otherwise lines will be wrapped improperly\n    var textwidth = (textBlock.naturalBounds.width * textscale) + 6;\n    var textheight = (textBlock.naturalBounds.height * textscale) + 2;\n    var left = (loc.x - pos.x) * sc;\n    var top = (loc.y - pos.y) * sc;\n\n    textarea.value = textBlock.text;\n    // the only way you can mix font and fontSize is if the font inherits and the fontSize overrides\n    // in the future maybe have textarea contained in its own div\n    diagram.div.style['font'] = textBlock.font;\n\n    var paddingsize = 1;\n    textarea.style['position'] = 'absolute';\n    textarea.style['zIndex'] = '100';\n    textarea.style['font'] = 'inherit';\n    textarea.style['fontSize'] = (textscale * 100) + '%';\n    textarea.style['lineHeight'] = 'normal';\n    textarea.style['width'] = (textwidth) + 'px';\n    textarea.style['left'] = ((left - (textwidth / 2) | 0) - paddingsize) + 'px';\n    textarea.style['top'] = ((top - (textheight / 2) | 0) - paddingsize) + 'px';\n    textarea.style['textAlign'] = textBlock.textAlign;\n    textarea.style['margin'] = '0';\n    textarea.style['padding'] = paddingsize + 'px';\n    textarea.style['border'] = '0';\n    textarea.style['outline'] = 'none';\n    textarea.style['whiteSpace'] = 'pre-wrap';\n    textarea.style['overflow'] = 'hidden'; // for proper IE wrap\n    textarea.rows = textBlock.lineCount;\n    textarea.textScale = textscale; // attach a value to the textarea, for convenience\n    textarea.className = 'goTXarea';\n\n    // Show:\n    diagram.div.appendChild(textarea);\n\n    // After adding, focus:\n    textarea.focus();\n    if (tool.selectsTextOnActivate) {\n      textarea.select();\n      textarea.setSelectionRange(0, 9999);\n    }\n\n    resize();\n  };\n\n  TextEditor.hide = function(diagram, tool) {\n    diagram.div.removeChild(textarea);\n    TextEditor.tool = null;  // forget reference to TextEditingTool\n  }\n\n  window.TextEditor = TextEditor;\n})(window);\n\n\n\n// WEBPACK FOOTER //\n// ./src/tools/textEditor.js"],"sourceRoot":""}