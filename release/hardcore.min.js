(function(e,a){'object'==typeof exports&&'object'==typeof module?module.exports=a():'function'==typeof define&&define.amd?define('hardcore',[],a):'object'==typeof exports?exports.hardcore=a():e.hardcore=a()})('undefined'==typeof self?this:self,function(){var _Mathabs=Math.abs,_Mathmin=Math.min,_Mathsqrt=Math.sqrt,_Mathcos=Math.cos,_Mathsin=Math.sin,_MathPI=Math.PI,_Mathmax=Math.max;return function(e){function a(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,a),i.l=!0,i.exports}var t={};return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},a.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return a.d(t,'a',t),t},a.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},a.p='http://static.365trtd.com/hardcore/',a(a.s=13)}([function(e){'use strict';var a=e.exports={checkPhone:function(){return!navigator||!!navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)},guid:function(){function e(){return(0|65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()},getElementByAttr:function(e,a,t,o){for(var r=e.getElementsByTagName(a),d=[],l=0;l<r.length;l++)r[l].getAttribute(t)==o&&d.push(r[l]);return d},clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},nodeInfo:function(e){var a='Node '+e.key+': '+e.text+'\n';return a+=e.group?'member of '+e.group:'top-level node',a},linkInfo:function(e){return'Link:\nfrom '+e.from+' to '+e.to},groupInfo:function(e){var a=e.adornedPart,t=a.memberParts.count,o=0;return a.memberParts.each(function(e){e instanceof go.Link&&o++}),'Group '+a.data.key+': '+a.data.text+'\n'+t+' members including '+o+' links'},queue:function(){this.data=[],this.enqueue=function(e){this.data.unshift(e)},this.dequeue=function(){this.data.pop()}},tdTravelTdpDataWidth:function(e,t,o,i){var r=new a.queue;void 0,r.enqueue(e);for(var d=null;!r.isEmpty();)if(d=r.dequeue(),o.push(i(d)),d.isparent){var l=t.findNodeDataForKey(d.isparent);if(l)for(r.enqueue(l);l.next&&l.next!=l.key&&(l=t.findNodeDataForKey(l.next),l);)r.enqueue(l)}},tdTravelTdpData:function(e,t,o,i){if(e)try{o.push(i(e))}catch(a){return}else return;if(e.isparent){var r=t.findNodeDataForKey(e.isparent);a.tdTravelTdpData(r,t,o,i)}if(e.next&&e.next!=e.key){var d=t.findNodeDataForKey(e.next);a.tdTravelTdpData(d,t,o,i)}},deleteOldData:function(e){var a,t;for(var o in window.localStorage)if(window.localStorage.hasOwnProperty(o)&&o.startsWith('TDCurrent'))try{a=JSON.parse(window.localStorage.getItem(o)),t=new Date().getTime()-a.modelData.updatedAt,t/1e3>86400*e&&(window.localStorage.removeItem(o))}catch(a){continue}},saveModelToLocalStorage:function(e,t){if(t.modelData.updatedAt=new Date().getTime(),!!window.localStorage){a.deleteOldData(3);try{window.localStorage.setItem('TDCurrent'+e,t.toJson())}catch(t){a.deleteOldData(1)}}},checkModel:function(e){function t(a){var t=e.findNodeDataForKey(a);return t?'exist':'not exist'}var o=e.nodeDataArray,i=e.findNodeDataForKey(1);a.tdTravelTdpData(i,e,[],function(e){'check key:'+e.key+',level:'+e.level+',parent:'+e.parent+','+('isparent:'+e.isparent+',prev:'+e.prev+',next:'+e.next);e.next&&'not exist'==t(e.next)&&void 0,e.isparent&&'not exist'==t(e.isparent)&&void 0,e.parent&&'not exist'==t(e.parent)&&void 0,e.prev&&'not exist'==t(e.prev)&&void 0})},tdTransToNum:function(e,a){1>=arguments.length&&(a=0);var t=a;try{return t=parseFloat(e),t}catch(a){return t}},simulateEnterWithAlt:function(a){var t=a.diagram;if(t.currentTool.currentTextEditor){var o=function(a){var e=a;if(e.which&&(13==e.keyCode&&e.altKey||10==e.keyCode&&e.ctrlKey||13==e.keyCode&&e.shiftKey||10==e.keyCode&&e.shiftKey)){var o=this.selectionStart,i=this.selectionEnd,r=this.value;return this.value=r.slice(0,o)+'\n'+r.slice(i),this.selectionStart=this.selectionEnd=o+1,!1}return!!(13!=e.keyCode||e.altKey)||(t.currentTool.isActive&&t.currentTool.acceptText(go.TextEditingTool.LostFocus),!1)};t.currentTool.currentTextEditor.mainElement.onkeypress=null,t.currentTool.currentTextEditor.mainElement.onkeypress=o;var i=t.currentTool.currentTextEditor.mainElement.value;e.exports.checkPhone()&&(t.currentTool.currentTextEditor.mainElement.selectionStart=i.length,t.currentTool.currentTextEditor.mainElement.selectionEnd=i.length)}},travelParts:function(e,a){var t=e.diagram;a(e);var o=e.containingGroup;o&&o.data.parent==e.data.key&&a(o);for(var i=[e],r,d,l,s;0<i.length;)if(r=i.pop(),r.data.isparent)for(l=t.findNodeForKey(r.data.isparent),d=r.findLinksTo(l).first(),a(d),a(l),o=l.containingGroup,o&&o.data.parent==l.data.key&&a(o),i.push(l);l.data.next;)s=t.findNodeForKey(l.data.next),d=l.findLinksTo(s).first(),a(d),a(s),o=s.containingGroup,o&&o.data.parent==s.data.key&&a(o),i.push(s),l=s}}},function(e){'use strict';function a(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}var t=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),o=go.GraphObject.make;void 0,go.GraphObject.defineBuilder('CircleButton',function(){function a(a,e){var t=a.diagram.findObjectAt(a.documentPoint,function(e){for(;null!==e.panel;){if(e.isActionable)return e;e=e.panel}return e},function(a){return a===e});return null!==t}var e='#F5F5F5',t='#BDBDBD',o=2.76142374915397,i=2.761423749153969,r=go.GraphObject.make(go.Panel,'Auto',{isActionable:!0,enabledChanged:function(e,a){var t=e.findObject('ButtonBorder');null!==t&&(t.fill=a?e._buttonFillNormal:e._buttonFillDisabled)},cursor:'pointer',_buttonFillNormal:e,_buttonStrokeNormal:t,_buttonFillOver:'#E0E0E0',_buttonStrokeOver:'#9E9E9E',_buttonFillPressed:'#BDBDBD',_buttonStrokePressed:'#9E9E9E',_buttonFillDisabled:'#E5E5E5'},go.GraphObject.make(go.Shape,{name:'ButtonBorder',figure:'Circle',spot1:new go.Spot(0,0,o,i),spot2:new go.Spot(1,1,-o,-i),parameter1:2,parameter2:2,fill:e,stroke:t}));return r.mouseEnter=function(a,e){if(e.isEnabledObject()){var t=e.findObject('ButtonBorder');if(t instanceof go.Shape){var o=e._buttonFillOver;e._buttonFillNormal=t.fill,t.fill=o,o=e._buttonStrokeOver,e._buttonStrokeNormal=t.stroke,t.stroke=o}}},r.mouseLeave=function(a,e){if(e.isEnabledObject()){var t=e.findObject('ButtonBorder');t instanceof go.Shape&&(t.fill=e._buttonFillNormal,t.stroke=e._buttonStrokeNormal)}},r.actionDown=function(a,e){if(e.isEnabledObject()&&null!==e._buttonFillPressed&&0===a.button){var t=e.findObject('ButtonBorder');if(t instanceof go.Shape){var o=a.diagram,i=o.skipsUndoManager;o.skipsUndoManager=!0;var r=e._buttonFillPressed;e._buttonFillOver=t.fill,t.fill=r,r=e._buttonStrokePressed,e._buttonStrokeOver=t.stroke,t.stroke=r,o.skipsUndoManager=i}}},r.actionUp=function(t,e){if(e.isEnabledObject()&&null!==e._buttonFillPressed&&0===t.button){var o=e.findObject('ButtonBorder');if(o instanceof go.Shape){var i=t.diagram,r=i.skipsUndoManager;i.skipsUndoManager=!0,a(t,e)?(o.fill=e._buttonFillOver,o.stroke=e._buttonStrokeOver):(o.fill=e._buttonFillNormal,o.stroke=e._buttonStrokeNormal),i.skipsUndoManager=r}}},r.actionCancel=function(t,e){if(e.isEnabledObject()&&null!==e._buttonFillPressed){var o=e.findObject('ButtonBorder');if(o instanceof go.Shape){var i=t.diagram,r=i.skipsUndoManager;i.skipsUndoManager=!0,a(t,e)?(o.fill=e._buttonFillOver,o.stroke=e._buttonStrokeOver):(o.fill=e._buttonFillNormal,o.stroke=e._buttonStrokeNormal),i.skipsUndoManager=r}}},r.actionMove=function(t,e){if(e.isEnabledObject()&&null!==e._buttonFillPressed){var o=t.diagram;if(0===o.firstInput.button&&(o.currentTool.standardMouseOver(),a(t,e))){var i=e.findObject('ButtonBorder');if(i instanceof go.Shape){var r=o.skipsUndoManager;o.skipsUndoManager=!0;var d=e._buttonFillPressed;i.fill!==d&&(i.fill=d),d=e._buttonStrokePressed,i.stroke!==d&&(i.stroke=d),o.skipsUndoManager=r}}}},r});var i=function(){function e(t){a(this,e);this;this.diagram=t.diagram,this.nodeProperties=this.getNodeProperties(),this.binding=this.getBinding()}return t(e,[{key:'getNodeProperties',value:function(){var e=this,a=this.diagram;return{}}},{key:'getNodeSelectionAdornmentTemplate',value:function(){return o(go.Adornment,'Auto',o(go.Shape,'Rectangle',{fill:null,stroke:'dodgerblue',strokeWidth:3}),o(go.Placeholder))}},{key:'getBinding',value:function(){return[new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('copyable','copyable').makeTwoWay()]}},{key:'getTextBuild',value:function(){return o(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.4),font:'bold 18px \u5E7C\u5706',editable:!0,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Uniform},new go.Binding('textAlign','textAlign',function(e){return-1<['start','center','end'].indexOf(e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return helpers.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return helpers.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e-30}).ofObject('main'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay())}},{key:'getNodeTemplate',value:function(){var e=this;return o(go.Node,e.nodeProperties,e.binding)}},{key:'click',value:function(a,e){e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)}},{key:'doubleClick',value:function(a,e){a.diagram.__trtd.selectText(a,e)}},{key:'mouseOver',value:function(a,e){a.diagram.__trtd.showNodeRemarkTips(a,e)}},{key:'mouseLeave',value:function(a){a.diagram.__trtd.removeNodeRemarkTips()}},{key:'mouseDragEnter',value:function(a,e){var t=e.part,o=a.diagram.selection.first();if(o instanceof go.Node&&'3'!=o.category&&'text'!=o.category&&1!=o.key){var i=t.findObject('SHAPE');i&&(i._prevFill=i.fill,i.fill='darkred')}}},{key:'mouseDragLeave',value:function(a,e){var t=e.part,o=t.findObject('SHAPE');o&&o._prevFill&&(o.fill=o._prevFill)}},{key:'mouseDrop',value:function(a,e){var t=e.part,o=a.diagram.selection.first();if(o instanceof go.Node&&'3'!=o.data.category&&'text'!=o.data.category&&1!=o.data.key)if(t.data.isparent){for(var i=a.diagram.findNodeForKey(t.data.isparent);i.data.next;)i=a.diagram.findNodeForKey(i.data.next);if(i.data.key==o.data.key)return;a.diagram.__trtd.setNodeAsSibling(o,i)}else a.diagram.__trtd.setNodeAsChildren(o,t)}}]),e}();e.exports=i},function(e){'use strict';function a(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var t=go.GraphObject.make;e.exports=function(e){return t(go.Node,'Auto',a({name:'NODE',_controlExpand:!0,layerName:'Background',zOrder:20,locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,rotateObjectName:'SHAPE',doubleClick:function(a,e){void 0,e.diagram.__trtd.nodeDoubleClickListener&&e.diagram.__trtd.nodeDoubleClickListener(e)},click:function(a,e){void 0,e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},selectable:!0,movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:e.__trtd.nodeContextMenu,selectionAdornmentTemplate:function(){var e=go.GraphObject.make;return e(go.Adornment,'Spot',e(go.Panel,'Auto',e(go.Shape,{fill:null,stroke:'blue',strokeWidth:1}),e(go.Placeholder)),e(go.Panel,'Vertical',{name:'ButtonIcon1',alignment:new go.Spot(0,1,-20,20),alignmentFocus:go.Spot.Center,width:60,height:60,isActionable:!0},e(go.Shape,'Circle',{fill:'rgba(1,1,1,0)',strokeWidth:0,stroke:'green',width:50,height:50})))}()},'contextMenu',function(){var e=go.GraphObject.make;return e(go.Adornment,'Vertical',e('ContextMenuButton',e(go.TextBlock,'\u5220\u9664'),{click:function(a){a.diagram.commandHandler.deleteSelection()}}),e('ContextMenuButton',e(go.TextBlock,'\u5C45\u4E2D'),{click:function(){centerPicture()}}),e('ContextMenuButton',e(go.TextBlock,'\u7B49\u5BBD\u9AD8'),{click:function(){equalWidthHeightPicture()}}),e('ContextMenuButton',e(go.TextBlock,'\u539F\u59CB\u6BD4\u4F8B',{stroke:'gray'}),{click:function(){}}),e('ContextMenuButton',e(go.TextBlock,'\u81F3\u4E8E\u9876\u5C42'),{click:function(){bringToLayer('Foreground')}}),e('ContextMenuButton',e(go.TextBlock,'\u81F3\u4E8E\u5E95\u5C42'),{click:function(){bringToLayer('Background')}}),e('ContextMenuButton',e(go.TextBlock,'\u4E0A\u79FB\u4E00\u5C42'),{click:function(){bringToLayer(null)}}),e('ContextMenuButton',e(go.TextBlock,'\u56FA\u5B9A',new go.Binding('text','',function(e,a){var t=a.part;return t.data.selectable==void 0?'\u56FA\u5B9A':t.data.selectable?'\u56FA\u5B9A':'\u53D6\u6D88\u56FA\u5B9A'})),{name:'fixnode',click:function(a,e){var t=e.diagram,o=e.part;t.startTransaction(),t.model.setDataProperty(o.data,'selectable',o.data.selectable!=void 0&&!o.data.selectable),t.commitTransaction()}}))}()),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),t(go.TextBlock,new go.Binding('text','text')),t(go.Picture,{name:'SHAPE'},{successFunction:function(e){e.width&&e.height||e.part.data.width&&e.part.data.height||(e.width=e.element.width,e.height=e.element.height)}},{sourceCrossOrigin:function(){return''}},new go.Binding('source','picture',function(e){return e+'?'+Date.now()}).makeTwoWay(function(e){return e?(e=e.replace(/\?.*$/g,''),e):''}),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('angle','pictureangle').makeTwoWay(),new go.Binding('opacity','opacity',function(e){return e?parseFloat(e):1}).makeTwoWay(function(e){return e})))}},function(e){'use strict';var a=go.GraphObject.make;e.exports=function(){var e={figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:1,stroke:'rgba(0,0,0,0)',fontSize:15,font:'sans-serif'};return a(go.Node,'Spot',{_controlExpand:!0,layerName:'Foreground',movable:!0,locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,location:new go.Point(0,0),toMaxLinks:1,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,contextMenu:a(go.Adornment),doubleClick:function(a,e){a.diagram.__trtd.selectText(a,e)}},new go.Binding('locationSpot','locationSpot',function(e){return go.Spot.parse(e)}).makeTwoWay(function(e){return go.Spot.stringify(e)}),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),a(go.Shape,{strokeDashArray:null,name:'SHAPE',figure:'Rectangle',fill:'rgba(0,0,0,0)',fromLinkable:!0,toLinkable:!0,cursor:'pointer',minSize:new go.Size(50,50),strokeWidth:2,stroke:'rgba(0,0,0,0)',portId:'',width:150},new go.Binding('strokeDashArray','strokeDashArray',function(e){return[e.split()[0],e.split()[1]]}).makeTwoWay(function(e){return e[0]+' '+e[1]}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),{figure:e.figure,fill:e.fill,strokeWidth:e.strokeWidth,stroke:e.stroke}),a(go.Shape,{name:'SHAPE_Back',figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:0},new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('height','height',function(e){return e}).ofObject('SHAPE')),a(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'bold 18px \u5E7C\u5706',editable:!0,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Fill},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return helpers.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return helpers.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()))}},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}function d(e,a){if(a.diagram.model.setDataProperty(e,'strokeWidth',a.diagram.__trtd.tdCurrentTheme.borderWidth),a.diagram.model.setDataProperty(e,'stroke',a.diagram.__trtd.tdCurrentTheme.borderColor),null==a.diagram.__trtd.tdCurrentTheme.colorRange)a.diagram.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0]);else if(a.diagram.__trtd.tdCurrentTheme.colorRange instanceof Array){var t='white';t=e.level>=a.diagram.__trtd.tdCurrentTheme.colorRange.length?a.diagram.__trtd.tdCurrentTheme.colorRange[e.level%a.diagram.__trtd.tdCurrentTheme.colorRange.length]:a.diagram.__trtd.tdCurrentTheme.colorRange[e.level],a.diagram.model.setDataProperty(e,'fill',t)}else if('random'!=a.diagram.__trtd.tdCurrentTheme.colorRange)'white'==a.diagram.__trtd.tdCurrentTheme.colorRange?a.diagram.model.setDataProperty(e,'fill','white'):a.diagram.model.setDataProperty(e,'fill','rgba(0,0,0,0)');else if(e.prev){var o=a.diagram.findNodeForKey(e.prev);o?a.diagram.model.setDataProperty(e,'fill',o.data.fill):a.diagram.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0])}else a.diagram.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0]);return e}function l(e,a,t){var o=a,i;for(t||(t=0);o.parent&&!(o.level==t);)i=e.findNodeDataForKey(o.parent),i&&(o=i);return o}function s(e,a){for(var t=a.diagram,o=e;o.data.parent&&o.data.parent!=a.data.key;)o=t.findNodeForKey(o.data.parent);return null!=o.data.parent}function c(e){if(null!=e.data.parent){var a=e.diagram,t=e.diagram.model;if(e.data.prev){var o=a.findNodeForKey(e.data.prev);if(e.data.next){var i=a.findNodeForKey(e.data.next);t.setDataProperty(o.data,'next',i.data.key),t.setDataProperty(i.data,'prev',o.data.key);var r=o.findLinksTo(e).first();t.setToKeyForLinkData(r.data,i.data.key);var r=e.findLinksTo(i).first();t.removeLinkData(r.data)}else{t.setDataProperty(o.data,'next',null);var r=o.findLinksTo(e).first();t.removeLinkData(r.data)}}else{var d=a.findNodeForKey(e.data.parent);if(e.data.next){var i=a.findNodeForKey(e.data.next);t.setDataProperty(d.data,'isparent',i.data.key),t.setDataProperty(i.data,'prev',null);var r=d.findLinksTo(e).first();t.setToKeyForLinkData(r.data,i.data.key),r=e.findLinksTo(i).first(),t.removeLinkData(r.data)}else{if(!d)return;t.setDataProperty(d.data,'isparent',null);var r=d.findLinksTo(e).first();r&&t.removeLinkData(r.data);var l=d.containingGroup;l&&(t.setDataProperty(d.data,'group',l.data.group),t.removeNodeData(l.data))}}t.setDataProperty(e.data,'parent',null),t.setDataProperty(e.data,'prev',null),t.setDataProperty(e.data,'next',null)}}function g(e,a){var t=a.diagram,o=t.__trtd.tdCurrentTheme;return null!=o.linkColor&&t.model.setDataProperty(e,'color',o.linkColor),e}function m(e,a){if(null==e.data.group&&null!=e.data.isparent){var t=o.findNodeForKey(e.data.isparent);if(t){var o=e.diagram,i=o.model,r={isGroup:!0,parent:e.data.key,key:'g_'+e.data.key,group:a,level:e.data.level};i.addNodeData(r),i.setDataProperty(e.data,'group',r.key);var d=t.containingGroup;for(d?i.setDataProperty(d.data,'group',r.key):i.setDataProperty(t.data,'group',r.key);t.data.next;)t=o.findNodeForKey(t.data.next),d=t.containingGroup,d?i.setDataProperty(d.data,'group',r.key):i.setDataProperty(t.data,'group',r.key)}}}function p(a,e){var t=a.diagram,o=a.diagram,i=o.selection.first();if(i){var r=l(o.model,i.data,0);o.startTransaction('ControlAutoLayout'),S.tdTravelTdpData(r,o.model,[],function(a){o.findNodeForKey(a.key).containingGroup&&o.findNodeForKey(a.key).containingGroup.layout&&(o.findNodeForKey(a.key).containingGroup.layout.isInitial=e,o.findNodeForKey(a.key).containingGroup.layout.isOngoing=e)}),r.group&&o.findNodeForKey(r.group)?(o.findNodeForKey(r.group).layout.isInitial=e,o.findNodeForKey(r.group).layout.isOngoing=e):(o.layout.isInitial=e,o.layout.isOngoing=e)}else o.nodes.each(function(a){o.findNodeForKey(a.data.key).layout&&(o.findNodeForKey(a.data.key).layout.isInitial=e,o.findNodeForKey(a.data.key).layout.isOngoing=e)}),o.layout.isInitial=e,o.layout.isOngoing=e;o.commitTransaction('ControlAutoLayout')}function u(e){if(e){var a=e.containingGroup;a&&(a.layout.isInitial=!0,a.layout.isOngoing=!0)}}function y(e,a){var t=a.diagram.__trtd.tdCurrentTheme;return t.groupStrokeWidth&&a.diagram.model.setDataProperty(e,'strokeWidth',t.groupStrokeWidth),t.groupStroke&&(e.stroke=t.groupStroke,a.diagram.model.setDataProperty(e,'stroke',t.groupStroke)),t.groupColor&&(e.fill=t.groupColor,a.diagram.model.setDataProperty(e,'fill',t.groupColor)),e}function h(e){if(e.data.isparent){var a=e.location.copy(),t=new go.Point(0,0),o=e.diagram.findNodeForKey(e.data.isparent),i=o.location.copy(),r=new go.Point(i.x-a.x,i.y-a.y),d=r.copy().rotate(-90),l=new go.Point(d.x+a.x,d.y+a.y);return l}var a=e.location.copy(),s=f(e.actualBounds.width+100,225);return a.offset(s[0],s[1]),a}function k(e,a){var t=a.location.copy(),o=e.location.copy(),i=new go.Point(o.x-t.x,o.y-t.y),r=new go.Point(0,0),d=20;if(e.data.next){var l=e.diagram.findNodeForKey(e.data.next),s=l.location.copy(),c=new go.Point(s.x-t.x,s.y-t.y),g=new go.Point((i.x+c.x)/2,(i.y+c.y)/2),m=r.directionPoint(g)-r.directionPoint(i);g=i.rotate(m);var p=f(d,r.directionPoint(g));g.offset(p[0],p[1]);var u=new go.Point(g.x+t.x,g.y+t.y);return u}if(e.data.prev&&e.diagram.findNodeForKey(e.data.prev)){var y=e.diagram.findNodeForKey(e.data.prev).location.copy(),h=new go.Point(y.x-t.x,y.y-t.y),m=r.directionPoint(i)-r.directionPoint(h);45<m&&(m=45)}else var m=60;var k=i.rotate(m),p=f(d,r.directionPoint(k));return k.offset(p[0],p[1]),k=new go.Point(k.x+t.x,k.y+t.y),k}function f(e,a){var t,o;return 0<=a&&90>=a?(t=e*_Mathsin(a*_MathPI/180),o=e*_Mathcos(a*_MathPI/180),[o,t]):90<a&&180>=a?(t=e*_Mathsin((180-a)*_MathPI/180),o=e*_Mathcos((180-a)*_MathPI/180),[-o,t]):180<a&&270>=a?(t=e*_Mathsin((a-180)*_MathPI/180),o=e*_Mathcos((a-180)*_MathPI/180),[-o,-t]):270<a&&360>=a?(t=e*_Mathsin((360-a)*_MathPI/180),o=e*_Mathcos((360-a)*_MathPI/180),[o,-t]):void 0}function T(e,a,t){var o=t.diagram;if(e.next){var i=o.model.findNodeDataForKey(e.next);return a.push(i),T(i,a,t)}return a}var x=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),b=t(14),S=t(0),v=t(10).Trtd,w=t(12),P=t(7),B=t(2),D=t(5),N=t(3),A=t(6),C=t(30),W=go.GraphObject.make,O=['#FFBFBF','#E9BFFF','#D1FF72','#00A2E8','#99D9EA'],L=function(e){function a(e,t){o(this,a);var r=i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));return r.config=t,r.modelChangedListener=t.modelChangedListener,r.type=t.type,r.diagram={},r.model=t.model,r.initDiagramBase(e,t),r.initDiagram(e,t),r.initListener(),r.model&&r.initModel(),r}return r(a,e),x(a,[{key:'initDiagram',value:function(e,a){var t=Object.assign({},a.diagramConfig);this.diagram.setProperties(t),this.addNodeTemplate(),this.addLinkTemplate(),this.addGroupTemplate()}},{key:'getTdData',value:function(){return this.diagram.model.toJson()}},{key:'getDefaultCustomMenuDivStr',value:function(){return'\n        <ul>\n            <li trtd_action="addFollower"><a class="i18n" data-lang="insertsl">\u63D2\u5165\u540C\u7EA7\u8282\u70B9</a></li>\n            <li trtd_action="startNewSpiral"><a class="i18n" data-lang="icn">\u63D2\u5165\u5B50\u8282\u70B9</a></li>\n            <li trtd_action="apiDuplicateNode"><a class="i18n" data-lang="duplicateNode">\u590D\u5236\u8282\u70B9</a></li>\n            <li trtd_action="apiDeleteSelection"><a class="i18n" data-lang="remove">\u5220\u9664</a></li>\n            <li trtd_action="orderChildNode"><a class="i18n" data-lang="ordernode">\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearOrderChildNode"><a class="i18n" data-lang="clearordernode">\u53D6\u6D88\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearNodeTextMenu"><a class="i18n" data-lang="emptynodetext">\u6E05\u7A7A\u8282\u70B9\u6587\u672C</a></li>\n            <li trtd_action="apiInsertTianpanNode"><a class="i18n" data-lang="insertnodetianpan">\u63D2\u5165\u5929\u76D8\u8282\u70B9</a></li>\n            <li trtd_action="addTextNode"><a class="i18n" data-lang="inserttext">\u63D2\u5165\u6587\u672C</a></li>\n            <li trtd_action="locateRootNodeMenu"><a class="i18n" data-lang="locaterootnode">\u5B9A\u4F4D\u6839\u8282\u70B9</a></li>\n            <li trtd_action="showAllNodesMenu"><a class="i18n" data-lang="displayallnodes">\u663E\u793A\u6240\u6709\u8282\u70B9</a></li>\n            <li trtd_action="fixPictureMenu"><a class="i18n" data-lang="fixnode">\u56FA\u5B9A\u8282\u70B9</a></li>\n            <li trtd_action="activePictureMenu"><a class="i18n" data-lang="cancelfix">\u53D6\u6D88\u56FA\u5B9A</a></li>\n\n            <li trtd_action="delYunpanAxis"><a class="i18n" data-lang="cancelfix">\u5220\u9664 CTRL+DEL</a></li>\n            <li trtd_action="addYunpanAxis"><a class="i18n" data-lang="cancelfix">\u589E\u52A0 CTRL+X/Y</a></li>\n        </ul>\n        '}},{key:'getShowContextMenus',value:function(e){var a='';if(e){if('autoText'==e.data.category)return'apiDeleteSelection';if('picGroup'==e.data.category)return'apiDeleteSelection';'8'==e.data.category&&(a='apiDeleteSelection,'),'text'==e.data.category&&(a='apiDeleteSelection,apiDuplicateNode'),'3'==e.data.category&&(a='apiDeleteSelection,',a+=e.selectable?',fixPictureMenu':',activePictureMenu'),('0'==e.data.category||'1'==e.data.category||'2'==e.data.category||''==e.data.category)&&(a='apiDeleteSelection,apiDuplicateNode,addFollower,startNewSpiral,orderChildNode,clearOrderChildNode'),('yunpanx'==e.data.category||'yunpany'==e.data.category)&&(a='delYunpanAxis,addYunpanAxis')}else a='addTextNode,apiInsertTianpanNode';return a}},{key:'apiInsertTianpanNode',value:function(){var e=this.diagram;e.startTransaction();var a={key:S.guid(),text:'\u53CC\u51FB\u7F16\u8F91\u5185\u5BB9',level:0,radius:100,fill:'white',category:'0',strokeWidth:2,stroke:'black',font:'bold 18px \u5E7C\u5706',textStroke:'black',newAdd:!0,angle:5};a.loc=go.Point.stringify(e.lastInput.documentPoint),e.model.addNodeData(a),e.commitTransaction()}},{key:'fixPictureMenu',value:function(){var e=this.diagram,a=e.findPartAt(e.lastInput.documentPoint,!1);e.startTransaction(),e.model.setDataProperty(a.data,'selectable',void 0!=a.data.selectable&&!a.data.selectable),e.commitTransaction()}},{key:'activePictureMenu',value:function(){this.fixPictureMenu()}},{key:'addTextNode',value:function(e){var a=this.diagram;a.startTransaction();var t={text:e||w.trans('blankText'),category:'autoText'};t.loc=go.Point.stringify(a.lastInput.documentPoint),a.model.addNodeData(t),a.commitTransaction()}},{key:'guid',value:function(){function e(){return(0|65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()}},{key:'initModel',value:function(e){e&&(this.model=e);var a=go.Model.fromJson(this.model);'dipan'==a.modelData.currentType&&(a.nodeDataArray=a.nodeDataArray.filter(function(e){if(!e.isGroup)return delete e.group,!0}),a.linkDataArray=[]),a.modelData.currentType||(a.modelData.currentType=this.type),-1<['jin','shui','wheel','huo'].indexOf(this.type)&&(a.modelData.currentType='tianpan'),this.diagram.layout.isInitial=!1,a.modelData.type=this.type;for(var t=0;t<a.nodeDataArray.length;t++)'waveGroup'==a.nodeDataArray[t].category&&(!a.nodeDataArray[t].centerTextAngle&&(a.nodeDataArray[t].centerTextAngle='independent'),!a.nodeDataArray[t].centerTextMode&&(a.nodeDataArray[t].centerTextMode='independent'),!a.nodeDataArray[t].maxOlive&&(a.nodeDataArray[t].maxOlive=50)),'yunGroup'==a.nodeDataArray[t].category&&(!a.nodeDataArray[t].shapeStrokes&&(a.nodeDataArray[t].shapeStrokes=['RGBA(237,28,36,0.3)','RGBA(255,192,0,0.3)','RGBA(255,255,0,0.3)','RGBA(146,208,80,0.3)','RGBA(192,200,250,0.3)','RGBA(255,178,125,0.3)','RGBA(209,110,210,0.3)','RGBA(248,163,62,0.3)','RGBA(248,161,164,0.3)','RGBA(244,115,120,0.3)']),!a.nodeDataArray[t].beginSpark&&(a.nodeDataArray[t].beginSpark='line'),null==a.nodeDataArray[t].showShape&&(a.nodeDataArray[t].showShape=!0)),'shape'==a.nodeDataArray[t].category&&'background'==a.nodeDataArray[t].role&&(a.nodeDataArray[t].visible=!0),a.nodeDataArray[t].role&&-1<a.nodeDataArray[t].role.indexOf('labelText')&&(a.nodeDataArray[t].movable=!0),'labelGroup'==a.nodeDataArray[t].category&&(a.nodeDataArray[t].selectable=!1);this.diagram.model=a,this.diagram.updateAllTargetBindings()}},{key:'loadModel',value:function(e){this.diagram.animationManager.isEnabled=!1,this.initModel(e)}},{key:'initListener',value:function(){}},{key:'addGroupTemplate',value:function(){this.diagram.groupTemplateMap.add('',W(go.Group,'Auto',{layerName:'Background',selectable:!1,pickable:!1,locationSpot:go.Spot.Center,ungroupable:!0,alignment:go.Spot.Center,click:function(){},contextClick:function(){},alignmentFocus:go.Spot.Center,selectionAdornmentTemplate:W(go.Adornment,'Spot',W(go.Panel,'Auto',W(go.Shape,'Circle',{stroke:'dodgerblue',strokeWidth:2,fill:null},new go.Binding('width','',function(){var e=myDiagram.selection.first();if(e instanceof go.Group)return e.actualBounds.width}),new go.Binding('height','',function(){var e=myDiagram.selection.first();if(e instanceof go.Group)return e.actualBounds.height})),W(go.Placeholder)),W(go.Panel,'Horizontal',{alignment:go.Spot.Top,alignmentFocus:go.Spot.Bottom})),copyable:!1},{layout:W(b,{isRealtime:!1,radius:NaN,clockwise:!0,isInitial:!1}),layoutConditions:go.Part.LayoutStandard&~go.Part.LayoutNodeSized&~go.Part.LayoutAdded},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),W(go.Panel,'Auto',W(go.Shape,'Circle',{name:'SHAPE',fill:'rgba(212,230,188,0)',stroke:null,spot1:new go.Spot(.01,.01),spot2:new go.Spot(.99,.99)},new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),new go.Binding('desiredSize','radius',function(e){var a=parseInt(e?e:100),t=new go.Size(a,a);return t}).makeTwoWay(function(e){return e.width})),W(go.Placeholder,{margin:0}))))}},{key:'addNodeTemplate',value:function(){var e=this,a=this.diagram;this.addNodeTemplateBase(),a.nodeTemplateMap.add('0',P(this.diagram)),a.nodeTemplateMap.add('1',P(this.diagram)),a.nodeTemplateMap.add('2',P(this.diagram)),a.nodeTemplateMap.add('3',B(this.diagram)),a.nodeTemplateMap.add('4',D(this.diagram)),a.nodeTemplateMap.add('',P(this.diagram)),a.nodeTemplateMap.add('8',A(this.diagram))}},{key:'addLinkTemplate',value:function(){this.diagram.linkTemplateMap.add('',C(this.diagram))}},{key:'setNodeAsChildren',value:function(e,a){if(!s(a,e)&&a.data.isparent!=e.data.key){var t=e.diagram,o=e.diagram.model;if(o.startTransaction('setNodeAsChildren'),c(e),a.data.isparent){var i=t.findNodeForKey(a.data.isparent);o.setDataProperty(a.data,'isparent',e.data.key),o.setDataProperty(i.data,'prev',e.data.key),o.setDataProperty(e.data,'next',i.data.key),o.setDataProperty(e.data,'parent',a.data.key);var r=a.findLinksTo(i).first();o.setToKeyForLinkData(r.data,e.data.key);var d=o.copyLinkData(r.data);d.from=e.data.key,d.to=i.data.key,o.addLinkData(d)}else{o.setDataProperty(a.data,'isparent',e.data.key),o.setDataProperty(e.data,'next',null),o.setDataProperty(e.data,'parent',a.data.key);var d={from:a.data.key,to:e.data.key,level:a.data.level+1,isTreeLink:!0};d.strokeWidth=2,g(d,e),o.addLinkData(d);var l={isGroup:!0,group:a.data.group,parent:a.data.key,key:'g_'+a.data.key,level:a.data.level};o.addNodeData(l),o.setDataProperty(a.data,'group',l.key)}var p=e.containingGroup;p&&p.data.parent==e.data.key?o.setDataProperty(p.data,'group',a.data.group):null==e.data.parent&&null!=e.data.isparent?m(e,a.data.group):o.setDataProperty(e.data,'group',a.data.group);var u=e.data.level-a.data.level-1;S.travelParts(e,function(e){o.setDataProperty(e.data,'level',e.data.level-u)}),o.commitTransaction('setNodeAsChildren')}}},{key:'setNodeAsSibling',value:function(e,a){if(!s(a,e)&&a.data.next!=e.data.key){var t=e.diagram,o=e.diagram.model;if(o.startTransaction('setNodeAsSibling'),c(e),null!=a.data.next){var i=t.findNodeForKey(a.data.next);o.setDataProperty(a.data,'next',e.data.key),o.setDataProperty(e.data,'next',i.data.key),o.setDataProperty(e.data,'prev',a.data.key),o.setDataProperty(i.data,'prev',e.data.key),o.setDataProperty(e.data,'parent',a.data.parent);var r=a.findLinksTo(i).first();o.setToKeyForLinkData(r.data,e.data.key);var d=o.copyLinkData(r.data);d.from=e.data.key,d.to=i.data.key,o.addLinkData(d)}else{o.setDataProperty(a.data,'next',e.data.key),o.setDataProperty(e.data,'next',null),o.setDataProperty(e.data,'prev',a.data.key),o.setDataProperty(e.data,'parent',a.data.parent),o.setDataProperty(e.data,'fill',a.data.fill);var l=a.findLinksInto().first(),d=o.copyLinkData(l.data);d.from=a.data.key,d.to=e.data.key,o.addLinkData(d)}var g=e.data.level-a.data.level;S.travelParts(e,function(e){o.setDataProperty(e.data,'level',e.data.level-g)});var p=e.containingGroup,u=t.findNodeForKey(a.data.parent);if(p&&p.data.parent==e.data.key?o.setDataProperty(e.containingGroup.data,'group',u.data.group):null==e.data.parent&&null!=e.data.isparent?m(e,u.data.group):o.setDataProperty(e.data,'group',u.data.group),u&&u.containingGroup){var y=u.containingGroup;y&&(y.layout.isOngoing=!0,y.layout.isValidLayout=!1)}o.commitTransaction('setNodeAsSibling')}}},{key:'setNodeAsChildren',value:function(e,a){if(!s(a,e)&&a.data.isparent!=e.data.key){var t=e.diagram,o=e.diagram.model;if(o.startTransaction('setNodeAsChildren'),c(e),a.data.isparent){var i=t.findNodeForKey(a.data.isparent);o.setDataProperty(a.data,'isparent',e.data.key),o.setDataProperty(i.data,'prev',e.data.key),o.setDataProperty(e.data,'next',i.data.key),o.setDataProperty(e.data,'parent',a.data.key);var r=a.findLinksTo(i).first();o.setToKeyForLinkData(r.data,e.data.key);var d=o.copyLinkData(r.data);d.from=e.data.key,d.to=i.data.key,o.addLinkData(d)}else{o.setDataProperty(a.data,'isparent',e.data.key),o.setDataProperty(e.data,'next',null),o.setDataProperty(e.data,'parent',a.data.key);var d={from:a.data.key,to:e.data.key,level:a.data.level+1,isTreeLink:!0};d.strokeWidth=2,g(d,e),o.addLinkData(d);var l={isGroup:!0,group:a.data.group,parent:a.data.key,key:'g_'+a.data.key,level:a.data.level};o.addNodeData(l),o.setDataProperty(a.data,'group',l.key)}var p=e.containingGroup;p&&p.data.parent==e.data.key?o.setDataProperty(p.data,'group',a.data.group):null==e.data.parent&&null!=e.data.isparent?m(e,a.data.group):o.setDataProperty(e.data,'group',a.data.group);var u=e.data.level-a.data.level-1;S.travelParts(e,function(e){o.setDataProperty(e.data,'level',e.data.level-u)}),o.commitTransaction('setNodeAsChildren')}}},{key:'deleteSelection',value:function(a){var e=this.diagram,t=e.commandHandler,o=e.selection.first();if(o&&!(o instanceof go.Group)&&1!=o.data.key&&'g_1'!=o.data.key){for(var r=null,d=['next','prev','parent'],l=0;l<d.length;l++)if(o.data[d[l]]){r=e.findNodeForKey(o.data[d[l]]);break}e.startTransaction('deleteSelection1');try{if(o instanceof go.Link)return;e.startTransaction('sub'),this.deleteNode(o,a),e.commitTransaction('sub'),go.CommandHandler.prototype.deleteSelection.call(t)}catch(a){e.commitTransaction('deleteSelection1')}e.commitTransaction('deleteSelection1'),r&&e.select(r)}}},{key:'deleteNode',value:function(e){var a=this.diagram,t=null;if(e instanceof go.Group&&e.memberParts.each(function(e){e.data.isparent&&(t=e)}),e=null==t?e:t,e instanceof go.Node){var o=e.findNodesInto().first()?e.findNodesInto().first():null,i=e.data.next?a.findNodeForKey(e.data.next):null;if(i)var r=i.findLinksInto().first();else var r=null;var d=e.findLinksInto().first(),l={};l=JSON.parse(JSON.stringify(e.data));var s=e.findLinksInto().first()?e.findLinksInto().first().data:null,c={};if(delete s.points,c=JSON.parse(JSON.stringify(s)),delete c.__gohashid,delete c.points,e.data.group)var g=a.findNodeForKey(e.data.group);else var g=null;try{if(e.data.isparent){var m=[],p=[];a.nodes.each(function(a){a.isMemberOf(g)&&a.data.key!=e.data.key&&(m.push(a.data),0<a.findLinksInto().count&&p.push(a.findLinksInto().first().data))}),t&&m.push(e.data),a.model.removeNodeDataCollection(m),a.model.removeLinkDataCollection(p),a.model.removeNodeData(g.data)}if(null!=o){if(o.data.key!=l.parent)a.model.setDataProperty(o.data,'next',null==i?null:i.data.key),null!=i&&(c.from=o.data.key,c.to=i.data.key,a.model.setDataProperty(i.data,'prev',o.data.key),a.model.addLinkData(c));else if(null==i){var u=a.findNodeForKey(o.data.group),y=a.findNodeForKey(o.data.parent);'Root'!==o.data.category&&(y?a.model.setDataProperty(o.data,'group',y.data.group):u&&u.data.group?a.model.setDataProperty(o.data,'group',u.data.group):a.model.setDataProperty(o.data,'group',void 0)),a.model.setDataProperty(o.data,'isparent',void 0),u&&a.model.removeNodeData(u.data)}else c.from=o.data.key,c.to=i.data.key,a.model.setDataProperty(i.data,'prev',void 0),a.model.addLinkData(c),a.model.setDataProperty(a.model.findNodeDataForKey(l.parent),'isparent',i.data.key);d&&a.model.removeLinkData(d.data),r&&a.model.removeLinkData(r.data)}}catch(e){}}a.isModified=!0}},{key:'addLevelNodeData',value:function(e){var a=null==window.localStorage.getItem('isautolayout')||'true'==window.localStorage.getItem('isautolayout'),t=e.diagram,o='tianpan',i=e.data.next,r=(t.model.nodeDataArray.length+1).toString(),l={key:r,text:w.trans('dce'),color:'yellow'};t.model.makeNodeDataKeyUnique(l),r=l.key;var s=null,c=null,m=t.model.findNodeDataForKey(e.data.parent).group;e.findNodesOutOf().each(function(a){a.data.level==e.data.level&&(s=a)});var c=null;e.findLinksOutOf().each(function(a){a.data.level==e.data.level&&(c=a)}),t.model.startTransaction(),l=d(l,e);null!=s&&(l.next=s.data.key,t.model.setDataProperty(s.data,'prev',l.key)),m&&(l.group=m),l.level=e.data.level,(l.radius=e.data.radius,l.fill=e.data.fill),l.parent=e.data.parent,l.prev=e.data.key,l.strokeWidth=e.data.strokeWidth,l.stroke=e.data.stroke,l.font=e.data.font,l.textStroke=e.findObject('TEXT').stroke,e.data.figure&&(l.figure=e.data.figure),l.loc=e.data.loc;var p=e.location.copy();if(e.data.parent){var u=t.findNodeForKey(e.data.parent);u&&(p=k(e,u))}l.loc=go.Point.stringify(p),e.data.width&&(l.width=e.data.width),e.data.height&&(l.height=e.data.height),l.category=e.data.category,l.newAdd=!0,t.model.addNodeData(l);var y={from:e.data.key,to:l.key};if(y.level=e.data.level,y.color=l.fill,y.isTreeLink=!0,y=g(y,e),y.strokeWidth=2,e.findLinksInto()&&e.findLinksInto().first()?(y.color=e.findLinksInto().first().data.color,y.strokeWidth=e.findLinksInto().first().data.strokeWidth,y.toArrow=e.findLinksInto().first().data.toArrow,y.strokeDashArray=e.findLinksInto().first().data.strokeDashArray):y=g(y,e),'dipan'==o,t.model.addLinkData(y,e),t.model.setDataProperty(e.data,'next',r),null!=c){var h={};delete c.data.points,h=JSON.parse(JSON.stringify(c.data)),delete h.__gohashid,delete h.points,h.from=l.key,h.to=c.data.to,t.model.removeLinkData(c.data),t.model.addLinkData(h)}return t.model.commitTransaction(),t.isModified=!0,l}},{key:'addFollower',value:function(a,t){if(!a)var a=this.diagram.lastInput;var o=a.diagram,i=o.selection.first();if(i){var r=i.diagram;if(null!==i&&i instanceof go.Node&&!(i instanceof go.Group)&&0!=i.findLinksInto().count){if(o.toolManager.textEditingTool.isActive){var d=o.selection.first().findObject('TEXT');d.text=o.toolManager.textEditingTool.currentTextEditor.innerText,o.toolManager.textEditingTool.stopTool()}3<=i.data.level?(p(a,!1),u(i)):p(a,!0),o.model.startTransaction('all');var l=this.addLevelNodeData(i);if(o.model.commitTransaction('all'),'undefined'!=typeof t&&!0==t){var s=r.findNodeForData(l);s&&r.select(s),o.isModified=!0;var d=o.selection.first().findObject('TEXT');d&&o.commandHandler.editTextBlock(d),S.simulateEnterWithAlt(a)}}}}},{key:'startNewSpiral',value:function(a){var t=this.diagram,o=t.lastInput,e=t.selection.first();if(e){var i=e.diagram;if(null!==e&&e instanceof go.Node&&!(e instanceof go.Group)&&!(e.data.isparent&&t.findNodeForKey(e.data.isparent)&&!t.findNodeForKey(e.data.isparent).visible)){2<=e.data.level?(p(o,!1),u(e)):p(o,!0),t.startTransaction(),t.startTransaction('addChildNodeData');var r=this.addChildNodeData(e);if(t.commitTransaction('addChildNodeData'),t.commitTransaction(),'undefined'!=typeof a&&!0==a){var d=t.findNodeForData(r);d&&t.centerRect(d.actualBounds),i.select(d);var l=t.selection.first().findObject('TEXT');l&&t.commandHandler.editTextBlock(l),S.simulateEnterWithAlt(o)}}}}},{key:'addChildNodeData',value:function(e){var a=null==window.localStorage.getItem('isautolayout')||'true'==window.localStorage.getItem('isautolayout'),t=e.diagram,o=arguments[1]?arguments[1]:null,i='tianpan';i='tianpan';var r=(t.model.nodeDataArray.length+1).toString(),l={key:r,text:w.trans('dce')};t.model.makeNodeDataKeyUnique(l),r=l.key;var s=t.findNodeForKey(e.data.isparent),c=null;if(e.findLinksOutOf().each(function(a){a.data.level>e.data.level&&(c=a)}),l.level=e.data.level+1,l.parent=e.data.key,l.prev=void 0,e.data.isparent&&null!=s&&(l.next=s.data.key,t.model.setDataProperty(s.data,'prev',l.key)),null!=o&&(l.istemp=!0,l.text=''),l.radius=0==e.data.level?_Mathmax(.75*e.data.radius,100):e.data.radius?_Mathmax(e.data.radius-5,50):_Mathmax(InitialFontSize-10*e.data.level,50),null!=s&&e.containingGroup&&(l.group=e.containingGroup.data.key),null==s){var m={isGroup:!0,group:e.data.group,parent:e.data.key,fill:'rgba(0,0,0,0)',stroke:'rgba(0,0,0,0)',strokeWidth:0,level:e.data.level};m=y(m,e),t.model.addNodeData(m),t.model.setGroupKeyForNodeData(e.data,m.key),l.group=m.key}l.fill=O[l.level%5],l.category=e.data.category,l.loc=go.Point.stringify(h(e)),l.strokeWidth=2,e.data.figure&&(l.figure=e.data.figure),e.data.picture&&(l.picture=e.data.picture),e.data.width&&(l.width=e.data.width),e.data.height&&(l.height=e.data.height),l=d(l,e),l.font=e.data.font,l.textStroke=e.findObject('TEXT').stroke,t.model.setDataProperty(e.data,'isparent',r),l.newAdd=!0,t.model.addNodeData(l);var p={from:e.data.key,to:l.key,level:l.level,isTreeLink:!0,strokeWidth:2},u=null;if(u=e.findLinksInto().first(),null==c?null==u?p=g(p,e):(p.toArrow=u.data.toArrow,p.strokeDashArray=u.data.strokeDashArray,p.color=u.data.color,p.strokeWidth=2):(p.toArrow=c.data.toArrow,p.strokeDashArray=c.data.strokeDashArray,p.color=c.data.color,p.strokeWidth=2),('dipan'==e.data.category||'Root'==e.data.category)&&(p.category='dipan'),t.model.addLinkData(p),null!=c){var k={};delete c.data.points,k=JSON.parse(JSON.stringify(c.data)),delete k.__gohashid,delete k.points,k.from=l.key,k.to=c.data.to,t.model.removeLinkData(c.data),t.model.addLinkData(k)}return'tianpan'==i,t.isModified=!0,l}},{key:'moveWithinNodes',value:function(e){var a=this.diagram,t=a.selection.first();if(t){if(!t)return void a.select(a.findNodeForKey(1));switch(e){case'left':if(t.data.prev){var o=a.findNodeForKey(t.data.prev);o&&a.select(o)}break;case'up':if(t.data.parent){var o=a.findNodeForKey(t.data.parent);o&&a.select(o)}break;case'right':if(t.data.next){var o=a.findNodeForKey(t.data.next);o&&a.select(o)}break;case'down':if(t.data.isparent){var o=a.findNodeForKey(t.data.isparent);o&&a.select(o)}}}}},{key:'selectText',value:function(a){var e=this.diagram,t=e.selection.first();if(t){var o=e.selection.first().findObject('TEXT');o&&e.commandHandler.editTextBlock(o),S.simulateEnterWithAlt(a)}}},{key:'dokeyDownFn',value:function(a){var e=this.diagram,t=this,o=this.diagram,a=o.lastInput,i=o.commandHandler;if(a.event.altKey){if('Q'==a.key)return void autoLayoutAll();if('R'==a.key)return void centerNode();if('C'==a.key)return void centerCurrentNode();if('A'==a.key)return void zoomToFit()}if(65<=a.event.keyCode&&90>=a.event.keyCode&&!a.event.altKey&&!a.event.ctrlKey&&!a.event.shiftKey)return a.bubbles=!1,this.selectText(a,e),!0;if(13===a.event.keyCode){var r=o.selection.first();r&&r.data.parent&&this.addFollower(a,!0),r&&!r.data.parent&&t.startNewSpiral(!0)}else 9===a.event.keyCode?t.startNewSpiral(!0):'t'===a.key?i.canCollapseSubGraph()?i.collapseSubGraph():i.canExpandSubGraph()&&i.expandSubGraph():'Del'==a.key?a.diagram.commandHandler.deleteSelection():113==a.event.keyCode?this.selectText(a,e):37==a.event.keyCode?this.moveWithinNodes('left',e):38==a.event.keyCode?this.moveWithinNodes('up',e):39==a.event.keyCode?this.moveWithinNodes('right',e):40==a.event.keyCode?this.moveWithinNodes('down',e):go.CommandHandler.prototype.doKeyDown.call(i);a.bubbles=!1}},{key:'downloadImage',value:function(){var e=this.diagram,a=e.makeImageData({scale:1,background:'#ffffff',type:'image/png',maxSize:new go.Size(9e3,9e3)});return a}},{key:'getNodeSelectionAdornmentTemplate',value:function(){return W(go.Adornment,'Spot',W(go.Panel,'Auto',W(go.Shape,{figure:'Circle',fill:'rgba(255,0,120,0.2)',stroke:'#767678',strokeWidth:12},new go.Binding('stroke','',function(a){return a.stroke?tinycolor(a.stroke).saturate().toString():'#767678'}),new go.Binding('strokeWidth','',function(a){return a.strokeWidth?a.strokeWidth+5:6}),new go.Binding('width','',function(a){return a.radius||150}),new go.Binding('height','',function(a){return a.radius||150})),W(go.Placeholder)),W('Button',{name:'AddChild',toolTip:W(go.Adornment,'Auto',W(go.Shape,{fill:'#FFFFCC'}),W(go.TextBlock,{textAlign:'center',margin:new go.Margin(8,4,4,4)},new go.Binding('text','',function(){return'\u589E\u52A0\u5B50\u8282\u70B9'}))),alignment:go.Spot.Top,alignmentFocus:go.Spot.Bottom,width:30,height:30,click:function(a){a.diagram.__trtd.startNewSpiral()}},W(go.Shape,'PlusLine',{stroke:'#770077',desiredSize:new go.Size(15,15)})),W('Button',{name:'AddLevel',toolTip:W(go.Adornment,'Auto',W(go.Shape,{fill:'#FFFFCC'}),W(go.TextBlock,{textAlign:'center',margin:new go.Margin(8,4,4,4)},new go.Binding('text','',function(){return'\u589E\u52A0\u540C\u7EA7\u8282\u70B9'}))),alignment:new go.Spot(1,.5,15,0),width:30,height:30,click:function(a){a.diagram.__trtd.addFollower(a)}},W(go.Shape,'PlusLine',{stroke:'#227700',desiredSize:new go.Size(15,15)}),new go.Binding('visible','level',function(e){return 0!=e})))}},{key:'orderChildNode',value:function(){var e=this.diagram,a=[],t=e.selection.first();if(t){if(e.startTransaction(),t.data.isparent){var o=e.model.findNodeDataForKey(t.data.isparent);a.push(o),T(o,a,this);for(var r=/^(\d+\、+)|(\d+\.+)/g,d=0;d<a.length;d++)r.test(a[d].text)?e.model.setDataProperty(a[d],'text',a[d].text.replace(r,d+1+'.')):''==a[d].text?e.model.setDataProperty(a[d],'text',d+1):e.model.setDataProperty(a[d],'text',d+1+'.'+a[d].text)}else;e.commitTransaction()}}},{key:'clearOrderChildNode',value:function(){var e=this.diagram,a=[],t=e.selection.first();if(t){if(e.startTransaction(),t.data.isparent){var o=e.model.findNodeDataForKey(t.data.isparent);a.push(o),T(o,a,this);for(var r=/^(\d+\、+)|(\d+\.+)/g,d=0;d<a.length;d++)r.test(a[d].text)&&e.model.setDataProperty(a[d],'text',a[d].text.replace(r,''))}else;e.commitTransaction()}}}]),a}(v);L.go=go,e.exports=L},function(e){'use strict';var a=go.GraphObject.make;e.exports=function(e){return a(go.Node,'Auto',{_controlExpand:!0,layerName:'default',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!1,doubleClick:function(a,e){interactions.selectText(a,e)},layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:a(go.Adornment),selectionAdornmentTemplate:e.__trtd.getNodeSelectionAdornmentTemplate()},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),a(go.Panel,'Spot',a(go.Picture,{name:'SHAPE'},{sourceCrossOrigin:function(){return'Anonymous'}},new go.Binding('source','picture',function(e){return e+'?'+Date.now()}).makeTwoWay(function(e){return e?(e=e.replace(/\?.*$/g,''),e):''}),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e})),a(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'bold 18px \u5E7C\u5706',stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Fill},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('maxSize','width',function(e){var a=1.4142135623730951*(e/2);return new go.Size(a,a)}).ofObject('SHAPE'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay())),{toolTip:a(go.Adornment,'Auto',a(go.Shape,{fill:'#FFFFCC'}),a(go.TextBlock,{margin:4},new go.Binding('text','',function(e){return e.text})))})}},function(e,a,t){'use strict';function o(a){var e=a.diagram;e.startTransaction();var t={text:'\u53CC\u51FB\u7F16\u8F91\u6587\u672C',category:'text'};t.loc=go.Point.stringify(e.lastInput.documentPoint),e.model.addNodeData(t),e.commitTransaction()}var i=go.GraphObject.make,r=t(8);e.exports=function(e){return i(go.Node,'Spot',{name:'NODE',_controlExpand:!0,layerName:'Background',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'BACKGROUND',resizable:!0,resizeObjectName:'BACKGROUND',rotatable:!0,rotateObjectName:'BACKGROUND',click:function(){},doubleClick:function(a){o(a)},selectable:!0,selectionObjectName:'BACKGROUND',movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:i(go.Adornment)},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),i(go.Shape,{name:'SHAPE',geometryString:r.threeWheel,fill:'black',strokeWidth:5,stroke:'black',minSize:new go.Size(50,50)},new go.Binding('fill','fill').makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('desiredSize','desiredSize',function(e){return e}).ofObject('BACKGROUND'),new go.Binding('angle','angle',function(e){return e}).ofObject('BACKGROUND'),new go.Binding('geometryString','geometryValue',function(e){return r[e]})),i(go.Shape,'Rectangle',{name:'BACKGROUND',fill:'rgba(1,1,1,0)',stroke:'rgba(1,1,1,0)'},new go.Binding('desiredSize','desiredSize',function(e,a){return e?go.Size.parse(e):a.part.findObject('SHAPE').measuredBounds.size}).makeTwoWay(function(e){return go.Size.stringify(e)}),new go.Binding('angle','angle').makeTwoWay(function(e){return e})))}},function(e){'use strict';var a=go.GraphObject.make;e.exports=function(t){var e={figure:'Circle',fill:'white',strokeWidth:2,stroke:'black',fontSize:15,font:'sans-serif'};return a(go.Node,'Spot',{_controlExpand:!0,layerName:'default',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!1,location:new go.Point(0,0),click:function(a,e){void 0,e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},doubleClick:function(a,e){a.diagram.__trtd.selectText(a,e)},toMaxLinks:1,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:t.__trtd.nodeResizeAdornmentTemplate(),contextMenu:a(go.Adornment),selectionAdornmentTemplate:t.__trtd.getNodeSelectionAdornmentTemplate(),mouseOver:function(a,e){t.__trtd.showNodeRemarkTips(a,e)},mouseLeave:function(){t.__trtd.removeNodeRemarkTips()},mouseDragEnter:function(a,e){var t=e.part,o=a.diagram.selection.first();if(o instanceof go.Node&&'3'!=o.category&&'text'!=o.category&&1!=o.key){var i=t.findObject('SHAPE');i&&(i._prevFill=i.fill,i.fill='darkred')}},mouseDragLeave:function(a,e){var t=e.part,o=t.findObject('SHAPE');o&&o._prevFill&&(o.fill=o._prevFill)},mouseDrop:function(a,e){var t=e.part,o=a.diagram.selection.first();if(o instanceof go.Node&&'3'!=o.data.category&&'text'!=o.data.category&&1!=o.data.key)if(t.data.isparent){for(var i=a.diagram.findNodeForKey(t.data.isparent);i.data.next;)i=a.diagram.findNodeForKey(i.data.next);if(i.data.key==o.data.key)return;a.diagram.__trtd.setNodeAsSibling(o,i)}else a.diagram.__trtd.setNodeAsChildren(o,t)}},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),a(go.Shape,{strokeDashArray:null,name:'SHAPE',figure:'Circle',fill:'rgba(0,0,0,0)',fromLinkable:!0,toLinkable:!0,cursor:'pointer',minSize:new go.Size(50,50),strokeWidth:2,stroke:'black',portId:''},new go.Binding('strokeDashArray','strokeDashArray',function(e){try{var a=[parseInt(e.split(' ')[0]),parseInt(e.split(' ')[1])]}catch(a){var a=null}return a}).makeTwoWay(function(e){return e[0]+' '+e[1]}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('desiredSize','radius',function(e){var a=parseInt(e?e:100),t=new go.Size(a,a);return t}).makeTwoWay(function(e){return e.width}),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),{figure:e.figure,fill:e.fill,strokeWidth:e.strokeWidth,stroke:e.stroke}),a(go.Shape,{name:'SHAPE_Back',figure:'Rectangle',fill:'rgba(128,128,128,0)',fromLinkable:!0,toLinkable:!0,strokeWidth:0},new go.Binding('desiredSize','width',function(e){var a=1.4142135623730951*(e/2);return new go.Size(a-3,a-3)}).ofObject('SHAPE')),a(go.Panel,'Table',a(go.RowColumnDefinition,{column:0,width:0}),a(go.Shape,'Rectangle',{row:0,column:0,fill:'rgba(0,255,0,0)',strokeWidth:0}),a(go.Panel,'Auto',{row:1,column:0},a(go.Shape,'RoundedRectangle',{fill:'rgba(0,0,0,0)',strokeWidth:0}),a(go.Picture,{alignment:go.Spot.Left,click:function(){alert('picture clicked')},name:'Picture',desiredSize:new go.Size(10,10)})),a(go.Shape,'Rectangle',{row:2,column:0,fill:'rgba(0,0,0,0)',strokeWidth:0}),a(go.Panel,'Auto',{row:0,column:1,rowSpan:3},a(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'bold 18px \u5E7C\u5706',stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Fill,click:function(){}},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return 1.4142135623730951*(e/2)}).ofObject('SHAPE'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()))))}},function(e){'use strict';e.exports={threeWheel:'M 225 0 C 100.736 0 0 100.735 0 225 s 100.736 225 225 225 c 124.265 0 225.001 -100.734 225.001 -225 C 450.002 100.735 349.265 0 225 0 Z M 225 1.515 c 62.006 0 118.106 25.257 158.591 66.037 c -38.634 133.172 -160.888 157.047 -160.888 157.047 l 0.047 0.083 h -0.051 C 123.453 130.609 19.61 161.966 9.597 165.291 C 35.716 70.857 122.255 1.515 225 1.515 Z M 1.517 225 c 0 -20.075 2.663 -39.524 7.627 -58.035 c 6.686 -2.295 111.992 -36.362 212.807 58.54 c -3.347 10.815 -36.032 125.634 54.089 217.118 c -16.395 3.83 -33.479 5.859 -51.04 5.859 C 101.575 448.482 1.517 348.428 1.517 225 Z M 277.292 442.318 c -89.298 -94.891 -57.746 -204.506 -53.915 -216.53 l 0.076 0.135 c 0 0 126.301 -26.492 161.022 -157.465 c 39.584 40.319 64.008 95.575 64.008 156.542 C 448.483 330.418 375.489 418.773 277.292 442.318 Z',fireWheel:'M225.000,450.000 C100.736,450.000 -0.000,349.264 -0.000,225.000 C-0.000,100.736 100.736,-0.000 225.000,-0.000 C349.264,-0.000 450.000,100.736 450.000,225.000 C450.000,349.264 349.264,450.000 225.000,450.000 ZM225.000,448.000 C338.085,448.000 431.498,363.821 446.026,254.709 C432.978,302.699 389.123,338.000 337.000,338.000 C274.592,338.000 224.000,287.408 224.000,225.000 C224.000,163.696 174.304,114.000 113.000,114.000 C51.696,114.000 2.000,163.696 2.000,225.000 C2.000,348.159 101.841,448.000 225.000,448.000 ZM225.000,2.000 C111.915,2.000 18.502,86.179 3.974,195.291 C17.022,147.301 60.877,112.000 113.000,112.000 C175.408,112.000 226.000,162.592 226.000,225.000 C226.000,286.304 275.696,336.000 337.000,336.000 C398.304,336.000 448.000,286.304 448.000,225.000 C448.000,225.000 448.000,225.000 448.000,225.000 C448.000,101.841 348.159,2.000 225.000,2.000 Z',goldWheel:'M449.993,0.008 L225.395,287.495 L355.004,449.995 L94.004,449.995 L224.597,287.502 L-0.008,0.008 L449.993,0.008 Z',waterWheel:'M268.000,443.000 C299.658,443.000 328.270,429.976 348.785,409.000 L351.564,409.000 C330.601,431.167 300.917,445.000 268.000,445.000 C204.487,445.000 153.000,393.513 153.000,330.000 C153.000,282.847 181.389,242.341 222.000,224.593 L222.000,224.508 C263.076,207.589 292.000,167.180 292.000,120.000 C292.000,57.592 241.408,7.000 179.000,7.000 C148.889,7.000 121.551,18.800 101.296,38.000 L98.382,38.000 C119.136,17.594 147.595,5.000 179.000,5.000 C242.513,5.000 294.000,56.487 294.000,120.000 C294.000,167.153 265.611,207.659 225.000,225.407 L225.000,225.478 C183.921,242.396 155.000,282.817 155.000,330.000 C155.000,392.408 205.592,443.000 268.000,443.000 Z'}},function(e,a,t){'use strict';function o(e){setTimeout(function(){try{if(!e.text)return;if(e.text&&''==e.text.trim())return;if(0!=e.lineCount%2){if('\n'==e.text[e.text.length-1])return void(e.text=e.text.substring(0,e.text.length-1));e.text+='\n'}}catch(a){}},100)}function i(e,a,t,o){var i=o.data.textAngle||'vertical',r;0==e.data.order%2?(a&&(r=a.data.nangle?a.data.textAngle||i:i,'horizontal'==r&&(a.locationSpot=new go.Spot(1,1,0,0),a.angle=0),a.__location=e.location.copy().offset(e.naturalBounds.width/2,0),a.__location=l(o.location,a.__location,e.angle),a.data.nloc?a.__offset?a.location=a.__location.copy().subtract(a.__offset):a.__offset=a.__location.copy().subtract(a.location):(a.location=e.location.copy().offset(e.naturalBounds.width/2,-e.naturalBounds.height/2),a.location=l(o.location,a.location,e.angle),delete a.__switchOrder),'vertical'==r&&(a.locationSpot=new go.Spot(.5,1,0,0),a.angle=e.angle)),t&&(r=t.data.nangle?t.data.textAngle||i:i,'horizontal'==r&&(t.locationSpot=new go.Spot(0,0,0,0),t.angle=0),void 0,t.__location=e.location.copy().offset(e.naturalBounds.width/2,0),t.__location=l(o.location,t.__location,e.angle),t.data.nloc?t.__offset?t.location=t.__location.copy().subtract(t.__offset):t.__offset=t.__location.copy().subtract(t.location):(t.location=e.location.copy().offset(e.naturalBounds.width/2,e.naturalBounds.height/2),t.location=l(o.location,t.location,e.angle),delete t.__switchOrder),'vertical'==r&&(t.locationSpot=new go.Spot(.5,0,0,0),t.angle=e.angle))):(a&&(r=a.data.nangle?a.data.textAngle||i:i,a.__location=e.location.copy().offset(e.naturalBounds.width/2,0),a.__location=l(o.location,a.__location,e.angle),a.data.nloc?a.__offset?a.location=a.__location.copy().subtract(a.__offset):a.__offset=a.__location.copy().subtract(a.location):(a.location=e.location.copy().offset(e.naturalBounds.width/2,e.naturalBounds.height/2),a.location=l(o.location,a.location,e.angle),delete a.__switchOrder),'horizontal'==r&&(a.locationSpot=new go.Spot(0,0,0,0),a.angle=0),'vertical'==r&&(a.locationSpot=new go.Spot(.5,0,0,0),a.angle=e.angle)),t&&(r=t.data.nangle?t.data.textAngle||i:i,t.__location=e.location.copy().offset(e.naturalBounds.width/2,0),t.__location=l(o.location,t.__location,e.angle),t.data.nloc?t.__offset?t.location=t.__location.copy().subtract(t.__offset):t.__offset=t.__location.copy().subtract(t.location):(t.location=e.location.copy().offset(e.naturalBounds.width/2,-e.naturalBounds.height/2),t.location=l(o.location,t.location,e.angle),delete t.__switchOrder),'horizontal'==r&&(t.locationSpot=new go.Spot(1,1,0,0),t.angle=0),'vertical'==r&&(t.locationSpot=new go.Spot(.5,1,0,0),t.angle=e.angle)))}function r(e,a,t){for(var r=[],d=t.data.oliveWidth,c=t.data.oliveHeight,g=t.data.shiStroke,m=t.data.xuStroke,p=t.data.centerStroke||'#3f5369',u=t.data.oliveType||'Ellipse',y=t.data.haveTail||!1,h=t.data.textAngle||'vertical',k=2*d/3,f=[],T=[],x=[],b,S,v,w,P;e.next();){var B=e.value;'shiText'==B.data.role&&f.push(B),'xuText'==B.data.role&&T.push(B),'centerText'==B.data.role&&x.push(B),B instanceof go.Node&&('line'==B.data.category&&(b=B,B.location=t.location.copy().offset(0,0),B.angle=t.angle),'wave'==B.data.category&&('Ellipse'==u?(B.diagram.model.setDataProperty(B.data,'oliveType','Ellipse'),B.diagram.model.setDataProperty(B.data,'desiredSize',d+' '+c)):(B.diagram.model.setDataProperty(B.data,'oliveType','Wave'),'waveTail'==B.data.role?(B.diagram.model.setDataProperty(B.data,'desiredSize',d/2+' '+c),B.diagram.model.setDataProperty(B.data,'selectable',!1)):B.diagram.model.setDataProperty(B.data,'desiredSize',d+' '+c)),B.angle=t.angle,k+=B.naturalBounds.width,r.push(B)))}k=r.length*d+2*d/3,y&&(k=r.length*d),void 0,b.findObject('SHAPE').width=k,b.diagram.model.setDataProperty(b.data,'stroke',p),t.containingGroup.layout.isOngoing=!0,t.containingGroup.layout.isValidLayout=!1,t.resizeObject.width=k,t.resizeObject.height=c,t.waveCount=r.length,v=t.data.xuStrokeWidth,S=t.data.shiStrokeWidth,w=t.data.shiStrokeDashArray,P=t.data.xuStrokeDashArray,r=r.sort(function(e,a){return+e.data.order-+a.data.order});var D=null,N=null;r.forEach(function(e,a){var r=a+1;N=e.__oldOrder?e.__oldOrder:e.data.order,delete e.__oldOrder,f[a]=e.diagram.findNodeForKey(e.data.shiText),T[a]=e.diagram.findNodeForKey(e.data.xuText),e.data.isNew||'waveTail'==e.data.role||N%2==r%2||(f[a].data.nloc&&(e.diagram.model.setDataProperty(f[a].data,'nloc',null),f[a].__oldLocation=f[a].location),T[a].data.nloc&&(e.diagram.model.setDataProperty(T[a].data,'nloc',null),T[a].__oldLocation=T[a].location)),e.diagram.model.setDataProperty(e.data,'order',r),e.data.nalign||e.diagram.model.setDataProperty(e.data,'textAlign','center'),g&&e.diagram.model.setDataProperty(e.data,'shiStroke',g),m&&e.diagram.model.setDataProperty(e.data,'xuStroke',m),v&&e.diagram.model.setDataProperty(e.data,'xuStrokeWidth',v),S&&e.diagram.model.setDataProperty(e.data,'shiStrokeWidth',S),w&&e.diagram.model.setDataProperty(e.data,'shiStrokeDashArray',w),P&&e.diagram.model.setDataProperty(e.data,'xuStrokeDashArray',P),e.location=t.location.copy().offset(d*(r-1),0);var c=!1;if('independent'==t.data.centerTextAngle){if(!e.data.centerText){var p=e.location.copy().offset(e.naturalBounds.width/2,0);p=l(t.location,p,e.angle);var u={text:e.data.text,minSize:d-30+' 30',deletable:!1,textAlign:e.data.textAlign,font:e.data.font||'18px \'Microsoft YaHei\'',textStroke:e.data.textStroke,category:'autoText',key:s.guid(),width:d-30,role:'centerText',level:0,group:e.data.group,order:r,visible:!1,layerName:'Foreground',locationSpot:go.Spot.stringify(new go.Spot(.5,.5,0,0)),selectable:!1,olive:e.data.key,loc:go.Point.stringify(p),angle:0};e.diagram.model.addNodeData(u),e.diagram.model.setDataProperty(e.data,'centerText',u.key),c=!0}var y=e.diagram.findNodeForKey(e.data.centerText);if(y){if(y.data.nalign||e.diagram.model.setDataProperty(y.data,'textAlign','center'),e.data.nangle||('vertical'==h&&(e.diagram.model.setDataProperty(y.data,'visible',!1),e.diagram.model.setDataProperty(e.data,'textVisible',!0)),'horizontal'==h&&(e.diagram.model.setDataProperty(y.data,'visible',!0),e.diagram.model.setDataProperty(e.data,'textVisible',!1),e.diagram.model.setDataProperty(y.data,'angle',0))),!c){var p=e.location.copy().offset(e.naturalBounds.width/2,0);p=l(t.location,p,e.angle),e.diagram.model.setDataProperty(y.data,'loc',go.Point.stringify(p))}e.diagram.model.setDataProperty(y.data,'order',r),y.data.nwidth||e.diagram.model.setDataProperty(y.data,'width',d-30),e.diagram.model.setDataProperty(y.data,'minSize',d-30+' 30'),s.checkPhone()&&(y.layerName='Background')}}e.text&&''!=e.text.trim()&&o(e.findObject('TEXT')),f[a]&&(!f[a].desiredSize.width&&f[a].updateTargetBindings(),e.diagram.model.setDataProperty(f[a].data,'showBorder',!0),!f[a].data.nwidth&&e.diagram.model.setDataProperty(f[a].data,'width',d),e.diagram.model.setDataProperty(f[a].data,'minSize',d-30+' 30'),e.diagram.model.setDataProperty(f[a].data,'order',r),!f[a].data.ncolor&&e.diagram.model.setDataProperty(f[a].data,'textStroke',g)),T[a]&&(!T[a].desiredSize.width&&T[a].updateTargetBindings(),e.diagram.model.setDataProperty(T[a].data,'minSize',d-30+' 30'),e.diagram.model.setDataProperty(T[a].data,'showBorder',!0),!T[a].data.nwidth&&e.diagram.model.setDataProperty(T[a].data,'width',d),!T[a].data.nalign&&e.diagram.model.setDataProperty(T[a].data,'textAlign','center'),e.diagram.model.setDataProperty(T[a].data,'order',r),!T[a].data.ncolor&&e.diagram.model.setDataProperty(T[a].data,'textStroke',m)),e.__location=l(t.location,e.location.copy(),e.angle),i(e,f[a],T[a],t),e.location=e.__location,D=e,e.diagram.model.setDataProperty(e.data,'isNew',null)})}function d(){go.Layout.call(this)}function l(e,a,t){if(e.equals(a))return a;var o=new go.Point(0,0).subtract(e.copy()),i=a.copy().offset(o.x,o.y),r=i.rotate(t),d=r.copy().offset(-o.x,-o.y);return d}var s=t(0);go.Diagram.inherit(d,go.Layout),d.prototype.doLayout=function(e){var a=this.diagram;a.model.startTransaction('WaveGroupLayout');var t=this.collectParts(e).iterator,o=this.group;return r(t,a,o),go.Layout.prototype.doLayout.call(this,e),void a.model.commitTransaction('WaveGroupLayout')},e.exports=d,e.exports.layoutWaveGroup=r,e.exports.adjustTextAngle=i},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e){var a=new go.Set,t=e.first();if(!t)a.addAll(e);else if(t.containingGroup&&'labelGroup'==t.containingGroup.data.category){var o=t.containingGroup.findSubGraphParts().iterator;for(a.add(t.containingGroup);o.next();){var i=o.value;a.add(i)}}else c.travelParts(t,function(e){a.add(e)});this;return go.DraggingTool.prototype.computeEffectiveCollection.call(this,a)}function d(e,a,t){return 2<=e.findLinksOutOf().count||1<=e.findLinksOutOf().count&&1==e.data.key?void 0:e.data.group===t.data.group}var i='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&'function'==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?'symbol':typeof e},l=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),s=go.GraphObject.make,c=t(0),g=t(3),m=t(2),p=t(11),u=function(){function e(a,t){o(this,e),this.config=t,this.modelChangedListener=t.modelChangedListener,this.showContextMenuListener=t.showContextMenuListener,this.hideContextMenuListener=t.hideContextMenuListener,this.ViewportBoundsChangedListener=t.ViewportBoundsChangedListener,this.InitialLayoutCompleted=t.InitialLayoutCompleted,this.cxElement=t.cxElement,this.deleteCallback=t.deleteCallback,this.canAddAxisGroup=null==t.canAddAxisGroup||t.canAddAxisGroup,this.createFigure=t.createFigure,this.openFigure=t.openFigure,this.useDefaultContext=null==t.useDefaultContext||t.useDefaultContext,this.defaultCxElement=null,this.type=t.type,this.div=a,this.containerDivId=t.containerDivId||'mainbox',this.diagram={},null!=t.model&&'object'==i(t.model)&&(t.model=JSON.stringify(t.model)),this.model=t.model,this.tpid=t.tpid||Date.now(),this.InitialFontSize=18,this.tdCurrentTheme={id:6,borderWidth:2,borderColor:'black',groupColor:'rgba(0,0,0,0)',groupStroke:'rgba(0,0,0,0)',groupStrokeWidth:0,themeName:'\u9ED1\u767D',linkColor:'black',colorRange:'white'},this.nodeClickListener=t.nodeClickListener,this.nodeDoubleClickListener=t.nodeDoubleClickListener,this.isModified=!1,this.lastModified=0,this.modifiedIndex=0}return l(e,[{key:'initDiagram',value:function(){}},{key:'addNodeTemplate',value:function(){}},{key:'resetZoom',value:function(e){this.diagram.commandHandler.resetZoom(e)}},{key:'getDefaultCustomMenuDivStr',value:function(){return'\n        <ul>\n            <li trtd_action="addLevelNodeMenu"><a class="i18n" data-lang="insertsl">\u63D2\u5165\u540C\u7EA7\u8282\u70B9</a></li>\n            <li trtd_action="addChildNodeMenu"><a class="i18n" data-lang="icn">\u63D2\u5165\u5B50\u8282\u70B9</a></li>\n            <li trtd_action="duplicateNode"><a class="i18n" data-lang="duplicateNode">\u590D\u5236\u8282\u70B9</a></li>\n            <li trtd_action="deleteNodeMenu"><a class="i18n" data-lang="remove">\u5220\u9664</a></li>\n            <li trtd_action="orderChildNode"><a class="i18n" data-lang="ordernode">\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearOrderChildNode"><a class="i18n" data-lang="clearordernode">\u53D6\u6D88\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearNodeTextMenu"><a class="i18n" data-lang="emptynodetext">\u6E05\u7A7A\u8282\u70B9\u6587\u672C</a></li>\n            <li trtd_action="insertTianpanMenu"><a class="i18n" data-lang="insertnodetianpan">\u63D2\u5165\u5929\u76D8\u8282\u70B9</a></li>\n            <li trtd_action="insertTextMenu"><a class="i18n" data-lang="inserttext">\u63D2\u5165\u6587\u672C</a></li>\n            <li trtd_action="locateRootNodeMenu"><a class="i18n" data-lang="locaterootnode">\u5B9A\u4F4D\u6839\u8282\u70B9</a></li>\n            <li trtd_action="showAllNodesMenu"><a class="i18n" data-lang="displayallnodes">\u663E\u793A\u6240\u6709\u8282\u70B9</a></li>\n            <li trtd_action="fixPictureMenu"><a class="i18n" data-lang="fixnode">\u56FA\u5B9A\u8282\u70B9</a></li>\n            <li trtd_action="activePictureMenu"><a class="i18n" data-lang="cancelfix">\u53D6\u6D88\u56FA\u5B9A</a></li>\n        \n            <li trtd_action="delYunpanAxis"><a class="i18n" data-lang="cancelfix">\u5220\u9664 CTRL+DEL</a></li>\n            <li trtd_action="addYunpanAxis"><a class="i18n" data-lang="cancelfix">\u589E\u52A0 CTRL+X/Y</a></li>\n            <li trtd_action="addFollowerGround"><a class="i18n" data-lang="insertsl">\u589E\u52A0\u540C\u7EA7\u8282\u70B9</a></li>\n            <li trtd_action="addNewCircle"><a class="i18n" data-lang="icn">\u589E\u52A0\u5B50\u8282\u70B9</a></li>\n            <li trtd_action="apiDeleteSelection"><a class="i18n" data-lang="remove">\u5220\u9664</a></li>\n        </ul>\n        '}},{key:'getShowContextMenus',value:function(e){var a='';return!e||e.data.isGroup?a='locateRootNodeMenu,showAllNodesMenu,insertTextMenu,insertTianpanMenu':(!(e instanceof go.Group)&&(!e.data.category||''==e.data.category||'0'==e.data.category||'1'==e.data.category||'4'==e.data.category)&&(a='addLevelNodeMenu,addChildNodeMenu,deleteNodeMenu,orderChildNode,clearOrderChildNode,clearNodeTextMenu,duplicateNode',a+=e.selectable?'fixPictureMenu':'activePictureMenu'),('8'==e.data.category||'text'==e.data.category||'addtextTemplate'==e.data.category)&&(a='deleteNodeMenu,duplicateNode'),('yunpanx'===e.data.category||'yunpany'===e.data.category)&&(a='delYunpanAxis,addYunpanAxis'),'dipan'===e.data.category&&(a='addFollowerGround,addChildDipanNode,deleteDipanNode')),a}},{key:'insertPicture',value:function(e){this.apiInsertPicture(e)}},{key:'apiInsertPicture',value:function(e){var a=this.diagram,t=this.diagram.model.modelData.currentType,o=a.selection.first();if(!o||'dipan'!=o.data.category||rootKey){a.model.startTransaction('setSourceOfPicture');try{var i=JSON.parse(localStorage.getItem('TRTD_documentPoint'));i||(i=a.lastInput.documentPoint)}catch(e){var i=a.lastInput.documentPoint}if(o)'3'==o.data.category&&a.model.setDataProperty(o.data,'picture',e);else{var r=(a.model.nodeDataArray.length+1).toString(),d={key:r,text:'',category:'3'};a.model.makeNodeDataKeyUnique(d),d.loc=go.Point.stringify(i),d.picture=e,a.model.addNodeData(d)}a.model.commitTransaction('setSourceOfPicture')}}},{key:'apiGetTheme',value:function(){for(var e=this.diagram.model,a='',t=0;t<e.nodeDataArray.length;t++)if('theme'==e.nodeDataArray[t].role||'themeText'==e.nodeDataArray[t].role||'themeText'==e.nodeDataArray[t].subRole){a=e.nodeDataArray[t].text;break}if(!a){var o=e.findNodeDataForKey(1);o&&(a=o.text)}return a}},{key:'apiGetThemeNode',value:function(){for(var e=this.diagram.model,a=null,t=this.diagram.nodes,o;t.next();)if(o=t.value,'theme'==o.data.role||'themeText'==o.data.role||'themeText'==o.data.subRole){a=o;break}if(!a){var i=this.diagram.findNodeForKey(1);i&&(a=i)}return a}},{key:'insertFigure',value:function(e,a){var t=this.diagram,o=this.diagram.model.modelData.currentType,i=t.selection.first();if(!i){t.model.startTransaction('setSourceOfPicture');try{var r=JSON.parse(localStorage.getItem('TRTD_documentPoint'))}catch(e){var r=t.lastInput.documentPoint}if(i)'3'!=i.data.category&&'text'!=i.data.category&&t.model.setCategoryForNodeData(i.data,'4'),'text'!=i.data.category&&t.model.setDataProperty(i.data,'picture',e);else{var d=(t.model.nodeDataArray.length+1).toString(),l={key:d,text:'',category:'3'};t.model.makeNodeDataKeyUnique(l),l.loc=go.Point.stringify(r),l.figureId=a,l.picture=e,t.model.addNodeData(l)}t.model.commitTransaction('setSourceOfPicture')}}},{key:'apiDuplicateNode',value:function(){function e(e){return e.level=0,delete e.prev,delete e.isparent,delete e.next,delete e.group,delete e.parent,e}var a=this.diagram,t=a.selection.first();if(t){a.startTransaction();var o=a.model.copyNodeData(t.data),i=t.location.copy();i.offset(50,-50),o.loc=go.Point.stringify(i),o.level=0,o=e(o),a.model.addNodeData(o),a.commitTransaction()}}},{key:'apiPreviewImage',value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'white',a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,t=this.diagram,o={scale:a,background:e,type:'image/png',maxSize:new go.Size(9e3,9e3)},i=new go.List(go.GraphObject);t.nodes.each(function(e){var a=e.findObject('figure');a&&(a.visible=!1),e instanceof go.Group||(i.add(e),e instanceof go.Node&&'centerText'==e.data.role&&(e.layerName='Foreground'))}),t.links.each(function(e){i.add(e)}),o.parts=i.iterator;var r=t.makeImageData(o);return t.nodes.each(function(e){var a=e.findObject('figure');e.data.figure&&a&&(a.visible=!0)}),r}},{key:'apiDeleteSelection',value:function(){this.diagram.toolManager.textEditingTool.doCancel(),this.diagram.commandHandler.deleteSelection()}},{key:'apiUndo',value:function(){this.diagram.commandHandler.undo()}},{key:'apiRedo',value:function(){this.diagram.commandHandler.redo()}},{key:'saveModel',value:function(){c.saveModelToLocalStorage(this.tpid,this.diagram.model)}},{key:'addNodeTemplateBase',value:function(){var e=this.diagram;this.diagram.nodeTemplateMap.add('text',g(this.diagram)),this.diagram.nodeTemplateMap.add('3',m(this.diagram)),e.nodeTemplateMap.add('pic',p('pic',{diagram:this.diagram}).getNodeTemplate()),e.nodeTemplateMap.add('autoText',p('autoText',{diagram:e}).getNodeTemplate()),e.groupTemplateMap.add('picGroup',p('picGroup',{diagram:e}).getNodeTemplate())}},{key:'addWater',value:function(){var a=this.diagram,t=a.selection.first(),o=null;t&&'axisGroup'==t.data.category&&(o=t.data.key);var i=a.lastInput;a.startTransaction('addCbian');var e=c.guid(),r=i.documentPoint,d={category:'picGroup',role:'cbian',isGroup:!0,level:0,key:e,loc:go.Point.stringify(r),deletable:!0};o&&(d.group=o);var l={group:e,text:'',resizable:!1,category:'pic',loc:go.Point.stringify(r),picture:'https://static.365trtd.com/system/water/water.png',width:150,height:150},s={text:'\u603B\u7ED3',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(r.copy().offset(3,-3)),movable:!0,group:e},g={text:'\u65F6\u95F4',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(r.copy().offset(150,0)),movable:!0,group:e},m={text:'\u80FD\u91CF',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(r.copy().offset(0,-150)),movable:!0,group:e},p={text:'\u603B\u7ED31',deletable:!0,textStroke:'#0e399d',iconVisible:!1,locationSpot:'0 0 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(r.copy().offset(155*_Mathcos(30*_MathPI/180),-150*_Mathsin(30*_MathPI/180))),movable:!0,group:e},u={text:'\u603B\u7ED32',deletable:!0,textStroke:'#FFC000',iconVisible:!1,locationSpot:'0 0.5 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(r.copy().offset(145*_Mathcos(45*_MathPI/180),-150*_Mathsin(45*_MathPI/180))),movable:!0,group:e},y={text:'\u603B\u7ED33',deletable:!0,textStroke:'#cb1c27',iconVisible:!1,locationSpot:'0 1 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(r.copy().offset(145*_Mathcos(70*_MathPI/180),-140*_Mathsin(70*_MathPI/180))),movable:!0,group:e};a.model.addNodeData(p),a.model.addNodeData(u),a.model.addNodeData(y),a.model.addNodeData(s),a.model.addNodeData(g),a.model.addNodeData(m),a.model.addNodeData(l),a.model.addNodeData(d),a.commitTransaction('addWater')}},{key:'initDiagramBase',value:function(e,a){var t=this,o=this.diagram,l=this,o=this.diagram,c={initialContentAlignment:go.Spot.Center,initialAutoScale:go.Diagram.Uniform,initialDocumentSpot:go.Spot.Center,initialViewportSpot:go.Spot.Center,"toolManager.hoverDelay":100,padding:-20,click:function(a){localStorage.setItem('TRTD_documentPoint',go.Point.stringify(a.documentPoint))},"draggingTool.isCopyEnabled":!1,"commandHandler.archetypeGroupData":{text:'Group',isGroup:!0,color:'blue'},allowDrop:!0,"undoManager.isEnabled":!0,"undoManager.maxHistoryLength":20,"toolManager.mouseWheelBehavior":go.ToolManager.WheelZoom,maxScale:5,minScale:.2,hasVerticalScrollbar:!1,hasHorizontalScrollbar:!1,scrollMode:go.Diagram.InfiniteScroll,scrollMargin:50,"animationManager.isEnabled":!1,maxSelectionCount:1,InitialLayoutCompleted:function(a){a.diagram.animationManager.isEnabled=!0,l.InitialLayoutCompleted&&l.InitialLayoutCompleted(a)},validCycle:go.Diagram.CycleDestinationTree,ModelChanged:function(a){a.isTransactionFinished&&(l.isModified=!0,l.lastModified=Date.now(),l.modifiedIndex+=1,setTimeout(function(){if(l.isModified){var e=Date.now()-l.lastModified;1e3<=e&&(l.modifiedIndex=0,l.isModified=!1,l.saveModel(a),l.modelChangedListener&&l.modelChangedListener(a.model))}},1100))},TextEdited:function(a){a.diagram.isModified=!0},contextMenu:s(go.Adornment),ViewportBoundsChanged:function(a){l.ViewportBoundsChangedListener&&l.ViewportBoundsChangedListener(a)}},g=Object.assign(c,a.diagramConfig);delete g.type,delete g.tpid,delete g.model,delete g.modelChangedListener,delete g.mouseOverListener,delete g.clickListener,this.diagram=s(go.Diagram,e,g),this.diagram.__trtd=this;var o=this.diagram,m=o.findLayer('Foreground');o.addLayerBefore(go.GraphObject.make(go.Layer,{name:'default'}),m),o.addLayerBefore(go.GraphObject.make(go.Layer,{name:'overflow'}),m);for(var p=10;0<=p;p--)o.addLayerBefore(go.GraphObject.make(go.Layer,{name:p.toString()}),m);o.toolManager.draggingTool.computeEffectiveCollection=r,o.toolManager.rotatingTool.handleArchetype=s(go.Panel,'Auto',s(go.Shape,'BpmnActivityLoop',{width:30,height:30,stroke:'green',fill:'transparent'}),s(go.Shape,'Rectangle',{width:30,height:30,stroke:'green',fill:'transparent',strokeWidth:0})),o.toolManager.linkReshapingTool.handleArchetype=s(go.Shape,'Circle',{width:30,height:30,fill:'lightblue',stroke:'dodgerblue'}),o.toolManager.linkingTool.linkValidation=d,o.toolManager.relinkingTool.linkValidation=d,o.commandHandler.doKeyDown=function(a){t.dokeyDownFn(a)},o.commandHandler.deleteSelection=function(){var e=l.diagram.selection.first();if(e&&'theme'!=e.data.role&&'themeText'!=e.data.role&&'themeText'!=e.data.subRole){var a=JSON.parse(JSON.stringify(e.data));l.deleteSelection(),l.deleteCallback&&l.deleteCallback(a)}},o.commandHandler.redo=function(){var e=o.commandHandler;o.clearSelection(),go.CommandHandler.prototype.redo.call(e)},o.commandHandler.undo=function(){var e=o.commandHandler;o.clearSelection(),o.toolManager&&o.toolManager.textEditingTool.doCancel(),go.CommandHandler.prototype.undo.call(e)},o.toolManager.clickCreatingTool.archetypeNodeData={category:'autoText',text:'\u53CC\u51FB\u7F16\u8F91\u6587\u672C',level:0,radius:120},this.addNodeTemplateBase(),this.addDiagramContextMenu()}},{key:'removeNodeRemarkTips',value:function(){var e=document.getElementById('tooltip');e&&e.parentNode.removeChild(e)}},{key:'showNodeRemarkTips',value:function(a,e){var t=document.getElementById('tooltip');if(!t||0==t.length){var o=document.createElement('div');o.setAttribute('id','tooltip'),o.setAttribute('style','word-wrap: break-word;word-break: break-all'),document.body.appendChild(o),t=document.getElementById('tooltip')}var i=document.getElementById('tooltip');if(!(!e.data.istemp&&e.data.text&&''==e.data.text.trim()&&(e.data.remark&&''==e.data.remark.trim()||'undefined'==typeof e.data.remark))){if(e.data.istemp)var r=lang.trans('tempnodetips');else if('y'===e.category||'LogicXor'===e.category&&'5'===e.data.loc.split(' ')[1])var r='\u6700\u53F3\u65B0\u589E';else if('x'===e.category||'LogicXor'===e.category&&'-20'===e.data.loc.split(' ')[0])var r='\u6700\u4E0A\u65B0\u589E';else{var r=e.data.text+'<br><hr>';r+=e.data.remark?e.data.remark:''}i.innerHTML=r,'y'===e.category||'x'===e.category||'LogicXor'===e.category?(i.style.left=a.event.clientX+10+'px',i.style.top=a.event.clientY-10+'px'):(i.style.left=a.event.clientX+50+'px',i.style.top=a.event.clientY-50+'px'),i.style.position='fixed',i.style.zIndex=5555,i.style.backgroundColor='#FFFFE1'}}},{key:'nodeResizeAdornmentTemplate',value:function(){return s(go.Adornment,'Spot',s(go.Placeholder),s(go.Shape,'Circle',{alignment:go.Spot.TopLeft,alignmentFocus:go.Spot.BottomRight,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}),s(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'customMenu',value:function(){if(this.defaultCxElement)return this.defaultCxElement;if(!this.useDefaultContext)return null;var e=this.getDefaultCustomMenuDivStr(),a=document.createElement('div');a.setAttribute('class','context-menu'),a.innerHTML=e;var t=document.getElementById(this.containerDivId);t.appendChild(a);var o=t.getElementsByClassName('context-menu')[0];return this.defaultCxElement=o,this.bindMenuEventListener(o),o}},{key:'bindMenuEventListener',value:function(e){for(var a=this,t=e.getElementsByTagName('li'),o=function(e){t[e].addEventListener('click',function(){var o=t[e].getAttribute('trtd_action');return a.diagram.__trtd[o](),a.diagram.currentTool.stopTool(),!1})},r=0;r<t.length;r++)o(r)}},{key:'addDiagramContextMenu',value:function(){var e=this,a=this.diagram,t=a.toolManager.contextMenuTool;if(!this.cxElement){this.defaultCxElement||(this.defaultCxElement=this.customMenu());var o=this.defaultCxElement}else var o=this.cxElement;o&&(o.addEventListener('contextmenu',function(a){return a.preventDefault(),!1},!1),o.tabIndex='1',t.showContextMenu=function(t){var r=this.diagram;if(null!==r){t!==this.currentContextMenu&&this.hideContextMenu();var d=a.findPartAt(a.lastInput.documentPoint,!1);this.currentContextMenu=t;var l=r.lastInput.viewPoint;if(o.style.left=l.x+'px',o.style.top=l.y+'px',e.showContextMenuListener)return e.showContextMenuListener(this.diagram,d);var s=e.getShowContextMenus(d),g=o.getElementsByTagName('li');if(s){for(var m=0;m<g.length;m++)g[m].style.display='none';for(var i=0;i<s.split(',').length;i++)try{c.getElementByAttr(o,'li','trtd_action',s.split(',')[i])[0]&&(c.getElementByAttr(o,'li','trtd_action',s.split(',')[i])[0].style.display='block')}catch(a){continue}}else if(''==s)for(var p=0;p<g.length;p++)g[p].style.display='block';else for(var u=0;u<g.length;u++)g[u].style.display='none';o.style.display='block'}},t.hideContextMenu=function(){if(null!==this.currentContextMenu&&(this.currentContextMenu=null,o.style.display='none',e.hideContextMenuListener))return e.hideContextMenuListener(a)})}},{key:'getNodeContextMenu',value:function(){return s(go.Adornment);var e={}}},{key:'dokeyDownFn',value:function(){var a=this.diagram,t=this.diagram,o=this.diagram.lastInput,e=a.commandHandler,i=a.selection.first();if(o.event.altKey){if('Q'==o.key)return void autoLayoutAll();if('R'==o.key)return void centerNode();if('C'==o.key)return void centerCurrentNode();if('A'==o.key)return void zoomToFit()}if(65<=o.event.keyCode&&90>=o.event.keyCode&&!o.event.altKey&&!o.event.ctrlKey&&!o.event.shiftKey)return o.bubbles=!1,t.__trtd.selectText(o),!0;if(13===o.event.keyCode)i&&'Root'==i.data.category?t.__trtd.addFollowerGround():i&&'dipan'==i.data.category&&t.__trtd.addFollowerGround();else if(9===o.event.keyCode)i&&'Root'==i.data.category?t.__trtd.addNewCircle():i&&'dipan'==i.data.category&&t.__trtd.addNewCircle();else if('t'===o.key)e.canCollapseSubGraph()?e.collapseSubGraph():e.canExpandSubGraph()&&e.expandSubGraph();else if('Del'==o.key){if(0==a.selection.count)return;t.__trtd.deleteSelection()}else 113==o.event.keyCode?t.__trtd.selectText():37==o.event.keyCode?t.__trtd.moveWithinNodes('left'):38==o.event.keyCode?t.__trtd.moveWithinNodes('up'):39==o.event.keyCode?t.__trtd.moveWithinNodes('right'):40==o.event.keyCode?t.__trtd.moveWithinNodes('down'):go.CommandHandler.prototype.doKeyDown.call(e);o.bubbles=!1}}]),e}();e.exports.Trtd=u},function(module,exports,__webpack_require__){'use strict';var waveNodeTemplate=__webpack_require__(15),waveGroupNodeTemplate=__webpack_require__(16),axisGroupNodeTemplate=__webpack_require__(17),iconTextNodeTemplate=__webpack_require__(19),autoTextNodeTemplate=__webpack_require__(20),labelGroupNodeTemplate=__webpack_require__(21),picNodeTemplate=__webpack_require__(22),picGroupNodeTemplate=__webpack_require__(23),yunGroupNodeTemplate=__webpack_require__(24),yunpanGroupNodeTemplate=__webpack_require__(26),shapeNodeTemplate=__webpack_require__(28),shapeTextNodeTemplate=__webpack_require__(29);module.exports=function(nodeType,options){var temp=nodeType+'NodeTemplate';var nodeTemplateClass=eval(temp);return new nodeTemplateClass(options)}},function(e){'use strict';function a(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var t=(o={trtd:{en:'Turn Round TD',chn:'\u5706\u8F6C\u5929\u5730'},save:{en:'Save',chn:'\u4FDD\u5B58'},preview:{en:'Preview',chn:'\u9884\u89C8'},logout:{en:'Log out',chn:'\u9000\u51FA'},menu:{en:'Menu',chn:'\u83DC\u5355'},usual:{en:'Common',chn:'\u5E38\u7528'},thinking:{en:'Train of Thought',chn:'\u601D\u8DEF'},appearance:{en:'Appearance',chn:'\u5916\u89C2'},view:{en:'View',chn:'\u89C6\u56FE'},insertll:{en:'Insert the Lower Leve',chn:'\u63D2\u5165\u4E0B\u7EA7'},insertsl:{en:'Insert Sibling Level',chn:'\u63D2\u5165\u540C\u7EA7'},undo:{en:'Undo',chn:'\u64A4\u9500'},redo:{en:'Redo',chn:'\u91CD\u505A'},cte:{en:'Click to edit',chn:'\u5355\u51FB\u7F16\u8F91'},dce:{en:'Double Click to Edit',chn:'\u53CC\u51FB\u7F16\u8F91\u5185\u5BB9'},centertheme:{en:'Central Theme',chn:'\u4E2D\u5FC3\u4E3B\u9898'},edit:{en:'Edit',chn:'\u7F16\u8F91'},remove:{en:'Delete',chn:'\u5220\u9664'},radius:{en:'Size',chn:'\u5927\u5C0F'},shape:{en:'Shape',chn:'\u5F62\u72B6'},borderwidth:{en:'Border Width',chn:'\u8FB9\u6846\u5BBD\u5EA6'},noborder:{en:'No Border',chn:'\u65E0\u8FB9\u6846'},borderstyle:{en:'Border Style',chn:'\u8FB9\u6846\u6837\u5F0F'},fillcolor:{en:'Fill Color',chn:'\u586B\u5145\u8272'},bordercolor:{en:'Border Color',chn:'\u8FB9\u6846\u989C\u8272'},image:{en:'Pictures',chn:'\u56FE\u7247'},insert:{en:'Insert',chn:'\u63D2\u5165'},delete:{en:'Remove',chn:'\u79FB\u9664'},remark:{en:'Comment',chn:'\u5907\u6CE8'},removeallnode:{en:'Empty Nodes',chn:'\u6E05\u7A7A\u8282\u70B9'},removeallline:{en:'Delete Lines',chn:'\u6E05\u7A7A\u8FDE\u7EBF'},arrangelayout:{en:'Arrange layout',chn:'\u6574\u7406\u5E03\u5C40'},previewSubPan:{en:'Preview SubPan',chn:'\u9884\u89C8\u5B50\u76D8'},arrowstyle:{en:'Arrow Style',chn:'\u7BAD\u5934\u6837\u5F0F'},linkstyle:{en:'Link Style',chn:'\u5F27\u6837\u5F0F'},clearText:{en:'Clear Text',chn:'\u6E05\u7A7A\u6587\u672C'},tdautolayout:{en:'Auto layout',chn:'\u5929\u76D8\u81EA\u52A8\u5E03\u5C40'},jumptonewnode:{en:'Auto locate',chn:'\u81EA\u52A8\u8DF3\u8F6C\u5230\u65B0\u7684\u8282\u70B9'},theme:{en:'Subject',chn:'\u4E3B\u9898'},backcolor:{en:'Background Color',chn:'\u80CC\u666F\u989C\u8272'},objofaction:{en:'Object',chn:'\u4F5C\u7528\u5BF9\u8C61'},oneobj:{en:'Single Node',chn:'\u5355\u4E2A\u8282\u70B9'},sibobj:{en:'Sibling Nodes',chn:'\u540C\u7EA7\u8282\u70B9'},allsibobj:{en:'All Sibling Nodes',chn:'\u6240\u6709\u540C\u7EA7\u8282\u70B9'},allnodes:{en:'All Nodes',chn:'\u6240\u6709\u8282\u70B9'},shade:{en:'Shade',chn:'\u9634\u5F71'},font:{en:'Font',chn:'\u5B57\u4F53'},fontsize:{en:'Font Size',chn:'\u5B57\u53F7'},compactdegree:{en:'Compact Level',chn:'\u7D27\u51D1\u7A0B\u5EA6'},compact:{en:'Compact',chn:'\u7D27\u51D1'},sparse:{en:'Sparse',chn:'\u7A00\u758F'},eq:{en:'Equal Interval',chn:'\u7B49\u95F4\u8DDD'},spread:{en:'Spread',chn:'\u5C55\u5F00'},firstl:{en:'First Layer',chn:'\u7B2C\u4E00\u5C42'},secondl:{en:'Second Layer',chn:'\u7B2C\u4E8C\u5C42'},threel:{en:'Third Layer',chn:'\u7B2C\u4E09\u5C42'},fourl:{en:'Fourth Layer',chn:'\u7B2C\u56DB\u5C42'},fifthl:{en:'Fifth Layer',chn:'\u7B2C\u4E94\u5C42'},localnodes:{en:'Location Nodes',chn:'\u5B9A\u4F4D\u8282\u70B9'},rootnode:{en:'Root Node',chn:'\u6839\u8282\u70B9'},currentnode:{en:'Current Nodes',chn:'\u5F53\u524D\u8282\u70B9'},displayallnodes:{en:'Display All Nodes',chn:'\u663E\u793A\u6240\u6709\u8282\u70B9'},return:{en:'Back',chn:'\u8FD4\u56DE'},tianpan:{en:'TianPan',chn:'\u5929\u76D8'},dipan:{en:'DiPan',chn:'\u5730\u76D8'},open:{en:'Open',chn:'\u6253\u5F00'},saveas:{en:'Save As',chn:'\u53E6\u5B58\u4E3A'},help:{en:'Help',chn:'\u5E2E\u52A9'},new:{en:'New',chn:'\u65B0\u5EFA'},commontemplate:{en:'Common template',chn:'\u5E38\u7528\u6A21\u677F'},openlocalfile:{en:'Open local file',chn:'\u6253\u5F00\u672C\u5730\u6587\u4EF6'},importtext:{en:'Import outline text',chn:'\u5BFC\u5165\u5927\u7EB2\u6587\u672C'},recentlyfile:{en:'Recently used files',chn:'\u6700\u8FD1\u4F7F\u7528\u7684\u6587\u4EF6'},exportdata:{en:'Export Data',chn:'\u53E6\u5B58\u4E3Atxt\u6570\u636E'},exporttext:{en:'Export Outline Text',chn:'\u5BFC\u51FA\u5927\u7EB2\u6587\u672C'},exportimg:{en:'Export Pictures',chn:'\u5BFC\u51FA\u56FE\u7247'},websupport:{en:'Website Support',chn:'\u7F51\u7AD9\u652F\u6301'},techsupport:{en:'Technical Support',chn:'\u6280\u672F\u652F\u6301'},techsupportqq:{en:'Technical Support to QQ Groups',chn:'\u6280\u672F\u652F\u6301QQ\u7FA4'},shortcutkey:{en:'Shortcut Key',chn:'\u5FEB\u6377\u952E'},addchildnode:{en:'Add Child',chn:'\u589E\u52A0\u5B50\u8282\u70B9'},addsibnode:{en:'Add Sibling',chn:'\u589E\u52A0\u540C\u7EA7\u8282\u70B9'},key:{en:'Key',chn:'\u952E'},or:{en:'Or',chn:'\u6216'},confirmedittext:{en:'Confirm the completion of editing text',chn:'\u7F16\u8F91\u5B8C\u6587\u5B57\u786E\u8BA4'},editnewline:{en:'Edit text newline',chn:'\u7F16\u8F91\u6587\u5B57\u6362\u884C'},canceltextedit:{en:'Cancel Text Editing',chn:'\u53D6\u6D88\u7F16\u8F91\u6587\u5B57'},activetextedit:{en:'Activate Text Editing',chn:'\u6FC0\u6D3B\u7F16\u8F91\u6587\u5B57'},sanpak:{en:'Select a node and press any key',chn:'\u9009\u4E2D\u8282\u70B9\u540E\u6309\u4EFB\u610F\u5B57\u6BCD\u952E'},auxview:{en:'Auxiliary View',chn:'\u8F85\u52A9\u67E5\u770B'},focusselectnode:{en:'Focus on selected nodes',chn:'\u805A\u7126\u9009\u4E2D\u8282\u70B9'},locateselectednode:{en:'Locate selected nodes',chn:'\u5B9A\u4F4D\u9009\u4E2D\u8282\u70B9'},locaterootnode:{en:'Locate Root Nodes',chn:'\u5B9A\u4F4D\u6839\u8282\u70B9'},bigcanvas:{en:'Enlarge Canvas',chn:'\u653E\u5927\u753B\u5E03'},smallcanvas:{en:'Narrow Canvas',chn:'\u7F29\u5C0F\u753B\u5E03'},switchnode:{en:'Switch selected nodes',chn:'\u5207\u6362\u9009\u62E9\u7684\u8282\u70B9'},mttnsn:{en:'Move to the next sibling node',chn:'\u79FB\u52A8\u5230\u4E0B\u4E00\u4E2A\u540C\u7EA7\u8282\u70B9'},mttlsn:{en:'Move to the last sibling node',chn:'\u79FB\u52A8\u5230\u4E0A\u4E00\u4E2A\u8282\u70B9'},mttfsn:{en:'Move to the first child node',chn:'\u79FB\u52A8\u5230\u7B2C\u4E00\u4E2A\u8282\u70B9'},mtfn:{en:'Move to Father Node',chn:'\u79FB\u52A8\u5230\u7236\u8282\u70B9'},direckey:{en:'Direction Key',chn:'\u65B9\u5411\u952E'},servicetd:{en:'Send Feedback',chn:'\u6211\u8981\u7ED9\u5706\u8F6C\u5929\u5730\u63D0\u610F\u89C1'},cbottc:{en:'Change background of the DiPan',chn:'\u66F4\u6362\u5730\u76D8\u80CC\u666F'},rbottc:{en:'Remove background of the DiPan',chn:'\u79FB\u9664\u5730\u76D8\u80CC\u666F'},icn:{en:'Insert child nodes',chn:'\u63D2\u5165\u5B50\u8282\u70B9'},addnodepic:{en:'Add Node Pictures',chn:'\u6DFB\u52A0\u8282\u70B9\u56FE\u7247'},removepicture:{en:'Remove Pictures',chn:'\u79FB\u9664\u56FE\u7247'},emptynodetext:{en:'Empty Node Text',chn:'\u6E05\u7A7A\u8282\u70B9\u6587\u672C'},insertnodetianpan:{en:'Insert Nodes of TianPan',chn:'\u63D2\u5165\u5929\u76D8\u8282\u70B9'},inserttext:{en:'Insert Text',chn:'\u63D2\u5165\u6587\u672C'},centerpicture:{en:'Center Pictures',chn:'\u5C45\u4E2D\u56FE\u7247'},ewah:{en:'Equal Width and Hight',chn:'\u7B49\u5BBD\u9AD8'},bringtofront:{en:'Bring to Front',chn:'\u7F6E\u4E8E\u9876\u5C42'},bringtobottom:{en:'Bring to Bottom',chn:'\u7F6E\u4E8E\u5E95\u5C42'},bringforward:{en:'Bring Forward',chn:'\u4E0A\u79FB\u4E00\u5C42'},fixnode:{en:'Fixed Nodes',chn:'\u56FA\u5B9A\u8282\u70B9'},cancelfix:{en:'Cancel Fixed',chn:'\u53D6\u6D88\u56FA\u5B9A'},themecolor:{en:'Theme Colors',chn:'\u4E3B\u9898\u989C\u8272'},standardcolor:{en:'Standard Colors',chn:'\u6807\u51C6\u989C\u8272'},webcolor:{en:'Web Colors',chn:'\u66F4\u591A\u989C\u8272'},backtop:{en:'Back to Palette',chn:'\u8FD4\u56DE\u4E3B\u9898\u989C\u8272'},history:{en:'History',chn:'\u5386\u53F2'},nohistory:{en:'No history yet',chn:'\u6682\u65E0\u5386\u53F2'},week:{en:'Week',chn:'\u6700\u8FD1\u4E00\u5468'},Jan:{en:'January',chn:'\u4E00\u6708'},Feb:{en:'February',chn:'\u4E8C\u6708'},Mar:{en:'March',chn:'\u4E09\u6708'},Apr:{en:'April',chn:'\u56DB\u6708'},May:{en:'May',chn:'\u4E94\u6708'},Jun:{en:'June',chn:'\u516D\u6708'},Jul:{en:'July',chn:'\u4E03\u6708'},Aug:{en:'August',chn:'\u516B\u6708'},Sep:{en:'September',chn:'\u4E5D\u6708'},Oct:{en:'October',chn:'\u5341\u6708'},Nov:{en:'November',chn:'\u5341\u4E00\u6708'},Dec:{en:'December',chn:'\u5341\u4E8C\u6708'},insertimg:{en:'Insert Pictures',chn:'\u63D2\u5165\u56FE\u7247'},imglist:{en:'Pictures list',chn:'\u56FE\u7247\u5217\u8868'},uploadimg:{en:'Upload Picture',chn:'\u4E0A\u4F20\u56FE\u7247'},katong:{en:'Cartoon Picture',chn:'\u5361\u901A\u56FE\u7247'},numbericon:{en:'Number Icons',chn:'\u6570\u5B57\u56FE\u7247'},qipao:{en:'Bubble',chn:'\u6C14\u6CE1'},custompic:{en:'Custom Picture',chn:'\u81EA\u5B9A\u4E49\u56FE\u7247'},picture:{en:'Picture',chn:'\u56FE\u7247'},cancel:{en:'Cancel',chn:'\u53D6\u6D88'},ok:{en:'Ok',chn:'\u786E\u5B9A'},previewimg:{en:'Preview Pictures',chn:'\u9884\u89C8\u56FE\u7247'},copyimg:{en:'Copy Picture',chn:'\u590D\u5236\u56FE\u7247'},copyimgsucces:{en:'Already Copy Picture Into Clipboard',chn:'\u6210\u529F\u590D\u5236\u56FE\u7247\u5230\u7C98\u8D34\u677F'},dragtoupload:{en:'Drag to Upload Picture',chn:'\u62D6\u62FD\u5230\u6B64\u5904\u4E0A\u4F20'},linkaddress:{en:'Link Address',chn:'\u94FE\u63A5\u5730\u5740'},insertremark:{en:'Insert Comment',chn:'\u63D2\u5165\u5907\u6CE8'},insertlink:{en:'Insert Link',chn:'\u63D2\u5165\u94FE\u63A5'},copy:{en:'copy',chn:'\u590D\u5236'},picdin:{en:'Picture definition',chn:'\u56FE\u7247\u6E05\u6670\u5EA6'},hsacc:{en:'Hierarchical Subject',chn:'\u5929\u76D8\u5C42\u7EA7\u4E3B\u9898'},mtwtb:{en:'Bold Border Subject',chn:'\u5929\u76D8\u767D\u5B57\u7C97\u53D8\u4E3B\u9898'},officetheme:{en:'Office Subject',chn:'Office\u4E3B\u9898'},lctheme:{en:'Light-coloured Subject',chn:'\u6D45\u8272\u4E3B\u9898'},web2theme:{en:'web2.0 Subject',chn:'Web2.0\u4E3B\u9898'},metrotheme:{en:'Metro Subject',chn:'Metro\u4E3B\u9898'},retrotheme:{en:'Retro Subject',chn:'\u590D\u53E4\u4E3B\u9898'},bustheme:{en:'Business Subject',chn:'\u5546\u4E1A\u4E3B\u9898'},hiet1:{en:'Hierachy Subject 1',chn:'\u5C42\u6B21\u4E3B\u98981'},hiet2:{en:'Hierachy Subject 2',chn:'\u5C42\u6B21\u4E3B\u98982'},eayth:{en:'Earlier Version Subject',chn:'\u65E7\u7248\u4E3B\u9898'},blankth:{en:'Pure-black Subject',chn:'\u7EAF\u9ED1\u8272\u4E3B\u9898'},transthe:{en:'Transparent Subject',chn:'\u900F\u660E\u4E3B\u9898'},randomdipan:{en:'Random Subject of the DiPan',chn:'\u968F\u673A\u5730\u76D8\u4E3B\u9898'},radomcolor1:{en:'Random Colour 1',chn:'\u968F\u673A\u8272\u5F691'},radomcolor2:{en:'Random Colour 1',chn:'\u968F\u673A\u8272\u5F692'},mylocalfile:{en:'My local file',chn:'\u6211\u7684\u672C\u5730\u6587\u4EF6'},ut2c:{en:'Up to 20 characters',chn:'\u6700\u591A20\u4E2A\u5B57\u7B26'},success:{en:'Success',chn:'\u6210\u529F'},danger:{en:'Fail',chn:'\u5931\u8D25'},info:{en:'Info',chn:'\u63D0\u793A'},strf:{en:'Save the file in:Menu->Open->Recently used file',chn:'\u6587\u4EF6\u4FDD\u5B58\u5728:\u83DC\u5355->\u6253\u5F00->\u6700\u8FD1\u4F7F\u7528\u6587\u4EF6\u4E2D'},netonffline:{en:'Network is not connected, commonly used template download failed',chn:'\u7F51\u7EDC\u672A\u8FDE\u63A5\uFF0C\u5E38\u7528\u6A21\u677F\u4E0B\u8F7D\u5931\u8D25'},cantcheckver:{en:'The network is not connected, the version of the test failed',chn:'\u7F51\u7EDC\u672A\u8FDE\u63A5\uFF0C\u7248\u672C\u68C0\u6D4B\u5931\u8D25'},spacebar:{en:'Space bar',chn:'\u7A7A\u683C\u952E'},supportmail:{en:'Support Mail',chn:'\u6280\u672F\u652F\u6301\u90AE\u7BB1'},updatesuccess:{en:'Update sucess',chn:'\u66F4\u65B0\u6210\u529F'},blankText:{en:'Blank text',chn:'\u7A7A\u767D\u6587\u672C'},blockquote:{en:'Block Quote',chn:'\u5F15\u7528'},bold:{en:'Bold',chn:'\u52A0\u7C97\u6587\u5B57'},code:{en:'Code',chn:'\u63D2\u5165\u4EE3\u7801'},color:{en:'Text Color',chn:'\u6587\u5B57\u989C\u8272'},coloredText:{en:'Colored Text',chn:'\u5F69\u8272\u6587\u5B57'},hr:{en:'Horizontal Line',chn:'\u5206\u9694\u7EBF'}},a(o,'image',{en:'Insert Image',chn:'\u63D2\u5165\u56FE\u7247'}),a(o,'externalImage',{en:'External Image',chn:'\u5916\u94FE\u56FE\u7247'}),a(o,'uploadImage',{en:'Upload Image',chn:'\u4E0A\u4F20\u56FE\u7247'}),a(o,'uploadFailed',{en:'Upload failed',chn:'\u4E0A\u4F20\u5931\u8D25\u4E86'}),a(o,'uploadError',{en:'Error occurs during upload',chn:'\u4E0A\u4F20\u51FA\u9519\u4E86'}),a(o,'imageUrl',{en:'Url',chn:'\u56FE\u7247\u5730\u5740'}),a(o,'imageSize',{en:'Size',chn:'\u56FE\u7247\u5C3A\u5BF8'}),a(o,'imageAlt',{en:'Alt',chn:'\u56FE\u7247\u63CF\u8FF0'}),a(o,'restoreImageSize',{en:'Restore Origin Size',chn:'\u8FD8\u539F\u56FE\u7247\u5C3A\u5BF8'}),a(o,'uploading',{en:'Uploading',chn:'\u6B63\u5728\u4E0A\u4F20'}),a(o,'indent',{en:'Indent',chn:'\u5411\u53F3\u7F29\u8FDB'}),a(o,'outdent',{en:'Outdent',chn:'\u5411\u5DE6\u7F29\u8FDB'}),a(o,'italic',{en:'Italic',chn:'\u659C\u4F53\u6587\u5B57'}),a(o,'link',{en:'Insert Link',chn:'\u63D2\u5165\u94FE\u63A5'}),a(o,'linkText',{en:'Text',chn:'\u94FE\u63A5\u6587\u5B57'}),a(o,'linkUrl',{en:'Url',chn:'\u94FE\u63A5\u5730\u5740'}),a(o,'linkTarget',{en:'Target',chn:'\u6253\u5F00\u65B9\u5F0F'}),a(o,'openLinkInCurrentWindow',{en:'Open link in current window',chn:'\u5728\u65B0\u7A97\u53E3\u4E2D\u6253\u5F00'}),a(o,'openLinkInNewWindow',{en:'Open link in new window',chn:'\u5728\u5F53\u524D\u7A97\u53E3\u4E2D\u6253\u5F00'}),a(o,'removeLink',{en:'Remove Link',chn:'\u79FB\u9664\u94FE\u63A5'}),a(o,'ol',{en:'Ordered List',chn:'\u6709\u5E8F\u5217\u8868'}),a(o,'ul',{en:'Unordered List',chn:'\u65E0\u5E8F\u5217\u8868'}),a(o,'strikethrough',{en:'Strikethrough',chn:'\u5220\u9664\u7EBF\u6587\u5B57'}),a(o,'table',{en:'Table',chn:'\u8868\u683C'}),a(o,'deleteRow',{en:'Delete Row',chn:'\u5220\u9664\u884C'}),a(o,'insertRowAbove',{en:'Insert Row Above',chn:'\u5728\u4E0A\u9762\u63D2\u5165\u884C'}),a(o,'insertRowBelow',{en:'Insert Row Below',chn:'\u5728\u4E0B\u9762\u63D2\u5165\u884C'}),a(o,'deleteColumn',{en:'Delete Column',chn:'\u5220\u9664\u5217'}),a(o,'insertColumnLeft',{en:'Insert Column Left',chn:'\u5728\u5DE6\u8FB9\u63D2\u5165\u5217'}),a(o,'insertColumnRight',{en:'Insert Column Right',chn:'\u5728\u53F3\u8FB9\u63D2\u5165\u5217'}),a(o,'deleteTable',{en:'Delete Table',chn:'\u5220\u9664\u8868\u683C'}),a(o,'title',{en:'Title',chn:'\u6807\u9898'}),a(o,'normalText',{en:'Text',chn:'\u666E\u901A\u6587\u672C'}),a(o,'underline',{en:'Underline',chn:'\u4E0B\u5212\u7EBF\u6587\u5B57'}),a(o,'alignment',{en:'Alignment',chn:'\u6C34\u5E73\u5BF9\u9F50'}),a(o,'alignCenter',{en:'Align Center',chn:'\u5C45\u4E2D'}),a(o,'alignLeft',{en:'Align Left',chn:'\u5C45\u5DE6'}),a(o,'alignRight',{en:'Align Right',chn:'\u5C45\u53F3'}),a(o,'selectLanguage',{en:'Select Language',chn:'\u9009\u62E9\u7A0B\u5E8F\u8BED\u8A00'}),a(o,'fontScale',{en:'Font Size',chn:'\u5B57\u4F53\u5927\u5C0F'}),a(o,'fontScaleXLarge',{en:'X Large Size',chn:'\u8D85\u5927\u5B57\u4F53'}),a(o,'fontScaleLarge',{en:'Large Size',chn:'\u5927\u53F7\u5B57\u4F53'}),a(o,'fontScaleNormal',{en:'Normal Size',chn:'\u6B63\u5E38\u5927\u5C0F'}),a(o,'fontScaleSmall',{en:'Small Size',chn:'\u5C0F\u53F7\u5B57\u4F53'}),a(o,'fontScaleXSmall',{en:'X Small Size',chn:'\u8D85\u5C0F\u5B57\u4F53'}),a(o,'savesuccess',{en:'Save successful',chn:'\u4FDD\u5B58\u6210\u529F'}),a(o,'failsuccess',{en:'Save failed',chn:'\u4FDD\u5B58\u5931\u8D25'}),a(o,'layoutmode',{en:'Layout Mode',chn:'\u5E03\u5C40\u65B9\u5F0F'}),a(o,'outequaldivid',{en:'Divided by the last layer',chn:'\u5916\u5708\u5747\u5206'}),a(o,'innerequaldivid',{en:'Divided by the first layer',chn:'\u5185\u5708\u5747\u5206'}),a(o,'givenlayer',{en:'Designate',chn:'\u6307\u5B9A\u5C42\u5747\u5206'}),a(o,'textdirection',{en:'Text Direction',chn:'\u6587\u5B57\u65B9\u5411'}),a(o,'textrotate',{en:'Rotate',chn:'\u65CB\u8F6C'}),a(o,'textoutside',{en:'Toward the outside',chn:'\u653E\u5C04'}),a(o,'upwards',{en:'Upwards',chn:'\u6B63\u5411'}),a(o,'sectorthickness',{en:'Sector thickness',chn:'\u6247\u533A\u5BBD\u5EA6'}),a(o,'thicknessrange',{en:'Range 100~300',chn:'\u8303\u56F4 100~300'}),a(o,'currentfile',{en:'Current File',chn:'\u7F16\u8F91\u4E2D'}),a(o,'uploadsuccess',{en:'Upload successful',chn:'\u4E0A\u4F20\u6210\u529F'}),a(o,'deletenodeinfo',{en:'Are you sure to delete the node and its child nodes?',chn:'\u5220\u9664\u8282\u70B9\u4F1A\u5220\u9664\u5B83\u7684\u6240\u6709\u5B50\u8282\u70B9\uFF0C\u786E\u5B9E\u8981\u5220\u9664\u5417\uFF1F'}),a(o,'exporttdp',{en:'Save as .tdp shared file',chn:'\u53E6\u5B58\u4E3A.tdp\u5171\u4EAB\u6587\u4EF6'}),a(o,'hypertype',{en:'Type',chn:'\u94FE\u63A5\u7C7B\u578B'}),a(o,'url',{en:'URL',chn:'\u7F51\u5740'}),a(o,'localfile',{en:'Local file',chn:'\u672C\u5730\u6587\u4EF6'}),a(o,'tiandipan',{en:'Tianpan or Dipan',chn:'\u5929\u5730\u76D8'}),a(o,'link',{en:'Hyperlink',chn:'\u94FE\u63A5'}),a(o,'outlineeditor',{en:'Outline Editor',chn:'\u5927\u7EB2\u7F16\u8F91'}),a(o,'modificationbuttons',{en:'Modification Buttons',chn:'\u4FEE\u6539\u6309\u94AE'}),a(o,'browsingbuttons',{en:'Browsing Buttons',chn:'\u6D4F\u89C8\u6309\u94AE'}),a(o,'show',{en:'Show',chn:'\u663E\u793A'}),a(o,'hide',{en:'Hide',chn:'\u9690\u85CF'}),a(o,'newnode',{en:'New Node',chn:'\u65B0\u8282\u70B9'}),a(o,'moveupnode',{en:'Move up',chn:'\u4E0A\u79FB\u8282\u70B9'}),a(o,'movedownnode',{en:'Move down',chn:'\u4E0B\u79FB\u8282\u70B9'}),a(o,'removenode',{en:'Remove',chn:'\u5220\u9664\u8282\u70B9'}),a(o,'editnode',{en:'Edit Node',chn:'\u7F16\u8F91\u8282\u70B9'}),a(o,'prevnode',{en:'Select Previous',chn:'\u4E0A\u4E00\u4E2A\u8282\u70B9'}),a(o,'nextnode',{en:'Select Next',chn:'\u4E0B\u4E00\u4E2A\u8282\u70B9'}),a(o,'expandnode',{en:'Expand',chn:'\u5C55\u5F00\u8282\u70B9'}),a(o,'collapsenode',{en:'Collapse',chn:'\u6298\u53E0\u8282\u70B9'}),a(o,'expandall',{en:'Expand All',chn:'\u5168\u90E8\u5C55\u5F00'}),a(o,'collapseall',{en:'Collapse All',chn:'\u5168\u90E8\u6298\u53E0'}),a(o,'preview',{en:'Preview',chn:'\u9884\u89C8'}),a(o,'cancel',{en:'Cancel',chn:'\u53D6\u6D88'}),a(o,'apply',{en:'Apply',chn:'\u5E94\u7528'}),a(o,'openpreviewimg',{en:'Preview image is loading',chn:'\u6B63\u5728\u6253\u5F00\u9884\u89C8\u56FE\u7247'}),a(o,'tempnodetips',{en:'This is a temp node',chn:'\u8FD9\u662F\u4E34\u65F6\u8282\u70B9'}),a(o,'buildtdp',{en:'Build .tdp shared file',chn:'\u751F\u6210.tdp\u6587\u4EF6\u4E0B\u8F7D'}),a(o,'deleteconfirm',{en:'Are you sure to clear all the nodes?',chn:'\u786E\u5B9A\u8981\u6E05\u7A7A\u8282\u70B9\uFF1F'}),a(o,'selecttargertnode',{en:'Select Target Node',cn:'\u8BF7\u9009\u62E9\u76EE\u6807\u8282\u70B9'}),a(o,'link2web',{en:'Link to Webpage',cn:'\u94FE\u63A5\u7F51\u9875'}),a(o,'link2node',{en:'Link to Node',cn:'\u94FE\u63A5\u8282\u70B9'}),a(o,'removelink',{en:'Remove Link',cn:'\u79FB\u9664\u8282\u70B9'}),a(o,'addtemp',{en:'Add Template',cn:'\u6DFB\u52A0\u6A21\u677F'}),a(o,'buildtdp',{en:'Build .tdp shared file',chn:'\u751F\u6210.tdp\u6587\u4EF6\u4E0B\u8F7D'}),a(o,'deleteconfirm',{en:'Are you sure to clear all the nodes?',chn:'\u786E\u5B9A\u8981\u6E05\u7A7A\u8282\u70B9\uFF1F'}),a(o,'success',{en:'Success',chn:'\u6210\u529F'}),a(o,'warning',{en:'Warning',chn:'\u8B66\u544A'}),a(o,'error',{en:'Failed',chn:'\u5931\u8D25'}),a(o,'unsupportfile',{en:'Unsupported File!',cn:'\u4E0D\u652F\u6301\u8BE5\u5BFC\u5165\u6587\u4EF6'}),o),o;e.exports={trans:function(e){return t[e]?t[e][localStorage.getItem('language')]?t[e][localStorage.getItem('language')]:t[e].chn:e}}},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}var i={};void 0,i.tianpan=t(4),i.dipan=t(31),i.jin=t(32),i.huo=t(33),i.shui=t(34),i.yunpan=t(35),i.wheel=t(36),i.dspiral=t(37),void 0;var r=function e(a,t){o(this,e);try{if(t.model){var r=go.Model.fromJson(t.model);r&&r.modelData&&r.modelData.type&&(t.type=r.modelData.type)}}catch(a){}var d=i[t.type];return new d(a,t)};r.go=go,r.version='0.0.15',void 0,'undefined'!=typeof window&&(window.Trtd=r),e.exports=r},function(e){'use strict';function a(){go.Layout.call(this),this._radius=NaN,this._spacing=10,this._clockwise=!0,this._pointlist=[]}function t(e,a){var t=_Mathcos(a),o=_Mathsin(a);return new go.Point(e*(t+a*o),e*(o-a*t))}function o(e,a){for(var t=!1,o=a.iterator;o.next();)if(_Mathsqrt(e.point.distanceSquaredPoint(o.value.point))<e.radius+o.value.radius){t=!0;break}return t}var i=go.GraphObject.make,r=!1,d='sparse';go.Diagram.inherit(a,go.Layout),a.prototype.cloneProtected=function(e){go.Layout.prototype.cloneProtected.call(this,e),e._radius=this._radius,e._spacing=this._spacing,e._clockwise=this._clockwise},a.prototype.doLayout=function(e){var a=Math.atan;null===this.network&&(this.network=this.makeNetwork(e));for(var l=null,s=!1,c=this.network.vertexes.iterator,g=[],m;c.next();)m=c.value,s?0===m.sourceEdges.count&&g.push(m):(null===l&&(l=m),0===m.sourceEdges.count&&(l=m,s=!0));if(null===l)return void(this.network=null);var p=this.clockwise?1:-1,u=2.5,h=!(null!=window.localStorage.getItem('isautolayout'))||'true'==window.localStorage.getItem('isautolayout'),k=!0,f=0,T=5,b=new go.List,S=150,v,w,P,x,y,B,D,N,A,C,W,O,L,G,z,F;'terse'==d,S=150;var E;B=l.destinationEdges.first(),w=null===B?null:B.toVertex,l.node.rad=v;for(var M=0,R=!1;null!==w;)M++,w.node.data.isGroup&&(R=!0),W=w.destinationEdges.first(),O=null===W?null:W.toVertex,B=W,w=O;B=l.destinationEdges.first(),w=null===B?null:B.toVertex,v=1;var j;if(w){E=w.node.actualBounds.width;for(var X=l.node.actualBounds.width/2+w.node.actualBounds.width/2;j=t(v,T),j=new go.Point(j.x+l.node.location.x,j.y+l.node.location.y),!(_Mathsqrt(j.distanceSquaredPoint(l.node.location))>X+10);)v+=.1}for(var H=0;k;){f++,u=T,B=l.destinationEdges.first(),l.node.data.angle=0,null!==B&&null!==B.link&&(B.link.curviness=p*v);null==B?20:B.link.curviness;w=null===B?null:B.toVertex,D=l,A=0;var K;for(P=0,x=0,w&&(w.node.data.angle=u),b.clear(),b.add({point:l.node.location,radius:l.node.actualBounds.width/2}),F=_Mathsqrt(t(v,5*_MathPI/2).distanceSquaredPoint(t(v,5*_MathPI/2-.7)));null!==w;){A++,l.node.data.rad=v,N=.4,K=u;for(var Y=0;20>=Y;Y++){if(G=t(v,u),G=new go.Point(G.x+l.node.location.x,G.y+l.node.location.y),P=G.x,x=G.y,w.node instanceof go.Group&&B.link.toNode!==w.node){var i=B.link.toNode.location.copy().subtract(w.node.location);G.x-=i.x,G.y-=i.y}if(E=w.node.actualBounds.width/2,L={point:G,radius:E},y=o(L,b),y){if(H++,u>=D.node.data.angle+_MathPI/2){u=D.node.data.angle+_MathPI/2;break}u=D.node.data.angle+(Y+1)*_MathPI/16,C=p*a((w.node.actualBounds.width/2+D.node.actualBounds.width/2+S)/_Mathsqrt(w.node.location.distanceSquaredPoint(l.node.location))),u<=D.node.data.angle+C&&(u=D.node.data.angle+C)}else break}if(y){v+=1;break}W=w.destinationEdges.first(),O=null===W?null:W.toVertex,w.centerX=G.x,w.centerY=G.y,w.node.data.angle=u,B.link.data.unautoLink=!1,B.link.rad=v,B.link.angle1=D.node.data.angle,B.link.angle2=w.node.data.angle;var I=!1;6>=M?1.3*M<3*_MathPI/2&&!R?u+=_Mathmin(3*_MathPI/2/M,_MathPI/2):w.node.data.isGroup?I=!0:u+=1.3:I=!0,I&&(null==O?(z=F,C=p*a((z+S)/_Mathsqrt(G.distanceSquaredPoint(l.node.location)))):(z=_Mathmax(F,w.node.actualBounds.width/2+O.node.actualBounds.width/2),C=p*a((z+S)/_Mathsqrt(G.distanceSquaredPoint(l.node.location)))),u+=C),E=w.node.actualBounds.width,b.add(L),B=W,D=w,w=O}null==w&&(k=!1)}this.updateParts(),this.network=null,r},a.prototype.commitLayout=function(){this.network.vertexes.each(function(e){e.commit()}),this.network.edges.each(function(e){e.commit()}),r},a.prototype.diameter=function(e){if(!e)return 0;var a=e.bounds;return _Mathsqrt(a.width*a.width/4+a.height*a.height/4)},Object.defineProperty(a.prototype,'radius',{get:function(){return this._radius},set:function(e){if('number'!=typeof e)throw new Error('new value for SpiralLayout.radius must be a number, not: '+e);this._radius!==e&&(this._radius=e,this.invalidateLayout())}}),Object.defineProperty(a.prototype,'spacing',{get:function(){return this._spacing},set:function(e){if('number'!=typeof e)throw new Error('new value for SpiralLayout.spacing must be a number, not: '+e);this._spacing!==e&&(this._spacing=e,this.invalidateLayout())}}),Object.defineProperty(a.prototype,'clockwise',{get:function(){return this._clockwise},set:function(e){if('boolean'!=typeof e)throw new Error('new value for SpiralLayout.clockwise must be a boolean, not: '+e);this._clockwise!==e&&(this._clockwise=e,this.invalidateLayout())}}),e.exports=a},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'makeGeo',value:function(e,a,t){var o=e.radiusX,i=void 0===o?150:o,r=e.radiusY,d=void 0===r?100:r;i=a.part.findObject('main').width/2,d=a.part.findObject('main').height/2;var l=new go.Geometry().add(new go.PathFigure(0,0).add(new go.PathSegment(go.PathSegment.SvgArc,2*i,0,i,d,0,1,t.clockwiseFlag?1:0)));return l.defaultStretch=go.GraphObject.Fill,l}},{key:'makeGeoWave',value:function(e,a,t){var o=e.radiusX,i=void 0===o?150:o,r=e.radiusY,d=void 0===r?100:r;i=a.part.findObject('main').width/2,d=a.part.findObject('main').height/2;var l=new go.PathSegment(go.PathSegment.QuadraticBezier,2*i,0,i,d*(t.clockwiseFlag?-1:1));'waveTail'==e.role&&(l=new go.PathSegment(go.PathSegment.QuadraticBezier,i,d*(t.clockwiseFlag?-1:1),i/2,d*(t.clockwiseFlag?-1:1)));var s=new go.Geometry().add(new go.PathFigure(0,0).add(l));return s.defaultStretch=go.GraphObject.None,s}},{key:'getShiHalfEllipseShape',value:function(){var e=this;return l(go.Shape,{name:'XU',strokeWidth:2,stroke:'#cb1c27',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.Uniform,alignment:go.Spot.Bottom,alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=0;return 0==a.order%2&&(o=1),a.flip,'Ellipse'==a.oliveType?e.makeGeo(a,t,{clockwiseFlag:o}):e.makeGeoWave(a,t,{clockwiseFlag:o})}),new go.Binding('stroke','shiStroke').makeTwoWay(),new go.Binding('strokeWidth','shiStrokeWidth').makeTwoWay(),new go.Binding('strokeDashArray','shiStrokeDashArray',function(e){return JSON.parse(e)}).makeTwoWay(function(e){return JSON.stringify(e)}),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getXuHalfEllipseShape',value:function(){var e=this;return l(go.Shape,{name:'SHI',strokeWidth:2,stroke:'#0e399d',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.Uniform,alignment:go.Spot.Bottom,strokeDashArray:[10,5],alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=1;return 0==a.order%2&&(o=0),'Ellipse'==a.oliveType?e.makeGeo(a,t,{clockwiseFlag:o}):e.makeGeoWave(a,t,{clockwiseFlag:o})}),new go.Binding('stroke','xuStroke').makeTwoWay(),new go.Binding('strokeWidth','xuStrokeWidth').makeTwoWay(),new go.Binding('strokeDashArray','xuStrokeDashArray',function(e){return JSON.parse(e)}).makeTwoWay(function(e){return JSON.stringify(e)}),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getTailShiShape',value:function(){var e=this;return l(go.Shape,{name:'XU',strokeWidth:2,stroke:'#cb1c27',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.None,alignment:go.Spot.Bottom,alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=0;return 0==a.order%2&&(o=1),a.flip,e.makeGeoWave(a,t,{clockwiseFlag:!o})}),new go.Binding('stroke','shiStroke').makeTwoWay(),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getTailXuShape',value:function(){var e=this;return l(go.Shape,{name:'TailXu',strokeWidth:2,stroke:'#0e399d',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.None,alignment:go.Spot.Bottom,strokeDashArray:[10,5],alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=1;return 0==a.order%2&&(o=0),e.makeGeoWave(a,t,{clockwiseFlag:!o})}),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getTextBuild',value:function(){return l(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.4),font:'18px \'Microsoft YaHei\'',editable:!1,angle:0,stroke:'black',isMultiline:!0,textEdited:function(e,a,t){var o=e.part.diagram.model.findNodeDataForKey(e.part.data.centerText);o&&(e.part.diagram.model.startTransaction('text'),e.part.diagram.model.setDataProperty(o,'text',t),e.part.diagram.model.commitTransaction('text')),setTimeout(function(){if(e.text&&!(e.text&&''==e.text.trim())&&0!=e.lineCount%2){if('\n'==t[t.length-1])return void(e.text=t.substring(0,t.length-1));e.text=t+'\n'}},100);e.part.containingGroup.layout.isValidLayout=!1},overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Uniform},new go.Binding('visible','textVisible').makeTwoWay(),new go.Binding('alignment','',function(){return new go.Spot(.5,.5)}),new go.Binding('textAlign','textAlign',function(e){return e}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e-30}).ofObject('main'),new go.Binding('text','text',function(e,a){return e}).makeTwoWay(function(e,a){return e}),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay())}},{key:'getNodeSelectionAdornmentTemplate',value:function(){return l(go.Adornment,'Spot',{},l(go.Panel,'Auto',l(go.Shape,{isPanelMain:!0,fill:null,stroke:'dodgerblue',strokeWidth:3}),l(go.Placeholder)),l('CircleButton',{name:'AddChild',toolTip:l(go.Adornment,'Auto',l(go.Shape,{fill:'#FFFFCC'}),l(go.TextBlock,{textAlign:'center',margin:new go.Margin(8,4,4,4)},new go.Binding('text','',function(){return'\u589E\u52A0\u6A44\u6984'}))),alignment:go.Spot.Right,alignmentFocus:go.Spot.Left,width:50,height:50,click:function(a){a.diagram.__trtd.addOlive()}},l(go.Shape,'PlusLine',{stroke:'#770077',desiredSize:new go.Size(25,25)})),l('CircleButton',{name:'RemoveChild',toolTip:l(go.Adornment,'Auto',l(go.Shape,{fill:'#FFFFCC'}),l(go.TextBlock,{textAlign:'center',margin:new go.Margin(8,4,4,4)},new go.Binding('text','',function(){return'\u5220\u9664\u6A44\u6984'}))),alignment:go.Spot.Left,alignmentFocus:go.Spot.Right,width:50,height:50,click:function(a){a.diagram.__trtd.deleteSelection()}},l(go.Shape,'MinusLine',{stroke:'#770077',desiredSize:new go.Size(25,25)})),l('Button',{name:'AddLevel',toolTip:l(go.Adornment,'Auto',l(go.Shape,{fill:'#FFFFCC'}),l(go.TextBlock,{textAlign:'center',margin:new go.Margin(8,4,4,4)},new go.Binding('text','',function(){return'\u589E\u52A0\u540C\u7EA7\u8282\u70B9'}))),alignment:new go.Spot(1,.5,15,0),width:30,height:30,click:function(a){a.diagram.__trtd.addOlive()}},l(go.Shape,'PlusLine',{stroke:'#227700',desiredSize:new go.Size(15,15)}),new go.Binding('visible','level',function(e){return 0!=e})))}},{key:'nodeResizeAdornmentTemplate',value:function(){return l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'getNodeTemplate',value:function(){var e=this.diagram,a=this;return l(go.Node,'Spot',{__trtdNode:a,layerName:'overflow',zOrder:5,movable:!0,resizable:!1,resizeObjectName:'main',selectionObjectName:'main',rotatable:!1,resizeAdornmentTemplate:a.nodeResizeAdornmentTemplate(),layoutConditions:~go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,locationSpot:go.Spot.LeftCenter,click:function(a,e){if(e.containingGroup)for(var t=e.containingGroup.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&('xuText'==o.data.role||'shiText'==o.data.role)&&(o.data.order==e.data.order?(''==o.data.text||''==o.data.text.trim())&&(o.findObject('textBorder').visible=!0):o.findObject('textBorder').visible=!1)},mouseOver:function(a,e){if(e.containingGroup){var t=e.diagram.findNodeForKey(e.data.shiText);t&&(t.findObject('textBorder').visible=!0);var o=e.diagram.findNodeForKey(e.data.xuText);o&&(o.findObject('textBorder').visible=!0);var i=e.diagram.findNodeForKey(e.data.centerText);i&&(i.layerName='Background')}},contextMenu:l(go.Adornment),mouseDragEnter:function(a,e){var t=e.part,o=a.diagram.selection.first();if('wave'==o.data.category||'picGroup'==o.data.category&&'cbian'==o.data.role){var i=t.diagram.findNodeForKey(t.data.centerText);i&&(i.layerName='Background');var r=t.findObject('main');r&&(r._prevFill=r.fill,r.fill='RGBA(146,208,80,0.5)')}},mouseDragLeave:function(a,e){var t=e.part,o=t.findObject('main');o&&o._prevFill&&(o.fill=o._prevFill);var i=t.diagram.findNodeForKey(t.data.centerText);i&&!c.checkPhone()&&(i.layerName='Foreground')},mouseDrop:function(a,e){var t=e.part,o=a.diagram.selection.first();if(o){if('picGroup'==o.data.category&&'cbian'==o.data.role){for(var i=o.findSubGraphParts().iterator,r=[],d={},l;i.next();)l=i.value,'autoText'==l.data.category&&('0 0 0 0'==l.data.locationSpot&&(d.shiText=l.data.text),'0 0.5 0 0'==l.data.locationSpot&&(d.centerText=l.data.text),'0 1 0 0'==l.data.locationSpot&&(d.xuText=l.data.text)),r.push(l.data);a.diagram.startTransaction('mouseDrop'),a.diagram.model.removeNodeDataCollection(r);JSON.parse(JSON.stringify(o.data));return a.diagram.model.removeNodeData(o.data),a.diagram.__trtd.addOlive(t,d),void a.diagram.commitTransaction('mouseDrop')}if('wave'==o.data.category&&t&&o.data.group==e.data.group){a.diagram.startTransaction('mouseDrop'),o.__oldOrder=o.data.order,a.diagram.model.setDataProperty(o.data,'order',t.data.order+.5);var s=a.diagram.findNodeForKey(o.data.xuText),c=a.diagram.findNodeForKey(o.data.shiText);return a.diagram.model.setDataProperty(c,'order',t.data.order+.5),a.diagram.model.setDataProperty(s,'order',t.data.order+.5),void a.diagram.commitTransaction('mouseDrop')}}},mouseLeave:function(a,e){if(e.containingGroup){for(var t=e.containingGroup.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1);try{var i=a.diagram.findNodeForKey(e.data.centerText);i&&(i.layerName='Foreground')}catch(a){}}},selectionAdornmentTemplate:this.getNodeSelectionAdornmentTemplate(),doubleClick:function(a,e){if(e&&e.containingGroup){if('horizontal'==e.containingGroup.data.textAngle&&'independent'==e.containingGroup.data.centerTextAngle){e.findObject('TEXT').visible=!0;var t=e.diagram.findNodeForKey(e.data.centerText);t&&(t.visible=!1)}setTimeout(function(){a.diagram.__trtd.selectText(a,e)},100)}}},this.binding,l(go.Shape,'Rectangle',{name:'main',fill:'rgba(0,0,0,0)',stroke:null,width:300,height:150},new go.Binding('areaBackground','isHighlighted',function(e,a){return e?'RGBA(146,208,80,0.5)':null;var t=a.part.data.color}).ofObject(),new go.Binding('fill','fill').makeTwoWay(),new go.Binding('desiredSize','desiredSize',function(e){return go.Size.parse(e)}).makeTwoWay(function(e){return go.Size.stringify(e)})),this.getShiHalfEllipseShape(),this.getXuHalfEllipseShape(),this.getTextBuild(),l(go.Shape,{geometryString:'M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z',visible:!1,name:'figure',cursor:'pointer',alignment:go.Spot.TopRight,alignmentFocus:go.Spot.TopRight,width:14,height:14,fill:'green',toolTip:l('ToolTip',l(go.Panel,'Vertical',l(go.Picture,new go.Binding('source','src',function(e){return'images/'+e+'.png'})),l(go.TextBlock,{text:'\u8FDB\u5165\u5B50\u76D8',margin:3}))),click:function(a){var e=a.targetObject.part;a.diagram.__trtd.openFigure({figure:e.data.figure,title:e.data.text,key:e.data.key,node:e})}},new go.Binding('visible','figure',function(e){return!!e})))}}]),a}(s);e.exports=g},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=t(9),m=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'nodeResizeAdornmentTemplate',value:function(){return l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'getNodeTemplate',value:function(){var e=this;return l(go.Group,'Spot',{selectionObjectName:'PH',layerName:'default',locationObjectName:'PH',resizeObjectName:'PH',resizable:!0,locationSpot:go.Spot.LeftCenter,alignment:go.Spot.Left,alignmentFocus:go.Spot.Left,click:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1)},selectionAdornmentTemplate:this.getNodeSelectionAdornmentTemplate(),resizeAdornmentTemplate:e.nodeResizeAdornmentTemplate(),mouseOver:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&('xuText'==e.data.role||'shiText'==e.data.role)&&(''==o.data.text||''==o.data.text.trim())&&(o.findObject('textBorder').visible=!0)},mouseLeave:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1)},rotatable:!0,contextMenu:l(go.Adornment),layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,layout:new g},new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),l(go.Shape,{name:'PH',figure:'Rectangle',alignment:new go.Spot(0,.5),stroke:'#9aa8b6',strokeWidth:0,minSize:new go.Size(300,70),maxSize:new go.Size(NaN,400),fill:'rgba(88,0,0,0)'},new go.Binding('desiredSize','desiredSize',function(e){return go.Size.parse(e)}).makeTwoWay(go.Size.stringify)),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify))}}]),a}(s);e.exports=m},function(e,a,t){'use strict';'use script';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=t(18),m=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'addFreeText',value:function(a,e){var t={text:'\u81EA\u7531\u6587\u672C',deletable:!0,role:'freeText',fill:'black',iconVisible:!1,locationSpot:'0.5 0.5 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(a.documentPoint),movable:!0,group:e.data.key};this.diagram.startTransaction('addFreeText'),this.diagram.model.addNodeData(t),this.diagram.commitTransaction('addFreeText')}},{key:'getNodeTemplate',value:function(){var a=this;return l(go.Group,'Auto',{selectionObjectName:'PH',layerName:'Background',locationObjectName:'PH',locationSpot:go.Spot.BottomLeft,rotatable:!1,alignment:go.Spot.Left,alignmentFocus:go.Spot.Left,click:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1)},doubleClick:function(t,e){a.addFreeText(t,e)},mouseOver:function(a,e){},contextMenu:l(go.Adornment),mouseLeave:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next()&&(o=t.value,'labelGroup'!=o.data.role););},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,layout:new g},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('copyable','copyable').makeTwoWay(),l(go.Shape,{name:'PH',figure:'Rectangle',stroke:'yellow',strokeWidth:0,fill:'rgba(0,0,0,0)'}))}}]),a}(s);e.exports=m},function(e){'use strict';function a(){go.Layout.call(this)}go.Diagram.inherit(a,go.Layout),a.prototype.doLayout=function(e){var a=this.diagram;a.startTransaction('AxisGroupLayout');for(var t=this.collectParts(e).iterator,o=[],i=[],r=this.group,d=0,l=0,s=[],c=[],g,m,p,u,y,h,k,f,T,x,b,S,v,w;t.next();)w=t.value,(i.push(w.data),'wave'==w.data.category&&o.push(w),!!(w instanceof go.Node))&&('axisYText'==w.data.role&&(y=w),'axisXText'==w.data.role&&(u=w),'themeText'==w.data.role&&(h=w),'shiText'==w.data.role&&s.push(w),'xuText'==w.data.role&&c.push(w),'labelText1'==w.data.role&&(k=w),'labelText2'==w.data.role&&(f=w),'labelText3'==w.data.role&&(T=w),'labelGroup'==w.data.role&&(x=w),w.naturalBounds.width>d&&(d=w.naturalBounds.width),w.naturalBounds.height>l&&(l=w.naturalBounds.height),'line'==w.data.category&&'centerLine'==w.data.role&&(g=w),w.data.group==r.key&&('line'==w.data.category&&('axisX'==w.data.role&&(w.angle=0,m=w),'axisY'==w.data.role&&(p=w,w.angle=270),w.location=r.location.copy().offset(0,0)),'waveGroup'==w.data.category&&(b=w,S=w.data.oliveWidth,v=w.data.oliveHeight,w.location=r.location.copy().offset(0,0))));if(p&&(p.angle=270),m&&(m.angle=0),b){var P=b.resizeObject.width*_Mathcos(_Mathabs(360-b.angle%360)/180*_MathPI),B=b.resizeObject.width*_Mathsin(_Mathabs(360-b.angle%360)/180*_MathPI);this.diagram.model.setDataProperty(m.data,'desiredSize',P+' '+10),this.diagram.model.setDataProperty(p.data,'desiredSize',B+' '+10),r.width=P,r.height=B;var D=b.data.shiStroke,N=b.data.xuStroke,A=b.data.centerStroke||'#3f5369';u&&(u.location=r.location.copy().offset(P,0),u.locationSpot=go.Spot.Top),y&&(y.location=r.location.copy().offset(-10,-B),y.locationSpot=go.Spot.Right)}if(h,x){for(var C=x.findSubGraphParts().iterator,W;C.next();)W=C.value,'labelText1'==W.data.role&&(k=W),'labelText2'==W.data.role&&(f=W),'labelText3'==W.data.role&&(T=W);b&&(b.labelText1=k,b.labelText2=f,b.labelText3=T)}return D&&k&&this.diagram.model.setDataProperty(k.data,'fill',D),N&&f&&this.diagram.model.setDataProperty(f.data,'fill',N),A&&T&&this.diagram.model.setDataProperty(T.data,'fill',A),go.Layout.prototype.doLayout.call(this,e),void a.commitTransaction('AxisGroupLayout')},e.exports=a},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'makeGeo',value:function(e,a,t){var o=e.radiusX,i=void 0===o?150:o,r=e.radiusY,d=void 0===r?100:r,l=new go.Geometry().add(new go.PathFigure(0,0).add(new go.PathSegment(go.PathSegment.SvgArc,2*i,0,i,d,0,1,t.clockwiseFlag?1:0)));return l.defaultStretch=go.GraphObject.Fill,l}},{key:'getShiHalfEllipseShape',value:function(){var e=this;return l(go.Shape,{name:'XU',stroke:'red',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.Uniform,alignment:go.Spot.Bottom,alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=0;return 0==a.order%2&&(a.flip=!0),a.flip&&(o=1),e.makeGeo(a,t,{clockwiseFlag:o})}),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getXuHalfEllipseShape',value:function(){var e=this;return l(go.Shape,{name:'SHI',stroke:'blue',fill:'rgba(0,66,0,0)',stretch:go.GraphObject.Uniform,alignment:go.Spot.Bottom,strokeDashArray:[5,5],alignmentFocus:go.Spot.Bottom},new go.Binding('geometry','',function(a,t){var o=1;return 0==a.order%2&&(a.flip=!0),a.flip&&(o=0),e.makeGeo(a,t,{clockwiseFlag:o})}),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size(e.width,e.height/2);return a}).ofObject('main'))}},{key:'getTextBuild',value:function(){return l(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.4),font:'bold 18px \u5E7C\u5706',editable:!0,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Uniform},new go.Binding('textAlign','textAlign',function(e){return-1<['start','center','end'].indexOf(e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e-30}).ofObject('main'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay())}},{key:'getNodeTemplate',value:function(){return l(go.Node,'Spot',{locationObjectName:'TEXT',movable:!0,resizable:!0,resizeObjectName:'TEXT',selectionObjectName:'TEXT',layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,locationSpot:go.Spot.LeftCenter,click:function(){},doubleClick:function(a,e){a.diagram.__trtd.selectText(a,e)},resizeAdornmentTemplate:l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.Right,cursor:'col-resize',desiredSize:new go.Size(9,9),fill:'lightblue',stroke:'dodgerblue'}))},new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),l(go.TextBlock,{name:'TEXT',width:200,height:30,maxSize:new go.Size(NaN,70),minSize:new go.Size(NaN,70),alignment:go.Spot.Center,verticalAlignment:go.Spot.Center,isMultiline:!1,overflow:go.TextBlock.OverflowEllipsis,stretch:go.GraphObject.Fill,maxLines:5,stroke:'black',editable:!0,textAlign:'start',font:'18px \'Microsoft YaHei\''},new go.Binding('text','text').makeTwoWay(),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e})),l(go.Panel,'Vertical',{alignment:go.Spot.Left,alignmentFocus:go.Spot.Right},l(go.Shape,{name:'ICON',width:16,height:16,click:function(){},figure:'Diamond',fill:'red',strokeWidth:0,margin:3},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('figure','figure').makeTwoWay(),new go.Binding('fill','fill',function(e){return e}).makeTwoWay(),new go.Binding('height','height',function(e){return e||(e=30),2*e/3}).ofObject('label'),new go.Binding('width','height',function(e){return e||(e=30),2*e/3}).ofObject('label'))))}}]),a}(s);e.exports=g},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'clearBorder',value:function(e){e.data.showBorder&&(e.findObject('textBorder').visible=!1)}},{key:'makeGeo',value:function(e,a,t){var o=e.radiusX,i=void 0===o?150:o,r=e.radiusY,d=void 0===r?100:r,l=new go.Geometry().add(new go.PathFigure(0,0).add(new go.PathSegment(go.PathSegment.SvgArc,2*i,0,i,d,0,1,t.clockwiseFlag?1:0)));return l.defaultStretch=go.GraphObject.Fill,l}},{key:'getNodeTemplate',value:function(){var e=this,a=this.diagram;return l(go.Node,'Spot',{_controlExpand:!0,__trtdNode:e,layerName:'Foreground',zOrder:10,movable:!0,visible:!0,locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),resizable:!0,rotatable:!1,location:new go.Point(0,0),toMaxLinks:1,mouseDrop:function(a,e){var t=e.part,o=a.diagram.selection.first();if('picGroup'==o.data.category&&'cbian'==o.data.role&&'centerText'==t.data.role){var r=a.diagram.findNodeForKey(t.data.olive);if(!r)return;for(var d=o.findSubGraphParts().iterator,l=[],s={},c;d.next();)c=d.value,'autoText'==c.data.category&&('0 0 0 0'==c.data.locationSpot&&(s.shiText=c.data.text),'0 0.5 0 0'==c.data.locationSpot&&(s.centerText=c.data.text),'0 1 0 0'==c.data.locationSpot&&(s.xuText=c.data.text)),l.push(c.data);a.diagram.startTransaction('mouseDrop'),a.diagram.model.removeNodeDataCollection(l);JSON.parse(JSON.stringify(o.data));return a.diagram.model.removeNodeData(o.data),a.diagram.__trtd.addOlive(r,s),void a.diagram.commitTransaction('mouseDrop')}if('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole){a.diagram.model.startTransaction('coreTextExchange');var g=o.data.orderX,m=o.data.orderY,p=o.data.dimKey;a.diagram.model.setDataProperty(o.data,'orderX',t.data.orderX),a.diagram.model.setDataProperty(o.data,'orderY',t.data.orderY),a.diagram.model.setDataProperty(o.data,'dimKey',t.data.dimKey),a.diagram.model.setDataProperty(t.data,'orderX',g),a.diagram.model.setDataProperty(t.data,'orderY',m),a.diagram.model.setDataProperty(t.data,'dimKey',p),a.diagram.model.commitTransaction('coreTextExchange')}if('dimText'==o.data.subRole&&'dimText'==t.data.subRole&&o.data.category==t.data.category){if(o.data.group!=t.data.group)return;if(!o.containingGroup)return;if('yunpanGroup'!=o.containingGroup.data.category)return;if(o.data.dimX!=t.data.dimX&&o.data.dimY!=t.data.dimY)return;a.diagram.model.startTransaction('dimTextExchange');var g=o.data.dimX,m=o.data.dimY,d=t.containingGroup.findSubGraphParts().iterator,u=[],y=[],h=[],k=[],f='X';0==o.data.dimX&&(f='Y');for(var T=o.data['dim'+f],x=t.data['dim'+f],c;d.next();)c=d.value,'yunpanText'==c.data.subRole&&(c.data['order'+f]==x&&h.push(c),c.data['order'+f]==T&&k.push(c));for(var b=0,i,S;b<h.length;b++)a.diagram.model.setDataProperty(h[b].data,'order'+f,T);for(var b=0;b<k.length;b++)a.diagram.model.setDataProperty(k[b].data,'order'+f,x);return a.diagram.model.setDataProperty(o.data,'dim'+f,x),a.diagram.model.setDataProperty(t.data,'dim'+f,T),void a.diagram.model.commitTransaction('dimTextExchange')}if('dimText'==o.data.subRole&&'dimText'==t.data.subRole){a.diagram.model.startTransaction('dimTextExchange');var g=o.data.dimX,m=o.data.dimY,d=t.containingGroup.findSubGraphParts().iterator,u=[],y=[],h=[],k=[],f='X';for(0==o.data.dimX&&(f='Y');d.next();){var c=d.value;c.data.dimKey==t.data.key&&u.push(c),c.data.dimKey==o.data.key&&y.push(c),'yunpanText'==c.data.subRole&&(c.data['order'+f]==t.data['order'+f]&&h.push(c),c.data['order'+f]==o.data['order'+f]&&k.push(c))}var v=(t.containingGroup.__yunPointsX.length+1)/2,w=(t.containingGroup.__yunPointsY.length+1)/2;o.data.dimX>v&&y.sort(function(e,a){return e.data.orderX-a.data.orderX}),o.data.dimX==v&&(o.data.dimY>w?y.sort(function(e,a){return e.data.orderY-a.data.orderY}):y.sort(function(e,a){return a.data.orderY-e.data.orderY})),o.data.dimX<v&&y.sort(function(e,a){return a.data.orderX-e.data.orderX}),t.data.dimX>v&&u.sort(function(e,a){return e.data.orderX-a.data.orderX}),t.data.dimX==v&&(t.data.dimY>w?u.sort(function(e,a){return e.data.orderY-a.data.orderY}):u.sort(function(e,a){return a.data.orderY-e.data.orderY})),t.data.dimX<v&&u.sort(function(e,a){return a.data.orderX-e.data.orderX});for(var b=0,i,S;b<y.length;b++)i=y[b].data.orderX,S=y[b].data.orderY,a.diagram.model.setDataProperty(y[b].data,'orderX',u[b].data.orderX),a.diagram.model.setDataProperty(y[b].data,'orderY',u[b].data.orderY),a.diagram.model.setDataProperty(u[b].data,'orderX',i),a.diagram.model.setDataProperty(u[b].data,'orderY',S);a.diagram.model.setDataProperty(o.data,'dimX',t.data.dimX),a.diagram.model.setDataProperty(o.data,'dimY',t.data.dimY),a.diagram.model.setDataProperty(t.data,'dimX',g),a.diagram.model.setDataProperty(t.data,'dimY',m),a.diagram.model.commitTransaction('dimTextExchange')}if('wave'==o.data.category&&'centerText'==t.data.role&&t&&o.data.group==e.data.group){a.diagram.startTransaction('mouseDrop'),o.__oldOrder=o.data.order,a.diagram.model.setDataProperty(o.data,'order',t.data.order+.5);var P=a.diagram.model.findNodeDataForKey(o.data.xuText),B=a.diagram.model.findNodeDataForKey(o.data.shiText);a.diagram.model.setDataProperty(B,'order',t.data.order+.5),a.diagram.model.setDataProperty(P,'order',t.data.order+.5),a.diagram.commitTransaction('mouseDrop')}},mouseDragEnter:function(a,e){var t=e.part,o=a.diagram.selection.first();o&&(('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole)&&(o.areaBackground=null,t.areaBackground='RGB(107,208,137)'),'dimText'==o.data.subRole&&'dimText'==t.data.subRole&&(o.areaBackground=null,t.areaBackground='RGB(107,208,137)'),'centerText'==t.data.role&&(t.layerName='Background'))},mouseDragLeave:function(a,e){var t=e.part,o=a.diagram.selection.first();('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole)&&(t.areaBackground=null),'dimText'==o.data.subRole&&'dimText'==t.data.subRole&&(t.areaBackground=null),'centerText'==t.data.role&&(t.layerName='Foreground')},selectionChanged:function(e){if('autoText'==e.data.category&&null!=e.data.orderX&&null!=e.data.orderY&&'freeText'==e.data.role&&('coreText'==e.data.subRole||'yunpanText'==e.data.subRole)&&e.containingGroup&&('yunGroup'==e.containingGroup.data.category||'yunpanGroup'==e.containingGroup.data.category)&&'line'==e.containingGroup.data.beginSpark&&e.containingGroup.__yunPointsX&&e.containingGroup.__yunPointsY){var a=(e.containingGroup.__yunPointsX.length+1)/2,t=(e.containingGroup.__yunPointsY.length+1)/2;if(e.data.orderX==a&&e.data.orderY==t)return;var o=e.data.orderX,i=e.data.orderY;o==a&&(o=i),i==t&&(i=o);var r=e.containingGroup.data.shapeStrokes,d=e.containingGroup.data.showShape;if(e.isSelected){if('between'==e.containingGroup.data.snapType)var l=_Mathmax(_Mathabs(e.data.orderX-a),_Mathabs(e.data.orderY-t))+1;else var l=_Mathmax(_Mathabs(e.data.orderX-a),_Mathabs(e.data.orderY-t));for(var s=e.containingGroup.findSubGraphParts().iterator,g=null,m;s.next();)if(m=s.value,'autoText'==m.data.category&&null!=m.data.orderX&&null!=m.data.orderY&&'freeText'==m.data.role&&(m.findObject('textBorder').visible=!1,(_Mathabs(m.data.orderX-a)==_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)<=_Mathabs(i-t)||_Mathabs(m.data.orderX-a)<=_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)==_Mathabs(i-t))&&(m.areaBackground='white',m.zOrder=999)),'shape'==m.data.category&&'background'==m.data.role){var p=m.findObject('SHAPE');m.data.gridWidth==2*l?(g=p,!p.__prestroke&&(p.__prestroke=p.stroke,p.stroke='rgba(255,0,0,0.5)')):p.__prestroke&&(p.stroke=p.__prestroke,delete p.__prestroke)}if(!g){if('between'==e.containingGroup.data.snapType)var u=2*l;else var u=2*l;e.diagram.model.startTransaction('addShape');var y={deletable:!0,role:'background',category:'shape',loc:go.Point.stringify(new go.Point(e.containingGroup.__yunPointsX[a-1],e.containingGroup.__yunPointsY[t-1])),movable:!0,group:-19,key:c.guid(),orderX:10,orderY:10,gridWidth:u,stroke:r[l-1],visible:!0,strokeDashArray:'[0,0]',strokeWidth:3};e.diagram.model.addNodeData(y),e.diagram.model.commitTransaction('addShape'),setTimeout(function(){var a=e.diagram.findNodeForKey(y.key);if(a){var t=a.findObject('SHAPE');t.__prestroke||(t.__prestroke=t.stroke,t.stroke='rgba(255,0,0,0.5)')}},100)}}else for(var s=e.containingGroup.findSubGraphParts().iterator,m;s.next();)if(m=s.value,'autoText'==m.data.category&&null!=m.data.orderX&&null!=m.data.orderY&&'freeText'==m.data.role&&(_Mathabs(m.data.orderX-a)==_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)<=_Mathabs(i-t)||_Mathabs(m.data.orderX-a)<=_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)==_Mathabs(i-t))&&(m.areaBackground=null,m.zOrder=NaN),'shape'==m.data.category&&'background'==m.data.role){var p=m.findObject('SHAPE');d||(p.stroke='rgba(255,0,0,0)'),m.data.gridWidth==2*l?!p.__prestroke&&(p.__prestroke=p.stroke,p.stroke='rgba(255,0,0,0.7)'):p.__prestroke&&(p.stroke=p.__prestroke,delete p.__prestroke)}}},click:function(){},mouseOver:function(a,e){e.data.showBorder&&''==e.data.text&&('xuText'==e.data.role||'shiText'==e.data.role)&&(e.findObject('textBorder').visible=!0),'centerText'==e.data.role&&(e.layerName='Background')},mouseLeave:function(a,e){e.data.showBorder&&(e.findObject('textBorder').visible=!1),'centerText'==e.data.role&&(e.layerName='Foreground')},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&~go.Part.LayoutNodeSized,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,contextMenu:l(go.Adornment),resizeAdornmentTemplate:l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.Left,cursor:'col-resize',desiredSize:new go.Size(9,9),fill:'lightblue',stroke:'dodgerblue'}),l(go.Shape,'Circle',{alignment:go.Spot.Right,cursor:'col-resize',desiredSize:new go.Size(9,9),fill:'lightblue',stroke:'dodgerblue'}),l(go.Shape,'Circle',{alignment:go.Spot.Top,cursor:'col-resize',desiredSize:new go.Size(9,9),fill:'lightblue',stroke:'dodgerblue'}),l(go.Shape,'Circle',{alignment:go.Spot.Bottom,cursor:'col-resize',desiredSize:new go.Size(9,9),fill:'lightblue',stroke:'dodgerblue'})),doubleClick:function(a,e){a.diagram.__trtd.selectText(a,e)}},new go.Binding('locationSpot','locationSpot',function(e){return go.Spot.parse(e)}).makeTwoWay(function(e){return go.Spot.stringify(e)}),new go.Binding('visible','visible').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('rotatable','rotatable').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('copyable','copyable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}),l(go.TextBlock,{name:'TEXT',alignment:new go.Spot(0,0),font:'18px \'Microsoft YaHei\'',editable:!1,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',verticalAlignment:go.Spot.Center,spacingAbove:4,spacingBelow:4,portId:'TEXT',margin:5,maxSize:new go.Size(600,NaN),minSize:new go.Size(10,10),stretch:go.GraphObject.UniformToFill,textEdited:function(e,a,t){var o=e.part;''==t.trim()&&('shiText'==o.data.role||'xuText'==o.data.role)&&(e.part.diagram.model.startTransaction('text'),e.part.diagram.model.setDataProperty(e.part.data,'nloc',null),e.part.diagram.model.commitTransaction('text')),e.part.data.role&&-1<e.part.data.role.indexOf('labelText')&&(e.part.containingGroup.layout.isValidLayout=!1)}},new go.Binding('areaBackground','isHighlighted',function(e,a){return e?'RGBA(146,208,80,0.5)':null;var t=a.part.data.color}).ofObject(),new go.Binding('background','background',function(e){return e}).makeTwoWay(),new go.Binding('areaBackground','areaBackground',function(e){return e}).makeTwoWay(),new go.Binding('textAlign','textAlign',function(e){return e}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('maxSize','',function(e){var a=NaN,t=NaN;return e.width&&(a=parseInt(e.width)),e.height&&(t=parseInt(e.height)),new go.Size(a,t)}),new go.Binding('minSize','minSize',function(e){return go.Size.parse(e)}),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()),l(go.Panel,'Vertical',{alignment:go.Spot.Left,alignmentFocus:go.Spot.Right},l(go.Shape,{name:'ICON',width:16,height:16,visible:!1,click:function(){},figure:'Circle',fill:'red',strokeWidth:0,margin:3},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('figure','figure').makeTwoWay(),new go.Binding('visible','iconVisible').makeTwoWay(),new go.Binding('fill','fill',function(e){return e}).makeTwoWay())),l(go.Shape,'Rectangle',{name:'textBorder',stroke:'green',strokeWidth:3,strokeDashArray:[10,5],visible:!1,fill:'transparent',alignment:go.Spot.Center,width:100,height:270},new go.Binding('stroke','textStroke'),new go.Binding('desiredSize','',function(e,a){if(!c.checkPhone())return new go.Size(a.part.naturalBounds.width-3,a.part.naturalBounds.height-3);var t=a.part.diagram.findNodeForKey(a.part.data.olive);return new go.Size(t.naturalBounds.width-3,t.naturalBounds.height)})),l(go.Shape,'Circle',{name:'place',stroke:'red',strokeWidth:1,strokeDashArray:null,visible:!1,fill:'transparent',alignment:go.Spot.Center,width:50,height:50},new go.Binding('stroke','placeStroke')),l(go.Shape,{geometryString:'M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z',visible:!1,name:'figure',cursor:'pointer',alignment:new go.Spot(1,0,5,-5),alignmentFocus:go.Spot.RightCenter,width:14,height:14,fill:'green',toolTip:l('ToolTip',l(go.Panel,'Vertical',l(go.Picture,new go.Binding('source','src',function(e){return'images/'+e+'.png'})),l(go.TextBlock,{text:'\u8FDB\u5165\u5B50\u76D8',margin:3}))),click:function(a){var e=a.targetObject.part;a.diagram.__trtd.openFigure({figure:e.data.figure,title:e.data.text,key:e.data.key,node:e})}},new go.Binding('visible','figure',function(e){return!!e})))}}]),a}(s);e.exports=g},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'switchBorder',value:function(e,a){e.findObject('groupBorder').opacity=a?1:0}},{key:'hiddenAllText',value:function(e){e.diagram.startTransaction();for(var a=e.findSubGraphParts().iterator,t=null,o;a.next();)o=a.value,null==t&&(t=o.visible),'autoText'==o.data.category&&e.diagram.model.setDataProperty(o.data,'visible',!t);e.diagram.commitTransaction()}},{key:'addLabelText',value:function(a,e){var t={text:'\u8BF4\u660E\uFF1A\u5185\u5BB9',deletable:!0,fill:'black',iconVisible:!0,locationSpot:'0 0 0 0',textAlign:'start',category:'autoText',loc:e.location.x+30+' '+e.location.y,movable:!1,group:e.data.key};this.diagram.startTransaction('addLabelText'),this.diagram.model.addNodeData(t),this.diagram.commitTransaction('addLabelText')}},{key:'getNodeTemplate',value:function(){var a=this;return l(go.Group,'Spot',{__trtdNode:a,layerName:'default',locationObjectName:'groupBorder',zOrder:5,background:'rgba(0,0,0,0)',rotatable:!1,minSize:new go.Size(200,100),locationSpot:go.Spot.Center,toolTip:l('ToolTip',l(go.TextBlock,{margin:4},new go.Binding('text','',function(){return'\u53CC\u51FB\u663E\u793A/\u9690\u85CF'}))),click:function(){},selectable:!0,doubleClick:function(t,e){a.hiddenAllText(e),a.switchBorder(e,!1)},mouseOver:function(t,e){if(a.switchBorder(e,!0),!!e.containingGroup){var o=e.containingGroup.findSubGraphParts().iterator;for(e.diagram.startTransaction();o.next();){var i=o.value;'autoText'==i.data.category&&i.data.role&&-1<i.data.role.indexOf('labelText')&&i.diagram.model.setDataProperty(i.data,'minSize','120 30')}e.diagram.commitTransaction()}},mouseLeave:function(t,e){a.switchBorder(e,!1)},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,layout:l(go.GridLayout,{isInitial:!1,isOngoing:!1,spacing:new go.Size(0,0),cellSize:go.Size.parse(300,150),arrangement:go.GridLayout.LeftToRight,wrappingColumn:1,isRealtime:!1,alignment:go.GridLayout.Location})},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('copyable','copyable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),l(go.Placeholder,{padding:30,alignment:go.Spot.Center,name:'placeholder'}),l(go.Shape,'Rectangle',{name:'groupBorder',stroke:'green',strokeWidth:3,strokeDashArray:[10,5],visible:!0,opacity:0,fill:null,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center},new go.Binding('desiredSize','',function(e,a){return new go.Size(a.part.measuredBounds.width-3,a.part.measuredBounds.height-3)}).ofObject('')))}}]),a}(s);e.exports=g},function(e,a,t){'use strict';function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function d(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var l=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),s=go.GraphObject.make,c=t(1),g=t(0),m=function(e){function a(e){return i(this,a),r(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return d(a,e),l(a,[{key:'getNodeSelectionAdornmentTemplate',value:function(){return s(go.Adornment,'Spot',s(go.Panel,'Auto',s(go.Shape,{fill:null,stroke:'dodgerblue',strokeWidth:1}),s(go.Placeholder)),s(go.Panel,'Vertical',{name:'ButtonIcon1',alignment:new go.Spot(0,1,-20,20),alignmentFocus:go.Spot.Center,width:60,height:60,isActionable:!0},s(go.Shape,'Circle',{fill:'rgba(1,1,1,0)',strokeWidth:0,stroke:'green',width:50,height:50})))}},{key:'nodeResizeAdornmentTemplate',value:function(){return s(go.Adornment,'Spot',s(go.Placeholder),s(go.Shape,'Circle',{alignment:go.Spot.TopLeft,alignmentFocus:go.Spot.BottomRight,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}),s(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'getNodeTemplate',value:function(){var e=this.diagram,a=this;return s(go.Node,'Spot',o({name:'NODE',_controlExpand:!0,layerName:'Background',locationSpot:go.Spot.BottomLeft,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,rotateObjectName:'SHAPE',doubleClick:function(a,e){e.diagram.__trtd.nodeDoubleClickListener&&e.diagram.__trtd.nodeDoubleClickListener(e)},click:function(a,e){e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},selectable:!0,movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:a.nodeResizeAdornmentTemplate(),contextMenu:e.__trtd.nodeContextMenu,selectionAdornmentTemplate:a.getNodeSelectionAdornmentTemplate()},'contextMenu',s(go.Adornment)),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('resizable','resizable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),s(go.Picture,{name:'SHAPE',width:400,height:400},{successFunction:function(e){e.width&&e.height||e.part.data.width&&e.part.data.height||(e.width=e.element.width,e.height=e.element.height)}},{sourceCrossOrigin:function(){return''}},new go.Binding('source','picture',function(e){return e+'?'+Date.now()}).makeTwoWay(function(e){return e?(e=e.replace(/\?.*$/g,''),e):''}),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('opacity','opacity',function(e){return e?parseFloat(e):1}).makeTwoWay(function(e){return e})))}}]),a}(c);e.exports=m},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'getNodeSelectionAdornmentTemplate',value:function(){return l(go.Adornment,'Spot',l(go.Panel,'Auto',l(go.Shape,{fill:null,stroke:'dodgerblue',strokeWidth:1}),l(go.Placeholder)),l(go.Panel,'Vertical',{name:'ButtonIcon1',alignment:new go.Spot(0,1,-20,20),alignmentFocus:go.Spot.Center,width:60,height:60,isActionable:!0},l(go.Shape,'Circle',{fill:'rgba(1,1,1,0)',strokeWidth:0,stroke:'green',width:50,height:50})))}},{key:'nodeResizeAdornmentTemplate',value:function(){return l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.TopLeft,alignmentFocus:go.Spot.BottomRight,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}),l(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'addFreeText',value:function(a,e){var t={text:'\u603B\u7ED3\u6587\u672C',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'0 0.5 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(a.documentPoint),movable:!0,group:e.data.key};this.diagram.startTransaction('addFreeText'),this.diagram.model.addNodeData(t),this.diagram.commitTransaction('addFreeText')}},{key:'getNodeTemplate',value:function(){var e=this.diagram,a=this;return l(go.Group,'Auto',{__trtdNode:a,layerName:'default',locationObjectName:'placeholder',zOrder:5,background:'rgba(0,0,0,0)',rotatable:!1,locationSpot:go.Spot.BottomLeft,click:function(){},layout:l(go.Layout),doubleClick:function(t,e){a.addFreeText(t,e)},contextMenu:l(go.Adornment),layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized},new go.Binding('location','loc',function(e){return go.Point.parse(e)}).makeTwoWay(go.Point.stringify),new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('layerName','layerName').makeTwoWay(),l(go.Placeholder,{padding:30,alignment:go.Spot.Center,name:'placeholder'}))}}]),a}(s);e.exports=g},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=t(25),m=function(e){function a(e){o(this,a);var t=i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.defaultTextFont='20px \'Microsoft YaHei\'',t}return r(a,e),d(a,[{key:'snapToGrid',value:function(e,a){if('coreText'!=e.subRole&&'themeText'!=e.subRole){var t=go.Point.parse(e.loc);if(a.__yunPointsX&&a.__yunPointsY)if(t.x>=a.__yunPointsX[0]&&t.x<=a.__yunPointsX[a.__yunPointsX.length-1]&&t.y>=a.__yunPointsY[a.__yunPointsY.length-1]&&t.y<=a.__yunPointsY[0]){for(var o=2e4,r=2e4,d=0,i,l,s;d<a.__yunPointsX.length;d++)i=_Mathabs(t.x-a.__yunPointsX[d]),i<o&&(o=i,l=d+1);for(var d=0;d<a.__yunPointsY.length;d++)i=_Mathabs(t.y-a.__yunPointsY[d]),i<r&&(r=i,s=d+1);null!=l&&null!=s&&(e.orderX=l,e.orderY=s)}else delete e.orderX,delete e.orderY}}},{key:'addFreeText',value:function(a,e){var t=e.data.gridWidth,o=a.documentPoint,i=this,r={text:'\u7075\u611F',deletable:!0,role:'freeText',fill:'black',iconVisible:!1,locationSpot:'0.5 0.5 0 0',minSize:'30 30',font:i.defaultTextFont,textAlign:'center',category:'autoText',loc:go.Point.stringify(o),movable:!0,group:e.data.key};this.snapToGrid(r,e),this.diagram.startTransaction('addFreeText'),this.diagram.model.addNodeData(r),this.diagram.commitTransaction('addFreeText'),e.layout.isValidLayout=!1}},{key:'getNodeTemplate',value:function(){var a=this;return l(go.Group,'Auto',{selectionObjectName:'PH',__trtdNode:a,layerName:'default',padding:0,margin:0,copyable:!0,zOrder:15,locationObjectName:'PH',locationSpot:new go.Spot(0,1,0,-0),rotatable:!1,alignment:go.Spot.Left,alignmentFocus:go.Spot.Left,click:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1);return void(e.layout.isValidLayout=!1)},doubleClick:function(t,e){a.addFreeText(t,e)},mouseOver:function(){},contextMenu:l(go.Adornment),mouseLeave:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next()&&(o=t.value,'labelGroup'!=o.data.role););},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,layout:new g},new go.Binding('deletable','deletable').makeTwoWay(function(e){return e}),new go.Binding('copyable','copyable').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('zOrder','zOrder').makeTwoWay(function(e){return e}),new go.Binding('locationSpot','',function(e){return new go.Spot(0,1,e.gridWidth,-e.gridHeight)}),l(go.Shape,{name:'PH',figure:'Rectangle',stroke:'yellow',strokeWidth:0,fill:'rgba(0,0,255,0.0)'}),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify))}}]),a}(s);e.exports=m},function(e){'use strict';function a(){go.Layout.call(this)}go.Diagram.inherit(a,go.Layout),a.prototype.doLayout=function(e){var a=this.diagram;a.startTransaction('YunGroupLayout');for(var t=this.collectParts(e).iterator,o=[],i=[],r=this.group,d=r.data.gridWidth,l=r.data.gridHeight,s=0,c=0,g=[],m=[],p=[],u=[],y=[],h=[],k=[],f=[],T=r.data.snapType||'grid',x=r.data.showShape,b=r.data.beginSpark,S=r.data.shapeStrokes,v,w,P,B,D,N,A,C,W,O;t.next();)O=t.value,(i.push(O.data),'wave'==O.data.category&&o.push(O),!!(O instanceof go.Node))&&('background'==O.data.role&&f.push(O),'axisYText'==O.data.role&&(B=O),'axisXText'==O.data.role&&(P=O),'themeText'==O.data.role&&(D=O),'shiText'==O.data.role&&g.push(O),'xuText'==O.data.role&&m.push(O),'labelText1'==O.data.role&&(N=O),'labelText2'==O.data.role&&(A=O),'labelText3'==O.data.role&&(C=O),'labelGroup'==O.data.role&&(W=O),O.naturalBounds.width>s&&(s=O.naturalBounds.width),O.naturalBounds.height>c&&(c=O.naturalBounds.height),'freeText'==O.data.role&&k.push(O),'line'==O.data.category&&(h.push(O),'verticalLine'==O.data.role&&p.push(O),'horizontalLine'==O.data.role&&u.push(O),'freelLine'==O.data.role&&y.push(O)),O.data.group==r.key&&'line'==O.data.category&&('axisX'==O.data.role&&(O.angle=0,v=O,O.location=r.location.copy().offset(0,0)),'axisY'==O.data.role&&(w=O,O.angle=270,O.location=r.location.copy().offset(0,0))));if(p.sort(function(e,a){return e.data.order-a.data.order}),u.sort(function(e,a){return e.data.order-a.data.order}),y.sort(function(e,a){return e.data.order-a.data.order}),'between'==T)var L=p.length*d+d,G=u.length*l+l;else var L=p.length*d,G=u.length*l;var z=[],F=[],E=(u.length+1)/2,M=(p.length+1)/2;return h.forEach(function(e){'axisX'!=e.data.role&&'axisY'!=e.data.role}),p.forEach(function(e,a){var t=a+1;e.diagram.model.setDataProperty(e.data,'order',t),e.location=r.location.copy().offset(d*t,0),e.angle=270,e.diagram.model.setDataProperty(e.data,'desiredSize',G+20+' 10'),'between'==T?(t<E&&z.push(e.location.x-d/2),t==E&&z.push(e.location.x),t>E&&z.push(e.location.x+d/2)):z.push(e.location.x)}),u.forEach(function(e,a){var t=a+1;e.diagram.model.setDataProperty(e.data,'order',t),e.location=r.location.copy().offset(0,-l*t),e.angle=0,e.diagram.model.setDataProperty(e.data,'desiredSize',L+20+' 10'),'between'==T?(t<M&&F.push(e.location.y+l/2),t==M&&F.push(e.location.y),t>M&&F.push(e.location.y-l/2)):F.push(e.location.y)}),this.group.__yunPointsX=z,this.group.__yunPointsY=F,y.forEach(function(){}),f.forEach(function(e){if(e.diagram.model.setDataProperty(e.data,'visible',!0),!x)e.diagram.model.setDataProperty(e.data,'stroke','rgba(255,0,0,0)');else try{e.diagram.model.setDataProperty(e.data,'stroke',S[e.data.gridWidth/2-1])}catch(a){}if(!e.data.desiredSize){e.data.orderX=E,e.data.orderY=M,e.location=new go.Point(z[e.data.orderX-1],F[e.data.orderY-1]);var a=e.data.gridWidth||2;if('between'==T){var t=new go.Size(d*(a-1),l*(a-1));e.diagram.model.setDataProperty(e.data,'strokeWidth',d)}else{var t=new go.Size(d*a+3,l*a+3);e.diagram.model.setDataProperty(e.data,'strokeWidth',3)}e.diagram.model.setDataProperty(e.data,'desiredSize',go.Size.stringify(t)),e.diagram.model.setDataProperty(e.data,'strokeDashArray','[0,0]')}}),k.forEach(function(e){if(e.areaBackground=null,e.diagram.model.setDataProperty(e.data,'height',null),e.diagram.model.setDataProperty(e.data,'width',null),r.data.autoSnapText&&(e.data.orderX&&e.data.orderY&&(e.location=new go.Point(z[e.data.orderX-1],F[e.data.orderY-1]),e.location=new go.Point(z[e.data.orderX-1],F[e.data.orderY-1])),'dimText'==e.data.subRole&&null!=e.data.dimX&&null!=e.data.dimY)){var a,t;a=z[e.data.dimX-1],t=F[e.data.dimY-1],e.data.dimX>=z.length&&(a=z[z.length-1]+d),e.data.dimY>=F.length&&(t=F[F.length-1]-l),0>=e.data.dimX&&(a=z[0]-d,'between'!=T&&e.data.dimY<F.length&&(a-=d/2)),0>=e.data.dimY&&(t=F[0]+l,'between'!=T&&e.data.dimX<z.length&&(t+=l/2)),e.location=new go.Point(a,t)}(e.data.orderY==M||e.data.dimY==M)&&(e.diagram.model.setDataProperty(e.data,'width',d-10),e.diagram.model.setDataProperty(e.data,'height',null)),(e.data.orderX==E||e.data.dimX==E)&&(e.diagram.model.setDataProperty(e.data,'height',l-10),e.diagram.model.setDataProperty(e.data,'width',null)),1>=_Mathabs(e.data.orderX-E)&&1>=_Mathabs(e.data.orderY-M)&&'between'!=T&&(e.diagram.model.setDataProperty(e.data,'width',d-10),e.diagram.model.setDataProperty(e.data,'height',l-10)),0==_Mathabs(e.data.orderX-E)&&0==_Mathabs(e.data.orderY-M)&&('between'==T?(e.diagram.model.setDataProperty(e.data,'width',d+d-10),e.diagram.model.setDataProperty(e.data,'height',l+l-10)):(e.diagram.model.setDataProperty(e.data,'width',d-10),e.diagram.model.setDataProperty(e.data,'height',l-10)))}),P,B,w&&(w.angle=270,this.diagram.model.setDataProperty(w.data,'desiredSize',G+30+' 10')),v&&(v.angle=0,this.diagram.model.setDataProperty(v.data,'desiredSize',L+30+' 10')),r.width=L+2*d,r.height=G+2*l,go.Layout.prototype.doLayout.call(this,e),void a.commitTransaction('YunGroupLayout')},e.exports=a},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=t(27),m=function(e){function a(e){o(this,a);var t=i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.defaultTextFont='20px \'Microsoft YaHei\'',t}return r(a,e),d(a,[{key:'snapToGrid',value:function(e,a){if('coreText'!=e.subRole&&'themeText'!=e.subRole){var t=go.Point.parse(e.loc);if(a.__yunPointsX&&a.__yunPointsY)if(t.x>=a.__yunPointsX[0]&&t.x<=a.__yunPointsX[a.__yunPointsX.length-1]&&t.y>=a.__yunPointsY[a.__yunPointsY.length-1]&&t.y<=a.__yunPointsY[0]){for(var o=2e4,r=2e4,d=0,i,l,s;d<a.__yunPointsX.length;d++)i=_Mathabs(t.x-a.__yunPointsX[d]),i<o&&(o=i,l=d+1);for(var d=0;d<a.__yunPointsY.length;d++)i=_Mathabs(t.y-a.__yunPointsY[d]),i<r&&(r=i,s=d+1);null!=l&&null!=s&&(e.orderX=l,e.orderY=s)}else delete e.orderX,delete e.orderY}}},{key:'addFreeText',value:function(a,e){var t=e.data.gridWidth,o=a.documentPoint,i=this,r={text:'\u8282\u70B9',deletable:!0,role:'freeText',fill:'black',iconVisible:!1,locationSpot:'0.5 0.5 0 0',minSize:'30 30',subRole:'yunpanText',font:i.defaultTextFont,textAlign:'center',category:'autoText',loc:go.Point.stringify(o),movable:!0,group:e.data.key};this.snapToGrid(r,e),this.diagram.startTransaction('addFreeText'),this.diagram.model.addNodeData(r),this.diagram.commitTransaction('addFreeText'),e.layout.isValidLayout=!1}},{key:'addFreeShapeText',value:function(a,e){var t=e.data.gridWidth,o=a.documentPoint,i=this,r={text:'\u8282\u70B9',deletable:!0,role:'freeText',fill:'#F2F2F2',iconVisible:!1,locationSpot:'0.5 0.5 0 0',minSize:'30 30',subRole:'yunpanText',desiredSize:go.Size.stringify(new go.Size(t-10,t-10)),font:i.defaultTextFont,textAlign:'center',category:'shapeText',loc:go.Point.stringify(o),movable:!0,group:e.data.key};this.snapToGrid(r,e),this.diagram.startTransaction('addFreeText'),this.diagram.model.addNodeData(r),this.diagram.commitTransaction('addFreeText'),e.layout.isValidLayout=!1}},{key:'getNodeTemplate',value:function(){var a=this;return l(go.Group,'Auto',{selectionObjectName:'PH',__trtdNode:a,layerName:'default',padding:0,margin:0,copyable:!1,zOrder:15,locationObjectName:'PH',locationSpot:new go.Spot(0,1,0,-0),rotatable:!1,alignment:go.Spot.Left,alignmentFocus:go.Spot.Left,click:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next();)o=t.value,'autoText'==o.data.category&&(o.findObject('textBorder').visible=!1);return void(e.layout.isValidLayout=!1)},doubleClick:function(t,e){a.addFreeShapeText(t,e)},mouseOver:function(){},contextMenu:l(go.Adornment),mouseLeave:function(a,e){for(var t=e.findSubGraphParts().iterator,o;t.next()&&(o=t.value,'labelGroup'!=o.data.role););},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&go.Part.LayoutNodeSized,layout:new g},new go.Binding('deletable','deletable').makeTwoWay(function(e){return e}),new go.Binding('copyable','copyable').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(function(e){return e}),new go.Binding('zOrder','zOrder').makeTwoWay(function(e){return e}),new go.Binding('locationSpot','',function(e){return new go.Spot(0,1,e.gridWidth,-e.gridHeight)}),l(go.Shape,{name:'PH',figure:'Rectangle',stroke:'yellow',strokeWidth:0,fill:'rgba(0,0,255,0.0)'}),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify))}}]),a}(s);e.exports=m},function(e){'use strict';function a(){go.Layout.call(this)}go.Diagram.inherit(a,go.Layout),a.prototype.doLayout=function(e){var a=this.diagram;a.startTransaction('YunGroupLayout');for(var t=this.collectParts(e).iterator,o=[],i=[],r=this.group,d=r.data.gridWidth,l=r.data.gridHeight,s=0,c=0,g=[],m=[],p=[],u=[],y=[],h=[],k=[],f=[],T=[],x=[],b=r.data.snapType||'grid',S=r.data.showShape,v=r.data.beginSpark,w=r.data.shapeStrokes,P,B,D,N,A,C,W,O,L,G;t.next();)G=t.value,(i.push(G.data),'wave'==G.data.category&&o.push(G),!!(G instanceof go.Node))&&(0==G.data.dimX&&'dimText'==G.data.subRole&&x.push(G),0==G.data.dimY&&'dimText'==G.data.subRole&&T.push(G),'background'==G.data.role&&f.push(G),'axisYText'==G.data.role&&(N=G),'axisXText'==G.data.role&&(D=G),'themeText'==G.data.role&&(A=G),'shiText'==G.data.role&&g.push(G),'xuText'==G.data.role&&m.push(G),'labelText1'==G.data.role&&(C=G),'labelText2'==G.data.role&&(W=G),'labelText3'==G.data.role&&(O=G),'labelGroup'==G.data.role&&(L=G),G.naturalBounds.width>s&&(s=G.naturalBounds.width),G.naturalBounds.height>c&&(c=G.naturalBounds.height),'freeText'==G.data.role&&k.push(G),'line'==G.data.category&&(h.push(G),'verticalLine'==G.data.role&&p.push(G),'horizontalLine'==G.data.role&&u.push(G),'freelLine'==G.data.role&&y.push(G)),G.data.group==r.key&&'line'==G.data.category&&('axisX'==G.data.role&&(G.angle=0,P=G,G.location=r.location.copy().offset(0,0)),'axisY'==G.data.role&&(B=G,G.angle=270,G.location=r.location.copy().offset(0,0))));if(p.sort(function(e,a){return e.data.order-a.data.order}),u.sort(function(e,a){return e.data.order-a.data.order}),y.sort(function(e,a){return e.data.order-a.data.order}),'between'==b)var z=p.length*d+d,F=u.length*l+l;else var z=p.length*d,F=u.length*l;var E=[],M=[],R=(u.length+1)/2,j=(p.length+1)/2;return h.forEach(function(e){'axisX'!=e.data.role&&'axisY'!=e.data.role}),p.forEach(function(e,a){var t=a+1;e.diagram.model.setDataProperty(e.data,'order',t),e.location=r.location.copy().offset(d*t,0),e.angle=270,e.diagram.model.setDataProperty(e.data,'deletable',!0),e.diagram.model.setDataProperty(e.data,'desiredSize',F+20+' 10'),'between'==b?(t<R&&E.push(e.location.x-d/2),t==R&&E.push(e.location.x),t>R&&E.push(e.location.x+d/2)):E.push(e.location.x)}),u.forEach(function(e,a){var t=a+1;e.diagram.model.setDataProperty(e.data,'order',t),e.diagram.model.setDataProperty(e.data,'deletable',!0),e.location=r.location.copy().offset(0,-l*t),e.angle=0,e.diagram.model.setDataProperty(e.data,'desiredSize',z+20+' 10'),'between'==b?(t<j&&M.push(e.location.y+l/2),t==j&&M.push(e.location.y),t>j&&M.push(e.location.y-l/2)):M.push(e.location.y)}),this.group.__yunPointsX=E,this.group.__yunPointsY=M,y.forEach(function(){}),k.forEach(function(e){if(e.areaBackground=null,r.data.autoSnapText&&(e.data.orderX&&e.data.orderY&&(e.location=new go.Point(E[e.data.orderX-1],M[e.data.orderY-1]),e.location=new go.Point(E[e.data.orderX-1],M[e.data.orderY-1])),'dimText'==e.data.subRole&&null!=e.data.dimX&&null!=e.data.dimY)){e.diagram.model.setDataProperty(e.data,'deletable',!0);var a,t;a=E[e.data.dimX-1],t=M[e.data.dimY-1],0>=e.data.dimX&&(a=E[0]-d/2-10,'between'!=b&&e.data.dimY<=M.length&&(a-=d/2)),0>=e.data.dimY&&(t=M[0]+l/2,'between'!=b&&e.data.dimX<=E.length&&(t+=l/2)),e.location=new go.Point(a,t)}}),D&&(D.location=r.location.copy().offset(z+50,0),D.locationSpot=go.Spot.Left),N&&(N.location=r.location.copy().offset(0,-(F+50)),N.locationSpot=go.Spot.Bottom),B&&(B.angle=270,this.diagram.model.setDataProperty(B.data,'desiredSize',F+30+' 10')),P&&(P.angle=0,this.diagram.model.setDataProperty(P.data,'desiredSize',z+30+' 10')),r.width=z+2*d,r.height=F+2*l,go.Layout.prototype.doLayout.call(this,e),void a.commitTransaction('YunGroupLayout')},e.exports=a},function(e,a,t){'use strict';function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function d(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var l=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),s=go.GraphObject.make,c=t(1),g=t(0),m=function(e){function a(e){return i(this,a),r(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return d(a,e),l(a,[{key:'getNodeSelectionAdornmentTemplate',value:function(){return s(go.Adornment,'Spot',s(go.Panel,'Auto',s(go.Shape,{fill:null,stroke:'dodgerblue',strokeWidth:1}),s(go.Placeholder)),s(go.Panel,'Vertical',{name:'ButtonIcon1',alignment:new go.Spot(0,1,-20,20),alignmentFocus:go.Spot.Center,width:60,height:60,isActionable:!0},s(go.Shape,'Circle',{fill:'rgba(1,1,1,0)',strokeWidth:0,stroke:'green',width:50,height:50})))}},{key:'nodeResizeAdornmentTemplate',value:function(){return s(go.Adornment,'Spot',s(go.Placeholder),s(go.Shape,'Circle',{alignment:go.Spot.TopLeft,alignmentFocus:go.Spot.BottomRight,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}),s(go.Shape,'Circle',{alignment:go.Spot.BottomRight,alignmentFocus:go.Spot.TopLeft,cursor:'col-resize',desiredSize:new go.Size(30,30),fill:'lightblue',stroke:'dodgerblue'}))}},{key:'getNodeTemplate',value:function(){var e=this.diagram,a=this;return s(go.Node,'Spot',o({name:'NODE',_controlExpand:!0,layerName:'default',zOrder:13,locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,rotateObjectName:'SHAPE',doubleClick:function(a,e){e.diagram.__trtd.nodeDoubleClickListener&&e.diagram.__trtd.nodeDoubleClickListener(e)},click:function(a,e){e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},selectable:!0,movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:a.nodeResizeAdornmentTemplate(),contextMenu:e.__trtd.nodeContextMenu,selectionAdornmentTemplate:a.getNodeSelectionAdornmentTemplate()},'contextMenu',s(go.Adornment)),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('resizable','resizable').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('visible','visible'),new go.Binding('zOrder','zOrder'),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),s(go.Shape,{strokeDashArray:null,margin:0,name:'SHAPE',figure:'Rectangle',fill:'rgba(0,0,0,0)',minSize:new go.Size(50,50),strokeWidth:3,stroke:'RGBA(255,0,0,0.2)',portId:''},new go.Binding('fill','fill').makeTwoWay(),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(),new go.Binding('figure','figure').makeTwoWay(),new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('desiredSize','desiredSize',function(e){var a=new go.Size.parse(e);return a}).makeTwoWay(function(e){return go.Size.stringify(e)}),new go.Binding('strokeDashArray','strokeDashArray',function(e){return JSON.parse(e)}).makeTwoWay(function(e){return JSON.stringify(e)})))}}]),a}(c);e.exports=m},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=go.GraphObject.make,s=t(1),c=t(0),g=function(e){function a(e){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return r(a,e),d(a,[{key:'clearBorder',value:function(e){e.data.showBorder&&(e.findObject('textBorder').visible=!1)}},{key:'makeGeo',value:function(e,a,t){var o=e.radiusX,i=void 0===o?150:o,r=e.radiusY,d=void 0===r?100:r,l=new go.Geometry().add(new go.PathFigure(0,0).add(new go.PathSegment(go.PathSegment.SvgArc,2*i,0,i,d,0,1,t.clockwiseFlag?1:0)));return l.defaultStretch=go.GraphObject.Fill,l}},{key:'getNodeTemplate',value:function(){var e=this,a=this.diagram;return l(go.Node,'Spot',{_controlExpand:!0,__trtdNode:e,layerName:'Foreground',zOrder:15,movable:!0,isShadowed:!0,shadowColor:'#57617a',shadowOffset:new go.Point(0,0),visible:!0,locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),selectionObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!1,location:new go.Point(0,0),toMaxLinks:1,mouseDrop:function(a,e){var t=e.part,o=a.diagram.selection.first();if('picGroup'==o.data.category&&'cbian'==o.data.role&&'centerText'==t.data.role){var r=a.diagram.findNodeForKey(t.data.olive);if(!r)return;for(var d=o.findSubGraphParts().iterator,l=[],s={},c;d.next();)c=d.value,'autoText'==c.data.category&&('0 0 0 0'==c.data.locationSpot&&(s.shiText=c.data.text),'0 0.5 0 0'==c.data.locationSpot&&(s.centerText=c.data.text),'0 1 0 0'==c.data.locationSpot&&(s.xuText=c.data.text)),l.push(c.data);a.diagram.startTransaction('mouseDrop'),a.diagram.model.removeNodeDataCollection(l);JSON.parse(JSON.stringify(o.data));return a.diagram.model.removeNodeData(o.data),a.diagram.__trtd.addOlive(r,s),void a.diagram.commitTransaction('mouseDrop')}if('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole){a.diagram.model.startTransaction('coreTextExchange');var g=o.data.orderX,m=o.data.orderY,p=o.data.dimKey;a.diagram.model.setDataProperty(o.data,'orderX',t.data.orderX),a.diagram.model.setDataProperty(o.data,'orderY',t.data.orderY),a.diagram.model.setDataProperty(o.data,'dimKey',t.data.dimKey),a.diagram.model.setDataProperty(t.data,'orderX',g),a.diagram.model.setDataProperty(t.data,'orderY',m),a.diagram.model.setDataProperty(t.data,'dimKey',p),a.diagram.model.commitTransaction('coreTextExchange')}if('dimText'==o.data.subRole&&'dimText'==t.data.subRole&&o.data.category==t.data.category){if(o.data.group!=t.data.group)return;if(!o.containingGroup)return;if('yunpanGroup'!=o.containingGroup.data.category)return;if(o.data.dimX!=t.data.dimX&&o.data.dimY!=t.data.dimY)return;a.diagram.model.startTransaction('dimTextExchange');var g=o.data.dimX,m=o.data.dimY,d=t.containingGroup.findSubGraphParts().iterator,u=[],y=[],h=[],k=[],f='X';0==o.data.dimX&&(f='Y');for(var T=o.data['dim'+f],x=t.data['dim'+f],c;d.next();)c=d.value,'yunpanText'==c.data.subRole&&(c.data['order'+f]==x&&h.push(c),c.data['order'+f]==T&&k.push(c));for(var b=0,i,S;b<h.length;b++)a.diagram.model.setDataProperty(h[b].data,'order'+f,T);for(var b=0;b<k.length;b++)a.diagram.model.setDataProperty(k[b].data,'order'+f,x);return a.diagram.model.setDataProperty(o.data,'dim'+f,x),a.diagram.model.setDataProperty(t.data,'dim'+f,T),void a.diagram.model.commitTransaction('dimTextExchange')}if('dimText'==o.data.subRole&&'dimText'==t.data.subRole){a.diagram.model.startTransaction('dimTextExchange');var g=o.data.dimX,m=o.data.dimY,d=t.containingGroup.findSubGraphParts().iterator,u=[],y=[],h=[],k=[],f='X';for(0==o.data.dimX&&(f='Y');d.next();){var c=d.value;c.data.dimKey==t.data.key&&u.push(c),c.data.dimKey==o.data.key&&y.push(c),'yunpanText'==c.data.subRole&&(c.data['order'+f]==t.data['order'+f]&&h.push(c),c.data['order'+f]==o.data['order'+f]&&k.push(c))}var v=(t.containingGroup.__yunPointsX.length+1)/2,w=(t.containingGroup.__yunPointsY.length+1)/2;o.data.dimX>v&&y.sort(function(e,a){return e.data.orderX-a.data.orderX}),o.data.dimX==v&&(o.data.dimY>w?y.sort(function(e,a){return e.data.orderY-a.data.orderY}):y.sort(function(e,a){return a.data.orderY-e.data.orderY})),o.data.dimX<v&&y.sort(function(e,a){return a.data.orderX-e.data.orderX}),t.data.dimX>v&&u.sort(function(e,a){return e.data.orderX-a.data.orderX}),t.data.dimX==v&&(t.data.dimY>w?u.sort(function(e,a){return e.data.orderY-a.data.orderY}):u.sort(function(e,a){return a.data.orderY-e.data.orderY})),t.data.dimX<v&&u.sort(function(e,a){return a.data.orderX-e.data.orderX});for(var b=0,i,S;b<y.length;b++)i=y[b].data.orderX,S=y[b].data.orderY,a.diagram.model.setDataProperty(y[b].data,'orderX',u[b].data.orderX),a.diagram.model.setDataProperty(y[b].data,'orderY',u[b].data.orderY),a.diagram.model.setDataProperty(u[b].data,'orderX',i),a.diagram.model.setDataProperty(u[b].data,'orderY',S);a.diagram.model.setDataProperty(o.data,'dimX',t.data.dimX),a.diagram.model.setDataProperty(o.data,'dimY',t.data.dimY),a.diagram.model.setDataProperty(t.data,'dimX',g),a.diagram.model.setDataProperty(t.data,'dimY',m),a.diagram.model.commitTransaction('dimTextExchange')}if('wave'==o.data.category&&'centerText'==t.data.role&&t&&o.data.group==e.data.group){a.diagram.startTransaction('mouseDrop'),o.__oldOrder=o.data.order,a.diagram.model.setDataProperty(o.data,'order',t.data.order+.5);var P=a.diagram.model.findNodeDataForKey(o.data.xuText),B=a.diagram.model.findNodeDataForKey(o.data.shiText);a.diagram.model.setDataProperty(B,'order',t.data.order+.5),a.diagram.model.setDataProperty(P,'order',t.data.order+.5),a.diagram.commitTransaction('mouseDrop')}},mouseDragEnter:function(a,e){var t=e.part,o=a.diagram.selection.first();o&&(('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole)&&(o.areaBackground=null,t.areaBackground='RGB(107,208,137)'),'dimText'==o.data.subRole&&'dimText'==t.data.subRole&&(o.areaBackground=null,t.areaBackground='RGB(107,208,137)'),'centerText'==t.data.role&&(t.layerName='Background'))},mouseDragLeave:function(a,e){var t=e.part,o=a.diagram.selection.first();('coreText'==o.data.subRole&&'coreText'==t.data.subRole||'yunpanText'==o.data.subRole&&'yunpanText'==t.data.subRole)&&(t.areaBackground=null),'dimText'==o.data.subRole&&'dimText'==t.data.subRole&&(t.areaBackground=null),'centerText'==t.data.role&&(t.layerName='Foreground')},selectionChanged:function(e){if('autoText'==e.data.category&&null!=e.data.orderX&&null!=e.data.orderY&&'freeText'==e.data.role&&'coreText'==e.data.subRole&&'yunpanText'==e.data.subRole&&e.containingGroup&&'yunGroup'==e.containingGroup.data.category&&'yunpanGroup'==e.containingGroup.data.category&&'line'==e.containingGroup.data.beginSpark&&e.containingGroup.__yunPointsX&&e.containingGroup.__yunPointsY){var a=(e.containingGroup.__yunPointsX.length+1)/2,t=(e.containingGroup.__yunPointsY.length+1)/2;if(e.data.orderX==a&&e.data.orderY==t)return;var o=e.data.orderX,i=e.data.orderY;o==a&&(o=i),i==t&&(i=o);var r=e.containingGroup.data.shapeStrokes,d=e.containingGroup.data.showShape;if(e.isSelected){if('between'==e.containingGroup.data.snapType)var l=_Mathmax(_Mathabs(e.data.orderX-a),_Mathabs(e.data.orderY-t))+1;else var l=_Mathmax(_Mathabs(e.data.orderX-a),_Mathabs(e.data.orderY-t));for(var s=e.containingGroup.findSubGraphParts().iterator,g=null,m;s.next();)if(m=s.value,'autoText'==m.data.category&&null!=m.data.orderX&&null!=m.data.orderY&&'freeText'==m.data.role&&(m.findObject('textBorder').visible=!1,(_Mathabs(m.data.orderX-a)==_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)<=_Mathabs(i-t)||_Mathabs(m.data.orderX-a)<=_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)==_Mathabs(i-t))&&(m.areaBackground='white',m.zOrder=999)),'shape'==m.data.category&&'background'==m.data.role){var p=m.findObject('SHAPE');m.data.gridWidth==2*l?(g=p,!p.__prestroke&&(p.__prestroke=p.stroke,p.stroke='rgba(255,0,0,0.5)')):p.__prestroke&&(p.stroke=p.__prestroke,delete p.__prestroke)}if(!g){if('between'==e.containingGroup.data.snapType)var u=2*l;else var u=2*l;e.diagram.model.startTransaction('addShape');var y={deletable:!0,role:'background',category:'shape',loc:go.Point.stringify(new go.Point(e.containingGroup.__yunPointsX[a-1],e.containingGroup.__yunPointsY[t-1])),movable:!0,group:-19,key:c.guid(),orderX:10,orderY:10,gridWidth:u,stroke:r[l-1],visible:!0,strokeDashArray:'[0,0]',strokeWidth:3};e.diagram.model.addNodeData(y),e.diagram.model.commitTransaction('addShape'),setTimeout(function(){var a=e.diagram.findNodeForKey(y.key);if(a){var t=a.findObject('SHAPE');t.__prestroke||(t.__prestroke=t.stroke,t.stroke='rgba(255,0,0,0.5)')}},100)}}else for(var s=e.containingGroup.findSubGraphParts().iterator,m;s.next();)if(m=s.value,'autoText'==m.data.category&&null!=m.data.orderX&&null!=m.data.orderY&&'freeText'==m.data.role&&(_Mathabs(m.data.orderX-a)==_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)<=_Mathabs(i-t)||_Mathabs(m.data.orderX-a)<=_Mathabs(o-a)&&_Mathabs(m.data.orderY-t)==_Mathabs(i-t))&&(m.areaBackground=null,m.zOrder=NaN),'shape'==m.data.category&&'background'==m.data.role){var p=m.findObject('SHAPE');d||(p.stroke='rgba(255,0,0,0)'),m.data.gridWidth==2*l?!p.__prestroke&&(p.__prestroke=p.stroke,p.stroke='rgba(255,0,0,0.7)'):p.__prestroke&&(p.stroke=p.__prestroke,delete p.__prestroke)}}},click:function(){},mouseOver:function(a,e){e.data.showBorder&&''==e.data.text&&('xuText'==e.data.role||'shiText'==e.data.role)&&(e.findObject('textBorder').visible=!0),'centerText'==e.data.role&&(e.layerName='Background')},mouseLeave:function(a,e){e.data.showBorder&&(e.findObject('textBorder').visible=!1),'centerText'==e.data.role&&(e.layerName='Foreground')},layoutConditions:go.Part.LayoutStandard&go.Part.LayoutRemoved&go.Part.LayoutAdded&~go.Part.LayoutNodeSized,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,contextMenu:l(go.Adornment),resizeAdornmentTemplate:l(go.Adornment,'Spot',l(go.Placeholder),l(go.Shape,'Circle',{alignment:go.Spot.BottomRight,cursor:'col-resize',desiredSize:new go.Size(15,15),fill:'lightblue',stroke:'dodgerblue'})),doubleClick:function(a,e){a.diagram.__trtd.selectText(a,e)}},new go.Binding('locationSpot','locationSpot',function(e){return go.Spot.parse(e)}).makeTwoWay(function(e){return go.Spot.stringify(e)}),new go.Binding('type','type',function(e){return go.Panel[e]}),new go.Binding('visible','visible').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('rotatable','rotatable').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('copyable','copyable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}),l(go.Shape,{strokeDashArray:null,opacity:.7,stretch:go.GraphObject.UniformToFill,name:'SHAPE',figure:'Circle',fill:'rgba(0,255,0,1)',fromLinkable:!1,toLinkable:!1,width:100,height:100,cursor:'pointer',minSize:new go.Size(50,50),strokeWidth:1,stroke:'black',portId:''},new go.Binding('strokeDashArray','shiStrokeDashArray',function(e){return JSON.parse(e)}).makeTwoWay(function(e){return JSON.stringify(e)}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('desiredSize','desiredSize',function(e){return go.Size.parse(e)}).makeTwoWay(function(e){return go.Size.stringify(e)}),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),new go.Binding('opacity','opacity').makeTwoWay()),l(go.Shape,{geometryString:'M540.5696 556.81024a81.8176 81.8176 0 0 1-53.0432-19.47648l-225.4848-191.52896a81.92 81.92 0 1 1 106.0864-124.86656l172.4416 146.47296 172.4416-146.47296a81.92 81.92 0 0 1 106.0864 124.86656l-225.4848 191.52896a81.7152 81.7152 0 0 1-53.0432 19.47648z m53.06368 246.23104l225.44384-191.52896a81.92 81.92 0 1 0-106.0864-124.84608l-172.40064 146.47296-172.48256-146.47296a81.92 81.92 0 1 0-106.04544 124.86656l225.52576 191.52896a81.7152 81.7152 0 0 0 53.00224 19.47648c18.88256 0 37.76512-6.49216 53.0432-19.49696z',visible:!1,name:'figure',cursor:'pointer',alignment:go.Spot.TopRight,alignmentFocus:go.Spot.TopRight,width:14,height:14,fill:'green',toolTip:l('ToolTip',l(go.Panel,'Vertical',l(go.Picture,new go.Binding('source','src',function(e){return'images/'+e+'.png'})),l(go.TextBlock,{text:'\u8FDB\u5165\u5B50\u76D8',margin:3}))),click:function(a){var e=a.targetObject.part;a.diagram.__trtd.openFigure({figure:e.data.figure,title:e.data.text,key:e.data.key,node:e})}},new go.Binding('visible','figure',function(e){return!!e})),l(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'18px \'Microsoft YaHei\'',editable:!1,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',verticalAlignment:go.Spot.Center,spacingAbove:4,spacingBelow:4,portId:'TEXT',margin:0,maxSize:new go.Size(600,NaN),minSize:new go.Size(10,10),stretch:go.GraphObject.UniformToFill,textEdited:function(e,a,t){var o=e.part;''==t.trim()&&('shiText'==o.data.role||'xuText'==o.data.role)&&(e.part.diagram.model.startTransaction('text'),e.part.diagram.model.setDataProperty(e.part.data,'nloc',null),e.part.diagram.model.commitTransaction('text')),e.part.data.role&&-1<e.part.data.role.indexOf('labelText')&&(e.part.containingGroup.layout.isValidLayout=!1)}},new go.Binding('background','background',function(e){return e}).makeTwoWay(),new go.Binding('areaBackground','areaBackground',function(e){return e}).makeTwoWay(),new go.Binding('textAlign','textAlign',function(e){return e}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return c.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('maxSize','',function(e){var a=NaN,t=NaN;return e.width&&(a=e.width),e.height&&(t=e.height),new go.Size(a,t)}),new go.Binding('minSize','minSize',function(e){return go.Size.parse(e)}),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()))}}]),a}(s);e.exports=g},function(e){'use strict';function a(){go.Link.call(this)}function t(e,a){var t,o;return 0<=a&&90>=a?(t=e*_Mathsin(a*_MathPI/180),o=e*_Mathcos(a*_MathPI/180),[o,t]):90<a&&180>=a?(t=e*_Mathsin((180-a)*_MathPI/180),o=e*_Mathcos((180-a)*_MathPI/180),[-o,t]):180<a&&270>=a?(t=e*_Mathsin((a-180)*_MathPI/180),o=e*_Mathcos((a-180)*_MathPI/180),[-o,-t]):270<a&&360>=a?(t=e*_Mathsin((360-a)*_MathPI/180),o=e*_Mathcos((360-a)*_MathPI/180),[o,-t]):void 0}function o(e,a,o){var i=new go.Point((a.x+o.x)/2,(a.y+o.y)/2);if(e.equals(a)){var d=i.copy(),l=_Mathsqrt(i.distanceSquaredPoint(a)),r=(a.directionPoint(o)+90)%360,s=.15*l,c=t(s,r);return d.offset(c[0],c[1]),l=_Mathsqrt(d.distanceSquaredPoint(a)),[l,d.x,d.y]}var g=_Mathsqrt(e.distanceSquaredPoint(i)),m=e.directionPoint(i),p=e.distanceSquaredPoint(o)<e.distanceSquaredPoint(a);if(p)var u=o.directionPoint(a);else var u=a.directionPoint(o);var y=_Mathabs(m-u);90<y&&180>y?y=180-y:180<=y&&(y=360-y);var h=g*_Mathcos(y*_MathPI/180),c=t(h,u),d=e.copy();d.offset(c[0],c[1]);var l=_Mathsqrt(d.distanceSquaredPoint(a));return[l,d.x,d.y]}function i(e,a,o){var i=arguments[3]?arguments[3]:triangleCircle(e,a,o);var r=i[0],d=new go.Point(i[1],i[2]),l=_Mathabs(d.directionPoint(e)-d.directionPoint(o));l=180<l?360-l:l;var s=r/_Mathcos(l/3*_MathPI/180),c=new go.Geometry(go.Geometry.Line);c.startX=d.x,c.startY=d.y,c.endX=e.x,c.endY=e.y,c.rotate(l/3,d.x,d.y);var g=d.direction(c.endX,c.endY),m;i=t(s,g),m=d.copy().offset(i[0],i[1]),c.rotate(l/3,d.x,d.y),g=d.direction(c.endX,c.endY);var p;return i=t(s,g),p=d.copy().offset(i[0],i[1]),[m,p]}var r=go.GraphObject.make;go.Diagram.inherit(a,go.Link),a.prototype.makeGeometry=function(){var e=go.Link.prototype.makeGeometry.call(this);return e.type!==go.Geometry.Path||0===e.figures.length?e:e},a.prototype.computePoints=function(){var e=Math.acos,a=this.diagram;if(null==this.fromNode||null==this.toNode)return!0;if(this.fromNode.location.equals(this.toNode.location))return!1;var t=this.fromNode.location.copy(),r=this.toNode.location.copy();if(!t.isReal()||!r.isReal())return!0;var d=a.findNodeForKey(this.toNode.data.parent);if(!d)return!0;d=d.location;var l=o(d,t,r),s=l,c=new go.Point(s[1],s[2]);this.micenter=c;var g=s[0],m=this.fromNode.actualBounds.width/2,p=this.toNode.actualBounds.width/2,u=(2*g*g-m*m)/(2*g),y=180*e(u/g)/_MathPI,h=new go.Geometry(go.Geometry.Line);h.startX=c.x,h.startY=c.y,h.endX=this.fromNode.location.x,h.endY=this.fromNode.location.y,y||(y=0),h.rotate(y,c.x,c.y);var k=new go.Point(h.endX,h.endY);u=(2*g*g-p*p)/(2*g),y=180*e(u/g)/_MathPI,h.endX=this.toNode.location.x,h.endY=this.toNode.location.y,y||(y=0),h.rotate(-y,c.x,c.y);var f=new go.Point(h.endX,h.endY),T=i(k,null,f,s),x=T[0],b=T[1];this.clearPoints(),(isNaN(k.x)||isNaN(k.y))&&(k=this.fromNode.location.copy()),(isNaN(f.x)||isNaN(f.y))&&(f=this.toNode.location.copy()),this.points.add(k),this.points.add(T[0]),this.points.add(T[1]),this.points.add(f);return!0},e.exports=function(){return r(a,{curve:go.Link.Bezier,layerName:'',isTreeLink:!0,curviness:30,adjusting:go.Link.Stretch,relinkableFrom:!0,relinkableTo:!0,reshapable:!0,layoutConditions:go.Part.LayoutStandard&~go.Part.LayoutNodeSized,mouseDragEnter:function(a,e){var t=e.part,o=t.findObject('SHAPE');o._preStoke=o.stroke,o.stroke='darkred',o._preStrokeWidth=o.strokeWidth,o.strokeWidth=5},mouseDragLeave:function(a,e){var t=e.part,o=t.findObject('SHAPE');o.stroke=o._preStoke,o.strokeWidth=o._preStrokeWidth},mouseDrop:function(a,e){var t=e.part,o=a.diagram.selection.first();if(!(!o instanceof go.Node)&&!(!o instanceof go.Group)&&1!=o.data.key){var i=t.fromNode,r=t.toNode;r.data.parent==i.data.key?a.diagram.__trtd.setNodeAsChildren(o,i):a.diagram.__trtd.setNodeAsSibling(o,i)}}},r(go.Shape,{name:'SHAPE',stroke:'#767678',strokeWidth:3},new go.Binding('strokeWidth','strokeWidth').makeTwoWay(),new go.Binding('stroke','color').makeTwoWay(),new go.Binding('strokeDashArray','strokeDashArray',function(e){try{var a=[parseInt(e.split(' ')[0]),parseInt(e.split(' ')[1])]}catch(a){var a=null}return a}).makeTwoWay(function(e){return e[0]+' '+e[1]})),r(go.Shape,{name:'Arrow',toArrow:'Triangle',stroke:'#767678',strokeWidth:3},new go.Binding('strokeWidth','strokeWidth'),new go.Binding('fill','color'),new go.Binding('stroke','color'),new go.Binding('toArrow','toArrow')),new go.Binding('curviness','curviness').makeTwoWay(),new go.Binding('points').makeTwoWay())}},function(e,a,t){'use strict';function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function d(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}function l(e){var a=e.selection.first();if(a.data.istemp){e.model.startTransaction();var t=e.findNodeForKey(a.data.parent);e.model.setDataProperty(a.data,'istemp',void 0);for(var o=null;t;){if(t.data.istemp)e.model.setDataProperty(t.data,'istemp',void 0),e.model.setDataProperty(t.data,'text','\u53CC\u51FB\u7F16\u8F91\u5185\u5BB9'),o=t;else{o&&e.model.setDataProperty(t.data,'isparent',o.data.key);break}t=e.findNodeForKey(t.data.parent)}e.model.commitTransaction(),e.isModified=!0}}function s(e,a){var t=a.__trtd.tdCurrentTheme;if(a.model.setDataProperty(e,'strokeWidth',t.borderWidth),a.model.setDataProperty(e,'stroke',t.borderColor),null==t.colorRange)a.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0]);else if(t.colorRange instanceof Array){var o='white';o=e.level>=t.colorRange.length?t.colorRange[e.level%t.colorRange.length]:t.colorRange[e.level],a.model.setDataProperty(e,'fill',o)}else if('random'!=t.colorRange)'white'==t.colorRange?a.model.setDataProperty(e,'fill','white'):a.model.setDataProperty(e,'fill','rgba(0,0,0,0)');else if(e.prev){var i=a.findNodeForKey(e.prev);i?a.model.setDataProperty(e,'fill',i.data.fill):a.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0])}else a.model.setDataProperty(e,'fill',randomColor({luminosity:'light',count:1})[0]);return e}function c(e,a){var t=e.sweep?e.sweep:360,a=e.layerThickness||100,o=e.dradius?e.dradius:100,i=new go.Point(o+a,0).rotate(-t/2),r=new go.Point(o,0).rotate(t/2),d=new go.Geometry().add(new go.PathFigure(i.x,i.y).add(new go.PathSegment(go.PathSegment.Arc,-t/2,t,0,0,o+a,o+a)).add(new go.PathSegment(go.PathSegment.Line,r.x,r.y)).add(new go.PathSegment(go.PathSegment.Arc,t/2,-t,0,0,o,o).close()));return d.normalize(),d}function g(e){var a=null;return a=e.nodeDataArray.find(function(e){if(!e.isGroup&&'Root'==e.category&&0==e.level)return!0}),a}var m=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),u=t(0),p=t(12),y=t(2),h=t(10).Trtd,k=go.GraphObject.make,f=function(e){function a(e,t){i(this,a);var o=r(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));return o.config=t,o.modelChangedListener=t.modelChangedListener,o.type=t.type,o.diagram={},o.model=t.model,o.readOnly=!1,null!=t.readOnly&&(o.readOnly=t.readOnly),o.initDiagramBase(e,t),o.diagram=o.initDiagram(e,t),o.initListener(),o.model&&o.initModel(),o}return d(a,e),m(a,[{key:'initDiagram',value:function(e,a){var t=this.diagram,o=Object.assign({"undoManager.isEnabled":!0,allowMove:!0,"animationManager.isEnabled":!1},a.diagramConfig);return this.diagram.setProperties(o),this.addNodeTemplate(),t}},{key:'getTdData',value:function(){return this.diagram.model.toJson()}},{key:'getDefaultCustomMenuDivStr',value:function(){return'\n        <ul>\n            <li trtd_action="addFollowerGround"><a class="i18n" data-lang="insertsl">\u589E\u52A0\u540C\u7EA7\u8282\u70B9</a></li>\n            <li trtd_action="addNewCircle"><a class="i18n" data-lang="icn">\u589E\u52A0\u5B50\u8282\u70B9</a></li>\n            <li trtd_action="apiDeleteSelection"><a class="i18n" data-lang="remove">\u5220\u9664</a></li>\n        </ul>\n        '}},{key:'getShowContextMenus',value:function(e){return e?'addFollowerGround,addNewCircle,apiDeleteSelection':'none'}},{key:'addTextNode',value:function(e){var a=this.diagram;a.startTransaction();var t={text:e||p.trans('blankText'),category:'text'};t.loc=go.Point.stringify(a.lastInput.documentPoint),a.model.addNodeData(t),a.commitTransaction()}},{key:'initModel',value:function(e){e&&(this.model=e);var a=go.Model.fromJson(this.model);'dipan'==a.modelData.currentType&&(a.nodeDataArray=a.nodeDataArray.filter(function(e){if(!e.isGroup)return delete e.group,!0}),a.linkDataArray=[]),this.diagram.layout.isInitial=!1,a.modelData.type=this.type,this.diagram.model=a,this.groundLayout(this.diagram),this.diagram.updateAllTargetBindings()}},{key:'loadModel',value:function(e){this.initModel(e)}},{key:'initListener',value:function(){}},{key:'addNodeTemplate',value:function(){var e=this,a=this.diagram,t=this.tdGetModelData(null,a.model,a),o=parseInt(t.layerThickness),i=t.tdDipanTextAngle;a.nodeTemplateMap.add('dipan',this.createDipanTemplate(o,i)),a.nodeTemplateMap.add('Root',this.getDipanRootTemplate(o)),a.nodeTemplateMap.add('3',y(this.diagram))}},{key:'createTextNodeTemplate',value:function(){var e={figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:1,stroke:'rgba(0,0,0,0)',fontSize:15,font:'sans-serif'};return k(go.Node,'Spot',{_controlExpand:!0,layerName:'Foreground',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,location:new go.Point(0,0),toMaxLinks:1,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,contextMenu:this.getNodeContextMenu},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),k(go.Shape,{strokeDashArray:null,name:'SHAPE',figure:'Rectangle',fill:'rgba(0,0,0,0)',fromLinkable:!0,toLinkable:!0,cursor:'pointer',minSize:new go.Size(50,50),strokeWidth:2,stroke:'rgba(0,0,0,0)',portId:'',width:150},new go.Binding('strokeDashArray','strokeDashArray',function(e){return[e.split()[0],e.split()[1]]}).makeTwoWay(function(e){return e[0]+' '+e[1]}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),{figure:e.figure,fill:e.fill,strokeWidth:e.strokeWidth,stroke:e.stroke}),k(go.Shape,{name:'SHAPE_Back',figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:0},new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('height','height',function(e){return e}).ofObject('SHAPE')),k(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'bold 22px \u5E7C\u5706',editable:!0,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Fill},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()))}},{key:'createDipanTemplate',value:function(e,a){if(null==100);if(null=='zhengli');var t=this,o=go.GraphObject.make;return o(go.Node,'Spot',{locationSpot:go.Spot.Center,locationObjectName:'MAIN',selectionObjectName:'SHAPE',click:function(a,e){t.readOnly&&e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},contextMenu:this.getNodeContextMenu,movable:!1,doubleClick:function(a){if(!t.readOnly){var e=a.diagram,o=e.selection.first();if(o){var i=e.selection.first().findObject('TEXT');i&&e.commandHandler.editTextBlock(i),u.simulateEnterWithAlt(a),l(e)}}},selectionAdorned:!t.readOnly,selectionAdornmentTemplate:o(go.Adornment,'Spot',o(go.Panel,'Auto',o(go.Shape,{fill:'rgba(255,232,211,0.1)',stroke:'blue',strokeWidth:2}),o(go.Placeholder)),o('Button',{alignment:go.Spot.RightCenter,alignmentFocus:go.Spot.Bottom,width:30,height:30,click:function(a){var e=a.diagram.selection.first();if(e.data.parent){var o=e.diagram.findNodeForKey(e.data.parent);if(o.data.istemp)return}t.addNewCircle(a)}},o(go.Shape,'PlusLine',{desiredSize:new go.Size(15,15)})),o('Button',{alignment:go.Spot.BottomCenter,width:30,height:30,click:function(a){a.diagram.selection.first().data.istemp||t.addFollowerGround(a)}},o(go.Shape,'PlusLine',{desiredSize:new go.Size(15,15)}))),mouseOver:function(){},mouseLeave:function(){},mouseDragEnter:function(){},mouseDragLeave:function(){},mouseDrop:function(){}},new go.Binding('angle','dangle'),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('selectionAdorned','selectionAdorned',function(e){return e?e:''}).makeTwoWay(function(e){return e}),o(go.Shape,{figure:'Rectangle',name:'MAIN',fill:'rgba(255,255,0,0)',strokeWidth:0,stroke:'red',height:1},new go.Binding('width','layerThickness',function(e){return parseInt(e||100)})),o(go.Shape,{name:'SHAPE',fill:'lightgray',strokeWidth:2,margin:5,stroke:'green',alignment:go.Spot.Right,alignmentFocus:go.Spot.Right,portId:''},new go.Binding('geometry','',function(e){return c(e)}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e})),o(go.Shape,{figure:'Rectangle',name:'LOCATE',fill:'rgba(0,255,0,0)',strokeWidth:0,stroke:'green',height:20,alignment:go.Spot.Right,alignmentFocus:go.Spot.Right},new go.Binding('width','layerThickness',function(e){return parseInt(e||100)})),o(go.TextBlock,{name:'TEXT',isMultiline:!0,click:function(){},textAlign:'center',editable:!1,wrap:go.TextBlock.WrapDesiredSize,overflow:go.TextBlock.OverflowClip,spacingAbove:4,spacingBelow:4,font:'bold 15px \u5E7C\u5706'},new go.Binding('text').makeTwoWay(),new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay(),new go.Binding('width','',function(e){var a=e.tdDipanTextAngle||'xuanzhuan',t=parseInt(e.layerThickness||100),o=.7*(e.sweep/180*e.dradius*_MathPI);return'fangshe'==a?o:'zhengli'==a?.7*t:'xuanzhuan'==a?.7*t:void 0}),new go.Binding('angle','textAngle').makeTwoWay(),new go.Binding('alignment','tdDipanTextAngle',function(e){var a=e||'xuanzhuan',t=go.Spot.Center;return'xuanzhuan'===a?t=go.Spot.Center:'fangshe'===a?t=go.Spot.Left:'zhengli'===a?t=go.Spot.Center:void 0,t}),new go.Binding('alignmentFocus','tdDipanTextAngle',function(e){var a=e||'xuanzhuan',t=go.Spot.Center;return'xuanzhuan'===a?t=go.Spot.Center:'fangshe'===a?t=go.Spot.Left:'zhengli'===a?t=go.Spot.Center:void 0,t})))}},{key:'getDipanRootTemplate',value:function(){var a=this,t=this,e;return k(go.Node,'Auto',(e={locationSpot:go.Spot.Center,selectionAdorned:!0,movable:!1,click:function(a,e){t.readOnly&&e.diagram.__trtd.nodeClickListener&&e.diagram.__trtd.nodeClickListener(e)},doubleClick:function(a){if(!t.readOnly){var e=a.diagram,o=e.selection.first();if(o){var i=e.selection.first().findObject('TEXT');i&&e.commandHandler.editTextBlock(i),u.simulateEnterWithAlt(a)}}},mouseOver:function(){},mouseLeave:function(){}},o(e,'selectionAdorned',!t.readOnly),o(e,'selectionAdornmentTemplate',k(go.Adornment,'Spot',k(go.Panel,'Auto',k(go.Shape,{fill:'rgba(255,232,211,0.1)',stroke:'blue',strokeWidth:2}),k(go.Placeholder)),k('Button',{alignment:go.Spot.RightCenter,alignmentFocus:go.Spot.Bottom,width:30,height:30,click:function(t){var e=t.diagram.selection.first();if(e.data.parent){var o=e.diagram.findNodeForKey(e.data.parent);if(o.data.istemp)return}a.addNewCircle(t)}},k(go.Shape,'PlusLine',{desiredSize:new go.Size(15,15)})))),o(e,'location',new go.Point(0,0)),e),new go.Binding('width','layerThickness',function(e){return e?2*e:200}),new go.Binding('height','layerThickness',function(e){return e?2*e:200}),k(go.Shape,'Circle',{name:'SHAPE',fill:'#FFBFBF',strokeWidth:0,spot1:go.Spot.TopLeft,spot2:go.Spot.BottomRight},new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e})),k(go.TextBlock,{name:'TEXT',font:'bold 23px \u5E7C\u5706',textAlign:'center',editable:!1,spacingAbove:4,isMultiline:!0,spacingBelow:4},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return u.tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('width','width').makeTwoWay(),new go.Binding('font','font').makeTwoWay(),new go.Binding('angle','textAngle').makeTwoWay()))}},{key:'tdGetModelData1',value:function(e,a){return Object.assign({currentType:'dipan',currentThemeID:0,layerThickness:100,splitLayer:1,layout:'inner',tdDipanTextAngle:'xuanzhuan'},a.modelData)}},{key:'tdGetModelData',value:function(e,a){var t=this.diagram,a=t.model,o={currentType:'tianpan',currentThemeID:0,layerThickness:100,splitLayer:1,layout:'inner',tdDipanTextAngle:'xuanzhuan'},i=g(a);if('undefined'!=typeof e&&null!=e)return i?i[e]||a.modelData[e]||o[e]:a.modelData[e]||o[e];if(i)for(var r in o)i[r]?o[r]=i[r]:a.modelData&&a.modelData[r]&&(o[r]=a.modelData[r]);else for(var r in o)a.modelData&&a.modelData[r]&&(o[r]=a.modelData[r]);return o}},{key:'deleteSelection',value:function(){var e=this.diagram,a=e.selection.first();var t=e.commandHandler,o=null;if(a&&!a.data.istemp&&1!=a.data.key&&'g_1'!=a.data.key&&'Root'!=a.data.key){e.model.startTransaction('all'),e.model.startTransaction('level1'),e.model.setDataProperty(a.data,'istemp',!0),this.deleteNode(a,e);var r=this.getMaxCircle(e),d=[];e.model.nodeDataArray.forEach(function(e){e.level>r&&d.push(e)}),e.model.removeNodeDataCollection(d),e.model.nodeDataArray.forEach(function(a){a.level==r&&null!=a.isparent&&e.model.setDataProperty(a,'isparent',null)}),e.model.removeNodeData(a.data),e.model.commitTransaction('level1'),this.groundLayout(e),e.model.commitTransaction('all');for(var o=null,l=['next','prev','parent'],s=0;s<l.length;s++)if(a.data[l[s]]){o=e.findNodeForKey(a.data[l[s]]);break}o&&e.select(o)}}},{key:'deleteNode',value:function(e){var a=this.diagram,t=e.data.prev?a.findNodeForKey(e.data.prev):null,o=e.data.next?a.findNodeForKey(e.data.next):null,r=e.data.parent?a.findNodeForKey(e.data.parent):null;if(e.data.isparent){var d=a.findNodeForKey(e.data.isparent),l=[];u.tdTravelTdpData(d.data,a.model,l,function(e){return e}),a.model.removeNodeDataCollection(l);this.getMaxCircle(a)}if(null!=r&&(r.data.isparent==e.data.key?null==o?a.model.setDataProperty(r.data,'isparent',void 0):(a.model.setDataProperty(r.data,'isparent',o.data.key),a.model.setDataProperty(o.data,'prev',void 0)):(a.model.setDataProperty(t.data,'next',null==o?null:o.data.key),null!=o&&a.model.setDataProperty(o.data,'prev',t.data.key))),'dipan'==a.model.modelData.currentType){for(var s=0,c=0;c<a.model.nodeDataArray.length&&(a.model.nodeDataArray[c].istemp||a.model.nodeDataArray[c].isGroup||s++,!(1<s));c++);if(1>=s){var i=a.model.findNodeDataForKey(1);delete i.group}}a.isModified=!0}},{key:'getMaxCircle',value:function(){var e=this.diagram,a=0,t=[],o=[],i=[],r=[];e.model.nodeDataArray.forEach(function(e){e.istemp||e.isGroup?r.push(e):(t.push(e),e.level&&o.push(e.level))});var d=_Mathmax.apply(null,o);return t.forEach(function(e){e.level===d&&i.push(e)}),d===-Infinity&&0===i.length?(a=0):d!==-Infinity&&0===i.length?a=d-1:0<i.length&&(a=d),a}},{key:'addNewCircle',value:function(){var e=this.diagram,a=this.getMaxCircle(),t=e.selection.first();if(t&&!(t.data.isparent&&e.findNodeForKey(t.data.isparent)&&!e.findNodeForKey(t.data.isparent).visible)){e.model.startTransaction('addNewCircle'),'istemp'in t.data&&t.data.istemp&&(l(e),''==t.data.text&&e.model.setDataProperty(t.data,'text',p.trans('dce')));var o=null;if(t.data.isparent&&(o=e.model.findNodeDataForKey(t.data.isparent)),null!=o&&o.istemp)e.model.setDataProperty(o,'istemp',!1),e.model.setDataProperty(o,'text',p.trans('dce'));else{var i=this.addChildNodeData(t);i.level>a&&(a=i.level),this.groundLayout(e)}e.model.commitTransaction('addNewCircle')}}},{key:'addChildNodeData',value:function(e){var a=null==window.localStorage.getItem('isautolayout')||'true'==window.localStorage.getItem('isautolayout'),t=e.diagram,o=arguments[1]?arguments[1]:null,i=(t.model.nodeDataArray.length+1).toString(),r={key:i,text:p.trans('dce')};t.model.makeNodeDataKeyUnique(r),i=r.key;var d=null;r.level=e.data.level+1,r.parent=e.data.key,r.prev=void 0,e.data.isparent&&(d=t.model.findNodeDataForKey(e.data.isparent),d&&(r.next=d.key,t.model.setDataProperty(d,'prev',r.key))),null!=o&&(r.istemp=!0,r.text='');var l=t.model.modelData.layerThickness;return r.dangle=e.data.dangle,r.dradius=e.data.dradius,r.sweep=e.data.sweep,r.layerThickness=l||100,r.tdDipanTextAngle=e.data.tdDipanTextAngle||'xuanzhuan',0!=e.data.level&&(r.category=e.data.category),'Root'==e.data.category&&(r.category='dipan'),r.strokeWidth=e.data.strokeWidth,e.data.figure&&(r.figure=e.data.figure),e.data.picture&&(r.picture=e.data.picture),e.data.width&&(r.width=e.data.width),e.data.height&&(r.height=e.data.height),r=s(r,t),r.font=e.data.font,r.textStroke=e.findObject('TEXT').stroke,t.model.setDataProperty(e.data,'isparent',i),r.newAdd=!0,t.model.addNodeData(r,t),t.isModified=!0,r}},{key:'addFollowerGround',value:function(){var e=this.diagram;if(0!=e.selection.count){var a=e.selection.first();if(1!=a.data.key&&a){var t=a.diagram;if(null!==a&&a instanceof go.Node&&!(a instanceof go.Group)){e.model.startTransaction('all'),'istemp'in a.data&&a.data.istemp&&(l(e),''==a.data.text&&e.model.setDataProperty(a.data,'text','')),e.startTransaction('sub1');var o=this.addLevelNodeData(a);e.commitTransaction('sub1'),this.groundLayout(e),e.model.commitTransaction('all');var i=t.findNodeForData(o);i&&t.select(i)}}}}},{key:'addLevelNodeData',value:function(e){var a=null==window.localStorage.getItem('isautolayout')||'true'==window.localStorage.getItem('isautolayout'),t=this.diagram,o=e.data.next,i=(t.model.nodeDataArray.length+1).toString(),r={key:i,text:p.trans('dce'),color:'yellow'};t.model.makeNodeDataKeyUnique(r),i=r.key;var d=null;if(o)var d=t.model.findNodeDataForKey(o);t.model.startTransaction(),r=s(r,t);return null!=d&&(r.next=d.key,t.model.setDataProperty(d,'prev',r.key)),r.level=e.data.level,r.radius=e.data.radius,r.fill=e.data.fill,r.dangle=e.data.dangle,r.dradius=e.data.dradius,r.sweep=e.data.sweep,r.layerThickness=e.data.layerThickness||100,r.tdDipanTextAngle=e.data.tdDipanTextAngle||'xuanzhuan',r.parent=e.data.parent,r.prev=e.data.key,r.strokeWidth=e.data.strokeWidth,r.stroke=e.data.stroke,r.font=e.data.font,r.textStroke=e.findObject('TEXT').stroke,e.data.figure&&(r.figure=e.data.figure),r.loc=e.data.loc,e.data.width&&(r.width=e.data.width),e.data.height&&(r.height=e.data.height),r.category=e.data.category,r.newAdd=!0,t.model.addNodeData(r),t.model.setDataProperty(e.data,'next',i),t.model.commitTransaction(),t.isModified=!0,r}},{key:'moveWithinNodes',value:function(e){var a=this.diagram,t=a.selection.first();if(t){if(!t)return void a.select(a.findNodeForKey(1));switch(e){case'left':if(t.data.prev){var o=a.findNodeForKey(t.data.prev);o&&a.select(o)}break;case'up':if(t.data.parent){var o=a.findNodeForKey(t.data.parent);o&&a.select(o)}break;case'right':if(t.data.next){var o=a.findNodeForKey(t.data.next);o&&a.select(o)}break;case'down':if(t.data.isparent){var o=a.findNodeForKey(t.data.isparent);o&&a.select(o)}}}}},{key:'selectText',value:function(a){var e=this.diagram,t=e.selection.first();if(t){var o=e.selection.first().findObject('TEXT');o&&e.commandHandler.editTextBlock(o),u.simulateEnterWithAlt(a)}}},{key:'groundLayout',value:function(e){function a(e,a){e.diagram.startTransaction('radial layout');var o=a.model.modelData.layerThickness||100,i=e.data.tdDipanTextAngle||'xuanzhuan';e.diagram.model.setDataProperty(e.data,'dangle',0),e.diagram.model.setDataProperty(e.data,'sweep',360),e.diagram.model.setDataProperty(e.data,'dradius',0),a.nodes.each(function(e){e.data._laid=!1}),e.location=new go.Point(0,0),m=s.getMaxCircle(a),t(e,1,90,360,o,i,a),e.diagram.commitTransaction('radial layout')}function t(e,o,r,d,l,c,g){s.addChildNodeData;try{var u=i(e)}catch(a){}e.data.key;if(!(3<=e.data.category)){var y=u.length;if(!(0===y&&e.data.level>=m)){if(0===y){var h=s.addChildNodeData(e,'temp'),k=g.findNodeForData(h);u.push(k),y++}for(var f=g.model.findNodeDataForKey(1),T=parseInt(f.layerThickness),x=T+(o-1)*l,b=d/y,S=0;S<y;S++){var v=u[S],w=r-d/2+b/2+S*b,P=new go.Point(x+l/2,0);if(v.data._laid){t(v,o+1,v.data.dangle,v.data.sweep,l,c,g);continue}P.rotate(w),v.diagram.model.setDataProperty(v.data,'loc',go.Point.stringify(P)),v.data._laid=!0,v.diagram.model.setDataProperty(v.data,'dangle',w),v.diagram.model.setDataProperty(v.data,'sweep',b),v.diagram.model.setDataProperty(v.data,'dradius',x),v.diagram.model.setDataProperty(v.data,'layerThickness',l);var p=v.findObject('TEXT');null!==p&&(p.angle=90<w&&270>w||-90>w?180:0,'xuanzhuan'==c&&v.diagram.model.setDataProperty(v.data,'textAngle',p.angle),'fangshe'==c&&v.diagram.model.setDataProperty(v.data,'textAngle',90),'zhengli'==c&&v.diagram.model.setDataProperty(v.data,'textAngle',-w)),'1'==v.data.key&&v.diagram.model.setDataProperty(v.data,'textAngle',0),t(v,o+1,w,d/y,l,c,g)}}}}function o(e){return e.model.modelData.layout?e.model.modelData.layout:'inner'}function i(e){try{if(!e.data.isparent)return[];var a=[],t;if(!e.data.isparent)return[];var o=e.diagram.findNodeForKey(e.data.isparent);if(t=o,t)for(a.push(o);t.data.next&&(t=e.diagram.findNodeForKey(t.data.next),!!t);)a.push(t);return a}catch(a){}}function r(o,i){null==o&&(o=i.findNodeDataForKey(1));var r=i.findNodeDataForKey(1),l=parseInt(r.layerThickness);i.nodeDataArray.forEach(function(e){e._laid=!1});var s=e.model.modelData.layerThickness,c=o.tdDipanTextAngle||'xuanzhuan',g=arguments[2]?arguments[2]:getMaxCircle(e),m=d(o,i,g),y=m.count;if(!(0>=y)){var h=360/y,k=i.nodeDataArray.length,f=[];if(o.isparent)var T=i.findNodeDataForKey(o.isparent);else return;u.tdTravelTdpData(T,i,f,function(e){return e});for(var x=1,b;x<=g;x++){b=_.filter(f,function(e){return!e.isGroup&&e.level==x});for(var S=0,v=0,w=l+(x-1)*s,P=0,B;P<b.length;P++){if(B=b[P],B._laid=!0,'1'==B.key){i.setDataProperty(n.data,'textAngle',0);continue}if(m=d(B,i,g),y=m.count,!(0>y)){if(0==y)var D=h;else var D=y*h;0==P&&(v=-90),S=v+D/2,v+=D;var N=S,A=new go.Point(w+s/2,0);A.rotate(N),i.setDataProperty(B,'loc',go.Point.stringify(A)),i.setDataProperty(B,'dangle',N),i.setDataProperty(B,'sweep',D),i.setDataProperty(B,'dradius',w),i.setDataProperty(B,'layerThickness',s);var p=90<N&&270>N||-90>N?180:0;if('xuanzhuan'==c&&i.setDataProperty(B,'textAngle',p),'fangshe'==c){var p=0<N&&180>N||-180>N?180:0;i.setDataProperty(B,'textAngle',90)}'zhengli'==c&&i.setDataProperty(B,'textAngle',-N)}}}g<this.getMaxCircle(e)&&t(e.findNodeForKey(1),1,90,360,s,c)}}function d(e,a,t,o){var i={count:0,list:[]},r=!1;try{if(1==e.key)a.nodeDataArray.forEach(function(e){r=o?e.level>=t:e.level==t,!_.has(e,'isGroup')&&r&&(i.count+=1,i.list.push(e))});else{if(e.isparent)var d=a.findNodeDataForKey(e.isparent);else return i;u.tdTravelTdpData(d,a,[],function(e){r=o?e.level>=t:e.level==t,!_.has(e,'isGroup')&&r&&(i.count+=1,i.list.push(e))})}}catch(a){return{count:0,list:[]}}return i}var e=this.diagram,l=e.findNodeForKey(1),s=this;if(l){l.location=new go.Point(0,0);var c=l.diagram;if(null!==c){l.data.category='Root';var g=o(e);if('out'==g){var m=this.getMaxCircle(e),p=e.model;u.tdTravelTdpData(l.data,p,[],function(a){if(a.level<m&&'undefined'==typeof a.isparent){var t=e.findNodeForKey(a.key);s.addChildNodeData(t,'temp')}}),changeLayout()}else'inner'==g?a(l,e):(splitLayer=e.model.modelData.splitLayer?e.model.modelData.splitLayer:splitLayer,r(null,e.model,splitLayer))}}}},{key:'dokeyDownFnq',value:function(a){var t=this.diagram,o=t.lastInput,e=t.commandHandler,i=t.selection.first();if(65<=o.event.keyCode&&90>=o.event.keyCode&&!o.event.altKey&&!o.event.ctrlKey&&!o.event.shiftKey)return o.bubbles=!1,this.selectText(o,a),!0;if(13===o.event.keyCode)i&&'Root'==i.data.category?this.addFollowerGround():i&&'dipan'==i.data.category&&this.addFollowerGround();else if(9===o.event.keyCode)i&&'Root'==i.data.category?this.addNewCircle():i&&'dipan'==i.data.category&&this.addNewCircle();else if('t'===o.key)e.canCollapseSubGraph()?e.collapseSubGraph():e.canExpandSubGraph()&&e.expandSubGraph();else if('Del'==o.key){if(0==t.selection.count)return;o.diagram.commandHandler.deleteSelection()}else 113==o.event.keyCode?this.selectText():37==o.event.keyCode?this.moveWithinNodes('left'):38==o.event.keyCode?this.moveWithinNodes('up'):39==o.event.keyCode?this.moveWithinNodes('right'):40==o.event.keyCode?this.moveWithinNodes('down'):go.CommandHandler.prototype.doKeyDown.call(e);o.bubbles=!1}},{key:'downloadImage',value:function(){var e=this.diagram,a=e.makeImageData({scale:1,background:'#ffffff',type:'image/png',maxSize:new go.Size(9e3,9e3)});return a}}]),a}(h);f.go=go,e.exports=f},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=t(4),s=t(7),c=t(2),g=t(5),m=t(3),p=t(6),u=function(e){function a(e,t){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t))}return r(a,e),d(a,[{key:'addNodeTemplate',value:function(){var e=this.diagram;e.nodeTemplateMap.add('0',s(this.diagram)),e.nodeTemplateMap.add('1',s(this.diagram)),e.nodeTemplateMap.add('2',s(this.diagram)),e.nodeTemplateMap.add('3',c(this.diagram)),e.nodeTemplateMap.add('4',g(this.diagram)),e.nodeTemplateMap.add('text',m(this.diagram)),e.nodeTemplateMap.add('',s(this.diagram)),e.nodeTemplateMap.add('8',p(this.diagram))}}]),a}(l);e.exports=u},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=t(4),s=t(7),c=t(2),g=t(5),m=t(3),p=t(6),u=function(e){function a(e,t){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t))}return r(a,e),d(a,[{key:'addNodeTemplate',value:function(){var e=this.diagram;e.nodeTemplateMap.add('0',s(this.diagram)),e.nodeTemplateMap.add('1',s(this.diagram)),e.nodeTemplateMap.add('2',s(this.diagram)),e.nodeTemplateMap.add('3',c(this.diagram)),e.nodeTemplateMap.add('4',g(this.diagram)),e.nodeTemplateMap.add('text',m(this.diagram)),e.nodeTemplateMap.add('',s(this.diagram)),e.nodeTemplateMap.add('8',p(this.diagram))}}]),a}(l);e.exports=u},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=t(4),s=t(7),c=t(2),g=t(5),m=t(3),p=t(6),u=function(e){function a(e,t){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t))}return r(a,e),d(a,[{key:'addNodeTemplate',value:function(){var e=this.diagram;e.nodeTemplateMap.add('0',s(this.diagram)),e.nodeTemplateMap.add('1',s(this.diagram)),e.nodeTemplateMap.add('2',s(this.diagram)),e.nodeTemplateMap.add('3',c(this.diagram)),e.nodeTemplateMap.add('4',g(this.diagram)),e.nodeTemplateMap.add('text',m(this.diagram)),e.nodeTemplateMap.add('',s(this.diagram)),e.nodeTemplateMap.add('8',p(this.diagram))}}]),a}(l);e.exports=u},function(e,a,t){'use strict';function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function d(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}function l(){return P(go.Node,'Vertical',{movable:!1,locationSpot:go.Spot.Bottom,location:new go.Point(0,0),angle:90,click:function(){},selectionAdornmentTemplate:function(){var e=go.GraphObject.make;return e(go.Adornment,'Spot',e(go.Panel,'Auto',e(go.Shape,{figure:'Linev',fill:'blue',stroke:'blue',strokeWidth:2}),e(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'blue',stroke:'blue',strokeWidth:0,alignment:new go.Spot(.5,0,0,0)}),e(go.Placeholder)))}(),contextMenu:h,mouseEnter:function(a,e){e.diagram},mouseLeave:function(a){a.diagram}},new go.Binding('angle','angle').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('selectable','selectable').makeTwoWay(),P(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'rgb(135,153,196)',stroke:'#8799c4',strokeWidth:0,strokeDashArray:[0,0]},new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('fill','stroke').makeTwoWay()),P(go.Shape,{name:'LINE',figure:'Linev',stroke:'#8799c4',strokeWidth:2,strokeDashArray:[4,2]},new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('strokeDashArray','strokeDashArray').makeTwoWay(),new go.Binding('geometryString','geometryString').makeTwoWay(),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay()))}function s(){return P(go.Node,'Vertical',{movable:!1,locationSpot:go.Spot.Bottom,location:new go.Point(0,0),click:function(){},selectionAdornmentTemplate:function(){var e=go.GraphObject.make;return e(go.Adornment,'Spot',e(go.Panel,'Auto',e(go.Shape,{figure:'Linev',fill:'rgba(255,0,120,0.2)',stroke:'blue',strokeWidth:2}),e(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'blue',stroke:'blue',strokeWidth:0,alignment:new go.Spot(.5,0,0,0)}),e(go.Placeholder)))}(),contextMenu:h,mouseEnter:function(a,e){e.diagram},mouseLeave:function(a){a.diagram}},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('selectable','selectable').makeTwoWay(),P(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'rgb(135,153,196)',stroke:'#8799c4',strokeWidth:0,strokeDashArray:[0,0]},new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('fill','stroke').makeTwoWay()),P(go.Shape,{name:'LINE',figure:'Linev',stroke:'#8799c4',strokeWidth:2,strokeDashArray:[4,2]},new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('strokeDashArray','strokeDashArray').makeTwoWay(),new go.Binding('geometryString','geometryString').makeTwoWay(),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay()))}function c(a){var e=go.GraphObject.make;return e(go.Node,'Vertical',{movable:!1,locationSpot:go.Spot.Bottom,location:new go.Point(0,0),angle:0,click:function(){},selectionAdornmentTemplate:function(){var e=go.GraphObject.make;return e(go.Adornment,'Spot',e(go.Panel,'Auto',e(go.Shape,{figure:'Linev',fill:'blue',stroke:'blue',strokeWidth:2}),e(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'blue',stroke:'blue',strokeWidth:2,alignment:new go.Spot(.5,0,0,0)}),e(go.Placeholder)))}(),mouseHover:function(){},mouseEnter:function(a,e){var t=e.diagram;t.model.setDataProperty(e.data,'stroke','blue'),t.model.setDataProperty(e.data,'fill','blue')},mouseLeave:function(t,e){var o=e.diagram;a.removeNodeRemarkTips(),o.model.setDataProperty(e.data,'stroke','#8799c4'),o.model.setDataProperty(e.data,'fill','#8799c4')}},new go.Binding('angle','angle').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),e(go.Shape,{geometry:go.Geometry.parse('M584.641736 896S299.62889 148.827862 0-128c0 0 413.707108 34.128461 584.641736 212.37111 0 0 163.261205-185.842992 584.641735-212.37111 0 0-486.056523 686.369398-584.641735 1024z',!0).rotate(180).scale(.0117,.0117),fill:'#8799c4',stroke:'#8799c4'},new go.Binding('fill','fill').makeTwoWay(),new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('strokeWidth','strokeWidth').makeTwoWay()),e(go.Shape,{name:'LINE',width:0,height:1e3,fill:'#8799c4',stroke:'#8799c4',strokeWidth:2},new go.Binding('height','height').makeTwoWay(),new go.Binding('fill','fill').makeTwoWay(),new go.Binding('stroke','stroke').makeTwoWay(),new go.Binding('strokeDashArray','strokeDashArray').makeTwoWay(),new go.Binding('strokeWidth','strokeWidth').makeTwoWay()))}function g(){var e=go.GraphObject.make,a;return e(go.Node,'Vertical',{movable:!1,selectionAdorned:!1,click:function(){}},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('locationSpot','dir',function(e){return m(e,!1)}),e(go.Panel,'Vertical',e(go.TextBlock,(a={name:'TEXT',alignment:new go.Spot(0,1),font:'14px \u5FAE\u8F6F\u96C5\u9ED1',width:70,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',editable:!0,isMultiline:!1,margin:0,stroke:'black'},o(a,'isMultiline',!0),o(a,'alignment',go.Spot.Right),o(a,'portId','TEXT'),o(a,'stretch',go.GraphObject.Fill),a),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay(),new go.Binding('margin','margin').makeTwoWay())))}function m(e){if('right'===e)return go.Spot.Right;return'top'===e?go.Spot.Top:void 0}function p(){var e=go.GraphObject.make,a={figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:1,stroke:'rgba(0,0,0,0)',fontSize:15,font:'sans-serif'};return e(go.Node,'Spot',{_controlExpand:!0,layerName:'Foreground',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,location:new go.Point(0,0),toMaxLinks:1,click:function(){},layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('isShadowed','isShadowed').makeTwoWay(),new go.Binding('angle','angle').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('layerName','layerName',function(e){return e?e:''}).makeTwoWay(function(e){return e}),e(go.Shape,{strokeDashArray:null,name:'SHAPE',figure:'Rectangle',fill:'rgba(0,0,0,0)',fromLinkable:!0,toLinkable:!0,cursor:'pointer',minSize:new go.Size(50,50),strokeWidth:2,stroke:'rgba(0,0,0,0)',portId:''},new go.Binding('strokeDashArray','strokeDashArray',function(e){return[e.split()[0],e.split()[1]]}).makeTwoWay(function(e){return e[0]+' '+e[1]}),new go.Binding('fill','fill',function(e){return e instanceof go.Brush?e.color:e}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('height','height',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke',function(e){return e instanceof go.Brush?e.stroke:e}).makeTwoWay(),new go.Binding('strokeWidth','strokeWidth',function(e){return e}).makeTwoWay(function(e){return e}),new go.Binding('figure','figure').makeTwoWay(),{figure:a.figure,fill:a.fill,strokeWidth:a.strokeWidth,stroke:a.stroke}),e(go.Shape,{name:'SHAPE_Back',figure:'Rectangle',fill:'rgba(0,0,0,0)',strokeWidth:0},new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('height','height',function(e){return e}).ofObject('SHAPE')),e(go.TextBlock,{name:'TEXT',alignment:new go.Spot(.5,.5),font:'bold 18px \u5E7C\u5706',editable:!0,stroke:'black',isMultiline:!0,overflow:go.TextBlock.OverflowClip,wrap:go.TextBlock.WrapDesiredSize,textAlign:'center',spacingAbove:4,spacingBelow:4,portId:'TEXT',stretch:go.GraphObject.Fill},new go.Binding('textAlign','textAlign',function(e){return _.contains(['start','center','end'],e)?e:'center'}).makeTwoWay(),new go.Binding('spacingAbove','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('spacingBelow','spacingline',function(e){return tdTransToNum(e,4)}).makeTwoWay(),new go.Binding('width','width',function(e){return e}).ofObject('SHAPE'),new go.Binding('text','text').makeTwoWay(),new go.Binding('stroke','textStroke').makeTwoWay(),new go.Binding('font','font').makeTwoWay()))}function u(a){var e=go.GraphObject.make;return e(go.Node,'Vertical',{movable:!1,locationSpot:go.Spot.Top,location:new go.Point(860,5),mouseHover:function(t,e){a.showNodeRemarkTips(t,e)},mouseLeave:function(){a.removeNodeRemarkTips()},click:function(a,e){void 0,void 0,0<+e.data.loc.split(' ')[1]?k(a):f(a)}},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),e(go.Shape,{figure:'LogicXor',stroke:'#8799c4',width:30,strokeWidth:2}))}function y(a){var t=a.diagram,o=a.diagram,i=o.lastInput,e=o.selection.first(),r=o.commandHandler;('Del'===i.key||8===i.event.keyCode)&&(void 0,T(i)),i.event.ctrlKey&&(89===i.event.keyCode&&(e&&'addtextTemplate'!==e.data.category||!e)&&k(i),88===i.event.keyCode&&(e&&'addtextTemplate'!==e.data.category||!e)&&f(i),i.bubbles=!1)}function h(){return P(go.Adornment,'Vertical',P('ContextMenuButton',P(go.TextBlock,'\u5220\u9664 DEl'),{click:function(a){T(a)}}),P('ContextMenuButton',P(go.TextBlock,'\u589E\u52A0 CTRL+X/Y'),{click:function(a,e){'0'===e.data.loc.split(' ')[1]&&'x'!==e.data.category?k(a):'0'===e.data.loc.split(' ')[0]&&'y'!==e.data.category&&f(a)}}))}function k(a){var e=a.diagram,t=e.selection.first(),o=e.model.nodeDataArray;var i=0,r=0,d='',s=260;o.forEach(function(a){if('y'===a.category&&(i=a.height-10),'x'===a.category&&(s=a.height+200,e.model.startTransaction('addheight'),e.model.setDataProperty(a,'height',s),e.model.commitTransaction('addheight')),'LogicXor'===a.category){var t=+a.loc.split(' ')[0];if(0<t){e.model.startTransaction(),e.model.setDataProperty(a,'loc',t+200+' 5'),e.model.commitTransaction()}}}),o.forEach(function(a){if('0'===a.loc.split(' ')[0]&&'addtextTemplate'!==a.category){var t=s-10;e.model.startTransaction('changel'),e.model.setDataProperty(a,'geometryString','M 0 0 L 0 '+t),e.model.commitTransaction('changel')}});var l='M 0 0 L 0 '+i;if(t&&('y'===t.data.category||'0'!==t.data.loc.split(' ')[0])&&'x'!==t.data.category&&'LogicXor'!==t.data.category&&'addtextTemplate'!==t.data.category)r=+t.data.loc.split(' ')[0]+200,d=r+' 0',o.forEach(function(a){if('LogicXor'!==a.category&&'addtextTemplate'!==a.category){var t=+a.loc.split(' ')[0];if(t>=r){t+=200;var o=t+' 0';e.model.startTransaction('changeloc'),e.model.setDataProperty(a,'loc',o),e.model.commitTransaction('changeloc')}}});else{var c=[];if(o.forEach(function(e){'0'!==e.loc.split(' ')[0]&&'LogicXor'!==e.category&&'addtextTemplate'!==e.category&&c.push(+e.loc.split(' ')[0])}),0===c.length)d='200 0';else{var g=_Mathmax.apply(null,c)+200;d=g+' 0'}}var m={key:S(),category:'yunpany',stroke:'#8799c4',geometryString:l,strokeDashArray:[4,2],loc:d},p={key:S(),category:'xtext',margin:10,textStroke:'#666666',text:'\u7EF4\u5EA6'+d.split(' ')[0]/200,loc:d,dir:'top'};e.model.startTransaction('addy'),e.model.addNodeData(m),e.model.addNodeData(p),e.model.commitTransaction('addy')}function f(a){var e=a.diagram,t=e.selection.first(),o=e.model.nodeDataArray,i=0,r=0,d='',s=260;o.forEach(function(a){if('x'===a.category&&(i=a.height-10),'y'===a.category&&(s=a.height+200,e.model.startTransaction('addheight'),e.model.setDataProperty(a,'height',s),e.model.commitTransaction('addheight')),'LogicXor'===a.category){var t=+a.loc.split(' ')[1];if(0>t){e.model.startTransaction(),e.model.setDataProperty(a,'loc','-20 '+(t-200)),e.model.commitTransaction()}}}),o.forEach(function(a){if('0'===a.loc.split(' ')[1]&&'addtextTemplate'!==a.category){var t=s-10;e.model.startTransaction('changel'),e.model.setDataProperty(a,'geometryString','M 0 0 L 0 '+t),e.model.commitTransaction('changel')}});var l='M 0 0 L 0 '+i;if(t&&('x'===t.data.category||'0'!==t.data.loc.split(' ')[1])&&'y'!==t.data.category&&'LogicXor'!==t.data.category&&'addtextTemplate'!==t.data.category)r=+t.data.loc.split(' ')[1]-200,d='0 '+r,o.forEach(function(a){if('LogicXor'!==a.category&&'addtextTemplate'!==a.category){var t=+a.loc.split(' ')[1];if(t<=r){t-=200;var o='0 '+t;e.model.startTransaction('changeloc'),e.model.setDataProperty(a,'loc',o),e.model.commitTransaction('changeloc')}}else;});else{var c=[];if(o.forEach(function(e){'0'!==e.loc.split(' ')[1]&&'LogicXor'!==e.category&&'addtextTemplate'!==e.category&&c.push(+e.loc.split(' ')[1])}),0===c.length)d='0 -200';else{var g=_Mathmin.apply(null,c)-200;d='0 '+g}}var m={key:S(),category:'yunpanx',stroke:'#8799c4',geometryString:l,strokeDashArray:[4,2],loc:d},p={key:S(),category:'ytext',text:'\u7EF4\u5EA6'+_Mathabs(+d.split(' ')[1]/200),textStroke:'#666666',loc:d,dir:'right'};e.model.startTransaction('addx'),e.model.addNodeData(m),e.model.addNodeData(p),e.model.commitTransaction('addx')}function T(a){var e=a.diagram,t=e.selection.first();if(t)if('yunpany'===t.data.category){var o=t.data.loc,i=+t.data.loc.split(' ')[0];e.model.nodeDataArray.forEach(function(a){'xtext'===a.category&&a.loc===o&&(e.model.startTransaction('delettext'),e.model.removeNodeData(t.data),e.model.removeNodeData(a),e.model.commitTransaction('delettext'))}),x(i,e)}else if('yunpanx'===t.data.category){var r=t.data.loc,d=+t.data.loc.split(' ')[1];e.model.nodeDataArray.forEach(function(a){'ytext'===a.category&&a.loc===r&&(e.model.startTransaction('delettext'),e.model.removeNodeData(a),e.model.removeNodeData(t.data),e.model.commitTransaction('delettext'))}),b(d,e)}else'ytext'!==t.data.category&&'xtext'!==t.data.category&&'LogicXor'!==t.data.category&&'x'!==t.data.category&&'y'!==t.data.category&&(e.model.startTransaction(),e.model.removeNodeData(t.data),e.model.commitTransaction())}function x(e,a){void 0,a.model.nodeDataArray.forEach(function(t){var o=+t.loc.split(' ')[0];if(o>e&&('yunpany'===t.category||'xtext'===t.category)){a.model.startTransaction('changea'),a.model.setDataProperty(t,'loc',o-200+' 0'),a.model.commitTransaction('changea')}if('x'===t.category){var i=t.height-200;a.model.startTransaction('cheight'),a.model.setDataProperty(t,'height',i),a.model.commitTransaction('cheight')}else if('yunpanx'===t.category){var r=NaN,d=(t.geometryString||'').split(' ');r=d[5]?+d[5]-200:+d[3]-200;var l=r+'';a.model.startTransaction('changea'),a.model.setDataProperty(t,'geometryString','M 0 0  L 0 '+l),a.model.commitTransaction('changea')}if('LogicXor'===t.category){var s=+t.loc.split(' ')[0];if(0<s){a.model.startTransaction(),a.model.setDataProperty(t,'loc',s-200+' 5'),a.model.commitTransaction()}}})}function b(e,a){void 0,a.model.nodeDataArray.forEach(function(t){var o=+t.loc.split(' ')[1];if(o<e&&('yunpanx'===t.category||'ytext'===t.category)){a.model.startTransaction('changea'),a.model.setDataProperty(t,'loc','0 '+(o+200)),a.model.commitTransaction('changea')}if('y'===t.category){var i=t.height-200;a.model.startTransaction('cheight'),a.model.setDataProperty(t,'height',i),a.model.commitTransaction('cheight')}else if('yunpany'===t.category){var r=NaN,d=(t.geometryString||'').split(' ');r=d[5]?+d[5]-200:+d[3]-200;var l=r+'';a.model.startTransaction('changea'),a.model.setDataProperty(t,'geometryString','M 0 0  L 0 '+l),a.model.commitTransaction('changea')}if('LogicXor'===t.category){var s=+t.loc.split(' ')[1];if(0>s){a.model.startTransaction(),a.model.setDataProperty(t,'loc','-20 '+(s+200)),a.model.commitTransaction()}}})}function S(){function e(){return(0|65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+'-'+e()+'-'+e()+'-'+e()+'-'+e()+e()+e()}var v=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),w=t(4),P=go.GraphObject.make,B=t(2),D=t(5),N=t(3),A=t(6),C=function(e){function a(e,t){i(this,a);var o=r(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t));return o.initDiagramYun(e,t),o}return d(a,e),v(a,[{key:'initDiagramYun',value:function(e,a){var t=this,o=this.diagram,i={contextMenu:this.getYunpanNodeContextMenu,"animationManager.isEnabled":!1};this.diagram.commandHandler.doKeyDown=function(){return y(t)};var r=Object.assign(i,a.diagramConfig);return this.diagram.setProperties(r),this.addNodeTemplate(),o}},{key:'addNodeTemplate',value:function(){var e=this,a=this.diagram;a.nodeTemplateMap.add('yunpanx',l(e)),a.nodeTemplateMap.add('yunpany',s(e)),a.nodeTemplateMap.add('y',c(e)),a.nodeTemplateMap.add('x',c(e)),a.nodeTemplateMap.add('ytext',g()),a.nodeTemplateMap.add('xtext',g()),a.nodeTemplateMap.add('LogicXor',u(e)),a.nodeTemplateMap.add('addtextTemplate',p())}}]),a}(w),W=null,O=null;e.exports=C},function(e,a,t){'use strict';function o(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function i(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function r(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}var d=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),l=t(4),s=t(7),c=t(2),g=t(5),m=t(3),p=t(6),u=function(e){function a(e,t){return o(this,a),i(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t))}return r(a,e),d(a,[{key:'addNodeTemplate',value:function(){var e=this,a=this.diagram;a.nodeTemplateMap.add('0',s(this.diagram)),a.nodeTemplateMap.add('1',s(this.diagram)),a.nodeTemplateMap.add('2',s(this.diagram)),a.nodeTemplateMap.add('3',c(this.diagram)),a.nodeTemplateMap.add('4',g(this.diagram)),a.nodeTemplateMap.add('text',m(this.diagram)),a.nodeTemplateMap.add('',s(this.diagram)),a.nodeTemplateMap.add('8',p(this.diagram))}}]),a}(l);e.exports=u},function(e,a,t){'use strict';function o(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function i(e,a){if(!(e instanceof a))throw new TypeError('Cannot call a class as a function')}function r(e,a){if(!e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return a&&('object'==typeof a||'function'==typeof a)?a:e}function d(e,a){if('function'!=typeof a&&null!==a)throw new TypeError('Super expression must either be null or a function, not '+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}function l(e,a,t){if(e.equals(a))return a;var o=new go.Point(0,0).subtract(e.copy()),i=a.copy().offset(o.x,o.y),r=i.rotate(t),d=r.copy().offset(-o.x,-o.y);return d}var s=function(){function e(e,a){for(var t=0,o;t<a.length;t++)o=a[t],o.enumerable=o.enumerable||!1,o.configurable=!0,'value'in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}return function(a,t,o){return t&&e(a.prototype,t),o&&e(a,o),a}}(),c=t(4),g=t(7),m=t(2),p=t(5),u=t(3),y=t(6),h=t(38),k=t(39),f=t(40),T=t(11),x=go.GraphObject.make,b=t(41),S=t(0),v=t(9).layoutWaveGroup,w=t(9).adjustTextAngle;t(42);var P=function(e){function a(e,t){i(this,a);var o=r(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e,t)),d=o,s={layout:x(go.Layout),initialContentAlignment:go.Spot.Center,initialAutoScale:go.Diagram.Uniform,initialDocumentSpot:go.Spot.Center,initialViewportSpot:go.Spot.Center,rotatingTool:new b,PartResized:function(a){var e=a.subject.part;if(e)if('waveGroup'==e.data.category){for(var t=400,o=400,i=e.findSubGraphParts().iterator,r=0,d,l,s,c;i.next();)c=i.value,'wave'==c.data.category&&(r+=1,s=c);var g=e.resizeObject.actualBounds,m=s.resizeObject.naturalBounds;d=5*(g.width-0)/3/r,d=3*(g.width-0)/(3*r+2),100>d&&(d=100),d>t&&(d=t),l=g.height,l>o&&(l=o),l>d&&(l=d),e.diagram.startTransaction(),e.diagram.model.setDataProperty(e.data,'oliveHeight',l),e.diagram.model.setDataProperty(e.data,'oliveWidth',d);var i=a.subject.part.findSubGraphParts().iterator;for(v(i,e.diagram,a.subject.part),i.reset();i.next();)i.value.updateTargetBindings();e.diagram.commitTransaction(),setTimeout(function(){a.subject.part.layout.isOngoing=!0,a.subject.part.layout.isValidLayout=!1},100)}else'autoText'===e.data.category&&(a.diagram.startTransaction('resize'),a.diagram.model.setDataProperty(e.data,'width',a.subject.width),a.diagram.model.setDataProperty(e.data,'nwidth',!0),a.diagram.commitTransaction('resize'))},SelectionMoved:function(a){try{var e=a.subject.first();if(!e)return;if('wave'==e.data.category&&e.containingGroup&&(e.containingGroup.layout.isValidLayout=!1),'autoText'==e.data.category){if('shiText'==e.data.role||'xuText'==e.data.role){if(e.diagram.startTransaction(),!e.__location){var t=e.diagram.findNodeForKey(e.data.olive),o=e.containingGroup;if(t){var i=o.location.copy().offset(o.data.oliveWidth*(t.data.order-1),0);e.__location=i.copy().offset(t.naturalBounds.width/2,0),e.__location=l(o.location,e.__location,t.angle)}}e.__location&&(e.__offset=0==e.data.order%2?e.__location.copy().subtract(e.location):e.__location.copy().subtract(e.location),delete e.__oldOrder),delete e.__oldLocation,''!=e.data.text.trim()&&(e.data.nloc=!0,e.diagram.model.setDataProperty(e.data,'nloc',!0)),e.diagram.commitTransaction()}e.containingGroup&&('yunGroup'==e.containingGroup.data.category||'yunpanGroup'==e.containingGroup.data.category)&&(e.containingGroup.__trtdNode.snapToGrid(e.data,e.containingGroup),e.containingGroup.layout.isValidLayout=!1)}'shapeText'==e.data.category&&e.containingGroup&&'yunpanGroup'==e.containingGroup.data.category&&(e.containingGroup.__trtdNode.snapToGrid(e.data,e.containingGroup),e.containingGroup.layout.isValidLayout=!1)}catch(e){}},click:function(a){d.clearAllTextBorder(),localStorage.setItem('TRTD_documentPoint',go.Point.stringify(a.documentPoint))}};return o.diagram.setProperties(s),o.diagram.commandHandler.doKeyDown=function(a){o.dokeyDownFn(a)},o.diagram.commandHandler.canCopySelection=function(){var e=d.diagram.selection.first();if(e)return'axisGroup'==e.data.category||'yunGroup'==e.data.category;var a=this.diagram.commandHandler;return go.CommandHandler.prototype.canCopySelection.call(a)},o.diagram.commandHandler.pasteFromClipboard=function(){for(var e=go.CommandHandler.prototype.pasteFromClipboard.call(this),a=e.iterator,t=[],o=[],i=[],r=[],d=null,l;a.next();){if(l=a.value,'shiText'==l.data.role){t.push(l);continue}if('xuText'==l.data.role){o.push(l);continue}if('centerText'==l.data.role){r.push(l);continue}if('wave'==l.data.category&&'waveTail'!=l.data.role){i.push(l);continue}'waveGroup'==l.data.category&&(d=l)}return d?(i=i.sort(function(e,a){return+e.data.order-+a.data.order}),t.sort(function(e,a){return+e.data.order-+a.data.order}),o.sort(function(e,a){return+e.data.order-+a.data.order}),r.sort(function(e,a){return+e.data.order-+a.data.order}),i.forEach(function(e,a){e.data.shiText=t[a].data.key,e.data.xuText=o[a].data.key,e.data.centerText=r[a].data.key,t[a].data.olive=e.data.key,o[a].data.olive=e.data.key}),e):(e=new go.Set(go.Part),e)},o.diagram.commandHandler.deleteSelection=function(){return o.deleteSelection()},o.diagram.toolManager.resizingTool.computeReshape=function(){return'shapeText'!=this.adornedObject.part.data.category&&void go.TextEditingTool.prototype.doCancel.call(this)},o.diagram.toolManager.textEditingTool.doCancel=function(){var e=this;try{if(this.textBlock)var a=this.textBlock.part}catch(a){}setTimeout(function(){try{if(a&&'wave'==a.data.category&&a.containingGroup&&'horizontal'==a.containingGroup.data.textAngle&&'independent'==a.containingGroup.data.centerTextAngle){a.findObject('TEXT').visible=!1;var e=a.diagram.findNodeForKey(a.data.centerText);e&&(e.visible=!0)}}catch(a){}},100),go.TextEditingTool.prototype.doCancel.call(e)},o.diagram.toolManager.resizingTool.computeReshape=function(){return'pic'!=this.adornedObject.part.data.category},window.TextEditor&&(o.diagram.toolManager.textEditingTool.defaultTextEditor=window.TextEditor),o.diagram.toolManager.clickCreatingTool.archetypeNodeData={category:'autoText',font:'18px \'Microsoft YaHei\'',text:'\u7A7A\u767D\u6587\u672C',level:0},o.diagram.groupTemplateMap.add('waveGroup1',x(go.Group,'Spot',{selectionObjectName:'SHAPE'},{locationObjectName:'SHAPE',locationSpot:go.Spot.Center},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),{rotatable:!0},new go.Binding('angle','angle',function(e){return e}).makeTwoWay(function(e){return e}),{resizable:!0,resizeObjectName:'SHAPE'},x(go.Panel,'Vertical',x(go.TextBlock,{font:'bold 12pt sans-serif'},new go.Binding('text','key')),x(go.Shape,{name:'SHAPE',fill:'transparent'},new go.Binding('desiredSize','desiredSize',go.Size.parse).makeTwoWay(go.Size.stringify))))),o}return d(a,e),s(a,[{key:'addNodeTemplate',value:function(){var e=this.diagram;e.nodeTemplateMap.add('0',g(this.diagram)),e.nodeTemplateMap.add('1',g(this.diagram)),e.nodeTemplateMap.add('2',g(this.diagram)),e.nodeTemplateMap.add('3',m(this.diagram)),e.nodeTemplateMap.add('4',p(this.diagram)),e.nodeTemplateMap.add('text',u(this.diagram)),e.nodeTemplateMap.add('',g(this.diagram)),e.nodeTemplateMap.add('8',y(this.diagram)),e.nodeTemplateMap.add('9',h(this.diagram)),e.nodeTemplateMap.add('line',k(this.diagram)),e.nodeTemplateMap.add('wave',T('wave',{diagram:e}).getNodeTemplate()),e.nodeTemplateMap.add('iconText',T('iconText',{diagram:e}).getNodeTemplate()),e.nodeTemplateMap.add('pic',T('pic',{diagram:this.diagram}).getNodeTemplate()),e.nodeTemplateMap.add('shape',T('shape',{diagram:this.diagram}).getNodeTemplate()),e.nodeTemplateMap.add('autoText',T('autoText',{diagram:e}).getNodeTemplate()),e.nodeTemplateMap.add('shapeText',T('shapeText',{diagram:e}).getNodeTemplate()),e.groupTemplateMap.add('labelGroup',T('labelGroup',{diagram:e}).getNodeTemplate()),e.groupTemplateMap.add('picGroup',T('picGroup',{diagram:e}).getNodeTemplate()),e.groupTemplateMap.add('waveGroup',T('waveGroup',{diagram:this.diagram}).getNodeTemplate()),e.groupTemplateMap.add('axisGroup',T('axisGroup',{diagram:this.diagram}).getNodeTemplate()),e.groupTemplateMap.add('yunGroup',T('yunGroup',{diagram:this.diagram}).getNodeTemplate()),e.groupTemplateMap.add('yunpanGroup',T('yunpanGroup',{diagram:this.diagram}).getNodeTemplate())}},{key:'deleteSelection',value:function(e){var a=this.diagram.commandHandler;e||(e=this.diagram.selection.first());var t=null,o,i,r;if(e&&e.canDelete()&&('yunGroup'!=e.data.category||e.data.deletable)){this.diagram.startTransaction('deleteSelection1');var d=0;if(e){if('axisGroup'==e.data.category){for(var l=e.findSubGraphParts().iterator,s;l.next();)s=l.value,this.diagram.model.removeNodeData(s.data);this.diagram.model.removeNodeData(e.data)}if('wave'==e.data.category&&e.containingGroup){for(var l=e.containingGroup.findSubGraphParts().iterator,s;l.next();)s=l.value,'wave'==s.data.category&&'waveTail'!=s.data.role&&(s.data.order==e.data.order+1&&(t=s),d++),'shiText'==s.data.role&&s.data.order==e.data.order&&(o=s),'xuText'==s.data.role&&s.data.order==e.data.order&&(i=s),'centerText'==s.data.role&&s.data.order==e.data.order&&(r=s);if(1>=d)return void this.diagram.commitTransaction('deleteSelection1');e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1,e.containingGroup.containingGroup&&(e.containingGroup.containingGroup.layout.isOngoing=!0,e.containingGroup.containingGroup.layout.isValidLayout=!1)}if('autoText'==e.data.category&&'dimText'==e.data.subRole&&e.containingGroup&&'yunpanGroup'==e.containingGroup.data.category){var l=e.containingGroup.findSubGraphParts().iterator,c=[],g=[],m='X',p='Y',u='verticalLine';for(0==e.data.dimX&&(m='Y',p='X',u='horizontalLine');l.next();){var s=l.value;'dimText'==s.data.subRole&&0==s.data['dim'+p]&&d++,'yunpanText'==s.data.subRole&&s.data['order'+m]==e.data['dim'+m]&&c.push(s.data),'line'==s.data.category&&s.data.role==u&&s.data.order==e.data['dim'+m]&&g.push(s.data)}if(1>=d)return void this.diagram.commitTransaction('deleteSelection1');for(l.reset();l.next();){var s=l.value;'dimText'==s.data.subRole&&0==s.data['dim'+p]&&s.data['dim'+m]>e.data['dim'+m]&&s.diagram.model.setDataProperty(s.data,'dim'+m,s.data['dim'+m]-1),'yunpanText'==s.data.subRole&&s.data['order'+m]>e.data['dim'+m]&&s.diagram.model.setDataProperty(s.data,'order'+m,s.data['order'+m]-1),'line'==s.data.category&&s.data.role==u&&s.data.order>e.data['dim'+m]&&s.diagram.model.setDataProperty(s.data,'order',s.data.order-1)}e.diagram.model.removeNodeDataCollection(g),e.diagram.model.removeNodeDataCollection(c),e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1}}i&&this.diagram.model.removeNodeData(i.data),o&&this.diagram.model.removeNodeData(o.data),r&&this.diagram.model.removeNodeData(r.data),go.CommandHandler.prototype.deleteSelection.call(a),this.diagram.commitTransaction('deleteSelection1'),t&&this.diagram.select(t)}}},{key:'layoutLabelGroup',value:function(){var e=this;setTimeout(function(){for(var a=e.diagram.nodes.iterator,t;a.next();)t=a.value,'labelGroup'==t.data.category&&(t.layout.isOngoing=!0,t.layout.isValidLayout=!1)},200)}},{key:'layoutAllGroup',value:function(){for(var e=this.diagram.nodes.iterator,a;e.next();)a=e.value,!0==a.data.isGroup&&(a.layout.isOngoing=!0,a.layout.isValidLayout=!1)}},{key:'splitOlive2Half',value:function(){var e=this.diagram,a=e.selection.first();if(a&&'wave'==a.data.category&&1!=a.data.order&&a.containingGroup){this.diagram.startTransaction('splitOlive2Half'),a.containingGroup.layout.isOngoing=!0,a.containingGroup.layout.isValidLayout=!1;var t=this.addAxisGroup({emptyAxis:!0});if(!t)return void this.diagram.commitTransaction('splitOlive2Half');for(var o=0,i;o<t.length;o++)if('waveGroup'==t[o].category){i=t[o];break}if(!i)return void this.diagram.commitTransaction('splitOlive2Half');for(var r=a.data.order,d=a.containingGroup.findSubGraphParts().iterator,l=[],s;d.next();)s=d.value,'wave'==s.data.category&&s.data.order>=r&&'waveTail'!=s.data.role&&l.push(s);for(var o=0;o<l.length;o++){this.diagram.model.setDataProperty(l[o].data,'group',i.key);var c=this.diagram.model.findNodeDataForKey(l[o].data.shiText),g=this.diagram.model.findNodeDataForKey(l[o].data.centerText),m=this.diagram.model.findNodeDataForKey(l[o].data.xuText);c&&this.diagram.model.setDataProperty(c,'group',i.key),g&&this.diagram.model.setDataProperty(g,'group',i.key),m&&this.diagram.model.setDataProperty(m,'group',i.key)}this.diagram.commitTransaction('splitOlive2Half')}}},{key:'splitOlive2Cbian',value:function(){var e=this.diagram,a=e.selection.first();if(a&&'wave'==a.data.category){this.diagram.startTransaction('splitOlive2Cbian');var t=this.diagram.model.findNodeDataForKey(a.data.shiText),o=this.diagram.model.findNodeDataForKey(a.data.centerText),i=this.diagram.model.findNodeDataForKey(a.data.xuText),r={shiText:t.text,centerText:o.text,xuText:i.text,basePoint:a.location.copy().offset(0,-300),group:a.data.group};this.deleteSelection(a),this.addCbian(r),this.diagram.commitTransaction('splitOlive2Cbian')}}},{key:'addCbian',value:function(a){var t=this.diagram,o=t.selection.first(),i=null;o&&'axisGroup'==o.data.category&&(i=o.data.key);var r=t.lastInput;t.startTransaction('addCbian');var e=S.guid();if(a&&a.basePoint)var d=a.basePoint;else var d=r.documentPoint;var l={category:'picGroup',role:'cbian',isGroup:!0,level:0,key:e,loc:go.Point.stringify(d),deletable:!0};i&&(l.group=i),a&&a.group&&(l.group=a.group);var s={group:e,text:'',resizable:!1,category:'pic',loc:go.Point.stringify(d),picture:'https://static.365trtd.com/system/cbian/cbian.png',width:150,height:150},c={text:'\u603B\u7ED3',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(d.copy().offset(3,-3)),movable:!0,group:e},g={text:'\u65F6\u95F4',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(d.copy().offset(150,0)),movable:!0,group:e},m={text:'\u80FD\u91CF',deletable:!0,fill:'black',iconVisible:!1,locationSpot:'1 0 0 0',textAlign:'center',category:'autoText',loc:go.Point.stringify(d.copy().offset(0,-150)),movable:!0,group:e},p={text:'\u603B\u7ED31',deletable:!0,textStroke:'#0e399d',iconVisible:!1,locationSpot:'0 0 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(d.copy().offset(155*_Mathcos(30*_MathPI/180),-150*_Mathsin(30*_MathPI/180))),movable:!0,group:e},u={text:'\u603B\u7ED33',deletable:!0,textStroke:'#FFC000',iconVisible:!1,locationSpot:'0 0.5 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(d.copy().offset(145*_Mathcos(45*_MathPI/180),-150*_Mathsin(45*_MathPI/180))),movable:!0,group:e},y={text:'\u603B\u7ED32',deletable:!0,textStroke:'#cb1c27',iconVisible:!1,locationSpot:'0 1 0 0',textAlign:'left',category:'autoText',loc:go.Point.stringify(d.copy().offset(145*_Mathcos(70*_MathPI/180),-140*_Mathsin(70*_MathPI/180))),movable:!0,group:e};a&&(p.text=a.shiText,u.text=a.centerText,y.text=a.xuText),t.model.addNodeData(p),t.model.addNodeData(u),t.model.addNodeData(y),t.model.addNodeData(c),t.model.addNodeData(g),t.model.addNodeData(m),t.model.addNodeData(s),t.model.addNodeData(l),t.commitTransaction('addCbian')}},{key:'adjustTextAngle',value:function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];w(a)}},{key:'addOlive',value:function(e,a){var t=this.diagram;if(e||(e=t.selection.first()),!!e){for(var o=0,i=e.containingGroup.findSubGraphParts().iterator,r=e.containingGroup.data.oliveWidth,d;i.next();)d=i.value,'wave'==d.data.category&&o++;var l=50;if(null!=e.containingGroup.data.maxOlive&&(l=e.containingGroup.data.maxOlive),!(o>l)){var s=this.diagram.findNodeForKey(e.data.shiText),c=this.diagram.findNodeForKey(e.data.xuText);t.startTransaction('dspiral');var g=1e3;null!=e.data.order&&(g=+e.data.order+.5);var m=JSON.parse(JSON.stringify(e.data));Object.assign(m,{key:S.guid(),order:g,text:''}),a&&(m.text=a.centerText),delete m.centerText,delete m.__gohashid,delete m.hyperlink,delete m.figure,delete m.remark;var p=JSON.parse(JSON.stringify(s.data));delete p.__gohashid,delete p.textAlign,delete p.hyperlink,delete p.figure,delete p.remark,delete p.nloc,Object.assign(p,{key:S.guid(),order:g,olive:m.key,text:''}),a&&(p.text=a.shiText);var u=JSON.parse(JSON.stringify(c.data));delete u.__gohashid,delete u.textAlign,delete u.hyperlink,delete u.figure,delete u.remark,delete u.nloc,Object.assign(u,{key:S.guid(),order:g,olive:m.key,text:''}),a&&(u.text=a.xuText),m.shiText=p.key,m.xuText=u.key,e.containingGroup&&(e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1,e.containingGroup.containingGroup&&(e.containingGroup.containingGroup.layout.isOngoing=!0,e.containingGroup.containingGroup.layout.isValidLayout=!1)),m.isNew=!0,t.model.addNodeData(m),t.model.addNodeData(p),t.model.addNodeData(u),t.commitTransaction('dspiral')}}}},{key:'getAxisGroupData',value:function(a){var t=this.diagram.lastInput,e=t.documentPoint,o=go.Point.stringify(e),i=S.guid(),r=S.guid(),d=S.guid(),l=S.guid(),s=S.guid(),c=S.guid(),g=S.guid(),m=S.guid(),p=S.guid(),u=S.guid(),y=S.guid(),h=S.guid(),k=S.guid(),f=S.guid(),T=S.guid(),x=S.guid(),b=S.guid(),v=S.guid(),w=S.guid(),P=[{category:'labelGroup',group:i,role:'labelGroup',isGroup:!0,level:0,key:r,loc:go.Point.stringify(e.copy().offset(30,700)),deletable:!1,selectable:!1},{category:'waveGroup',maxOlive:15,deletable:!1,haveTail:!0,oliveType:'Wave',shiStroke:'#0e399d',xuStroke:'#cb1c27',centerStroke:'rgba(9, 166, 9, 1)',oliveWidth:150,oliveHeight:120,isGroup:!0,level:0,key:d,loc:o,angle:330.08938180947,group:i,movable:!1,desiredSize:'700 120',textAngle:'horizontal',centerTextAngle:'independent',centerTextMode:'independent'},{category:'axisGroup',isGroup:!0,level:0,key:i,loc:o,angle:0,desiredSize:'300 150'},{category:'line',level:0,key:-11,loc:o,desiredSize:'700 1',width:1400,height:1,group:d,angle:330.08938180947,role:'centerLine',selectable:!1,stroke:'rgba(9, 166, 9, 1)'},{category:'line',level:0,key:-8,loc:'-91.91674008334496 -140.02427812707117',desiredSize:'606.7630471788291 10',width:1400,height:1,angle:0,group:i,role:'axisX',selectable:!1,stroke:'#0e399d'},{category:'line',level:0,key:-7,loc:'-91.91674008334496 -140.02427812707117',desiredSize:'349.05387059630493 10',width:1400,height:1,angle:270,group:i,role:'axisY',selectable:!1,stroke:'#cb1c27'},{text:'\u80FD\u91CF',deletable:!1,font:'24px \'Microsoft YaHei\'',category:'autoText',loc:'-101.91674008334496 -489.0781487233761',key:-12,role:'axisYText',locationSpot:'1 0.5 0 0',group:i,movable:!0},{text:'\u4E3B\u9898',role:'themeText',deletable:!1,font:'24px \'Microsoft YaHei\'',category:'autoText',loc:go.Point.stringify(e.copy().offset(-30,0)),key:-13,level:0,group:i,locationSpot:'0.5 0 0 0',movable:!0,width:300},{text:'\u65F6\u95F4',deletable:!1,font:'24px \'Microsoft YaHei\'',category:'autoText',loc:'514.8463070954841 -140.02427812707117',key:-14,role:'axisXText',group:i,locationSpot:'0.5 0 0 0'},{text:'\u5B9E\u7EBF\uFF1A',deletable:!1,fill:'#cb1c27',iconVisible:!0,locationSpot:'0 0 0 0',textAlign:'start',category:'autoText',loc:go.Point.stringify(e.copy().offset(30,-350)),role:'labelText1',movable:!0,group:r,visible:!0,minSize:'120 30'},{text:'\u865A\u7EBF\uFF1A',deletable:!1,fill:'#0e399d',iconVisible:!0,locationSpot:'0 0 0 0',textAlign:'start',category:'autoText',loc:go.Point.stringify(e.copy().offset(30,-310)),role:'labelText2',movable:!0,group:r,visible:!0,minSize:'120 30'},{text:'\u4E2D\u7EBF\uFF1A',deletable:!1,fill:'#3f5369',iconVisible:!0,locationSpot:'0 0 0 0',textAlign:'start',category:'autoText',loc:go.Point.stringify(e.copy().offset(30,-270)),role:'labelText3',movable:!0,group:r,visible:!0,minSize:'120 30'},{category:'wave',text:'',role:'waveTail',deletable:!1,selectable:!1,level:0,key:'2d6ff2f1-0966-36bf-4e85-f5775ca0652b',group:d,loc:'710.0826118675676 -829.1890319396903',desiredSize:'75 120',order:999,oliveType:'Wave',angle:330.08938180947,textAlign:'center',shiStroke:'#0e399d',xuStroke:'#cb1c27',centerText:'df53d882-fe51-d78e-d8e3-8d9681578cb8',textVisible:!1,isNew:null}];return a||(P=P.concat([{category:'wave',text:'1\n',level:0,key:l,group:d,desiredSize:'150 120',order:1,shiText:m,xuText:p,angle:330.08938180947,loc:'-91.91674008334496 -140.02427812707123',oliveType:'Ellipse',textAlign:'center',shiStroke:'#cb1c27',xuStroke:'#0e399d',centerText:x,textVisible:!1},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:m,width:150,role:'shiText',level:0,group:d,order:1,olive:l,loc:'4.128618140465704 -125.47989214278559',locationSpot:'0 0 0 0',textStroke:'#cb1c27',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:p,width:150,role:'xuText',level:0,group:d,order:1,olive:l,loc:'-56.2078366340385 -230.36321886941172',locationSpot:'1 1 0 0',textStroke:'#0e399d',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{category:'wave',text:'3\n',level:0,key:s,group:d,desiredSize:'150 120',order:3,shiText:u,xuText:y,angle:330.08938180947,loc:'168.12456585043884 -289.61879409691636',oliveType:'Ellipse',textAlign:'center',shiStroke:'#cb1c27',xuStroke:'#0e399d',centerText:b,textVisible:!1},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:u,width:150,role:'shiText',level:0,group:d,order:3,olive:s,loc:'264.16992407424954 -275.07440811263075',locationSpot:'0 0 0 0',textStroke:'#cb1c27',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:y,width:150,role:'xuText',level:0,group:d,order:3,olive:s,loc:'203.83346929974533 -379.9577348392569',locationSpot:'1 1 0 0',textStroke:'#0e399d',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{category:'wave',text:'2\n',level:0,key:c,group:d,desiredSize:'150 120',order:2,shiText:h,xuText:k,angle:330.08938180947,loc:'38.10391288354694 -214.8215361119938',oliveType:'Ellipse',textAlign:'center',shiStroke:'#cb1c27',xuStroke:'#0e399d',centerText:v,textVisible:!1},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:h,width:150,role:'shiText',level:0,group:d,order:2,olive:c,loc:'73.8128163328534 -305.1604768543343',locationSpot:'1 1 0 0',textStroke:'#cb1c27',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:k,width:150,role:'xuText',level:0,group:d,order:2,olive:c,loc:'134.1492711073576 -200.27715012770815',locationSpot:'0 0 0 0',textStroke:'#0e399d',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{category:'wave',text:'4\n',level:0,key:g,group:d,desiredSize:'150 120',order:4,shiText:f,xuText:T,angle:330.08938180947,loc:'298.1452188173308 -364.41605208183887',oliveType:'Ellipse',textAlign:'center',shiStroke:'#cb1c27',xuStroke:'#0e399d',centerText:w,textVisible:!1},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:f,width:150,role:'shiText',level:0,group:d,order:4,olive:g,loc:'333.8541222666372 -454.7549928241794',locationSpot:'1 1 0 0',textStroke:'#cb1c27',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{deletable:!1,text:'',font:'18px \'Microsoft YaHei\'',category:'autoText',key:T,width:150,role:'xuText',level:0,group:d,order:4,olive:g,loc:'394.1905770411414 -349.87166609755326',locationSpot:'0 0 0 0',textStroke:'#0e399d',showBorder:!0,angle:0,minSize:'120 30',textAlign:'center'},{text:'1\n',minSize:'120 30',deletable:!1,textAlign:'center',font:'18px \'Microsoft YaHei\'',category:'autoText',key:x,width:120,role:'centerText',level:0,group:d,order:1,visible:!0,layerName:'Foreground',locationSpot:'0.5 0.5 0 0',selectable:!1,olive:l,loc:'-26.039609246786398 -177.92155550609866',angle:0},{text:'2\n',minSize:'120 30',deletable:!1,textAlign:'center',font:'18px \'Microsoft YaHei\'',category:'autoText',key:v,width:120,role:'centerText',level:0,group:d,order:2,visible:!0,layerName:'Foreground',locationSpot:'0.5 0.5 0 0',selectable:!1,olive:c,loc:'103.9810437201055 -252.71881349102122',angle:0},{text:'3\n',minSize:'120 30',deletable:!1,textAlign:'center',font:'18px \'Microsoft YaHei\'',category:'autoText',key:b,width:120,role:'centerText',level:0,group:d,order:3,visible:!0,layerName:'Foreground',locationSpot:'0.5 0.5 0 0',selectable:!1,olive:s,loc:'234.00169668699743 -327.5160714759438',angle:0},{text:'4\n',minSize:'120 30',deletable:!1,textAlign:'center',font:'18px \'Microsoft YaHei\'',category:'autoText',key:w,width:120,role:'centerText',level:0,group:d,order:4,visible:!0,layerName:'Foreground',locationSpot:'0.5 0.5 0 0',selectable:!1,olive:g,loc:'364.0223496538893 -402.3133294608663',angle:0}])),P}},{key:'addAxisGroup',value:function(e){for(var a=this.diagram,t=0,o=0;o<a.model.nodeDataArray.length;o++)'axisGroup'==a.model.nodeDataArray[o].category&&(t+=1);if(!(13<t)){var i=this.getAxisGroupData(e);if(i){a.startTransaction('dspiral');for(var o=0;o<i.length;o++)a.model.addNodeData(i[o]);return a.commitTransaction('dspiral'),i}}}},{key:'selectText',value:function(a){var e=this.diagram,t=e.selection.first();if(t){var o=e.selection.first().findObject('TEXT');if(o&&e.commandHandler.editTextBlock(o),!S.checkPhone())S.simulateEnterWithAlt(a);else{var i=e.currentTool.currentTextEditor.mainElement.value;e.currentTool.currentTextEditor.mainElement.selectionStart=i.length,e.currentTool.currentTextEditor.mainElement.selectionEnd=i.length}}}},{key:'clearAllTextBorder',value:function(){for(var e=this.diagram.nodes.iterator,a;e.next();)a=e.value,'autoText'==a.data.category&&(a.findObject('textBorder').visible=!1)}},{key:'apiSwitchWaveTail',value:function(){var e=this.diagram.selection.first();if(e){this.diagram.startTransaction();for(var a=e.findSubGraphParts().iterator,t=null,i=null,r,d;a.next();)if(d=a.value,i=d,'waveTail'==d.data.role){t=d;break}if(r=i?i.data.loc:e.data.loc,t)this.diagram.model.removeNodeData(t.data),this.diagram.model.setDataProperty(e.data,'haveTail',!1);else{var l;this.diagram.model.setDataProperty(e.data,'haveTail',!0);var s=(l={category:'wave',text:'',role:'waveTail',deletable:!1,selectable:!1},o(l,'deletable',!1),o(l,'level',0),o(l,'key',S.guid()),o(l,'group',e.data.key),o(l,'loc',r),o(l,'desiredSize',e.data.oliveWidth+' '+e.data.oliveHeight),o(l,'order',2e3),l);this.diagram.model.addNodeData(s)}e.layout.isOngoing=!0,e.layout.isValidLayout=!1,this.diagram.commitTransaction()}}},{key:'apiSwitchToEllipse',value:function(){var e=this.diagram.selection.first();if(e){this.diagram.startTransaction(),this.diagram.model.setDataProperty(e.data,'oliveType','Ellipse');for(var a=e.findSubGraphParts().iterator,t=null,o;a.next();)if(o=a.value,'waveTail'==o.data.role){t=o;break}t&&this.diagram.model.removeNodeData(t.data),e.layout.isOngoing=!0,e.layout.isValidLayout=!1,e.containingGroup&&(e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1),this.diagram.commitTransaction()}}},{key:'apiSwitchToWave',value:function(){var e=this.diagram.selection.first();if(e){this.diagram.startTransaction('apiSwitchToWave'),this.diagram.model.setDataProperty(e.data,'oliveType','Wave');for(var a=e.findSubGraphParts().iterator,t=null,i=null,r=e.data.haveTail,d,l;a.next();)if(l=a.value,i=l,'waveTail'==l.data.role){t=l;break}if(d=i?i.data.loc:e.data.loc,!t&&!0==r){var s=(c={category:'wave',text:'',role:'waveTail',deletable:!1,selectable:!1},o(c,'deletable',!1),o(c,'level',0),o(c,'key',S.guid()),o(c,'group',e.data.key),o(c,'loc',d),o(c,'desiredSize',e.data.oliveWidth+' '+e.data.oliveHeight),o(c,'order',2e3),c),c;this.diagram.model.addNodeData(s)}e.layout.isOngoing=!0,e.layout.isValidLayout=!1,e.containingGroup&&(e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1),this.diagram.commitTransaction('apiSwitchToWave')}}},{key:'apiSwitchTextAngle',value:function(e){var a=this.diagram.selection.first();if(a){a.diagram.startTransaction('apiSwitchTextAngle'),e&&-1<['horizontal','vertical'].indexOf(e)?(a.diagram.model.setDataProperty(a.data,'textAngle',e),a.data.textAngle=e):(e={horizontal:'vertical',vertical:'horizontal'}[a.data.textAngle]||'horizontal',a.diagram.model.setDataProperty(a.data,'textAngle',e),a.data.textAngle=e),a.layout.isOngoing=!0,a.layout.isValidLayout=!1,a.diagram.commitTransaction('apiSwitchTextAngle')}}},{key:'getDefaultCustomMenuDivStr',value:function(){return'\n        <ul>\n            <li trtd_action="drillAnalyze"><a class="i18n" data-lang="cancelfix">\u63D2\u5165\u5B50\u76D8</a></li>\n            <li trtd_action="addFollower"><a class="i18n" data-lang="insertsl">\u63D2\u5165\u540C\u7EA7\u8282\u70B9</a></li>\n            <li trtd_action="startNewSpiral"><a class="i18n" data-lang="icn">\u63D2\u5165\u5B50\u8282\u70B9</a></li>\n            <li trtd_action="apiDuplicateNode"><a class="i18n" data-lang="duplicateNode">\u590D\u5236\u8282\u70B9</a></li>\n            <li trtd_action="apiDeleteSelection"><a class="i18n" data-lang="remove">\u5220\u9664</a></li>\n            <li trtd_action="splitOlive2Cbian"><a class="i18n" data-lang="remove">\u5206\u79BB</a></li>\n            <li trtd_action="splitOlive2Half"><a class="i18n" data-lang="remove">\u62C6\u5206</a></li>\n            <li trtd_action="orderChildNode"><a class="i18n" data-lang="ordernode">\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearOrderChildNode"><a class="i18n" data-lang="clearordernode">\u53D6\u6D88\u5B50\u8282\u70B9\u7F16\u53F7</a></li>\n            <li trtd_action="clearNodeTextMenu"><a class="i18n" data-lang="emptynodetext">\u6E05\u7A7A\u8282\u70B9\u6587\u672C</a></li>\n            <li trtd_action="apiInsertTianpanNode"><a class="i18n" data-lang="insertnodetianpan">\u63D2\u5165\u5929\u76D8\u8282\u70B9</a></li>\n            <li trtd_action="addTextNode"><a class="i18n" data-lang="inserttext">\u63D2\u5165\u6587\u672C</a></li>\n            <li trtd_action="locateRootNodeMenu"><a class="i18n" data-lang="locaterootnode">\u5B9A\u4F4D\u6839\u8282\u70B9</a></li>\n            <li trtd_action="showAllNodesMenu"><a class="i18n" data-lang="displayallnodes">\u663E\u793A\u6240\u6709\u8282\u70B9</a></li>\n            <li trtd_action="fixPictureMenu"><a class="i18n" data-lang="fixnode">\u56FA\u5B9A\u8282\u70B9</a></li>\n            <li trtd_action="activePictureMenu"><a class="i18n" data-lang="cancelfix">\u53D6\u6D88\u56FA\u5B9A</a></li>\n            <li trtd_action="apiSwitchToEllipse"><a class="i18n" data-lang="cancelfix">\u5207\u6362\u4E3A\u6A44\u6984\u5F62\u72B6</a></li>\n            <li trtd_action="apiSwitchToWave"><a class="i18n" data-lang="cancelfix">\u5207\u6362\u4E3A\u87BA\u65CB\u5F62\u72B6</a></li>\n            <li trtd_action="apiSwitchWaveTail"><a class="i18n" data-lang="cancelfix">\u6DFB\u52A0/\u5220\u9664\u5C3E\u5DF4</a></li>\n            <li trtd_action="apiSwitchTextAngle"><a class="i18n" data-lang="cancelfix">\u5207\u6362\u6587\u5B57\u65B9\u5411</a></li>\n            <li trtd_action="addCbian"><a class="i18n" data-lang="cancelfix">\u6DFB\u52A0\u603B\u7ED3\u56FE</a></li>\n            <li trtd_action="addAxisGroup"><a class="i18n" data-lang="cancelfix">\u63D2\u5165\u62D3\u6251</a></li>\n            <li trtd_action="showRect"><a class="i18n" data-lang="cancelfix">\u663E\u793A\u77E9\u5F62\u7EBF</a></li>\n            <li trtd_action="hideRect"><a class="i18n" data-lang="cancelfix">\u9690\u85CF\u77E9\u5F62\u7EBF</a></li>\n            <li trtd_action="offShowRedLine"><a class="i18n" data-lang="cancelfix">\u5173\u95ED\u81EA\u52A8\u663E\u793A\u7EA2\u7EBF</a></li>\n            <li trtd_action="autoShowRedline"><a class="i18n" data-lang="cancelfix">\u81EA\u52A8\u663E\u793A\u81EA\u65CB\u7EA2\u7EBF</a></li>\n            <li trtd_action="bringupLayer"><a class="i18n" data-lang="cancelfix">\u4E0A\u79FB\u4E00\u5C42</a></li>\n            <li trtd_action="bringdownLayer"><a class="i18n" data-lang="cancelfix">\u4E0B\u79FB\u4E00\u5C42</a></li>\n            <li trtd_action="bringToBackground"><a class="i18n" data-lang="cancelfix">\u7F6E\u4E8E\u5E95\u5C42</a></li>\n            <li trtd_action="bringToForeground"><a class="i18n" data-lang="cancelfix">\u7F6E\u4E8E\u9876\u5C42</a></li>\n            <li trtd_action="addDimTtext"><a class="i18n" data-lang="cancelfix">\u589E\u52A0\u7EF4\u5EA6</a></li>\n        </ul>\n        '}},{key:'getShowContextMenus',value:function(e){var a=null;return e?(-1<['axisGroup'].indexOf(e.data.category)&&(a='addCbian,apiDeleteSelection'),-1<['picGroup'].indexOf(e.data.category)&&(a='apiDeleteSelection'),-1<['3'].indexOf(e.data.category)&&(a='bringupLayer,apiDeleteSelection,bringdownLayer,bringToBackground,bringToForeground'),-1<['wave'].indexOf(e.data.category)&&(null==e.data.deletable?e.deletable&&(a='apiDeleteSelection,splitOlive2Cbian,splitOlive2Half'):e.data.deletable&&(a='apiDeleteSelection,splitOlive2Cbian,splitOlive2Half')),-1<['waveGroup'].indexOf(e.data.category)&&(a='apiSwitchTextAngle,',a+='Ellipse'==e.data.oliveType?'apiSwitchToWave':'apiSwitchToEllipse,apiSwitchWaveTail'),-1<['yunGroup'].indexOf(e.data.category)&&(a='',a+=e.data.showShape?'hideRect':'showRect',a+='line'==e.data.beginSpark?',offShowRedLine':',autoShowRedline'),-1<['autoText'].indexOf(e.data.category)&&0>['shiText','xuText'].indexOf(e.data.role)&&(a='apiDeleteSelection'),'dimText'==e.data.subRole&&'yunpanGroup'==e.containingGroup.data.category&&(a='apiDeleteSelection,addDimTtext'),'shapeText'==e.data.category&&'yunpanGroup'==e.containingGroup.data.category&&(a='apiDeleteSelection'),-1<['wave','autoText','shapeText'].indexOf(e.data.category)&&e.data.text&&(a+=',drillAnalyze')):(a=this.canAddAxisGroup?'addCbian,addAxisGroup':'addCbian'),a}},{key:'addDimTtext',value:function(){var e=this.diagram.selection.first(),a=this.diagram;if(e&&'dimText'==e.data.subRole){var t=0,o=e.containingGroup.findSubGraphParts().iterator,i=[],r=null,d='X',l='Y',s='verticalLine';for(0==e.data.dimX&&(d='Y',l='X',s='horizontalLine');o.next();){var c=o.value;'dimText'==c.data.subRole&&0==c.data['dim'+l]&&t++,'yunpanText'==c.data.subRole&&c.data['order'+d]==e.data['dim'+d]&&i.push(c.data),'line'==c.data.category&&c.data.role==s&&c.data.order==e.data['dim'+d]&&(r=c)}if(!(30<=t)){for(this.diagram.startTransaction('addDimTtext'),o.reset();o.next();){var c=o.value;'dimText'==c.data.subRole&&0==c.data['dim'+l]&&c.data['dim'+d]>e.data['dim'+d]&&c.diagram.model.setDataProperty(c.data,'dim'+d,c.data['dim'+d]+1),'yunpanText'==c.data.subRole&&c.data['order'+d]>e.data['dim'+d]&&c.diagram.model.setDataProperty(c.data,'order'+d,c.data['order'+d]+1),'line'==c.data.category&&c.data.role==s&&c.data.order>e.data['dim'+d]&&c.diagram.model.setDataProperty(c.data,'order',c.data.order+1)}var g=JSON.parse(JSON.stringify(e.data));if(delete g.key,delete g.__gohashid,r){var m=JSON.parse(JSON.stringify(r.data));delete m.key,delete m.__gohashid,++m.order,e.diagram.model.addNodeData(m)}g['dim'+d]=e.data['dim'+d]+1,g.text='\u7EF4\u5EA6'+g['dim'+d],e.diagram.model.addNodeData(g),e.containingGroup.layout.isOngoing=!0,e.containingGroup.layout.isValidLayout=!1,this.diagram.commitTransaction('addDimTtext')}}}},{key:'bringToBackground',value:function(){var e=this.diagram.selection.first(),a=this.diagram;a.model.startTransaction(),a.model.setDataProperty(e.data,'layerName','Background'),a.model.setDataProperty(e.data,'zOrder',1),a.model.commitTransaction()}},{key:'bringToForeground',value:function(){var e=this.diagram.selection.first(),a=this.diagram;a.model.startTransaction(),a.model.setDataProperty(e.data,'layerName','Foreground'),a.model.setDataProperty(e.data,'zOrder',999),a.model.commitTransaction()}},{key:'bringdownLayer',value:function(){var e=this.diagram.selection.first(),a=this.diagram;if(e){var t=e.layerName,o=t,i=e.zOrder;'Foreground'==t&&(o='default'),'default'==t&&(o='Background'),'Background'==t&&(o='Background'),a.model.startTransaction(),a.model.setDataProperty(e.data,'layerName',o),a.model.setDataProperty(e.data,'zOrder',1),a.model.commitTransaction()}}},{key:'bringupLayer',value:function(){var e=this.diagram.selection.first(),a=this.diagram;if(e){var t=e.layerName,o=t,i=e.zOrder;'Background'==t&&(o='default'),'default'==t&&(o='Foreground'),'Foreground'==t&&(o='Foreground'),a.model.startTransaction(),a.model.setDataProperty(e.data,'layerName',o),a.model.setDataProperty(e.data,'zOrder',999),a.model.commitTransaction()}}},{key:'bringToLayer',value:function(e){var a=myDiagram.selection.first();if(myDiagram.model.startTransaction(),a)if(null==e){e=a.data.layerName?a.data.layerName:'';var t=myDiagram.model.copyNodeData(a.data);myDiagram.model.removeNodeData(a.data),myDiagram.model.addNodeData(t)}else myDiagram.model.setDataProperty(a.data,'layerName',e);myDiagram.model.commitTransaction()}},{key:'showRect',value:function(){var e=this.diagram.selection.first();if(e&&'yunGroup'==e.data.category){e.diagram.startTransaction('showRect'),e.diagram.model.setDataProperty(e.data,'showShape',!0);for(var a=e.findSubGraphParts().iterator,t;a.next();)t=a.value,'background'==t.data.role&&e.diagram.model.setDataProperty(t.data,'visible',!0);e.layout.isValidLayout=!1,e.diagram.commitTransaction('showRect')}}},{key:'hideRect',value:function(){var e=this.diagram.selection.first();if(e&&'yunGroup'==e.data.category){e.diagram.startTransaction('hideRect'),e.diagram.model.setDataProperty(e.data,'showShape',!1);for(var a=e.findSubGraphParts().iterator,t;a.next();)t=a.value,'background'==t.data.role&&(e.diagram.model.setDataProperty(t.data,'visible',!0),e.diagram.model.setDataProperty(t.data,'stroke','rgba(255,0,0,0)'));e.diagram.commitTransaction('hideRect')}}},{key:'autoShowRedline',value:function(){var e=this.diagram.selection.first();e&&'yunGroup'==e.data.category&&(e.diagram.startTransaction('beginSpark'),e.diagram.model.setDataProperty(e.data,'beginSpark','line'),e.diagram.commitTransaction('beginSpark'))}},{key:'offShowRedLine',value:function(){var e=this.diagram.selection.first();e&&'yunGroup'==e.data.category&&(e.diagram.startTransaction('offShowRedLine'),e.diagram.model.setDataProperty(e.data,'beginSpark',void 0),e.diagram.commitTransaction('offShowRedLine'))}},{key:'dokeyDownFn',value:function(a){var e=this,t=this.diagram,o=this,i=this.diagram,a=i.lastInput,r=i.commandHandler;if(a.event.altKey){if('Q'==a.key)return void autoLayoutAll();if('R'==a.key)return void centerNode();if('C'==a.key)return void centerCurrentNode();if('A'==a.key)return void zoomToFit()}if(65<=a.event.keyCode&&90>=a.event.keyCode&&!a.event.altKey&&!a.event.ctrlKey&&!a.event.shiftKey){a.bubbles=!1;var d=i.selection.first();if(!d)return;if('wave'==d.data.category&&d.containingGroup&&'horizontal'==d.containingGroup.data.textAngle&&'independent'==d.containingGroup.data.centerTextAngle){d.findObject('TEXT').visible=!0;var l=d.diagram.findNodeForKey(d.data.centerText);l&&(l.visible=!1)}return setTimeout(function(){e.selectText(a,t)},100),!0}if(13===a.event.keyCode){var d=i.selection.first();d&&'wave'==d.category&&this.addOlive()}else 9===a.event.keyCode?this.addFollower(!0):'t'===a.key?r.canCollapseSubGraph()?r.collapseSubGraph():r.canExpandSubGraph()&&r.expandSubGraph():'Del'==a.key?a.diagram.commandHandler.deleteSelection():113==a.event.keyCode?this.selectText(a,t):37==a.event.keyCode?this.moveWithinNodes('left',t):38==a.event.keyCode?this.moveWithinNodes('up',t):39==a.event.keyCode?this.moveWithinNodes('right',t):40==a.event.keyCode?this.moveWithinNodes('down',t):go.CommandHandler.prototype.doKeyDown.call(r);a.bubbles=!1}},{key:'findPrevOlive',value:function(e){if(1>=e.data.order)return null;for(var a=null,t=e.containingGroup.findSubGraphParts().iterator,o;t.next();)if(o=t.value,'wave'==o.data.category&&o.data.order==e.data.order-1){a=o;break}return a}},{key:'findNextOlive',value:function(e){for(var a=null,t=e.containingGroup.findSubGraphParts().iterator,o;t.next();)if(o=t.value,'waveTail'!=o.data.role)if('autoText'==e.data.category){if('shiText'==o.data.role&&o.data.order==e.data.order+1){a=o;break}}else if('wave'==o.data.category&&o.data.order==e.data.order+1){a=o;break}return a}},{key:'findUpOlive',value:function(e){var a=null;return'wave'==e.data.category&&(0==e.data.order%2?a=this.diagram.findNodeForKey(e.data.shiText):a=this.diagram.findNodeForKey(e.data.xuText)),'xuText'==e.data.role&&(0!=e.data.order%2||(a=this.diagram.findNodeForKey(e.data.olive))),'shiText'==e.data.role&&0!=e.data.order%2&&(a=this.diagram.findNodeForKey(e.data.olive)),a}},{key:'findDownOlive',value:function(e){var a=null;return'wave'==e.data.category&&(0==e.data.order%2?a=this.diagram.findNodeForKey(e.data.xuText):a=this.diagram.findNodeForKey(e.data.shiText)),'xuText'==e.data.role&&0!=e.data.order%2&&(a=this.diagram.findNodeForKey(e.data.olive)),'shiText'==e.data.role&&(0!=e.data.order%2||(a=this.diagram.findNodeForKey(e.data.olive))),a}},{key:'moveWithinNodes',value:function(e){var a=this.diagram,t=a.selection.first();if(t){if('autoText'==t.data.category&&'coreText'==t.data.subRole){if(!(t.containingGroup&&'yunGroup'==t.containingGroup.data.category&&'yunpanGroup'==t.containingGroup.data.category))return;var o=3e4,i=3e4,r;switch(t.containingGroup.__yunPointsX&&t.containingGroup.__yunPointsY&&(o=(t.containingGroup.__yunPointsX.length+1)/2,i=(t.containingGroup.__yunPointsY.length+1)/2),e){case'left':if(t.data.orderX==o)return;for(var d=t.containingGroup.findSubGraphParts().iterator,l;d.next();)if(l=d.value,'coreText'==l.data.subRole&&l.data.dimKey==t.data.dimKey&&+l.data.orderX==+t.data.orderX-1){r=l;break}break;case'up':if(t.data.orderY==i)return;for(var d=t.containingGroup.findSubGraphParts().iterator,l;d.next();)if(l=d.value,'coreText'==l.data.subRole&&l.data.dimKey==t.data.dimKey&&+l.data.orderY==+t.data.orderY+1){r=l;break}break;case'right':if(t.data.orderX==o)return;for(var d=t.containingGroup.findSubGraphParts().iterator,l;d.next();)if(l=d.value,'coreText'==l.data.subRole&&l.data.dimKey==t.data.dimKey&&+l.data.orderX==+t.data.orderX+1){r=l;break}break;case'down':if(t.data.orderY==i)return;for(var d=t.containingGroup.findSubGraphParts().iterator,l;d.next();)if(l=d.value,'coreText'==l.data.subRole&&l.data.dimKey==t.data.dimKey&&+l.data.orderY==+t.data.orderY-1){r=l;break}}r&&a.select(r)}if('wave'==t.data.category||'shiText'==t.data.role||'xuText'==t.data.role)switch(e){case'left':var s=this.findPrevOlive(t);s&&a.select(s);break;case'up':var c=this.findUpOlive(t);c&&a.select(c);break;case'right':var r=this.findNextOlive(t);r&&a.select(r);break;case'down':var g=this.findDownOlive(t);g&&a.select(g);}}}},{key:'drillAnalyze',value:function(){var e=this.diagram.selection.first();if(e)if(null!=e.data.figure)this.openFigure&&this.openFigure({figure:e.data.figure,title:e.data.text,key:e.data.key,node:e});else if(this.createFigure)this.createFigure({title:e.data.text||'\u672A\u547D\u540D\u62D3\u6251',key:e.data.key,node:e})}}]),a}(c);e.exports=P},function(e,a,t){'use strict';function o(a){var e=a.diagram;e.startTransaction();var t={text:'\u53CC\u51FB\u7F16\u8F91\u6587\u672C',category:'text'};t.loc=go.Point.stringify(e.lastInput.documentPoint),e.model.addNodeData(t),e.commitTransaction()}var i=go.GraphObject.make,r=t(8);e.exports=function(e){return i(go.Node,'Spot',{name:'NODE',_controlExpand:!0,layerName:'Background',locationSpot:go.Spot.Center,resizeCellSize:new go.Size(10,10),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,rotateObjectName:'SHAPE',click:function(){},doubleClick:function(a){o(a)},selectable:!0,selectionObjectName:'SHAPE',movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:i(go.Adornment)},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),i(go.Shape,{name:'SHAPE',fill:'white',strokeWidth:3,stroke:'black',minSize:new go.Size(50,50)},new go.Binding('fill','fill').makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('desiredSize','desiredSize',function(e){return e}).ofObject('BACKGROUND'),new go.Binding('angle','angle',function(e){return e}).ofObject('BACKGROUND'),new go.Binding('geometryString','geometryString',function(e){return e})),i(go.Shape,'Rectangle',{name:'BACKGROUND',fill:'rgba(1,1,1,0)',angle:0,stroke:'rgba(1,1,1,0)'},new go.Binding('desiredSize','desiredSize',function(e,a){return e?go.Size.parse(e):a.part.findObject('SHAPE').measuredBounds.size}).makeTwoWay(function(e){return go.Size.stringify(e)})))}},function(e,a,t){'use strict';var o=go.GraphObject.make,i=t(8);e.exports=function(e){return o(go.Node,'Spot',{name:'NODE',zOrder:10,layerName:'default',padding:0,_controlExpand:!0,locationSpot:go.Spot.LeftCenter,resizeCellSize:new go.Size(1,1),locationObjectName:'SHAPE',resizable:!0,resizeObjectName:'SHAPE',rotatable:!0,mouseDragEnter:function(){},mouseDrop:function(a,e){e.part},click:function(){},deletable:!1,doubleClick:function(a,e){if(!e.selectable){var t=a.diagram.findObjectAt(a.documentPoint,function(e){return e.part},function(e){return e.canSelect()&&'wave'==e.data.category});t&&(a.diagram.select(t),t.doubleClick(a,t)),void 0}},selectable:!0,selectionObjectName:'SHAPE',movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:o(go.Adornment)},new go.Binding('zOrder','zOrder').makeTwoWay(),new go.Binding('selectable','selectable').makeTwoWay(),new go.Binding('locationSpot','locationSpot',function(e){return go.Spot.parse(e)}).makeTwoWay(function(e){return go.Spot.stringify(e)}),new go.Binding('movable','movable').makeTwoWay(),new go.Binding('visible','visible').makeTwoWay(),new go.Binding('deletable','deletable').makeTwoWay(),new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),new go.Binding('angle','angle').makeTwoWay(function(e,t,o){return e}),o(go.Shape,'LineH',{name:'SHAPE',alignment:go.Spot.Left,alignmentFocus:go.Spot.Left,stretch:go.GraphObject.Horizontal,strokeCap:'round',strokeDashArray:[0,0],width:300,height:20,margin:0,fill:'white',strokeWidth:3,stroke:'black',minSize:new go.Size(NaN,10),maxSize:new go.Size(NaN,20)},new go.Binding('fill','fill').makeTwoWay(function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeDashArray','strokeDashArray',function(e){return JSON.parse(e)}).makeTwoWay(function(e){return JSON.stringify(e)}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('desiredSize','desiredSize',function(e,a){return e?go.Size.parse(e):a.part.findObject('SHAPE').measuredBounds.size}).makeTwoWay(function(e){return go.Size.stringify(e)})),o(go.Shape,{name:'BeginArrow',visible:!1,margin:0,alignment:new go.Spot(0,.5,10,0),alignmentFocus:go.Spot.Right,geometryString:'M 0,-4 l -8,4 8,4',strokeCap:'round',fill:'black',width:10,height:15,strokeWidth:3,stroke:'black'},new go.Binding('fill','stroke',function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('visible','showBeginArrow')),o(go.Shape,{name:'EndArrow',visible:!1,margin:0,alignment:new go.Spot(1,.5,0,0),alignmentFocus:go.Spot.Right,geometryString:'M 0,-4 l 8,4 -8,4',strokeCap:'round',fill:'black',width:10,height:15,strokeWidth:3,stroke:'black'},new go.Binding('fill','stroke',function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('visible','showEndArrow')),o(go.Shape,{name:'Arrow',visible:!0,margin:0,alignment:new go.Spot(1,.5,5,0),alignmentFocus:go.Spot.Right,geometryString:'F M 158,-4 l 8,4 -8,4 2,-4 z',strokeCap:'round',fill:'black',width:20,height:15,strokeWidth:3,stroke:'black'},new go.Binding('fill','stroke',function(e){return e}),new go.Binding('stroke','stroke').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e}),new go.Binding('visible','showArrow')))}},function(e,a,t){'use strict';function o(){return go.Geometry.parse('M 0,80 A100,80 0 1 1 200,80')}function i(e,a){var t=go.Geometry.parse('M 0,80 A100,80 0 1 0 200,80');return a.isGeometryPositioned=!0,a.position=new go.Point(-100,-100),t}function r(a){var e=a.diagram;e.startTransaction();var t={text:'\u53CC\u51FB\u7F16\u8F91\u6587\u672C',category:'text'};t.loc=go.Point.stringify(e.lastInput.documentPoint),e.model.addNodeData(t),e.commitTransaction()}var d=go.GraphObject.make,l=t(8);e.exports=function(e){return d(go.Node,'Spot',{name:'NODE',_controlExpand:!0,layerName:'Background',locationSpot:go.Spot.Center,locationObjectName:'BACKGROUND',resizable:!0,resizeObjectName:'BACKGROUND',rotatable:!0,rotateObjectName:'BACKGROUND',click:function(){},doubleClick:function(a){r(a)},selectable:!0,movable:!0,angle:0,layoutConditions:go.Part.LayoutStandard&go.Part.LayoutNodeSized&go.Part.LayoutAdded&go.Part.LayoutNodeSized,alignment:go.Spot.Center,alignmentFocus:go.Spot.Center,resizeAdornmentTemplate:e.__trtd.nodeResizeAdornmentTemplate(),contextMenu:d(go.Adornment)},new go.Binding('location','loc',go.Point.parse).makeTwoWay(go.Point.stringify),d(go.Shape,'Rectangle',{name:'BACKGROUND',fill:'rgba(1,1,1,0)',angle:0,stroke:'rgba(1,1,1,1)'},new go.Binding('desiredSize','desiredSize',function(e){return go.Size.parse(e)}).makeTwoWay(function(e){return go.Size.stringify(e)})),d(go.Shape,{name:'UP',stroke:'blue',position:new go.Point(0,0),isGeometryPositioned:!0,alignment:go.Spot.Center,stretch:go.GraphObject.Fill},new go.Binding('geometry','',o),new go.Binding('stroke','stroke1').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e})),d(go.Shape,{name:'DOWN',stroke:'red',alignment:go.Spot.Center,strokeDashArray:[10,10],isGeometryPositioned:!0,position:new go.Point(-100,-100),stretch:go.GraphObject.Fill},new go.Binding('geometry','',i),new go.Binding('stroke','stroke2').makeTwoWay(function(e){return e}),new go.Binding('strokeWidth','strokeWidth').makeTwoWay(function(e){return e})))}},function(e){'use strict';function a(){go.RotatingTool.call(this),this._initialInfo=null,this._rotatePoint=new go.Point,this.handleAngle=0,this.handleArchetype=o(go.Panel,'Auto',o(go.Shape,'BpmnActivityLoop',{width:30,height:30,stroke:'green',fill:'transparent'}),o(go.Shape,'Rectangle',{width:30,height:30,stroke:'green',fill:'transparent',strokeWidth:0}))}function t(e,a,t){this.relativeLocation=e,this.centerLocationOffset=a,this.rotationAngle=t}var o=go.GraphObject.make;go.Diagram.inherit(a,go.RotatingTool),a.prototype.doActivate=function(){go.RotatingTool.prototype.doActivate.call(this);var e=this.adornedObject.part;if(e instanceof go.Group&&'waveGroup'==e.data.category){this._rotatePoint=e.location;var a=new go.Map(go.Part,t),o=e.data.textAngle||'vertical';this.walkTree(e,a,o),this._initialInfo=a}},a.prototype.walkTree=function(e,a,o){if(!(null===e||e instanceof go.Link)&&('horizontal'!=o||'autoText'!=e.data.category)){var i=e.locationObject.getDocumentPoint(go.Spot.Center),r=i.copy().subtract(e.location),d=i.subtract(this._rotatePoint);if(a.add(e,new t(d,r,e.rotateObject.angle)),e instanceof go.Group)for(var l=e.memberParts.iterator;l.next();)this.walkTree(l.value,a,o)}},a.prototype.rotate=function(e){var a=this.adornedObject.part;if(a instanceof go.Group&&(300>(e+360)%360||340<(e+360)%360)&&(300>(e+360)%360&&(e=300),340<(e+360)%360&&(e=340),void 0),go.RotatingTool.prototype.rotate.call(this,e),a instanceof go.Group){var t=e-this.originalAngle,o=this._rotatePoint;a.diagram.startTransaction();for(var i=this._initialInfo.iterator,r;i.next();){if(r=i.key,r instanceof go.Link)return;var d=i.value,l=d.rotationAngle+t,s=o.copy().add(d.relativeLocation),c=o.directionPoint(s),g=(t+c)*(_MathPI/180),m=d.centerLocationOffset.copy();m.rotate(t);var p=_Mathsqrt(o.distanceSquaredPoint(s)),u=new go.Point(o.x+p*_Mathcos(g),o.y+p*_Mathsin(g)).subtract(m);a.diagram.model.setDataProperty(r.data,'loc',go.Point.stringify(u)),a.diagram.model.setDataProperty(r.data,'angle',l),a.layout.isOngoing=!0,a.layout.isValidLayout=!1,a.containingGroup&&(a.containingGroup.layout.isOngoing=!0,a.containingGroup.layout.isValidLayout=!1),a.diagram.commitTransaction()}}},e.exports=a},function(){'use strict';(function(e){function a(){o.style.minHeight='40px',o.style.height='auto',o.style.height=o.scrollHeight+'px'}function t(){setTimeout(a,0)}var o=document.createElement('textarea');o.id='myTextArea',void 0,o.addEventListener('input',function(){var e=r.tool;if(null!==e.textBlock){var a=e.measureTemporaryTextBlock(this.value),t=this.textScale;this.style.width=20+a.measuredBounds.width*t+'px',this.rows=a.lineCount}},!1);var i;i=e.attachEvent?function(e,a){a.forEach(function(a){e.attachEvent('on'+a.evt,a.handler)})}:function(e,a){a.forEach(function(a){e.addEventListener(a.evt,a.handler,!1)})},i(o,[{evt:'change',handler:a},{evt:'cut',handler:t},{evt:'paste',handler:t},{evt:'drop',handler:t},{evt:'keydown',handler:t}]),o.addEventListener('keydown',function(a){var e=r.tool;if(null!==e.textBlock){var t=a.which;return 13===t?(!1===e.textBlock.isMultiline&&a.preventDefault(),void e.acceptText(go.TextEditingTool.Enter)):9===t?(e.acceptText(go.TextEditingTool.Tab),void a.preventDefault()):void(27===t&&(e.doCancel(),null!==e.diagram&&e.diagram.doFocus()))}},!1),o.addEventListener('focus',function(){var e=r.tool;e&&null!==e.currentTextEditor&&(e.state===go.TextEditingTool.StateActive&&(e.state=go.TextEditingTool.StateEditing),e.selectsTextOnActivate&&(o.select(),o.setSelectionRange(0,9999)))},!1),o.addEventListener('blur',function(){var e=r.tool;e&&null!==e.currentTextEditor&&e.state!==go.TextEditingTool.StateNone&&(o.focus(),e.selectsTextOnActivate&&(o.select(),o.setSelectionRange(0,9999)))},!1);var r=new go.HTMLInfo;r.valueFunction=function(){return o.value},r.mainElement=o,r.show=function(e,t,i){if(e instanceof go.TextBlock){if(r.tool=i,i.state===go.TextEditingTool.StateInvalid)return o.style.border='3px solid red',void o.focus();var d=e.getDocumentPoint(go.Spot.Center),l=t.position,s=t.scale,c=e.getDocumentScale()*s;c<i.minimumEditorScale&&(c=i.minimumEditorScale);var g=e.naturalBounds.width*c+6,m=e.naturalBounds.height*c+2,p=(d.x-l.x)*s,u=(d.y-l.y)*s;o.value=e.text,t.div.style.font=e.font;var y=1;o.style.position='absolute',o.style.zIndex='100',o.style.font='inherit',o.style.fontSize=100*c+'%',o.style.lineHeight='normal',o.style.width=g+'px',o.style.left=(0|p-g/2)-y+'px',o.style.top=(0|u-m/2)-y+'px',o.style.textAlign=e.textAlign,o.style.margin='0',o.style.padding=y+'px',o.style.border='0',o.style.outline='none',o.style.whiteSpace='pre-wrap',o.style.overflow='hidden',o.rows=e.lineCount,o.textScale=c,o.className='goTXarea',t.div.appendChild(o),o.focus(),i.selectsTextOnActivate&&(o.select(),o.setSelectionRange(0,9999)),a()}},r.hide=function(e){e.div.removeChild(o),r.tool=null},e.TextEditor=r})(window)}])});
//# sourceMappingURL=hardcore.min.js.map